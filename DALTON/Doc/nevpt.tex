\chapter{NEVPT2 calculations}\label{ch:nevpt2}

\section{General considerations}\label{sec:nevptgeneral}
NEVPT2 \index{NEVPT2} is a form of second-order multireference
perturbation theory \index{multireference PT}
which can be applied to CAS--SCF wavefunctions or, more generally, to
CAS--CI wavefunctions. The term NEVPT is an acronym for
\textit{``n--electron valence state perturbation theory''}. While we
refer the reader to the pertinent
literature~\cite{nevpt1,nevpt2,nevpt3}, we limit ourselves to
recalling here that the most relevant feature of NEVPT2 consists in
that the first order correction to the wave function is expanded over a
set of properly chosen \emph{multireference} functions which correctly
take into consideration the two--electron interactions occurring among
the active electrons. Among the properties ensured by NEVPT2 we quote:

\begin{itemize}
\item Strict separability (size consistence): the energy of a
  collection of non--interacting systems equals the sum of the
  energies of the isolated systems
\item Absence of intruder states: the zero-order energies associated
  to the functions of the outer space are well separated from the
  zero-order energy of the state being studied, thus avoiding
  divergences in   the perturbation summation
\item The first order correction to the wavefunction is an
  eigenfunction of the spin operators $S^2$ and $S_z$
\item Electronically excited states are dealt with at the same level
  of accuracy as the ground state
\item NEVPT2 energies are invariant under a unitary transformation of
  the active orbitals. Furthermore, the choice of canonical orbitals
  for the core and virtual orbitals (the default choice) ensure that
  the results coincide with those of an enlarged version of the theory
  fully invariant under rotations in the core and virtual orbital
  spaces, respectively.%~\cite{nevpt4}
\item NEVPT2 coincides with MP2 in the case of a HF wave function
\end{itemize}

NEVPT2 has been implemented in two variants both of which are present
in \dalton, these are the \emph{strongly contracted} (SC) and the
\emph{partially contracted} (PC) variants. The two variants differ by
the number of perturber functions employed in the perturbation
summation. The PC--NEVPT2 uses a richer function space and is
in general more accurate than the SC--NEVPT2. The results of
SC--NEVPT2 and PC--NEVPT2 are anyway usually very close to one
another.

\begin{center}
\fbox{
\parbox[h][\height][l]{12cm}{
\small
\noindent
{\bf Reference literature:}
\begin{list}{}{}
\item General reference : C.~Angeli, R.~Cimiraglia, S.~Evangelisti,
  T.~Leininger and J.~P.~Malrieu,
\newblock {\em J.~Chem.~Phys.}, {\bf 114},\hspace{0.25em}10252, (2001)
\item General reference : C.~Angeli, R.~Cimiraglia and J.~P.~Malrieu,
\newblock {\em Chem. Phys. Lett.}, {\bf 350},\hspace{0.25em}297, (2001)
\item General reference : C.~Angeli, R.~Cimiraglia and J.~P.~Malrieu,
\newblock {\em J. Chem. Phys.}, {\bf 117}, \hspace{0.25em}9138, (2002)
\item  Excited states : C.~Angeli, S.~Borini and R.~Cimiraglia,
\newblock {\em Theor.~Chem.~Acc.}, {\bf 111}, \hspace{0.25em}352 (2004)
\end{list}
}}
\end{center}

\section{Input description}\label{sec:nevpt2input}

NEVPT2 must follow a CAS--SCF or CAS--CI calculation. The keyword
\Key{NEVPT2} has to be specified in the \Sec{*WAVE FUNCTIONS} data
section. Furthermore a small {*NEVPT2} data group
 can be specified providing the few input data that can
optionally be provided by the user:
\Key{THRESH},
the threshold to discard small coefficients in the CAS wavefunction
(default = 0.0),
\Key{FROZEN},
a vector specifying for each symmetry the core orbitals which are
excluded from the correlation treatment (the default is no
freezing) and
\Key{STATE},
the state in a CASCI calculation. This keyword is unnecessary
(ignored) in the CASSCF case.
An example of a NEVPT2 calculation is

\begin{verbatim}
**DALTON INPUT
**WAVE FUNCTIONS
.MCSCF
.NEVPT2
*NEVPT2
.THRESH
1.0D-12
.FROZEN
 1 0 1 0
**END OF DALTON INPUT
\end{verbatim}
