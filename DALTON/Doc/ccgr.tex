%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Gradients \Sec{CCGR}}\label{sec:ccgr}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\index{numerical derivatives!coupled cluster}

This section is used in the calculation of numerical derivatives
of the CC energy. Since it is numerical it can be used for all models
and both ground and excited states.

For excited states there is the problem of specifying 
which excited state is to be studied - and keeping track of this.
One can specify the excited state by symmetry and number, using the keywords below.
This works fine for gradients (though ordering may change in course of the
optimization, but excited state optimization will inevitably be less black box
than ground state optimizations), but can fail when there is symmetry lowering
in the calculation of numerical Hessians. 
For this purpose one can give the excitation energy for the 
appropriate state at a lower level 
(for example CCS) and from that find symmetry and number used 
in the real higher level calculation.
%Solves partially the problem in (i). 
It is implemented by the keywords in the CCEXCI section.

\begin{description}

\item[\Key{NUMGD}] 

Specify that the calculation of gradients is to be done numerically.
All that is required for coupled cluster (in addition to appropriate 
minimization, keywords see Chapter~\ref{ch:geometrywalks}).

\item[\Key{XSTNUM}] \verb| | \newline
\verb|READ (LUCMD,*) IXSTAT|\newline
The number of the excited state for which the  gradient is to be calculated 
(counted in terms of increasing energy).

\item[\Key{XSTSYM}]  \verb| | \newline
\verb|READ (LUCMD,*) IXSTSY|\newline
Symmetry for excited state for which gradient is to be calculated.


\end{description}
