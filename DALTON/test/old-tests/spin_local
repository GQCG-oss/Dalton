#!/bin/sh
#
# This is the script for generating files for a specific Dalton test job.
#
# For the .check file ksh or bash is preferred, otherwise use sh
# (and hope it is not the old Bourne shell, which will not work)
#
if [ -x /bin/ksh ]; then
   CHECK_SHELL='#!/bin/ksh'
elif [ -x /bin/bash ]; then
   CHECK_SHELL='#!/bin/bash'
else
   CHECK_SHELL='#!/bin/sh'
fi


#######################################################################
#  TEST DESCRIPTION                                                   #
#######################################################################
cat > spin_local.info <<'%EOF%'
   spin_local
   ----------
   Molecule:         H2O
   Wave Function:    DFT/B3LYP (6-31G)
   Test Purpose:     Analysis of spin-spin coupling constants
                     in terms of localized occupied orbitals
                     using Foster-Boys localization
%EOF%

#######################################################################
#  MOLECULE INPUT                                                     #
#######################################################################
cat > spin_local.mol <<'%EOF%'
BASIS
6-31G
Test for localization of orbitals.
Water
    2    0      
Charge=8.0 Atoms=1 
O     0.00000  -0.22491  0.00000
Charge=1.0 Atoms=2 
H1    1.45235   0.89962  0.00000
H2   -1.45235   0.89962  0.00000
FINISH
%EOF%

#######################################################################
#  DALTON INPUT                                                       #
#######################################################################
cat > spin_local.dal <<'%EOF%'
**DALTON INPUT
.RUN PROPERTIES
**INTEGRALS
.NOSUP
**WAVE FUNCTIONS
.DFT
 B3LYP
*ORBITAL
.NOSUPSYM
**PROPERTIES
.LOCALIZATION
.SPIN-SPIN
*TRPRSP
.MAXRED
 1700
.THRESH
 1.0D-5
*LINRES
.MAXRED
 1700
.THRESH
 1.0D-5
*SPIN-SPIN
.SOSOCC
.ABUNDA
 0.04
*LOCALIZATION
.FOSBOY
*END OF DALTON INPUT
%EOF%

#######################################################################
#  CHECK SCRIPT                                                       #
#######################################################################
echo $CHECK_SHELL > spin_local.check
cat >> spin_local.check <<'%EOF%'
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi

# Basis set
CRIT1=`$GREP "O * 1 * 8\.0000 * 22 * 9 * \[10s4p\|3s2p\]" $log | wc -l`
CRIT2=`$GREP "H2 * 2 * 1\.0000 * 4 * 2 * \[4s\|2s\]" $log | wc -l`
CRIT3=`$GREP "total\: * 3 * 1(0| )\.0000 * 30 * 13" $log | wc -l`
TEST[1]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[1]=3
ERROR[1]="BASIS SET NOT CORRECT"

# Cartesian Coordinates
CRIT1=`$GREP "Total number of coordinates\: * 9" $log | wc -l`
CRIT2=`$GREP "O * \: * 1 * x * (0| )\.0000000000 * 2 * y * (\-0| \-)\.2249100000 * 3 * z * (0| )\.0000000000" $log | wc -l`
CRIT3=`$GREP "H1 * \: * 4 * x * 1\.4523500000 * 5 * y * (0| )\.8996200000 * 6 * z * (0| )\.0000000000" $log | wc -l`
CRIT4=`$GREP "H2 * \: * 7 * x * \-1\.4523500000 * 8 * y * (0| )\.8996200000 * 9 * z * (0| )\.0000000000" $log | wc -l`
CRIT5=`$GREP "bond distance\: * H1 * O * (0| )\.972[0-9][0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "bond distance\: * H2 * O * (0| )\.972[0-9][0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "bond angle\: * H1 * O * H2 * 104\.5[0-9][0-9]" $log | wc -l`
TEST[2]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7`
CTRL[2]=10
ERROR[2]="CARTESIAN COORDINATES NOT CORRECT"

# DFT setup
CRIT1=`$GREP "Restricted\, closed shell Kohn\-Sham DFT calculation\." $log | wc -l`
CRIT2=`$GREP "Number of closed shell electrons * 10" $log | wc -l`
CRIT3=`$GREP "This is a DFT calculation of type\: B3LYP" $log | wc -l`
CRIT4=`$GREP "Weighted mixed functional\:" $log | wc -l`
CRIT5=`$GREP "HF exchange\: * (0| )\.20[0-9][0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "VWN\: * (0| )\.190[0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "LYP\: * (0| )\.810[0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "Becke\: * (0| )\.720[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "Slater\: * (0| )\.800[0-9][0-9]" $log | wc -l`
TEST[3]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[3]=16
ERROR[3]="DFT SETUP NOT CORRECT"

# DFT energy
CRIT1=`$GREP "Final DFT energy\: * \-76\.348553[0-9][0-9][0-9][0-9][0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "Nuclear repulsion\: * 9\.055001[0-9][0-9][0-9][0-9][0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "Electronic energy\: * \-85\.403554[0-9][0-9][0-9][0-9][0-9][0-9]" $log | wc -l`
TEST[4]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[4]=3
ERROR[4]="DFT ENERGY NOT CORRECT"

# Properties setup
CRIT1=`$GREP "Nuclear spin\-spin coupling constants" $log | wc -l`
CRIT2=`$GREP "Localized orbitals are used in the analysis" $log | wc -l`
CRIT3=`$GREP "Spin\-spin couplings printed for atoms with abundance greater than \: * (0| )\.040 \%" $log | wc -l`
CRIT4=`$GREP "Orbital analysis of spin\-spin couplings" $log | wc -l`
CRIT5=`$GREP "Only contributions from pairs of occupied * orbitals are printed" $log | wc -l`
TEST[5]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[5]=5
ERROR[5]="PROPERTIES SETUP NOT CORRECT"

# Foster-Boys localization 
CRIT1=`$GREP "FOSOCC\: Foster Boys localization of all occupied orbitals" $log | wc -l`
CRIT2=`$GREP "INCREASED BY * 2\.349[0-9][0-9] * TO * 2\.733[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "1 * O * 1s * \-*1\.0102 * \-*0*\.0649 * \-*0*\.0649 * \-*0*\.0816 * \-*0*\.0816" $log | wc -l`
CRIT4=`$GREP "2 * O * 1s * \-*0*\.0130 * \-*0*\.2082 * \-*0*\.2082 * \-*0*\.2915 * \-*0*\.2915" $log | wc -l`
CRIT5=`$GREP "3 * O * 1s * \-*0*\.0597 * \-*0*\.1376 * \-*0*\.1376 * \-*0*\.3891 * \-*0*\.3891" $log | wc -l`
CRIT6=`$GREP "4 * O * 2px * \-*0*\.0000 * \-*0*\.3640 * \-*0*\.3640 * \-*0*\.0000 * \-*0*\.0000" $log | wc -l`
CRIT7=`$GREP "5 * O * 2py * \-*0*\.0125 * \-*0*\.2896 * \-*0*\.2896 * \-*0*\.2740 * \-*0*\.2740" $log | wc -l`
CRIT8=`$GREP "6 * O * 2pz * \-*0*\.0000 * \-*0*\.0000 * \-*0*\.0000 * \-*0*\.4571 * \-*0*\.4571" $log | wc -l`
CRIT9=`$GREP "7 * O * 2px * \-*0*\.0000 * \-*0*\.1679 * \-*0*\.1679 * \-*0*\.0000 * \-*0*\.0000" $log | wc -l`
CRIT10=`$GREP "8 * O * 2py * \-*0*\.0068 * \-*0*\.1799 * \-*0*\.1799 * \-*0*\.2016 * \-*0*\.2016" $log | wc -l`
CRIT11=`$GREP "9 * O * 2pz * \-*0*\.0000 * \-*0*\.0000 * \-*0*\.0000 * \-*0*\.3569 * \-*0*\.3569" $log | wc -l`
CRIT12=`$GREP "10 * H1 * 1s * (0| )\.0049 * (0\.0455| \.0455|\-0\.0455| \-\.0455|0\.3295| \.3295|\-0\.3295| \-\.3295) * (0\.0455| \.0455|\-0\.0455| \-\.0455|0\.3295| \.3295|\-0\.3295| \-\.3295) * (0| |\-0| \-)\.0328 * (0| |\-0| \-)\.0328" $log | wc -l`
CRIT13=`$GREP "11 * H1 * 1s * (\-0| \-)\.0071 * (0\.1475| \.1475|\-0\.1475| \-\.1475|0\.0675| \.0675|\-0\.0675| \-\.0675) * (0\.0675| \.0675|\-0\.0675| \-\.0675|0\.1475| \.1475|\-0\.1475| \-\.1475) * (0| |\-0| \-)\.0647 * (0| |\-0| \-)\.0647" $log | wc -l`
CRIT14=`$GREP "12 * H2 * 1s * (0| )\.0049 * (0\.0455| \.0455|\-0\.0455| \-\.0455|0\.3295| \.3295|\-0\.3295| \-\.3295) * (0\.0455| \.0455|\-0\.0455| \-\.0455|0\.3295| \.3295|\-0\.3295| \-\.3295) * (0| |\-0| \-)\.0328 * (0| |\-0| \-)\.0328" $log | wc -l`
CRIT15=`$GREP "13 * H2 * 1s * (\-0| \-)\.0071 * (0\.1475| \.1475|\-0\.1475| \-\.1475|0\.0675| \.0675|\-0\.0675| \-\.0675) * (0\.1475| \.1475|\-0\.1475| \-\.1475|0\.0675| \.0675|\-0\.0675| \-\.0675) * (0| |\-0| \-)\.0647 * (0| |\-0| \-)\.0647" $log | wc -l`
TEST[6]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[6]=15
ERROR[6]="FOSTER-BOYS LOCALIZATION NOT CORRECT"

# Triplet excitation energies
CRIT1=`$GREP "1 * 1 * (0| )\.2525[0-9] * 6\.870[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "1 * 2 * (0| )\.3152[0-9] * 8\.578[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "1 * 3 * (0| )\.3375[0-9] * 9\.185[0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "1 * 4 * (0| )\.3923[0-9] * 1(0| )\.674[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "1 * 5 * (0| )\.4755[0-9] * 12\.938[0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "1 * 6 * (0| )\.5411[0-9] * 14\.725[0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "1 * 7 * (0| )\.9423[0-9] * 25\.642[0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "1 * 8 * (0| )\.9948[0-9] * 27\.071[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "1 * 9 * 1\.0024[0-9] * 27\.277[0-9][0-9]" $log | wc -l`
CRIT10=`$GREP "1 * 10 * 1\.0220[0-9] * 27\.811[0-9][0-9]" $log | wc -l`
CRIT11=`$GREP "1 * 11 * 1\.0410[0-9] * 28\.327[0-9][0-9]" $log | wc -l`
CRIT12=`$GREP "1 * 12 * 1\.0491[0-9] * 28\.548[0-9][0-9]" $log | wc -l`
CRIT13=`$GREP "1 * 13 * 1\.0614[0-9] * 28\.883[0-9][0-9]" $log | wc -l`
CRIT14=`$GREP "1 * 14 * 1\.0975[0-9] * 29\.864[0-9][0-9]" $log | wc -l`
CRIT15=`$GREP "1 * 15 * 1\.1409[0-9] * 31\.048[0-9][0-9]" $log | wc -l`
CRIT16=`$GREP "1 * 16 * 1\.1458[0-9] * 31\.181[0-9][0-9]" $log | wc -l`
CRIT17=`$GREP "1 * 17 * 1\.2020[0-9] * 32\.708[0-9][0-9]" $log | wc -l`
CRIT18=`$GREP "1 * 18 * 1\.2140[0-9] * 33\.035[0-9][0-9]" $log | wc -l`
CRIT19=`$GREP "1 * 19 * 1\.2286[0-9] * 33\.432[0-9][0-9]" $log | wc -l`
CRIT20=`$GREP "1 * 20 * 1\.2868[0-9] * 35\.017[0-9][0-9]" $log | wc -l`
CRIT21=`$GREP "1 * 21 * 1\.2964[0-9] * 35\.278[0-9][0-9]" $log | wc -l`
CRIT22=`$GREP "1 * 22 * 1\.3598[0-9] * 37\.002[0-9][0-9]" $log | wc -l`
CRIT23=`$GREP "1 * 23 * 1\.4390[0-9] * 39\.158[0-9][0-9]" $log | wc -l`
CRIT24=`$GREP "1 * 24 * 1\.5554[0-9] * 42\.326[0-9][0-9]" $log | wc -l`
CRIT25=`$GREP "1 * 25 * 1\.6433[0-9] * 44\.716[0-9][0-9]" $log | wc -l`
CRIT26=`$GREP "1 * 26 * 1\.7007[0-9] * 46\.280[0-9][0-9]" $log | wc -l`
CRIT27=`$GREP "1 * 27 * 1\.7303[0-9] * 47\.084[0-9][0-9]" $log | wc -l`
CRIT28=`$GREP "1 * 28 * 1\.7652[0-9] * 48\.033[0-9][0-9]" $log | wc -l`
CRIT29=`$GREP "1 * 29 * 1\.8077[0-9] * 49\.190[0-9][0-9]" $log | wc -l`
CRIT30=`$GREP "1 * 30 * 1\.8507[0-9] * 5(0| )\.361[0-9][0-9]" $log | wc -l`
CRIT31=`$GREP "1 * 31 * 1\.9492[0-9] * 53\.041[0-9][0-9]" $log | wc -l`
CRIT32=`$GREP "1 * 32 * 2\.2888[0-9] * 62\.281[0-9][0-9]" $log | wc -l`
CRIT33=`$GREP "1 * 33 * 19\.073[0-9][0-9] * 519\.01[0-9][0-9][0-9]" $log | wc -l`
CRIT34=`$GREP "1 * 34 * 19\.149[0-9][0-9] * 521\.07[0-9][0-9][0-9]" $log | wc -l`
CRIT35=`$GREP "1 * 35 * 19\.799[0-9][0-9] * 538\.77[0-9][0-9][0-9]" $log | wc -l`
CRIT36=`$GREP "1 * 36 * 19\.800[0-9][0-9] * 538\.80[0-9][0-9][0-9]" $log | wc -l`
CRIT37=`$GREP "1 * 37 * 19\.834[0-9][0-9] * 539\.73[0-9][0-9][0-9]" $log | wc -l`
CRIT38=`$GREP "1 * 38 * 19\.946[0-9][0-9] * 542\.77[0-9][0-9][0-9]" $log | wc -l`
CRIT39=`$GREP "1 * 39 * 19\.997[0-9][0-9] * 544\.15[0-9][0-9][0-9]" $log | wc -l`
CRIT40=`$GREP "1 * 40 * 2(0| )\.387[0-9][0-9] * 554\.76[0-9][0-9][0-9]" $log | wc -l`
TEST[7]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
		$CRIT25 \+ $CRIT26 \+ $CRIT27 \+ $CRIT28 \+ $CRIT29 \+ $CRIT30 \+ \
		$CRIT31 \+ $CRIT32 \+ $CRIT33 \+ $CRIT34 \+ $CRIT35 \+ $CRIT36 \+ \
		$CRIT37 \+ $CRIT38 \+ $CRIT39 \+ $CRIT40`
CTRL[7]=40
ERROR[7]="TRIPLET EXCITATION ENERGIES NOT CORRECT"

# Singlet excitation energies
CRIT1=`$GREP "1 * 1 * (0| )\.2818[0-9] * 7\.669[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "1 * 2 * (0| )\.3593[0-9] * 9\.777[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "1 * 3 * (0| )\.3607[0-9] * 9\.815[0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "1 * 4 * (0| )\.4495[0-9] * 12\.231[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "1 * 5 * (0| )\.5342[0-9] * 14\.537[0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "1 * 6 * (0| )\.6599[0-9] * 17\.958[0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "1 * 7 * 1\.0146[0-9] * 27\.610[0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "1 * 8 * 1\.0258[0-9] * 27\.914[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "1 * 9 * 1\.0604[0-9] * 28\.857[0-9][0-9]" $log | wc -l`
CRIT10=`$GREP "1 * 10 * 1\.0967[0-9] * 29\.843[0-9][0-9]" $log | wc -l`
CRIT11=`$GREP "1 * 11 * 1\.1129[0-9] * 3(0| )\.283[0-9][0-9]" $log | wc -l`
CRIT12=`$GREP "1 * 12 * 1\.1350[0-9] * 3(0| )\.885[0-9][0-9]" $log | wc -l`
CRIT13=`$GREP "1 * 13 * 1\.1401[0-9] * 31\.024[0-9][0-9]" $log | wc -l`
CRIT14=`$GREP "1 * 14 * 1\.1734[0-9] * 31\.930[0-9][0-9]" $log | wc -l`
CRIT15=`$GREP "1 * 15 * 1\.1925[0-9] * 32\.451[0-9][0-9]" $log | wc -l`
CRIT16=`$GREP "1 * 16 * 1\.2482[0-9] * 33\.965[0-9][0-9]" $log | wc -l`
CRIT17=`$GREP "1 * 17 * 1\.3130[0-9] * 35\.730[0-9][0-9]" $log | wc -l`
CRIT18=`$GREP "1 * 18 * 1\.3175[0-9] * 35\.852[0-9][0-9]" $log | wc -l`
CRIT19=`$GREP "1 * 19 * 1\.3178[0-9] * 35\.861[0-9][0-9]" $log | wc -l`
CRIT20=`$GREP "1 * 20 * 1\.3293[0-9] * 36\.172[0-9][0-9]" $log | wc -l`
CRIT21=`$GREP "1 * 21 * 1\.3649[0-9] * 37\.142[0-9][0-9]" $log | wc -l`
CRIT22=`$GREP "1 * 22 * 1\.4401[0-9] * 39\.187[0-9][0-9]" $log | wc -l`
CRIT23=`$GREP "1 * 23 * 1\.6423[0-9] * 44\.691[0-9][0-9]" $log | wc -l`
CRIT24=`$GREP "1 * 24 * 1\.6436[0-9] * 44\.725[0-9][0-9]" $log | wc -l`
CRIT25=`$GREP "1 * 25 * 1\.7239[0-9] * 46\.909[0-9][0-9]" $log | wc -l`
CRIT26=`$GREP "1 * 26 * 1\.7667[0-9] * 48\.076[0-9][0-9]" $log | wc -l`
CRIT27=`$GREP "1 * 27 * 1\.8254[0-9] * 49\.671[0-9][0-9]" $log | wc -l`
CRIT28=`$GREP "1 * 28 * 1\.8445[0-9] * 5(0| )\.192[0-9][0-9]" $log | wc -l`
CRIT29=`$GREP "1 * 29 * 1\.8614[0-9] * 5(0| )\.651[0-9][0-9]" $log | wc -l`
CRIT30=`$GREP "1 * 30 * 1\.9313[0-9] * 52\.555[0-9][0-9]" $log | wc -l`
CRIT31=`$GREP "1 * 31 * 1\.9981[0-9] * 54\.371[0-9][0-9]" $log | wc -l`
CRIT32=`$GREP "1 * 32 * 2\.4544[0-9] * 66\.788[0-9][0-9]" $log | wc -l`
CRIT33=`$GREP "1 * 33 * 19\.110[0-9][0-9] * 52(0| )\.00[0-9][0-9][0-9]" $log | wc -l`
CRIT34=`$GREP "1 * 34 * 19\.181[0-9][0-9] * 521\.96[0-9][0-9][0-9]" $log | wc -l`
CRIT35=`$GREP "1 * 35 * 19\.844[0-9][0-9] * 539\.98[0-9][0-9][0-9]" $log | wc -l`
CRIT36=`$GREP "1 * 36 * 19\.876[0-9][0-9] * 54(0| )\.86[0-9][0-9][0-9]" $log | wc -l`
CRIT37=`$GREP "1 * 37 * 19\.891[0-9][0-9] * 541\.27[0-9][0-9][0-9]" $log | wc -l`
CRIT38=`$GREP "1 * 38 * 19\.992[0-9][0-9] * 544\.02[0-9][0-9][0-9]" $log | wc -l`
CRIT39=`$GREP "1 * 39 * 2(0| )\.075[0-9][0-9] * 546\.27[0-9][0-9][0-9]" $log | wc -l`
CRIT40=`$GREP "1 * 40 * 2(0| )\.472[0-9][0-9] * 557\.07[0-9][0-9][0-9]" $log | wc -l`
TEST[8]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
		$CRIT25 \+ $CRIT26 \+ $CRIT27 \+ $CRIT28 \+ $CRIT29 \+ $CRIT30 \+ \
		$CRIT31 \+ $CRIT32 \+ $CRIT33 \+ $CRIT34 \+ $CRIT35 \+ $CRIT36 \+ \
		$CRIT37 \+ $CRIT38 \+ $CRIT39 \+ $CRIT40`
CTRL[8]=40
ERROR[8]="SINGLET EXCITATION ENERGIES NOT CORRECT"

# O-H coupling DSO orbital contributions 
CRIT1=`$GREP "1 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 1 * (0| )\.131[0-9]" $log | wc -l`
CRIT2=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.496[0-9]" $log | wc -l`
CRIT3=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * 1\.353[0-9]" $log | wc -l`
CRIT4=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.652[0-9]" $log | wc -l`
CRIT5=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.652[0-9]" $log | wc -l`
TEST[9]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[9]=8
ERROR[9]="O-H coupling DSO orbital contributions NOT CORRECT"

# O-H coupling PSO orbital contributions 
CRIT1=`$GREP "1 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 1 * (\-0| \-)\.021[0-9]" $log | wc -l`
CRIT2=`$GREP "6 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.050[0-9]" $log | wc -l`
CRIT3=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * \-2\.824[0-9]" $log | wc -l`
CRIT4=`$GREP "8 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 2 * (0| )\.032[0-9]" $log | wc -l`
CRIT5=`$GREP "9 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.177[0-9]" $log | wc -l`
CRIT6=`$GREP "10 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.177[0-9]" $log | wc -l`
CRIT7=`$GREP "11 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 3 * (0| )\.217[0-9]" $log | wc -l`
CRIT8=`$GREP "12 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 3 * (\-0| \-)\.267[0-9]" $log | wc -l`
CRIT9=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * (0| )\.772[0-9]" $log | wc -l`
CRIT10=`$GREP "14 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 3 * (\-0| \-)\.013[0-9]" $log | wc -l`
CRIT11=`$GREP "15 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 3 * (\-0| \-)\.013[0-9]" $log | wc -l`
CRIT12=`$GREP "16 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.327[0-9]" $log | wc -l`
CRIT13=`$GREP "17 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.084[0-9]" $log | wc -l`
CRIT14=`$GREP "18 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.015[0-9]" $log | wc -l`
CRIT15=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * \-3\.235[0-9]" $log | wc -l`
CRIT16=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.256[0-9]" $log | wc -l`
CRIT17=`$GREP "21 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.327[0-9]" $log | wc -l`
CRIT18=`$GREP "22 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.084[0-9]" $log | wc -l`
CRIT19=`$GREP "23 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.015[0-9]" $log | wc -l`
CRIT20=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.256[0-9]" $log | wc -l`
CRIT21=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * \-3\.235[0-9]" $log | wc -l`
CRIT22=`$GREP "TOTAL * \-1(0| )\.36[0-9][0-9]" $log | wc -l`
TEST[10]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22`
CTRL[10]=30
ERROR[10]="O-H coupling PSO orbital contributions NOT CORRECT"

# O-H coupling FC orbital contributions 
CRIT1=`$GREP "1 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 1 * \-1\.350[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 1 * (0| )\.846[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 1 * \-11\.04[0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "4 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 1 * 5\.032[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 1 * 5\.033[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.011[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * 7\.812[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 2 * 9\.263[0-9]" $log | wc -l`
CRIT9=`$GREP "9 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 2 * \-1\.117[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 2 * \-1\.117[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 3 * (\-0| \-)\.017[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 3 * \-1\.004[0-9]" $log | wc -l`
CRIT13=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * \-122\.2[0-9][0-9][0-9]" $log | wc -l`
CRIT14=`$GREP "14 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 3 * \-1\.587[0-9]" $log | wc -l`
CRIT15=`$GREP "15 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 3 * \-1\.587[0-9]" $log | wc -l`
CRIT16=`$GREP "16 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.094[0-9]" $log | wc -l`
CRIT17=`$GREP "17 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 4 * \-1\.727[0-9]" $log | wc -l`
CRIT18=`$GREP "18 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 4 * 28\.93[0-9][0-9]" $log | wc -l`
CRIT19=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * 12\.06[0-9][0-9]" $log | wc -l`
CRIT20=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * \-2\.214[0-9]" $log | wc -l`
CRIT21=`$GREP "21 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.094[0-9]" $log | wc -l`
CRIT22=`$GREP "22 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 5 * \-1\.727[0-9]" $log | wc -l`
CRIT23=`$GREP "23 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 5 * 28\.93[0-9][0-9]" $log | wc -l`
CRIT24=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * \-2\.214[0-9]" $log | wc -l`
CRIT25=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * 12\.06[0-9][0-9]" $log | wc -l`
CRIT26=`$GREP "TOTAL * \-39\.14[0-9][0-9]" $log | wc -l`
TEST[11]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
		$CRIT25 \+ $CRIT26`
CTRL[11]=38
ERROR[11]="O-H coupling FC orbital contributions NOT CORRECT"

# O-H coupling SD(+FC) orbital contributions 
CRIT1=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.806[0-9]" $log | wc -l`
CRIT2=`$GREP "8 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.049[0-9]" $log | wc -l`
CRIT3=`$GREP "9 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.059[0-9]" $log | wc -l`
CRIT4=`$GREP "10 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.059[0-9]" $log | wc -l`
CRIT5=`$GREP "12 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 3 * (0| )\.028[0-9]" $log | wc -l`
CRIT6=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * 3\.265[0-9]" $log | wc -l`
CRIT7=`$GREP "17 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.098[0-9]" $log | wc -l`
CRIT8=`$GREP "18 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 4 * (0| )\.118[0-9]" $log | wc -l`
CRIT9=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.940[0-9]" $log | wc -l`
CRIT10=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.093[0-9]" $log | wc -l`
CRIT11=`$GREP "22 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.098[0-9]" $log | wc -l`
CRIT12=`$GREP "23 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 5 * (0| )\.118[0-9]" $log | wc -l`
CRIT13=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.093[0-9]" $log | wc -l`
CRIT14=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.940[0-9]" $log | wc -l`
CRIT15=`$GREP "TOTAL * (0| )\.289[0-9]" $log | wc -l`
TEST[12]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[12]=20
ERROR[12]="O-H coupling SD(+FC) orbital contributions NOT CORRECT"

# O-H total coupling orbital contributions 
CRIT1=`$GREP "1 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 1 * \-1\.240[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 1 * (0| )\.846[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 1 * \-11\.04[0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "4 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 1 * 5\.031[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 1 * 5\.031[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.061[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * 3\.684[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 2 * 9\.24[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "9 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 2 * \-1\.355[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 2 * \-1\.355[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 3 * (0| )\.200[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 3 * \-1\.244[0-9]" $log | wc -l`
CRIT13=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * \-116\.8[0-9][0-9][0-9]" $log | wc -l`
CRIT14=`$GREP "14 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 3 * \-1\.601[0-9]" $log | wc -l`
CRIT15=`$GREP "15 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 3 * \-1\.601[0-9]" $log | wc -l`
CRIT16=`$GREP "16 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.421[0-9]" $log | wc -l`
CRIT17=`$GREP "17 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 4 * \-1\.910[0-9]" $log | wc -l`
CRIT18=`$GREP "18 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 4 * 29\.03[0-9][0-9]" $log | wc -l`
CRIT19=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * 7\.234[0-9]" $log | wc -l`
CRIT20=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * \-2\.564[0-9]" $log | wc -l`
CRIT21=`$GREP "21 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.421[0-9]" $log | wc -l`
CRIT22=`$GREP "22 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 5 * \-1\.910[0-9]" $log | wc -l`
CRIT23=`$GREP "23 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 5 * 29\.03[0-9][0-9]" $log | wc -l`
CRIT24=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * \-2\.564[0-9]" $log | wc -l`
CRIT25=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * 7\.233[0-9]" $log | wc -l`
CRIT26=`$GREP "TOTAL * \-49\.54[0-9][0-9]" $log | wc -l`
TEST[13]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
		$CRIT25 \+ $CRIT26`
CTRL[13]=38
ERROR[13]="O-H total coupling orbital contributions NOT CORRECT"

# H-H coupling DSO orbital contributions 
CRIT1=`$GREP "1 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 1 * \-1\.329[0-9]" $log | wc -l`
CRIT2=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * \-2\.297[0-9]" $log | wc -l`
CRIT3=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * \-2\.297[0-9]" $log | wc -l`
CRIT4=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.081[0-9]" $log | wc -l`
CRIT5=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.081[0-9]" $log | wc -l`
CRIT6=`$GREP "TOTAL * \-6\.08[0-9][0-9]" $log | wc -l`
TEST[14]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[14]=6
ERROR[14]="H-H coupling DSO orbital contributions NOT CORRECT"

# H-H coupling PSO orbital contributions
CRIT1=`$GREP "1 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 1 * (0| )\.224[0-9]" $log | wc -l`
CRIT2=`$GREP "(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 1 * (0| )\.017[0-9]" $log | wc -l`
CRIT3=`$GREP "4 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 1 * (\-0| \-)\.039[0-9]" $log | wc -l`
CRIT4=`$GREP "5 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 1 * (\-0| \-)\.039[0-9]" $log | wc -l`
CRIT5=`$GREP "(6|11) * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.017[0-9]" $log | wc -l`
CRIT6=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * (\-0| \-)\.041[0-9]" $log | wc -l`
CRIT7=`$GREP "(8|12) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.101[0-9]" $log | wc -l`
CRIT8=`$GREP "(9|14) * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.085[0-9]" $log | wc -l`
CRIT9=`$GREP "(10|15) * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.085[0-9]" $log | wc -l`
CRIT10=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * (\-0| \-)\.041[0-9]" $log | wc -l`
CRIT11=`$GREP "(9|14) * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.027[0-9]" $log | wc -l`
CRIT12=`$GREP "(10|15) * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.027[0-9]" $log | wc -l`
CRIT13=`$GREP "16 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.039[0-9]" $log | wc -l`
CRIT14=`$GREP "1(7|8) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.027[0-9]" $log | wc -l`
CRIT15=`$GREP "1(7|8) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 4 * (0| )\.085[0-9]" $log | wc -l`
CRIT16=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * 1\.584[0-9]" $log | wc -l`
CRIT17=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * (0| )\.154[0-9]" $log | wc -l`
CRIT18=`$GREP "21 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.039[0-9]" $log | wc -l`
CRIT19=`$GREP "2(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.027[0-9]" $log | wc -l`
CRIT20=`$GREP "2(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 5 * (0| )\.085[0-9]" $log | wc -l`
CRIT21=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * (0| )\.154[0-9]" $log | wc -l`
CRIT22=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * 1\.584[0-9]" $log | wc -l`
CRIT23=`$GREP "TOTAL * 3\.63[0-9][0-9]" $log | wc -l`
TEST[15]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23`
CTRL[15]=23
ERROR[15]="H-H coupling PSO orbital contributions NOT CORRECT"

# H-H coupling FC orbital contributions
CRIT1=`$GREP "(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 1 * (\-0| \-)\.016[0-9]" $log | wc -l`
CRIT2=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * 2\.822[0-9]" $log | wc -l`
CRIT3=`$GREP "(8|12) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.045[0-9]" $log | wc -l`
CRIT4=`$GREP "(9|14) * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.014[0-9]" $log | wc -l`
CRIT5=`$GREP "1(0|5) * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.014[0-9]" $log | wc -l`
CRIT6=`$GREP "(6|11)  * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.016[0-9]" $log | wc -l`
CRIT7=`$GREP "(8|12) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-12\.35[0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * 2\.822[0-9]" $log | wc -l`
CRIT9=`$GREP "(9|14) * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.174[0-9]" $log | wc -l`
CRIT10=`$GREP "1(0|5) * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.174[0-9]" $log | wc -l`
CRIT11=`$GREP "1(7|8) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.174[0-9]" $log | wc -l`
CRIT12=`$GREP "1(8|7) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 4 * (0| )\.014[0-9]" $log | wc -l`
CRIT13=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.136[0-9]" $log | wc -l`
CRIT14=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * (0| )\.072[0-9]" $log | wc -l`
CRIT15=`$GREP "2(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.174[0-9]" $log | wc -l`
CRIT16=`$GREP "2(3|2) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 5 * (0| )\.014[0-9]" $log | wc -l`
CRIT17=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * (0| )\.072[0-9]" $log | wc -l`
CRIT18=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.136[0-9]" $log | wc -l`
CRIT19=`$GREP "TOTAL * \-7\.55[0-9][0-9]" $log | wc -l`
TEST[16]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19`
CTRL[16]=19
ERROR[16]="H-H coupling FC orbital contributions NOT CORRECT"

# H-H coupling SD(+FC) orbital contributions
CRIT1=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * (0| )\.324[0-9]" $log | wc -l`
CRIT2=`$GREP "(8|12) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.010[0-9]" $log | wc -l`
CRIT3=`$GREP "(8|12) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.116[0-9]" $log | wc -l`
CRIT4=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * (0| )\.324[0-9]" $log | wc -l`
CRIT5=`$GREP "(9|14) * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.031[0-9]" $log | wc -l`
CRIT6=`$GREP "(10|15) * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.031[0-9]" $log | wc -l`
CRIT7=`$GREP "1(7|8) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 4 * (0| )\.031[0-9]" $log | wc -l`
CRIT8=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * (0| )\.124[0-9]" $log | wc -l`
CRIT9=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * (0| )\.012[0-9]" $log | wc -l`
CRIT10=`$GREP "2(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 5 * (0| )\.031[0-9]" $log | wc -l`
CRIT11=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * (0| )\.012[0-9]" $log | wc -l`
CRIT12=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * (0| )\.124[0-9]" $log | wc -l`
CRIT13=`$GREP "TOTAL * 1\.172[0-9]" $log | wc -l`
TEST[17]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13`
CTRL[17]=13
ERROR[17]="H-H coupling SD(+FC) orbital contributions NOT CORRECT"

# H-H total coupling orbital contributions
CRIT1=`$GREP "1 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 1 * \-1\.106[0-9]" $log | wc -l`
CRIT2=`$GREP "(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 1 * (0| )\.018[0-9]" $log | wc -l`
CRIT3=`$GREP "4 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 1 * (\-0| \-)\.038[0-9]" $log | wc -l`
CRIT4=`$GREP "5 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 1 * (\-0| \-)\.038[0-9]" $log | wc -l`
CRIT5=`$GREP "(6|11) * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.018[0-9]" $log | wc -l`
CRIT6=`$GREP "7 * \-\*\*\-\-\*\*\- * 2 * \-\*\*\-\-\*\*\- * 2 * (0| )\.809[0-9]" $log | wc -l`
CRIT7=`$GREP "(8|12) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.136[0-9]" $log | wc -l`
CRIT8=`$GREP "(9|14) * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.098[0-9]" $log | wc -l`
CRIT9=`$GREP "1(0|5) * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * (2|3) * (0| )\.098[0-9]" $log | wc -l`
CRIT10=`$GREP "(8|12) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-12\.23[0-9][0-9]" $log | wc -l`
CRIT11=`$GREP "13 * \-\*\*\-\-\*\*\- * 3 * \-\*\*\-\-\*\*\- * 3 * (0| )\.809[0-9]" $log | wc -l`
CRIT12=`$GREP "(9|14) * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.170[0-9]" $log | wc -l`
CRIT13=`$GREP "1(0|5) * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * (2|3) * (\-0| \-)\.170[0-9]" $log | wc -l`
CRIT14=`$GREP "16 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.038[0-9]" $log | wc -l`
CRIT15=`$GREP "1(7|8) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 4 * (\-0| \-)\.170[0-9]" $log | wc -l`
CRIT16=`$GREP "1(7|8) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 4 * (0| )\.098[0-9]" $log | wc -l`
CRIT17=`$GREP "19 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 4 * 1\.490[0-9]" $log | wc -l`
CRIT18=`$GREP "20 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 4 * (0| )\.239[0-9]" $log | wc -l`
CRIT19=`$GREP "21 * \-\*\*\-\-\*\*\- * 1 * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.038[0-9]" $log | wc -l`
CRIT20=`$GREP "2(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 5 * (\-0| \-)\.170[0-9]" $log | wc -l`
CRIT21=`$GREP "2(2|3) * \-\*\*\-\-\*\*\- * (2|3) * \-\*\*\-\-\*\*\- * 5 * (0| )\.098[0-9]" $log | wc -l`
CRIT22=`$GREP "24 * \-\*\*\-\-\*\*\- * 4 * \-\*\*\-\-\*\*\- * 5 * (0| )\.239[0-9]" $log | wc -l`
CRIT23=`$GREP "25 * \-\*\*\-\-\*\*\- * 5 * \-\*\*\-\-\*\*\- * 5 * 1\.490[0-9]" $log | wc -l`
CRIT24=`$GREP "TOTAL * \-8\.82[0-9][0-9]" $log | wc -l`
TEST[18]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24`
CTRL[18]=24
ERROR[18]="H-H total coupling orbital contributions NOT CORRECT"

# O-H total coupling
CRIT1=`$GREP "Isotropic coupling * \: * \-49\.54[0-9][0-9] Hz" $log | wc -l`
CRIT2=`$GREP "Anisotropic coupling * \: * 17\.77[0-9][0-9] Hz" $log | wc -l`
CRIT3=`$GREP "Isotropic DSO contribution\: * (\-0| \-)\.316[0-9] Hz" $log | wc -l`
CRIT4=`$GREP "Isotropic PSO contribution\: * \-1(0| )\.366[0-9] Hz" $log | wc -l`
CRIT5=`$GREP "Isotropic SD contribution \: * (0| )\.289[0-9] Hz" $log | wc -l`
CRIT6=`$GREP "Isotropic FC contribution \: * \-39\.14[0-9][0-9] Hz" $log | wc -l`
TEST[19]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[19]=12
ERROR[19]="O-H TOTAL COUPLING NOT CORRECT"

# H-H total coupling
CRIT1=`$GREP "Isotropic coupling * \: * \-8\.82[0-9][0-9] Hz" $log | wc -l`
CRIT2=`$GREP "Anisotropic coupling * \: * \-41\.78[0-9][0-9] Hz" $log | wc -l`
CRIT3=`$GREP "Isotropic DSO contribution\: * \-6\.087[0-9] Hz" $log | wc -l`
CRIT4=`$GREP "Isotropic PSO contribution\: * 3\.639[0-9] Hz" $log | wc -l`
CRIT5=`$GREP "Isotropic SD contribution \: * 1\.172[0-9] Hz" $log | wc -l`
CRIT6=`$GREP "Isotropic FC contribution \: * \-7\.55[0-9][0-9] Hz" $log | wc -l`
TEST[20]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[20]=6
ERROR[20]="H-H TOTAL COUPLING NOT CORRECT"

PASSED=1
for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
      echo "${ERROR[i]} ( test = ${TEST[i]}; control = ${CTRL[i]} );"
      PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
   echo TEST ENDED PROPERLY
   exit 0
else
   echo THERE IS A PROBLEM
   exit 1
fi

%EOF%
