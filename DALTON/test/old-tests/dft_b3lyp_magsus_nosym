#!/bin/sh

info='
   dft_b3lyp_magsus_nosym 
   ----------------------
   Molecule:         HOF
   Wave Function:    DFT (B3LYP) / 6-31G** 
   Test Purpose:     Test magnetizability and molecular
                     rotational g-factor calculation 
'

molecule='BASIS
6-31G**
HOF B3LYP/6-31g**

    3   0
        1.    1
H         -1.7477891561           -1.7077611826             .0000000000
        8.    1
O         -1.4230900102             .1042645372             .0000000000
        9.    1
F          1.2876238525            -.0038104469             .0000000000
'

dalton='**DALTON INPUT
.RUN WAVE FUNCTION
.PROPERTIES
**WAVE FUNCTIONS
.DFT
 B3LYP
**PROPERTIES
.MAGNET
**END OF INPUT
'

test='

check_scf_energy DFT -175.457032841072 5e-8

check_magnetizabilities -2.8715 -9.7870 6.9155 -1.8761 1.1057

check_mag_tensors 1e-5 "
       -4.122229076844      0.003446693039      0.000000000000
        0.003446693039     -2.134349975926      0.000000000000
        0.000000000000      0.000000000000     -2.357868140000
" "
       -4.383056604480      0.104164743269     -0.000000000000
        0.104164743269    -12.310514051932     -0.000000000000
       -0.000000000000     -0.000000000000    -12.667450772772
" "
        0.260827527636     -0.100718050230      0.000000000000
       -0.100718050230     10.176164076006      0.000000000000
        0.000000000000      0.000000000000     10.309582632771
"

check_g_tensors 1e-5 "
      0.62564819     -0.02129131     -0.00000000
     -0.45875066     -0.09788415     -0.00000000
     -0.00000000     -0.00000000     -0.05846851
" "
      0.96244318     -0.02229256      0.00000000
     -0.48032390      0.51435972      0.00000000
      0.00000000      0.00000000      0.53423357
" "
     -0.37306694      0.00865690      0.00000000
      0.18652491     -0.54293311      0.00000000
      0.00000000      0.00000000     -0.51654100
" "
      0.03627196     -0.00765566     -0.00000000
     -0.16495167     -0.06931076     -0.00000000
     -0.00000000     -0.00000000     -0.07616108
"
'
. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"


# check_basis "6-31G**" "
# H 1 1  4s1p 2s1p
# O 1 6  10s4p1d 3s2p1d
# F 1 9  10s4p1d 3s2p1d

