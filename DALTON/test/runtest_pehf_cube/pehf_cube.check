#!/bin/ksh
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi

#
# electrostatic potential cube file test
#
CRIT1=`$GREP "4 * \-12\.739514 * \-10\.611603 * \-8\.018425" pehf_cube.embedding_potential.cube | wc -l`
CRIT2=`$GREP "59 * ( |0)\.333333 * ( |0)\.000000 * ( |0)\.000000" pehf_cube.embedding_potential.cube | wc -l`
CRIT3=`$GREP "59 * ( |0)\.000000 * ( |0)\.333333 * ( |0)\.000000" pehf_cube.embedding_potential.cube | wc -l`
CRIT4=`$GREP "49 * ( |0)\.000000 * ( |0)\.000000 * ( |0)\.333333" pehf_cube.embedding_potential.cube | wc -l`
# line 11
CRIT5=`$GREP "(\-|\-0)\.19211E\-02 * (\-|\-0)\.19246E\-02 * (\-|\-0)\.19265E\-02 * (\-|\-0)\.19267E\-02 * (\-|\-0)\.19252E\-02 * (\-|\-0)\.19220E\-02" pehf_cube.embedding_potential.cube | wc -l`
# line 100
CRIT6=`$GREP "(\-|\-0)\.15862E\-02 * (\-|\-0)\.15650E\-02 * (\-|\-0)\.15414E\-02 * (\-|\-0)\.15155E\-02 * (\-|\-0)\.14872E\-02 * (\-|\-0)\.14566E\-02" pehf_cube.embedding_potential.cube | wc -l`
TEST[1]=`expr $CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 `
CTRL[1]=6
ERROR[1]="EMBEDDING POTENTIAL CUBE FILE NOT CORRECT"

#
# electric field cube file test
#
CRIT1=`$GREP "4 * \-12\.739514 * \-10\.611603 * \-8\.018425" pehf_cube.embedding_field_1.cube | wc -l`
CRIT2=`$GREP "59 * ( |0)\.333333 * ( |0)\.000000 * ( |0)\.000000" pehf_cube.embedding_field_1.cube | wc -l`
CRIT3=`$GREP "59 * ( |0)\.000000 * ( |0)\.333333 * ( |0)\.000000" pehf_cube.embedding_field_1.cube | wc -l`
CRIT4=`$GREP "49 * ( |0)\.000000 * ( |0)\.000000 * ( |0)\.333333" pehf_cube.embedding_field_1.cube | wc -l`
# line 11
CRIT5=`$GREP "( |0)\.26466E\-03 * ( |0)\.26925E\-03 * ( |0)\.27362E\-03 * ( |0)\.27777E\-03 * ( |0)\.28165E\-03 * ( |0)\.28524E\-03" pehf_cube.embedding_field_1.cube | wc -l`
# line 100
CRIT6=`$GREP "( |0)\.30282E\-03 * ( |0)\.30456E\-03 * ( |0)\.30579E\-03 * ( |0)\.30648E\-03 * ( |0)\.30661E\-03 * ( |0)\.30616E\-03" pehf_cube.embedding_field_1.cube | wc -l`
TEST[2]=`expr $CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 `
CTRL[2]=6
ERROR[2]="EMBEDDING FIELD X COMPONENT CUBE FILE NOT CORRECT"

#
# electric field cube file test
#
CRIT1=`$GREP "4 * \-12\.739514 * \-10\.611603 * \-8\.018425" pehf_cube.embedding_field_2.cube | wc -l`
CRIT2=`$GREP "59 * ( |0)\.333333 * ( |0)\.000000 * ( |0)\.000000" pehf_cube.embedding_field_2.cube | wc -l`
CRIT3=`$GREP "59 * ( |0)\.000000 * ( |0)\.333333 * ( |0)\.000000" pehf_cube.embedding_field_2.cube | wc -l`
CRIT4=`$GREP "49 * ( |0)\.000000 * ( |0)\.000000 * ( |0)\.333333" pehf_cube.embedding_field_2.cube | wc -l`
# line 11
CRIT5=`$GREP "(\-|\-0)\.18002E\-04 * (\-|\-0)\.19405E\-04 * (\-|\-0)\.20912E\-04 * (\-|\-0)\.22528E\-04 * (\-|\-0)\.24255E\-04 * (\-|\-0)\.26095E\-04" pehf_cube.embedding_field_2.cube | wc -l`
# line 100
CRIT6=`$GREP "(\-|\-0)\.16101E\-03 * (\-|\-0)\.16707E\-03 * (\-|\-0)\.17319E\-03 * (\-|\-0)\.17937E\-03 * (\-|\-0)\.18558E\-03 * (\-|\-0)\.19180E\-03" pehf_cube.embedding_field_2.cube | wc -l`
TEST[3]=`expr $CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 `
CTRL[3]=6
ERROR[3]="EMBEDDING FIELD Y COMPONENT CUBE FILE NOT CORRECT"

#
# electric field cube file test
#
CRIT1=`$GREP "4 * \-12\.739514 * \-10\.611603 * \-8\.018425" pehf_cube.embedding_field_3.cube | wc -l`
CRIT2=`$GREP "59 * ( |0)\.333333 * ( |0)\.000000 * ( |0)\.000000" pehf_cube.embedding_field_3.cube | wc -l`
CRIT3=`$GREP "59 * ( |0)\.000000 * ( |0)\.333333 * ( |0)\.000000" pehf_cube.embedding_field_3.cube | wc -l`
CRIT4=`$GREP "49 * ( |0)\.000000 * ( |0)\.000000 * ( |0)\.333333" pehf_cube.embedding_field_3.cube | wc -l`
# line 11
CRIT5=`$GREP "( |0)\.12792E\-04 * ( |0)\.81417E\-05 * ( |0)\.32685E\-05 * (\-|\-0)\.18202E\-05 * (\-|\-0)\.71156E\-05 * (\-|\-0)\.12607E\-04" pehf_cube.embedding_field_3.cube | wc -l`
# line 100
CRIT6=`$GREP "(\-|\-0)\.60268E\-04 * (\-|\-0)\.67217E\-04 * (\-|\-0)\.74229E\-04 * (\-|\-0)\.81270E\-04 * (\-|\-0)\.88306E\-04 * (\-|\-0)\.9530[12]E\-04" pehf_cube.embedding_field_3.cube | wc -l`
TEST[4]=`expr $CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 `
CTRL[4]=6
ERROR[4]="EMBEDDING FIELD Z COMPONENT CUBE FILE NOT CORRECT"

PASSED=1 
for i in 1 2 3 4
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
     echo "${ERROR[i]} ( test = ${TEST[i]}; control = ${CTRL[i]} ); "
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi                
