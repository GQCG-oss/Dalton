#!/bin/ksh
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi

#
# Frequency dependent polarizability tensors 
#
#  1   XDIPLEN   XDIPLEN    0.100000       21.889007        0.087761
#  2   YDIPLEN   YDIPLEN    0.100000       35.726910        0.221713
#  3   ZDIPLEN   ZDIPLEN    0.100000        4.678586        0.009109
#  4   XDIPLEN   YDIPLEN    0.100000       -9.770390       -0.112158
#  5   XDIPLEN   ZDIPLEN    0.100000       -0.007963       -0.000023
#  6   YDIPLEN   ZDIPLEN    0.100000       -0.000789        0.000022
#
#      Averaged value       0.100000       20.764834        0.106194
#
#  7   XDIPLEN   XDIPLEN    0.200000       25.985198        0.362055
#  8   YDIPLEN   YDIPLEN    0.200000       46.572526        0.993228
#  9   ZDIPLEN   ZDIPLEN    0.200000        5.015170        0.023834
# 10   XDIPLEN   YDIPLEN    0.200000      -15.477325       -0.537649
# 11   XDIPLEN   ZDIPLEN    0.200000       -0.009000       -0.000089
# 12   YDIPLEN   ZDIPLEN    0.200000        0.000422        0.000119
#
#      Averaged value       0.200000       25.857631        0.459706

CRIT1=`$GREP " XDIPLEN   XDIPLEN    0\.100000       21\.88....        0\.0877.." $log | wc -l`
CRIT2=`$GREP " YDIPLEN   YDIPLEN    0\.100000       35\.72....        0\.2217.." $log | wc -l`
CRIT3=`$GREP " ZDIPLEN   ZDIPLEN    0\.100000        4\.678...        0\.0091.." $log | wc -l`
CRIT4=`$GREP " XDIPLEN   YDIPLEN    0\.100000       \-9\.770...       \-0\.1121.." $log | wc -l`
CRIT5=`$GREP " XDIPLEN   ZDIPLEN    0\.100000       \-0\.0079..       \-0\.00002." $log | wc -l`
CRIT6=`$GREP " YDIPLEN   ZDIPLEN    0\.100000       \-0\.0007..        0\.00002." $log | wc -l`
CRIT7=`$GREP " XDIPLEN   XDIPLEN    0\.200000       25\.98....        0\.36205." $log | wc -l`
CRIT8=`$GREP " YDIPLEN   YDIPLEN    0\.200000       46\.57....        0\.99322." $log | wc -l`
CRIT9=`$GREP " ZDIPLEN   ZDIPLEN    0\.200000        5\.015...        0\.02383." $log | wc -l`
CRIT10=`$GREP " XDIPLEN   YDIPLEN    0\.200000      \-15\.47....       \-0\.53764." $log | wc -l`
CRIT11=`$GREP " XDIPLEN   ZDIPLEN    0\.200000       \-0\.00(89|90)..       \-0\.0000(89|90)" $log | wc -l`
CRIT12=`$GREP " YDIPLEN   ZDIPLEN    0\.200000        0\.0004..        0\.00011." $log | wc -l`
TEST[1]=`expr   $CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
                $CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[1]=12
ERROR[1]="Polarizability is NOT CORRECT"

PASSED=1
for i in 1
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
     echo "${ERROR[i]} ( test = ${TEST[i]}; control = ${CTRL[i]} ); "
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi
