#!/bin/ksh
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi

#
# Test of PE-HF one-photon absorption properties
#
 CRIT1=`$GREP "\@ STATE NO\: * 1 \*TRANSITION MOMENT\: *  4\.........E\-06 * \*ENERGY\(eV\)\: * 3\.2366..." $log | wc -l`
 CRIT2=`$GREP "\@ STATE NO\: * 2 \*TRANSITION MOMENT\: *  1\.88......E\-04 * \*ENERGY\(eV\)\: * 7\.2850..." $log | wc -l`
 CRIT3=`$GREP "\@ STATE NO\: * 3 \*TRANSITION MOMENT\: * \-6\.6.......E\-05 * \*ENERGY\(eV\)\: * 9\.7637..." $log | wc -l`
 CRIT4=`$GREP "\@ STATE NO\: * 4 \*TRANSITION MOMENT\: * \-2\.5.......E\-05 * \*ENERGY\(eV\)\: * 9\.8832..." $log | wc -l`
 CRIT5=`$GREP "\@ STATE NO\: * 1 \*TRANSITION MOMENT\: * \-4\.3.......E\-05 * \*ENERGY\(eV\)\: * 3\.2366..." $log | wc -l`
 CRIT6=`$GREP "\@ STATE NO\: * 2 \*TRANSITION MOMENT\: *  3\.6.......E\-05 * \*ENERGY\(eV\)\: * 7\.2850..." $log | wc -l`
 CRIT7=`$GREP "\@ STATE NO\: * 3 \*TRANSITION MOMENT\: * \-5\.5.......E\-05 * \*ENERGY\(eV\)\: * 9\.7637..." $log | wc -l`
 CRIT8=`$GREP "\@ STATE NO\: * 4 \*TRANSITION MOMENT\: * \-3\.........E\-06 * \*ENERGY\(eV\)\: * 9\.8832..." $log | wc -l`
 CRIT9=`$GREP "\@ STATE NO\: * 1 \*TRANSITION MOMENT\: *  5\.94......E\-04 * \*ENERGY\(eV\)\: * 3\.2366..." $log | wc -l`
CRIT10=`$GREP "\@ STATE NO\: * 2 \*TRANSITION MOMENT\: * ( |0)\.295972.. * \*ENERGY\(eV\)\: * 7\.2850..." $log | wc -l`
CRIT11=`$GREP "\@ STATE NO\: * 3 \*TRANSITION MOMENT\: * \-4\.1890....E\-02 * \*ENERGY\(eV\)\: * 9\.7637..." $log | wc -l`
CRIT12=`$GREP "\@ STATE NO\: * 4 \*TRANSITION MOMENT\: * (\-|\-0)\.133875.. * \*ENERGY\(eV\)\: * 9\.8832..." $log | wc -l`
TEST[1]=`expr $CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ $CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 `
CTRL[1]=12
ERROR[1]="ONE-PHOTON ABSORPTION PROPERTIES NOT CORRECT"

PASSED=1 
for i in 1
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
     echo "${ERROR[i]} ( test = ${TEST[i]}; control = ${CTRL[i]} ); "
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi                
