#!/bin/sh
#
# This is the script for generating files for a specific Dalton test job.
#
# For the .check file ksh or bash is preferred, otherwise use sh
# (and hope it is not the old Bourne shell, which will not work)
#
if [ -x /bin/ksh ]; then
   CHECK_SHELL='#!/bin/ksh'
elif [ -x /bin/bash ]; then
   CHECK_SHELL='#!/bin/bash'
else
   CHECK_SHELL='#!/bin/sh'
fi


#######################################################################
#  TEST DESCRIPTION
#######################################################################
cat > prop_roa.info <<'%EOF%'
   prop_roa
   --------
   Molecule:         C3H4
   Wave Function:    SCF / DZ(Dunning)
   Test Purpose:     Single-point calculation of Raman Optical Activity
                     parameters
%EOF%

#######################################################################
#  MOLECULE INPUT
#######################################################################
cat > prop_roa.mol <<'%EOF%'
BASIS
DZ(Dunning)
ROA calculation for allene (H2C=C=CH2) at optimized geometry SCF-DZ
No symmetry
    2  0 0
        6.    3
C1    0.0            0.0           0.0
C2    0.0	     2.4743846667  0.0
C3    0.0           -2.4743846667  0.0
        1.    4
H4    1.7367853003   3.5259125935  0.0
H5   -1.7367853003   3.5259125935  0.0
H6    0.0           -3.5259125935  1.7367853003
H7    0.0           -3.5259125935 -1.7367853003
%EOF%

#######################################################################
#  DALTON INPUT
#######################################################################
cat > prop_roa.dal <<'%EOF%'
**DALTON INPUT
.WALK
.MAX IT
 50
*WALK
.NUMERI
.PRINT
 1
.DISPLA
 0.001
**WAVE FUNCTIONS
.HF
*SCF INPUT
.THRESH
1.0D-8
**START
.VROA
*ABALNR
.THRESH
5.0D-8
.FREQUE
     3
0.0932147101 0.088558504 0.08564539532
**EACH STEP
.VROA
*ABALNR
.THRESH
5.0D-8
.FREQUE
     3
0.0932147101 0.088558504 0.08564539532
**PROPERTIES
.VROA
.RAMAN
.VIBANA
*RESPON
.THRESH
1.0D-6
*ABALNR
.THRESH
5.0D-8
.FREQUE
     3
0.0932147101 0.088558504 0.08564539532
*VIBANA
.HESPUN
.ISOTOP
   4   7
1 1 1 2 1 1 2
1 1 1 1 2 2 1
1 1 1 2 1 2 1
1 1 1 1 2 1 2
**END OF DALTON INPUT
%EOF%
#######################################################################



#######################################################################

#######################################################################
#  CHECK SCRIPT
#######################################################################
echo $CHECK_SHELL >prop_roa.check
cat >>prop_roa.check <<'%EOF%'
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
   GREPL="egrep -a -l"
else
   GREP="egrep"
   GREPL="egrep -l"
fi

# Geometry
CRIT1=`$GREPL "1 * C1 * x * (0| )\.0000000000" $log | wc -l`
CRIT2=`$GREPL "4 * C2 * x * (0| )\.0000000000" $log | wc -l`
CRIT3=`$GREPL "5 * y * 2\.4743846667" $log | wc -l`
CRIT4=`$GREPL "7 * C3 * x * (0| )\.0000000000" $log | wc -l`
CRIT5=`$GREPL "8 * y * \-2\.4743846667" $log | wc -l`
CRIT6=`$GREPL "10 * H4 * x * 1\.7367853003" $log | wc -l`
CRIT7=`$GREPL "11 * y * 3\.5259125935" $log | wc -l`
CRIT8=`$GREPL "13 * H5 * x * \-1\.7367853003" $log | wc -l`
CRIT9=`$GREPL "14 * y * 3\.5259125935" $log | wc -l`
CRIT10=`$GREPL "16 * H6 * x * (0| )\.0000000000" $log | wc -l`
CRIT11=`$GREPL "17 * y * \-3\.5259125935" $log | wc -l`
CRIT12=`$GREPL "18 * z * 1\.7367853003" $log | wc -l`
CRIT13=`$GREPL "19 * H7 * x * (0| )\.0000000000" $log | wc -l`
CRIT14=`$GREPL "20 * y * \-3\.5259125935" $log | wc -l`
CRIT15=`$GREPL "21 * z * \-1\.7367853003" $log | wc -l`
TEST[1]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
TEST[1]=15 # test disabled Apr 2006
CTRL[1]=15
ERROR[1]="INITIAL GEOMETRY NOT CORRECT"

# Initial energy
CRIT1=`$GREPL "Final * HF energy\: * \-115\.8302823663[0-9][0-9]" $log | wc -l`
CRIT2=`$GREPL "Electronic energy\: * \-175\.0835477694[0-9][0-9]" $log | wc -l`
TEST[2]=`expr	$CRIT1 \+ $CRIT2`
CTRL[2]=2
ERROR[2]="INITIAL ENERGY NOT CORRECT"

# Numerical walk
CRIT1=`$GREP "Walk type\: Numerical differentiation" $log | wc -l`
CRIT2=`$GREP "Vibrational Raman intensities and optical activity" $log | wc -l`
TEST[3]=`expr	$CRIT1 \+ $CRIT2`
CTRL[3]=46
ERROR[3]="WALK NOT SET UP CORRECTLY"

# Frequencies
CRIT1=`$GREP "Number of frequencies * \: * 3" $log | wc -l`
CRIT2=`$GREP "Frequencies * \: * (0| )\.093215 * (0| )\.088559 * (0| )\.085645" $log | wc -l`
TEST[4]=`expr	$CRIT1 \+ $CRIT2`
CTRL[4]=88
ERROR[4]="SPECIFIED FREQUENCIES NOT CORRECT"

# Optical rotation
CRIT1=`$GREPL "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.430053[0-9]" $log | wc -l`
CRIT2=`$GREPL "Ez * (0| )\.430053[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT3=`$GREPL "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.407688[0-9]" $log | wc -l`
CRIT4=`$GREPL "Ez * (0| )\.407688[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT5=`$GREPL "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.393766[0-9]" $log | wc -l`
CRIT6=`$GREPL "Ez * (0| )\.393766[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT7=`$GREPL "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.496605[0-9]" $log | wc -l`
CRIT8=`$GREPL "Ez * (0| )\.496605[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT9=`$GREPL "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.470845[0-9]" $log | wc -l`
CRIT10=`$GREPL "Ez * (0| )\.470845[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT11=`$GREPL "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.454805[0-9]" $log | wc -l`
CRIT12=`$GREPL "Ez * (0| )\.454805[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
TEST[5]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[5]=12
ERROR[5]="OPTICAL ROTATION NOT CORRECT"

# Polarizability tensor
CRIT1=`$GREPL "1 * 17\.5550150[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT2=`$GREPL "2 * (\-0|\-|0| )\.00000000 * 65\.5489224[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREPL "3 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 17\.5550150[0-9]" $log | wc -l`
CRIT4=`$GREPL "1 * 17\.5181914[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT5=`$GREPL "2 * (\-0|\-|0| )\.00000000 * 65\.0400881[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT6=`$GREPL "3 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 17\.5181914[0-9]" $log | wc -l`
CRIT7=`$GREPL "1 * 17\.4962021[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT8=`$GREPL "2 * (\-0|\-|0| )\.00000000 * 64\.7395750[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT9=`$GREPL "3 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 17\.4962021[0-9]" $log | wc -l`
TEST[6]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[6]=9
ERROR[6]="POLARIZABILITY TENSOR NOT CORRECT"

# No-London G tensor
CRIT1=`$GREPL "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4966056[0-9]" $log | wc -l`
CRIT2=`$GREPL "3 * (0| )\.4966056[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREPL "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4708455[0-9]" $log | wc -l`
CRIT4=`$GREPL "3 * (0| )\.4708455[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT5=`$GREPL "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4548056[0-9]" $log | wc -l`
CRIT6=`$GREPL "3 * (0| )\.4548056[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
TEST[7]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[7]=6
ERROR[7]="NO-LONDON G TENSORS NOT CORRECT"

# London G tensor
CRIT1=`$GREPL "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4300538[0-9]" $log | wc -l`
CRIT2=`$GREPL "3 * (0| )\.4300538[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREPL "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4076881[0-9]" $log | wc -l`
CRIT4=`$GREPL "3 * (0| )\.4076881[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT5=`$GREPL "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.3937663[0-9]" $log | wc -l`
CRIT6=`$GREPL "3 * (0| )\.3937663[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
TEST[8]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[8]=6
ERROR[8]="LONDON G TENSORS NOT CORRECT"

# A tensor
CRIT1=`$GREPL "1 * (\-0|\-|0| )\.000000.. * 22\.751177.. * (\-0|\-|0| )\.000000.. * 22\.751177.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT2=`$GREPL "2 * 11\.690695.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT3=`$GREPL "3 *  \-22\.751177.. * (\-0|\-|0| )\.000000.. * \-22\.751177.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT4=`$GREPL "2 * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * \-11\.690695.." $log | wc -l`
CRIT5=`$GREPL "1 * (\-0|\-|0| )\.000000.. * 22\.693019.. * (\-0|\-|0| )\.000000.. * 22\.693019.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT6=`$GREPL "2 * 11\.655869.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT7=`$GREPL "3 * \-22\.693019.. * (\-0|\-|0| )\.000000.. * \-22\.693019.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT8=`$GREPL "2 * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * \-11\.655869.." $log | wc -l`
CRIT9=`$GREPL "1 * (\-0|\-|0| )\.000000.. * 22\.658293.. * (\-0|\-|0| )\.000000.. * 22\.658293.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT10=`$GREPL "2 * 11\.635106..* (\-0|\-|0| )\.000000..* (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT11=`$GREPL "3 *  \-22\.658293.. * (\-0|\-|0| )\.000000.. * \-22\.658293.. * (\-0|\-|0| )\.000000.." $log | wc -l`
CRIT12=`$GREPL "2 * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * (\-0|\-|0| )\.000000.. * \-11\.635106.." $log | wc -l`
TEST[9]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[9]=12
ERROR[9]="A TENSOR NOT CORRECT"

# Rayleigh properties
CRIT1=`$GREPL "24\.7212 * 50\.5800 * 1466\.513[0-9] * 303\.4801 * (0| )\.2069" $log | wc -l`
CRIT2=`$GREPL "24\.4359 * 49\.5900 * 1446\.745[0-9] * 297\.540[12] * (0| )\.2057" $log | wc -l`
CRIT3=`$GREPL "24\.2680 * 49\.0104 * 1435\.131[0-9] * 294\.0626 * (0| )\.2049" $log | wc -l`
TEST[10]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[10]=3
ERROR[10]="RAYLEIGH PROPERTIES NOT CORRECT"

# Displaced geometries
CRIT1=`$GREPL "Final * HF energy\: * \-115\.8302816229[0-9][0-9]" $log | wc -l`
CRIT2=`$GREPL "Final * HF energy\: * \-115\.8302818721[0-9][0-9]" $log | wc -l`
CRIT3=`$GREPL "Final * HF energy\: * \-115\.8302818685[0-9][0-9]" $log | wc -l`
CRIT4=`$GREPL "Final * HF energy\: * \-115\.8302820258[0-9][0-9]" $log | wc -l`
CRIT5=`$GREPL "Final * HF energy\: * \-115\.8302822115[0-9][0-9]" $log | wc -l`
CRIT6=`$GREPL "Final * HF energy\: * \-115\.8302822118[0-9][0-9]" $log | wc -l`
CRIT7=`$GREPL "Final * HF energy\: * \-115\.8302822897[0-9][0-9]" $log | wc -l`
CRIT8=`$GREPL "Final * HF energy\: * \-115\.8302822958[0-9][0-9]" $log | wc -l`
CRIT9=`$GREPL "Final * HF energy\: * \-115\.8302823011[0-9][0-9]" $log | wc -l`
CRIT10=`$GREPL "Final * HF energy\: * \-115\.8302823540[0-9][0-9]" $log | wc -l`
CRIT11=`$GREPL "Final * HF energy\: * \-115\.8302823663[0-9][0-9]" $log | wc -l`
TEST[11]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11`
CTRL[11]=11
ERROR[11]="DISPLACED GEOMETRIES NOT CORRECT"

# Vibrational frequencies
CRIT1=`$GREPL "1 * A * 3428\.47 * (0| )\.01562[0-9] * 10\.27[0-9] * (0| )\.243[0-9]" $log | wc -l`
CRIT2=`$GREPL "2 * A * 3428\.47 * (0| )\.01562[0-9] * 10\.27[0-9] * (0| )\.243[0-9]" $log | wc -l`
CRIT3=`$GREPL "3 * A * 3328\.58 * (0| )\.01516[0-9] * 5\.71[0-9] * (0| )\.135[0-9]" $log | wc -l`
CRIT4=`$GREPL "4 * A * 3328\.27 * (0| )\.01516[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT5=`$GREPL "5 * A * 2178\.98 * (0| )\.00992[0-9] * 116\.49[0-9] * 2\.756[0-9]" $log | wc -l`
CRIT6=`$GREPL "6 * A * 1620\.52 * (0| )\.00738[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT7=`$GREPL "7 * A * 1572\.44 * (0| )\.00716[0-9] * 6\.50[0-9] * (0| )\.154[0-9]" $log | wc -l`
CRIT8=`$GREPL "8 * A * 1168\.67 * (0| )\.00532[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT9=`$GREPL "9 * A * 1140\.15 * (0| )\.00519[0-9] * (0| )\.29[0-9] * (0| )\.007[0-9]" $log | wc -l`
CRIT10=`$GREPL "10 * A * 1140\.15 * (0| )\.00519[0-9] * (0| )\.29[0-9] * (0| )\.007[0-9]" $log | wc -l`
CRIT11=`$GREPL "11 * A * 1050\.77 * (0| )\.00478[0-9] * 93\.33[0-9] * 2\.208[0-9]" $log | wc -l`
CRIT12=`$GREPL "12 * A * 1050\.77 * (0| )\.00478[0-9] * 93\.33[0-9] * 2\.208[0-9]" $log | wc -l`
CRIT13=`$GREPL "13 * A * 952\.17 * (0| )\.00433[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT14=`$GREPL "14 * A * 414\.32 * (0| )\.00188[0-9] * 16\.30[0-9] * (0| )\.385[0-9]" $log | wc -l`
CRIT15=`$GREPL "15 * A * 414\.32 * (0| )\.00188[0-9] * 16\.30[0-9] * (0| )\.385[0-9]" $log | wc -l`
TEST[12]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[12]=15
ERROR[12]="VIBRATIONAL FREQUENCIES NOT CORRECT"

# Raman properties freq1
 CRIT1=`$GREPL  "1 * 3428\.4. * 0*\.000000 * 16\.6006.. *  66\.4027.. * 49\.80(19|20).. * 0*\.750000" $log | wc -l`
 CRIT2=`$GREPL  "2 * 3428\.4. * 0*\.000000 * 16\.6006.. *  66\.4026.. * 49\.80(19|20).. * 0*\.750000" $log | wc -l`
 CRIT3=`$GREPL  "3 * 3328\.5. * 0*\.000000 *  9\.4054.. *  37\.6219.. * 28\.2164.. * 0*\.750000" $log | wc -l`
 CRIT4=`$GREPL  "4 * 3328\.2. *  6\.5550.. *  5\.7572.. * 318\.0053.. * 17\.2716.. * 0*\.0543.." $log | wc -l`
 CRIT5=`$GREPL  "5 * 2178\.9. * 0*\.000000 * 0*\.0573.. *  0*\.2292.. * 0*\.1719.. * 0*\.750000" $log | wc -l`
 CRIT6=`$GREPL  "6 * 1620\.5. * 0*\.0009.. *  1\.7183.. *   6\.9164.. *  5\.1551.. * 0*\.7453.." $log | wc -l`
 CRIT7=`$GREPL  "7 * 1572\.4. * 0*\.000000 * 0*\.0779.. *  0*\.3116.. * 0*\.2337.. * 0*\.750000" $log | wc -l`
 CRIT8=`$GREPL  "8 * 1168\.6. *  1\.2120.. * 10\.5349.. *  96\.6835.. * 31\.6048.. * 0*\.3268.." $log | wc -l`
 CRIT9=`$GREPL  "9 * 1140\.1. * 0*\.000000 * 0*\.2606.. *   1\.0427.. * 0*\.7820.. * 0*\.750000" $log | wc -l`
CRIT10=`$GREPL "10 * 1140\.1. * 0*\.000000 * 0*\.2606.. *   1\.0427.. * 0*\.7820.. * 0*\.750000" $log | wc -l`
CRIT11=`$GREPL "11 * 1050\.7. * 0*\.000000 *  1\.1449.. *   4\.5798.. *  3\.4348.. * 0*\.750000" $log | wc -l`
CRIT12=`$GREPL "12 * 1050\.7. * 0*\.000000 *  1\.1449.. *   4\.5798.. *  3\.4349.. * 0*\.750000" $log | wc -l`
CRIT13=`$GREPL "13 *  952\.1. * 0*\.000000 *  1\.2642.. *   5\.0571.. *  3\.7928.. * 0*\.750000" $log | wc -l`
CRIT14=`$GREPL "14 *  414\.3. * 0*\.000000 * 0*\.8382.. *   3\.3529.. *  2\.5147.. * 0*\.750000" $log | wc -l`
CRIT15=`$GREPL "15 *  414\.3. * 0*\.000000 * 0*\.8382.. *   3\.3529.. *  2\.5147.. * 0*\.750000" $log | wc -l`
TEST[13]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[13]=15
ERROR[13]="RAMAN PROPERTIES FREQ1 NOT CORRECT"

# Raman optical activity freq1
 CRIT1=`$GREPL  "1 * 3428\.4. * 0*\.000000 * 16\.6006.. * 116\.204. * 99\.604. * 232\.409. * 0*\.857." $log | wc -l`
 CRIT2=`$GREPL  "2 * 3428\.4. * 0*\.000000 * 16\.6006.. * 116\.204. * 99\.604. * 232\.409. * 0*\.857." $log | wc -l`
 CRIT3=`$GREPL  "3 * 3328\.5. * 0*\.000000 *  9\.4054.. *  65\.838. * 56\.432. * 131\.676. * 0*\.857." $log | wc -l`
 CRIT4=`$GREPL  "4 * 3328\.2. *  6\.5550.. *  5\.7572.. * 335\.277. * 34\.543. * 670\.554. * 0*\.103." $log | wc -l`
 CRIT5=`$GREPL  "5 * 2178\.9. * 0*\.000000 * 0*\.0573.. *  0*\.401. * 0*\.343. *  0*\.802. * 0*\.857." $log | wc -l`
 CRIT6=`$GREPL  "6 * 1620\.5. * 0*\.0009.. *  1\.7183.. *  12\.071. * 10\.310. *  24\.143. * 0*\.854." $log | wc -l`
 CRIT7=`$GREPL  "7 * 1572\.4. * 0*\.000000 * 0*\.0779.. *  0*\.545. * 0*\.467. *   1\.090. * 0*\.857." $log | wc -l`
 CRIT8=`$GREPL  "8 * 1168\.6. *  1\.2120.. * 10\.5349.. * 128\.288. * 63\.209. * 256\.576. * 0*\.492." $log | wc -l`
 CRIT9=`$GREPL  "9 * 1140\.1. * 0*\.000000 * 0*\.2606.. *   1\.824. *  1\.564. *   3\.649. * 0*\.857." $log | wc -l`
CRIT10=`$GREPL "10 * 1140\.1. * 0*\.000000 * 0*\.2606.. *   1\.824. *  1\.564. *   3\.649. * 0*\.857." $log | wc -l`
CRIT11=`$GREPL "11 * 1050\.7. * 0*\.000000 *  1\.1449.. *   8\.014. *  6\.869. *  16\.029. * 0*\.857." $log | wc -l`
CRIT12=`$GREPL "12 * 1050\.7. * 0*\.000000 *  1\.1449.. *   8\.014. *  6\.869. *  16\.029. * 0*\.857." $log | wc -l`
CRIT13=`$GREPL "13 *  952\.1. * 0*\.000000 *  1\.2642.. *   8\.849. *  7\.585. *  17\.699. * 0*\.857." $log | wc -l`
CRIT14=`$GREPL "14 *  414\.3. * 0*\.000000 * 0*\.8382.. *   5\.867. *  5\.029. *  11\.735. * 0*\.857." $log | wc -l`
CRIT15=`$GREPL "15 *  414\.3. * 0*\.000000 * 0*\.8382.. *   5\.867. *  5\.029. *  11\.735. * 0*\.857." $log | wc -l`
TEST[14]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[14]=15
ERROR[14]="ROA FREQ1 NOT CORRECT"

# Circular intensity difference freq1
CRIT1=`$GREPL "11 * 946\.6. * 0*\.0109.. * \-0*\.034(2|3).. * \-0*\.0675.. * \-0*\.0010.." $log | wc -l`
CRIT2=`$GREPL "12 * 940\.4. * 1\.5152.. * 0*\.8730.. * 0*\.6898.. * 1.0562.." $log | wc -l`
CRIT3=`$GREPL "13 * 741\.0. * \-0*\.6732.. * \-0*\.5357.. * \-0*\.1944.. * \-0*\.8770.." $log | wc -l`
CRIT4=`$GREPL "14 * 385\.1. * 1\.8345.. * 2\.4107.. * 0*\.2936.. * 4\.5278.." $log | wc -l`
CRIT5=`$GREPL "15 * 381\.0. * \-1\.8742.. * \-2\.4785.. * \-0*\.2938.. * \-4\.6632.." $log | wc -l`
TEST[15]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[15]=5
ERROR[15]="CIRCULAR INTENSITY DIFFERENCES FREQ1 NOT CORRECT"

# Raman properties freq2
 CRIT1=`$GREPL  "1 * 3428\.4. * 0*\.000000 * 16\.3159.. *  65\.2636.. * 48\.9477.. * 0*\.750000" $log | wc -l`
 CRIT2=`$GREPL  "2 * 3428\.4. * 0*\.000000 * 16\.3158.. *  65\.2635.. * 48\.9476.. * 0*\.750000" $log | wc -l`
 CRIT3=`$GREPL  "3 * 3328\.5. * 0*\.000000 *  9\.3258.. *  37\.3033.. * 27\.9775.. * 0*\.750000" $log | wc -l`
 CRIT4=`$GREPL  "4 * 3328\.2. *  6\.4696.. *  5\.6209.. * 313\.6199.. * 16\.8628.. * 0*\.0537.." $log | wc -l`
 CRIT5=`$GREPL  "5 * 2178\.9. * 0*\.000000 * 0*\.0560.. *  0*\.2243.. * 0*\.1682.. * 0*\.750000" $log | wc -l`
 CRIT6=`$GREPL  "6 * 1620\.5. * 0*\.0007.. *  1\.7382.. *   6\.9875.. *  5\.2148.. * 0*\.7463.." $log | wc -l`
 CRIT7=`$GREPL  "7 * 1572\.4. * 0*\.000000 * 0*\.0778.. *  0*\.3112.. * 0*\.2334.. * 0*\.750000" $log | wc -l`
 CRIT8=`$GREPL  "8 * 1168\.6. *  1\.1682.. * 10\.1487.. *  93\.1642.. * 30\.4462.. * 0*\.3268.." $log | wc -l`
 CRIT9=`$GREPL  "9 * 1140\.1. * 0*\.000000 * 0*\.2500.. *   1\.0002.. * 0*\.7501.. * 0*\.750000" $log | wc -l`
CRIT10=`$GREPL "10 * 1140\.1. * 0*\.000000 * 0*\.2500.. *   1\.0002.. * 0*\.7501.. * 0*\.750000" $log | wc -l`
CRIT11=`$GREPL "11 * 1050\.7. * 0*\.000000 *  1\.1008.. *   4\.4033.. *  3\.3025.. * 0*\.750000" $log | wc -l`
CRIT12=`$GREPL "12 * 1050\.7. * 0*\.000000 *  1\.1008.. *   4\.4033.. *  3\.3025.. * 0*\.750000" $log | wc -l`
CRIT13=`$GREPL "13 *  952\.1. * 0*\.000000 *  1\.2600.. *   5\.0401.. *  3\.7801.. * 0*\.750000" $log | wc -l`
CRIT14=`$GREPL "14 *  414\.3. * 0*\.000000 * 0*\.8223.. *   3\.2893.. *  2\.4669.. * 0*\.750000" $log | wc -l`
CRIT15=`$GREPL "15 *  414\.3. * 0*\.000000 * 0*\.8223.. *   3\.2892.. *  2\.4669.. * 0*\.750000" $log | wc -l`
TEST[16]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[16]=15
ERROR[16]="RAMAN PROPERTIES FREQ2 NOT CORRECT"

# Raman optical activity freq2
 CRIT1=`$GREPL  "1 * 3428\.4. * 0*\.000000 * 16\.3159.. * 114\.211. * 97\.895. * 228\.422. * 0*\.857." $log | wc -l`
 CRIT2=`$GREPL  "2 * 3428\.4. * 0*\.000000 * 16\.3158.. * 114\.211. * 97\.895. * 228\.422. * 0*\.857." $log | wc -l`
 CRIT3=`$GREPL  "3 * 3328\.5. * 0*\.000000 *  9\.3258.. *  65\.280. * 55\.955. * 130\.561. * 0*\.857." $log | wc -l`
 CRIT4=`$GREPL  "4 * 3328\.2. *  6\.4696.. *  5\.6209.. * 330\.482. * 33\.725. * 660\.965. * 0*\.102." $log | wc -l`
 CRIT5=`$GREPL  "5 * 2178\.9. * 0*\.000000 * 0*\.0560.. *  0*\.392. * 0*\.336. *  0*\.785. * 0*\.857." $log | wc -l`
 CRIT6=`$GREPL  "6 * 1620\.5. * 0*\.0007.. *  1\.7382.. *  12\.202. * 10\.429. *  24\.404. * 0*\.854." $log | wc -l`
 CRIT7=`$GREPL  "7 * 1572\.4. * 0*\.000000 * 0*\.0778.. *  0*\.544. * 0*\.466. *   1\.089. * 0*\.857." $log | wc -l`
 CRIT8=`$GREPL  "8 * 1168\.6. *  1\.1682.. * 10\.1487.. * 123\.610. * 60\.892. * 247\.221. * 0*\.492." $log | wc -l`
 CRIT9=`$GREPL  "9 * 1140\.1. * 0*\.000000 * 0*\.2500.. *   1\.750. *  1\.500. *   3\.500. * 0*\.857." $log | wc -l`
CRIT10=`$GREPL "10 * 1140\.1. * 0*\.000000 * 0*\.2500.. *   1\.750. *  1\.500. *   3\.500. * 0*\.857." $log | wc -l`
CRIT11=`$GREPL "11 * 1050\.7. * 0*\.000000 *  1\.1008.. *   7\.705. *  6\.605. *  15\.411. * 0*\.857." $log | wc -l`
CRIT12=`$GREPL "12 * 1050\.7. * 0*\.000000 *  1\.1008.. *   7\.705. *  6\.605. *  15\.411. * 0*\.857." $log | wc -l`
CRIT13=`$GREPL "13 *  952\.1. * 0*\.000000 *  1\.2600.. *   8\.820. *  7\.560. *  17\.640. * 0*\.857." $log | wc -l`
CRIT14=`$GREPL "14 *  414\.3. * 0*\.000000 * 0*\.8223.. *   5\.756. *  4\.934. *  11\.512. * 0*\.857." $log | wc -l`
CRIT15=`$GREPL "15 *  414\.3. * 0*\.000000 * 0*\.8223.. *   5\.756. *  4\.933. *  11\.512. * 0*\.857." $log | wc -l`
TEST[17]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[17]=15
ERROR[17]="ROA FREQ2 NOT CORRECT"

# Circular intensity difference freq2
CRIT1=`$GREPL "11 * 946\.6. * (0| )\.0095.. * (\-0|\-)\.0337.. * (\-0|\-)\.0657.. * (\-0|\-)\.0017.." $log | wc -l`
CRIT2=`$GREPL "12 * 940\.4. * 1\.4336.. * (0| )\.8179.. * (0| )\.6558.. * (0| )\.9799.." $log | wc -l`
CRIT3=`$GREPL "13 * 741\.0.* (\-0|\-)\.6294.. * (\-0|\-)\.5000.. * (\-0|\-)\.1810.. * (\-0|\-)\.8191.." $log | wc -l`
CRIT4=`$GREPL "14 * 385\.1.* 1\.7354.. * 2\.2878.. * (0| )\.2748.. * 4\.3007.." $log | wc -l`
CRIT5=`$GREPL "15 * 381\.0.* \-1.7728.. * \-2.3520.. * (\-0|\-)\.2749.. * \-4.4292.." $log | wc -l`
TEST[18]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[18]=5
ERROR[18]="CIRCULAR INTENSITY DIFFERENCES FREQ2 NOT CORRECT"

# Raman properties freq3
CRIT1=`$GREPL "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 64\.59(44|45|46|47|48|49|50|51)[0-9][0-9] * 48\.44(58|59|60|61|62|63)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT2=`$GREPL "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 64\.59(44|45|46|47|48|49|50|51)[0-9][0-9] * 48\.44(58|59|60|61|62|63)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT3=`$GREPL "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.2785[0-9][0-9] * 37\.1141[0-9][0-9] * 27\.8356[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT4=`$GREPL "4 * 3328\.2[0-9] * 6\.4193[0-9][0-9] * 5\.5412[0-9][0-9] * 311\.0371[0-9][0-9] * 16\.6238[0-9][0-9] * (0| )\.0534[0-9][0-9]" $log | wc -l`
CRIT5=`$GREPL "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0553[0-9][0-9] * (0| )\.2215[0-9][0-9] * (0| )\.1661[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT6=`$GREPL "6 * 1620\.5[0-9] * (0| )\.0006[0-9][0-9] * 1\.7496[0-9][0-9] * 7\.0283[0-9][0-9] * 5\.2488[0-9][0-9] * (0| )\.7468[0-9][0-9]" $log | wc -l`
CRIT7=`$GREPL "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0777[0-9][0-9] * (0| )\.3109[0-9][0-9] * (0| )\.2332[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT8=`$GREPL "8 * 1168\.6[0-9] * 1\.1429[0-9][0-9] * 9\.9262[0-9][0-9] * 91\.1364[0-9][0-9] * 29\.7788[0-9][0-9] * (0| )\.3267[0-9][0-9]" $log | wc -l`
CRIT9=`$GREPL "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * (0| )\.975[5-7][0-9][0-9] * (0| )\.7317[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT10=`$GREPL "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * (0| )\.975[5-7][0-9][0-9] * (0| )\.7317[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT11=`$GREPL "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 4\.30(09|10)[0-9][0-9] * 3\.225[7-8][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT12=`$GREPL "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 4\.30(09|10)[0-9][0-9] * 3\.225[7-8][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT13=`$GREPL "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2575[0-9][0-9] * 5\.0(299|300)[0-9][0-9] * 3\.772[4-5][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT14=`$GREPL "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 3\.25[1-2][0-9][0-9][0-9] * 2\.43[8-9]..[0-9] * (0| )\.750000" $log | wc -l`
CRIT15=`$GREPL "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 3\.25[1-2][0-9][0-9][0-9] * 2\.43[8-9]..[0-9] * (0| )\.750000" $log | wc -l`
TEST[19]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[19]=15
ERROR[19]="RAMAN PROPERTIES FREQ3 NOT CORRECT"

# Raman optical activity freq3
CRIT1=`$GREPL "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 113\.04[0-1][0-9] * 96\.89[1-2][0-9] * 226\.08[0-4][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT2=`$GREPL "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 113\.04[0-1][0-9] * 96\.89[1-2][0-9] * 226\.08[0-4][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT3=`$GREPL "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.2785[0-9][0-9] * 64\.949[0-9] * 55\.671[0-9] * 129\.899[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT4=`$GREPL "4 * 3328\.2[0-9] * 6\.4193[0-9][0-9] * 5\.5412[0-9][0-9] * 327\.661[0-9] * 33\.247[0-9] * 655\.322[0-9] * (0| )\.101[0-9]" $log | wc -l`
CRIT5=`$GREPL "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0553[0-9][0-9] * (0| )\.387[0-9] * (0| )\.332[0-9] * (0| )\.775[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT6=`$GREPL "6 * 1620\.5[0-9] * (0| )\.0006[0-9][0-9] * 1\.7496[0-9][0-9] * 12\.277[0-9] * 10\.497[0-9] * 24\.554[0-9] * (0| )\.855[0-9]" $log | wc -l`
CRIT7=`$GREPL "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0777[0-9][0-9] * (0| )\.544[0-9] * (0| )\.466[0-9] * 1\.088[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT8=`$GREPL "8 * 1168\.6[0-9] * 1\.1429[0-9][0-9] * 9\.9262[0-9][0-9] * 120\.915[0-9] * 59\.557[0-9] * 241\.830[0-9] * (0| )\.492[0-9]" $log | wc -l`
CRIT9=`$GREPL "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * 1\.707[0-9] * 1\.463[0-9] * 3\.41[4-5][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT10=`$GREPL "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * 1\.707[0-9] * 1\.463[0-9] * 3\.41[4-5][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT11=`$GREPL "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 7\.526[0-9] * 6\.451[0-9] * 15\.053[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT12=`$GREPL "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 7\.526[0-9] * 6\.451[0-9] * 15\.053[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT13=`$GREPL "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2575[0-9][0-9] * 8\.802[0-9] * 7\.545[0-9] * 17\.605[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT14=`$GREPL "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 5\.69[0-1][0-9] * 4\.87[7-9][0-9] * 11\.38[0-3][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT15=`$GREPL "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 5\.69[0-1][0-9] * 4\.87[7-9][0-9] * 11\.38[0-3][0-9] * (0| )\.857[0-9]" $log | wc -l`
TEST[20]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[20]=15
ERROR[20]="ROA FREQ3 NOT CORRECT"

# Circular intensity difference freq3
CRIT1=`$GREPL "11 * 946\.6. * (0| )\.0087.. * (\-0|\-)\.0332.. * (\-0|\-)\.0645.. * (\-0|\-)\.0020.." $log | wc -l`
CRIT2=`$GREPL "12 * 940\.4. * 1\.3830.. * (0| )\.7843.. * (0| )\.6346.. * (0| )\.9340.." $log | wc -l`
CRIT3=`$GREPL "13 * 741\.0. * (\-0|\-)\.6028.. * (\-0|\-)\.4785.. * (\-0|\-)\.1729.. * (\-0|\-)\.7841.." $log | wc -l`
CRIT4=`$GREPL "14 * 385\.1. * 1\.6740.. * 2\.2111.. * (0| )\.2634.. * 4\.1588.." $log | wc -l`
CRIT5=`$GREPL "15 * 381\.0. * \-1\.7100.. * \-2\.2732.. * (\-0|\-)\.2634.. * \-4\.2829.." $log | wc -l`
TEST[21]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[21]=5
ERROR[21]="CIRCULAR INTENSITY DIFFERENCES FREQ3 NOT CORRECT"

# Isotopic frequencies
CRIT1=`$GREPL "1 * A * 3381\.7[0-9] * (0| )\.01540[0-9] * 5\.64[0-9] * (0| )\.133[0-9]" $log | wc -l`
CRIT2=`$GREPL "2 * A * 3381\.6[0-9] * (0| )\.01540[0-9] * 8\.40[0-9] * (0| )\.198[0-9]" $log | wc -l`
CRIT3=`$GREPL "3 * A * 2509\.9[0-9] * (0| )\.01143[0-9] * 7\.25[0-9] * (0| )\.171[0-9]" $log | wc -l`
CRIT4=`$GREPL "4 * A * 2486\.3[0-9] * (0| )\.01132[0-9] * 3\.01[0-9] * (0| )\.071[0-9]" $log | wc -l`
CRIT5=`$GREPL "5 * A * 2141\.1[0-9] * (0| )\.00975[0-9] * 109\.70[0-9] * 2\.596[0-9]" $log | wc -l`
CRIT6=`$GREPL "6 * A * 1491\.7[0-9] * (0| )\.00679[0-9] * (0| )\.08[0-9] * (0| )\.002[0-9]" $log | wc -l`
CRIT7=`$GREPL "7 * A * 1421\.5[0-9] * (0| )\.00647[0-9] * 5\.28[0-9] * (0| )\.125[0-9]" $log | wc -l`
CRIT8=`$GREPL "8 * A * 1157\.2[0-9] * (0| )\.00527[0-9] * (0| )\.00[0-9] * (0| )\.0000" $log | wc -l`
CRIT9=`$GREPL "9 * A * 1018\.5[0-9] * (0| )\.00464[0-9] * 57\.51[0-9] * 1\.361[0-9]" $log | wc -l`
CRIT10=`$GREPL "10 * A * 993\.8[0-9] * (0| )\.00452[0-9] * 6.10[0-9] * (0| )\.144[0-9]" $log | wc -l`
CRIT11=`$GREPL "11 * A * 946\.6[0-9] * (0| )\.00431[0-9] * 5\.42[0-9] * (0| )\.128[0-9]" $log | wc -l`
CRIT12=`$GREPL "12 * A * 940\.4[0-9] * (0| )\.00428[0-9] * 66\.24[0-9] * 1\.567[0-9]" $log | wc -l`
CRIT13=`$GREPL "13 * A * 741\.0[0-9] * (0| )\.00337[0-9] * 9\.04[0-9] * (0| )\.214[0-9]" $log | wc -l`
CRIT14=`$GREPL "14 * A * 385\.1[0-9] * (0| )\.00175[0-9] * 14\.65[0-9] * (0| )\.346[0-9]" $log | wc -l`
CRIT15=`$GREPL "15 * A * 381\.0[0-9] * (0| )\.00173[0-9] * 14\.76[0-9] * (0| )\.349[0-9]" $log | wc -l`
TEST[22]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[22]=15
ERROR[22]="ISOTOPIC FREQUENCIES NOT CORRECT"

PASSED=1
for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
     echo "${ERROR[i]} ( test = ${TEST[i]}; control = ${CTRL[i]} ); "
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi

%EOF%
#######################################################################
