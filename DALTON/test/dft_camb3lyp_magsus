#!/bin/sh

info='
   dft_camb3lyp_magsus 
   ----------------------
   Molecule:         HOF
   Wave Function:    DFT (CAM-B3LYP) / 6-31G** 
   Test Purpose:     Test magnetizability and molecular
                     rotational g-factor calculation with
                     Coulomb attenuated functional 
'

molecule='BASIS
6-31G**
HOF B3LYP/6-31G**

    3   0 
        1.    1
H         -1.7477891561           -1.7077611826             .0000000000
        8.    1
O         -1.4230900102             .1042645372             .0000000000
        9.    1
F          1.2876238525            -.0038104469             .0000000000
'

dalton='**DALTON INPUT
.RUN WAVE FUNCTION
.PROPERTIES
.DIRECT
**WAVE FUNCTIONS
.DFT
 CAMB3LYP
**PROPERTIES
.MAGNET
**END OF INPUT
'

test='
check_scf_energy DFT -175.475531229427 5e-8

check_mag_tensors 1e-5 "
       -4.132992516215     -0.000099135628      0.000000000000
       -0.000099135628     -2.170374441571     -0.000000000000
        0.000000000000     -0.000000000000     -2.400509384344
" "
       -4.383994470300      0.098463705936     -0.000000000000
        0.098463705936    -12.316576502084     -0.000000000000
       -0.000000000000     -0.000000000000    -12.669021874570
" "
        0.251001954085     -0.098562841565      0.000000000000
       -0.098562841565     10.146202060513     -0.000000000000
        0.000000000000     -0.000000000000     10.268512490225
"

check_g_tensors 1e-5 "
      0.63833861     -0.02141068     -0.00000000
     -0.46132256     -0.09607957      0.00000000
     -0.00000000      0.00000000     -0.05610737
" "
      0.96244318     -0.02229256      0.00000000
     -0.48032390      0.51435972      0.00000000
      0.00000000      0.00000000      0.53423357
" "
     -0.35993492      0.00853394     -0.00000000
      0.18387549     -0.54174858      0.00000000
     -0.00000000      0.00000000     -0.51455046
" "
      0.03583036     -0.00765206     -0.00000000
     -0.16487415     -0.06869070      0.00000000
     -0.00000000     -0.00000000     -0.07579048
"
'
. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"


# check_basis "6-31G**" "
# H 1 1  4s1p 2s1p
# O 1 6  10s4p1d 3s2p1d
# F 1 9  10s4p1d 3s2p1d

