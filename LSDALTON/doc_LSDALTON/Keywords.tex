
\chapter{List of \lsdalton\ keywords}\label{ch:keywords}

In this chapter, we describe all keywords for the different sections
of the LSDALTON.INP file. In general, LSDALTON.INP is divided into the following sections under
the headlines:
\begin{itemize}
\item **GENERAL contain general settings (optional)
\item **INTEGRAL contain settings for the calculation of integrals (optional)
\item **WAVE FUNCTIONS contains info about the wave function (e.g. HF/DFT) and settings
for optimization of the wave function (mandatory)
\item **OPTIMIZE contains settings for geometry optimization (optional)
\item **RESPONS contains info about requested molecular properties for HF and DFT (optional)
\item **DEC \emph{or} **CC contains info about MP2 and coupled-cluster calculations (optional)
\item **PLT contains information about construction of *.plt files which may be used to visualize densities and orbitals using e.g. the Chimera program~\cite{chimera}.
\item **PLTGRID contains information about grid used for construction of *.plt files.
\end{itemize}
Each of these sections may contain subsections, indicated by a single asterisk. LSDALTON.INP
should always end with *END OF INPUT. 

\section{**GENERAL}\label{sec:integral}

This input module defines the way the integrals should be calculated.
\begin{description}

\item[\Key{SCALAPACK}] Use SCALAPACK matrices. NB: Requires linking to the scalapack lib (provided by MKL)
\item[\Key{SCALAPACKBLOCKSIZE}] the blocksize used in SCALAPACK matrices
\item[\Key{CSR}] Use Compressed-Sparse Row matrices. NB: Requires linking to MKL library!
\item[\Key{TIME}] Activate the printout of timings.
\item[\Key{NOGCBASIS}] Deactivate the use of the Grand Canonical basis \cite{trilevel1, trilevel2}
\item[\Key{FORCEGCBASIS}] The Grand Canonical basis \cite{trilevel1, trilevel2} is deactivated when the program
detects the use of a Dunning basis set like (cc-pVXZ) but the calculation will force the use of the Grand Canonical basis using this keyword.

\end{description}
\section{**INTEGRAL}\label{sec:integral}

This input module defines the way the integrals should be calculated.
\begin{description}

\item[\Key{DENSFIT}] Use density-fitting for the Coulomb contribution (no exact exchange density-fitting method have been introduced). 
When using this keyword, an auxiliary basis set has to be 
specified in \mol\ file.

\item[\Key{RUNMM}] Use the (Fast) Multipole Method.

\item[\Key{AOPRINT}] 
\verb| | \newline
\verb|<Print level>|\newline
Print the Atomic Orbital information. The higher the print level, the more information will be printed.
\item[\Key{BASPRINT}] 
\verb| | \newline
\verb|<Print level>|\newline
Print the basis set information. The higher the print level, the more information will be printed.
Using a print level of 6 will print the input exponents and contraction coefficients read from file as well as the normalized basis used in LSDALTON.  
\item[\Key{CARMOM}] 
\verb| | \newline
\verb|<Order of multipole moment>|\newline
Calculate the cartesian multipole moment integrals to the order requested. 
\begin{eqnarray}
\int \chi_{\mu}(r_{1}) x^{i}y^{j}z^{k} \chi_{\rho}(r_{2}) dr_{1}dr_{2}
\end{eqnarray}
\item[\Key{CART-E}] Use cartesian E-coefficients instead of hermite E-coefficients for the McMurchie-Davidson
integral-evaluation scheme \cite{McMurchie1978} used in \lsdalton. The use of Cartesian E-coefficients is 
default in most integral programs. We however use hermite E-coefficients according to ref.~\cite{reine:4771}.
\item[\Key{ETUVIL}] Build E-coefficients inside the integral loop, in order to reduced memory requirements. 
This will increase the workload! 
%\item[\Key{FRAGMENT}] Calculate integrals in fragments, in order to reduced memory requirements 
\item[\Key{FTUVMAXPRIM}] 
\verb| | \newline
\verb|<Maxprim>|\newline
Sets the maximum number of primitives used in the FTUV batches in the J-engine algorithm.
\item[\Key{INTPRINT}] 
\verb| | \newline
\verb|<Print level>|\newline
Print information about the actual integral evaluation. The higher the print level, the more information will be printed. 
\item[\Key{NOJENGINE}] Turn off J-engine algorithm (which is default) for the calculation of the Coulomb matrix 
(see Refs. \cite{shao:425} and \cite{shao:6572}). Compute instead Coulomb-like contributions from the explicitly calculated integrals.
\item[\Key{NOLINK}] Turn off the LinK algorithm (which is default) for the calculation of the exchange matrix (see Ref. \cite{ochsenfeld:1663}).
\item[\Key{LINSCAPRINT}] 
\verb| | \newline
\verb|<Print level>|\newline
Print level in the integral code. The higher the print level, the more information will be printed.
\item[\Key{LOW RJ000 ACCURACY}] Use a decreased accuracy for the calculation of the Boys function.
\item[\Key{MAXPASSES}] 
\verb| | \newline
\verb|<maxpass>|\newline
Change the maximum number of collected overlaps (default is 40).
\item[\Key{MOLPRINT}] 
\verb| | \newline
\verb|<Print level>|\newline
Print information about the molecule. The higher the print level, the more information will be printed. 
\item[\Key{NO CS}] Deactivate the use of Cauchy-Schwarz screening.
\item[\Key{NO PASS}] Deactivate the use of Passes, the collection of overlaps which is used as default in order to increase efficiency. 
\item[\Key{NO PS}] Deactivate the use of primitive Cauchy-Schwarz screening.
\item[\Key{NO SCREEN}] Deactivate the use of all screening methods.
\item[\Key{NOFAMILY}] Deactivate the exploitation of family type basis set, basis set sharing exponents for different angular momentums.  
\item[\Key{NOSEGMENT}] Deactivate the use of segments. The use of segments is used to reduced the numer of primitive functions in the calculation of integrals.
\item[\Key{NSETUV}] Use non-spherical E-coefficients.
\item[\Key{OVERLAP-DF-J}] Use the Overlap density fitting algorithm for the calculation of the Coulomb matrix.
%\item[\Key{PARI}] Use pair-atomic-resolution-of-the-identity algorithm for the calculation of the Fock matrix
\item[\Key{SPHMOM}] 
\verb| | \newline
\verb|<Order of multipole moment>|\newline
Calculate spherical multipole moment integrals to the requested order.
\item[\Key{THR\_CS}] 
\verb| | \newline
\verb|<CS_Threshold>|\newline
Cauchy-Schwarz screening threshold.
\item[\Key{THR\_PS}] 
\verb| | \newline
\verb|<PS_Threshold>|\newline
Primitive Cauchy-Schwarz screening threshold.
\item[\Key{THRESH}]
\verb| | \newline
\verb|<Threshold>|\newline
An overall screening threshold for integral evaluation. The various integral-evaluation thresholds (below) are set according to
\begin{itemize}
\item The Cauchy-Schwarz screening threshold is set equal to Threshold (can be set separately by \Key{THR\_CS})
\item The Primitve Cauchy-Schwarz screening threshold is set equal to Threshold$\cdot 10^{-1}$  (can be set separately by \Key{THR\_PS})
\item The Overlap-distribution distance-screening threshold is set equal to 
      Threshold$\cdot 10^{-1}$.
      When calculating overlap integrals, this threshold 
      is used for setting up AO extents. Overlap distributions (ODs) for which the 
      distance between the two AOs are larger than the sum of the extents are 
      screened away.
\item The Overlap-distribution extent-screeing threshold is set equal to 
      Threshold$\cdot 10^{-1}$. When calculating overlap integrals, this threshold 
      is used for setting up OD extents. Overlap integrals between two ODs separated
      by more than the sum of the extents are screened away. 
\item The FMM threshold is used to distinguish the Coulomb repulsion into classical and non-classical interactions, based on
      the non-classical extent of the contineous charge distribution (orbitals or orbital products). By default this threshold 
      is set equal to Threshold$\cdot 10^{-1}$ (can be set separately by \Key{SCREEN} under *FMM)
\end{itemize}
\item[\Key{UNCONT}] Treat the basis functions (given by input) as fully uncontracted basis fuctions (i.e. ignore
any contraction coefficients given in the basis and treat instead all the primitives as separate basis functions).
\end{description}

\subsection{*FMM}\label{subsec:denfit}

This input block is used to specify settings for the (continuous) fast multipole moment (FMM) treatment of 
classical Coulomb interactions.\newline
% comment by A. Krapp for FMM gradients. 
%
% Meant as a reminder to those who will rewrite/restructure/optimise the FMM code
%
For gradients OpenMP parallelisation is turned off. The reason for this is that a continous counter used 
to identify moments for orbital products has to be the same in both moments and derivative moments. 
For the same reason screening [only during writing (see printmm routines)!!] is turned off both for the serial 
and parallel cases. As a consequence of the screeening been turned off the moments have to be recalculated for the gradient and can not be reused from the preceeding energy evaluation. 
%
% a solution to these problems could be to calculate moments and derivatives moments at the same time as was
% done in the FCK3 code.
%
The gradient implementation has been tested both for regular and density fitting Coulomb interactions. 
It works for the combined N-e +  e-e + N-N interactions (default), 
and for the e-e interaction only (invoked by \Key{NOONE}).
It has however not been tested for speed and efficiency.
%
% end of comment 
\begin{description}
\item[\Key{LMAX}] \verb| |\newline
\verb|<Lmax>|\newline
The maximum multipole-moment expansion order of a given orbital product.
\item[\Key{TLMAX}] \verb| |\newline
\verb|<TLmax>|\newline
The maximum order used for translated multipole-moments.
\item[\Key{SCREEN}] \verb| |\newline
\verb|<Threshold>|\newline
Defines the threshold used to determine if a contribution can be calculated classically on non-classically.
\item[\Key{NOONE}] Do not use FMM for the nuclear-electron attraction.
\item[\Key{NOMMBU}] Do not use io-buffers for interfacing multipole-moments to the FMM driver.
\end{description}

\section{**WAVE FUNCTION}\label{sec:wavefunc}
\begin{description}
\item[\Key{HF}] Hartree-Fock calculation.
\item[\Key{DFT}] \verb| | \newline
\verb|<FUNCTIONAL>|\newline
DFT calculation. The exchange---correlation functional is read from the following line.

Functionals in \lsdalton\ can be divided into two groups: generic and combined functionals. 
Combined functionals are a linear combination of generic ones. One can always create own combined functionals by using GGAKey general functional.
A number of standalone functionals are also included within \lsdalton. 

It should be noted that the input is not case sensitive, although the notation
employed in this manual makes use of case to exphasise exchange or correlation 
functional properties and reflect the original literature sources.

Supported functionals are: 
\subsubsection{Exchange Functionals}
\providecommand\exfn[1]{#1}

\begin{description}
\item[Slater] Dirac-Slater exchange functional \cite{dft:hohenberg,dft:kohn,dft:slater}.\index{Slater}

\item[Becke] 1988 Becke exchange GGA correction \cite{dft:becke88}. Note that the full Becke88 exchange functional is given as \exfn{Slater} + \exfn{Becke}.\index{Becke}

%\item[mBecke] 1998 modified \exfn{Becke} exchange correction presented in reference \cite{dft:edf1} for use in the EDF1 functional. The $\beta$ value of 0.0042 in \exfn{Becke} is changed to 0.0035.\index{mBecke}\index{EDF1}

%\item[B86] Becke 1986 exchange functional, a divergence free, semi-empirical gradient-corrected exchange functional~\cite{dft:b86,dft:b86r}.\index{B86} This functional corresponds to the B86R functional of the Molpro program.

%\item[B86mx] B86 exchange functional modified with a gradient correction for large density gradients~\cite{dft:b86mgc}.\index{B86mx}

%\item[DBx] Double-Becke exchange functional defined in 1998 by Gill et al.\cite{dft:edf1,dft:edf2} for use in the EDF1 functional. The full DBx functional is defined as 1.030952*\exfn{Slater} - 8.44793*\exfn{Becke} + 10.4017*\exfn{mBecke} \index{EDF1}\index{Double-Becke}\index{Becke}

%\item[DK87x] DePristo and Kress' 1987 rational function GGA exchange functional (equation 7) from Ref. \cite{dft:dk87}.\index{DK87} The full exchange functional is defined as \exfn{Slater} + \exfn{DK87x}.

%\item[G96x] Gill's 1996 GGA correction exchange functional~\cite{dft:g96}.\index{G96} The complete exchange functional is given by \exfn{Slater} + \exfn{G96x}.

%\item[LG93x] 1993 GGA exchange functional~\cite{dft:lg93,dft:g961lyp}.\index{LG93} The full LG93 exchange functional is given by \exfn{Slater} + \exfn{LG93x} 

%\item[LRC95x] 1995 GGA exchange functional with correct asymptotic behavior~\cite{dft:lrc95}.\index{LRC95} The LRC95x exchange functional includes the Slater exchange (Eq 6 from original reference).

\item[KTx] Keal and Tozer's 2003 GGA exchange functional (With x being 1,2 or 3). Note that the gradient correction pre-factor constant, $\gamma$, is not included in the KT exchange 
  definition, but rather in the KT1, KT2 and KT3 definitions. The full KT exchange is given by \cite{dft:kt12}\index{KT}, \exfn{Slater} + $\gamma$\exfn{KTx} ($\gamma$ is -0.006 for KT1,KT2 and -0.004 for KT3). 

\item[OPTX] Handy's 2001 exchange functional correction \cite{dft:optx}.\index{OPTX} The full OPTX exchange functional is given by 1.05151*\exfn{Slater} - 1.43169*\exfn{OPTX}.

\item[PBEx] Perdew, Burke and Ernzerhof 1996 exchange functional~\cite{dft:pbe}.\index{PBEx}

%\item[revPBEx] Zhang and Wang's 1998 revised PBEx exchange functional, with $\kappa$ of 1.245 \cite{dft:revpbe}.\index{revPBE}\index{PBE}

%\item[RPBEx] Hammer, Hansen and N{\o}rskov's 1999 revised PBEx exchange functional \cite{dft:revpbe}.\index{RPBE}\index{PBE}

%\item[mPBEx] Adamo and Barone's 2002 modified PBEx exchange functional~\cite{dft:mpbe}.\index{mPBE}\index{PBE}

\item[PW86x] Perdew and Wang 1986 exchange functional (the PWGGA-I functional)\cite{dft:pw86x}.\index{PW86x}

%\item[PW91x] Perdew and Wang 1991 exchange functional (the pwGGA-II functional) and includes Slater exchange \cite{dft:pw91}.\index{PW86x} This functional is also given in a separate parameterization in Refs.~\cite{dft:g96,dft:mpw}, which is labeled PW91x2, and is defined as \exfn{PW91x} = \exfn{Slater} + \exfn{PW91x2}.

%\item[mPW] Adamo and Barone's 1998 modified PW91x GGA correction exchange functional ~\cite{dft:pw91,dft:mpw}. The full exchange functional is given by \exfn{Slater} + \exfn{mPW}.\index{mPW}

\end{description}

\subsubsection{Correlation Functionals}
\providecommand\corfn[1]{#1}
\begin{description}

\item[VWN3] correlation functional of Vosko, Wilk and Nusair, 1980 (equation III) 
  \cite{dft:vwn}. This is the form used in the Gaussian program.\index{VWN3}

\item[VWN5] correlation functional of Vosko, Wilk and Nusair, 1980 (equation
  V -- the recommended one). The VWN keyword is a synonym for VWN5~\cite{dft:vwn}.\index{VWN5}

%\item[FT97c] Filatov and Thiel 1997 (FT97) correlation functional
%  \cite{dft:ft97}.\index{FT97}

\item[LYP] correlation functional by Lee, Yang and Parr, 1988
  \cite{dft:lyp1,dft:lyp2}.\index{LYP}

%\item[LYPr] 1998 modified \corfn{LYP} functional, which is the re-parameterized EDF1 version 
%  with modified parameters (0.055, 0.158, 0.25, 0.3505)
%  \cite{dft:lyp1,dft:lyp2,dft:edf1}.\index{LYPr}\index{EDF1}

\item[P86c] non-local part of the correlation functional of the Perdew 1986 correlation functional
  \cite{dft:p86}. PZ81 (1981 Perdew local) is usually used for the local part of the
  functional, with a total corelation functional of \index{P86}\index{PZ81}
  \corfn{P86c} + \corfn{PZ81}.

\item[PBEc] Perdew, Burke and Ernzerhof 1996 correlation functional, 
  defined as PW91c local and PBEc non-local correlation~\cite{dft:pbe}.\index{PBEc}

\item[PW91c] 1991 correlation functional of Perdew and Wang (the pwGGA-II functional)
  ~\cite{dft:pw91}.\index{PW91} This functional includes both the PW91c non-local and 
  PW91c local (ie PW92c) contributions. The non-local PW91c contribution may be determined
  as \corfn{PW91c} - \corfn{PW92c}.

%\item[PW92c] local correlation functional of Perdew and Wang, 1992~\cite{dft:pw91,dft:pw92}.\index{PW91}
%  This functional is the local contribution to the PW91c correlation functional.

%\item[PW92ac] gradient correction to the PW91c correlation functional of Perdew and Wang,
%  equation 16 from Ref.~\cite{dft:pw91,dft:pw92}.\index{PW91} The PWGGA-IIA functional
%  as defined in the original reference is \corfn{PW91c} + \corfn{PW92ac}. 

\item[PZ81] local correlation functional of Perdew and Zunger, 1981~\cite{dft:pz81}.\index{PZ81}

%\item[Wigner] original 1938 spin-polarized correlation functional~\cite{dft:wigner}.\index{Wigner}

%\item[WL90c] Wilson and Levy's 1990 non-local spin-dependent correlation functional 
%  (equation 15 from Ref.~\cite{dft:wl90}).\index{WL90}

\end{description}

\subsubsection{Standalone Functionals}
\providecommand\onefn[1]{#1}
\begin{description}
\item[LB94] asymptotically correct functional of Leeuwen and
  Baerends 1994~\cite{dft:lb94}. This functional improves description of the
  asymptotic density on the expense of core and inner valence.\index{LB94}

%\item[B97] Becke 1997 functional~\cite{dft:b97}.\index{B97}

%\item[B97-1] Hamprecht et al.'s 1998 re-parameterization of the 
%  B97 functional~\cite{dft:b97-1}.\index{B97}\index{B97-1}

%\item[B97-2] Modification of B97 functional in 2001 by Wilson, Bradley and Tozer 
%  \cite{dft:b97-2}.\index{B97}\index{B97-2}

%\item[B97-K] Boese and Martin 2004 re-parameterization of the 
%  B97-1 functional for kinetics~\cite{dft:b97-1}.\index{B97}\index{B97-K}

%\item[HCTH] is a synonym for the HCTH407 functional (detailed below).
%  \cite{dft:hcth407}.\index{HCTH}\index{HCTH407}

%\item[HCTH93] Original 1998 HCTH functional, parameterized on a set of 
%  93 training systems~\cite{dft:hcth93}.\index{HCTH}\index{HCTH93}

%\item[HCTH120] The HCTH functional parameterized on a set of 120 training systems 
%  in 2000~\cite{dft:hcth120}.\index{HCTH}\index{HCTH120}

%\item[HCTH147] The HCTH functional parameterized on a set of 147 training systems 
%  in 2000~\cite{dft:hcth120}.\index{HCTH}\index{HCTH147}

%\item[HCTH407] The HCTH functional parameterized on a set of 407 training systems 
%  in 2001~\cite{dft:hcth407}.\index{HCTH}\index{HCTH407}

%\item[HCTH407p] The HCTH407 functional re-parameterized in 2003 on a set of 407 
%  training systems and ammonia dimer to incorporate hydrogen bonding 
%  \cite{dft:hcth407p}.\index{HCTH}\index{HCTH407}\index{HCTH407p}

\end{description}

\subsubsection{Combined functionals}
\providecommand\funexample[1]{\\{\tt #1 }}
\begin{description}

\item[GGAKey] is a universal keyword allowing users to manually
  construct arbitrary linear combinations of exchange and correlation 
  functionals from the list above. Even fractional 
  Hartree--Fock exchange can be specified. This keyword is to be 
  followed by a string of functionals with associated weights. 
  The syntax is \verb|NAME=WEIGHT ...|. 
  As an example, B3LYP may be constructed as:
\begin{verbatim}
.DFT
 GGAKey HF=0.2 Slater=0.8 Becke=0.72 LYP=0.81 VWN=0.19
\end{verbatim}

The following GGA and hybrid functional aliases are defined within 
\lsdalton\ and provide further examples of the GGAKey keyword.

\item[SVWN5] is a sum of Slater functional and VWN (or VWN5) correlation
  functional. SVWN is a synonym for SVWN5. It is equivalent to
  \funexample{GGAKey Slater=1 VWN5=1}
  \index{SVWN}

\item[SVWN3] is a sum of the Slater exchange functional and VWN3 correlation
  functional. It is equivalent to the Gaussian program LSDA functional 
  and can alternatively be selected by following set of keywords
  \funexample{GGAKey Slater=1 VWN3=1}
  \index{SVWN3}

\item[LDA] A synonym for SVWN5 (or SVWN). \index{LDA}

%\item[BVWN] is a sum of the \exfn{Slater} functional, \exfn{Becke} correction and 
%  \corfn{VWN} correlation functional.  It is equivalent to 
%  \funexample{GGAKey Slater=1 Becke=1 VWN=1}
%  \index{BVWN}

\item[BLYP] is a sum of Slater functional, Becke88 correction and LYP
  correlation functional.  It is equivalent to 
  \funexample{GGAKey Slater=1 Becke=1 LYP=1}
  \index{BLYP}

\item[B3LYP] 3-parameter hybrid functional \cite{dft:b3lyp} equivalent to:
  \funexample{GGAKey HF=0.2 Slater=0.8 Becke=0.72 LYP=0.81 VWN=0.19}
  \index{B3LYP}

\item[B3LYP-G] hybrid functional with VWN3 form used for
  correlation---this is the form used by the Gaussian quantum chemistry
  program. Keyword B3LYPGauss is a synonym for B3LYPg.\index{B3LYPG} 
  This functional can be explicitely set up by
  \funexample{GGAKey HF=0.2 Slater=0.8 Becke=0.72 LYP=0.81 VWN3=0.19}
  \index{B3LYP, Gaussian version}

%\item[B1LYP] 1-parameter hybrid functional with 25\% exact exchange \cite{dft:b1lyp}. 
%  Equivalent to: \funexample{GGAKey HF=0.25 Slater=0.75 Becke=0.75 LYP=1}
%  \index{B3LYP}

\item[BP86] Becke88 exchange functional and Perdew86 correlation
  functional (with Perdew81 local correlation). The explicit form is:
  \funexample{GGAKey Slater=1 Becke=1 PZ81=1 P86c=1}
  \index{BP86}

\item[B3P86] variant of \verb|B3LYP| with VWN used for local
  correlation  and P86 for the nonlocal part.
  \funexample{GGAKey HF=0.2 Slater=0.8 Becke=0.72 P86c=0.81 VWN=1}
  \index{B3P86}

\item[B3P86-G] variant of \verb|B3LYP| with VWN3 used for local
  correlation and P86 for the nonlocal part.
  This is the form used by the Gaussian quantum chemistry program.
  \funexample{GGAKey HF=0.2 Slater=0.8 Becke=0.72 P86c=0.81 VWN3=1}
  \index{B3P86}\index{B3P86, Gaussian version}

\item[BPW91] Becke88 exchange functional and PW91 correlation
  functional. The explicit form is:
  \funexample{GGAKey Slater=1 Becke=1 PW91c=1}
  \index{BPW91}

%\item[B3PW91] 3-parameter Becke-PW91 functional, with PW91 correlation 
%  functional. Note that PW91c includes PW92c local correlation, thus only
%  excess PW92c local correlation is required (coefficient of 0.19).
%  \funexample{GGAKey HF=0.2 Slater=0.8 Becke=0.72 PW91c=0.81 PW92c=0.19}
%  \index{B3PW91}

%\item[B1PW91] 1-parameter hybrid functional \cite{dft:b1lyp} equivalent to:
%  \funexample{GGAKey HF=0.25 Slater=0.75 Becke=0.75 PW91c=1}
%  \index{B1PW91}

%\item[B86VWN] is a sum of \exfn{Slater} and \exfn{B86x} exchange functionals and 
%  the \corfn{VWN} correlation functional. It is equivalent to 
%  \funexample{GGAKey Slater=1 B86x=1 VWN=1}
%  \index{B86VWN}

%\item[B86LYP] is a sum of \exfn{Slater} and \exfn{B86x} exchange functionals and 
%  the \corfn{LYP} correlation functional. It is equivalent to 
%  \funexample{GGAKey Slater=1 B86x=1 LYP=1}
%  \index{B86LYP}

%\item[B86P86] is a sum of \exfn{Slater} and \exfn{B86x} exchange functionals and 
%  the \corfn{P86c} correlation functional. It is equivalent to 
%  \funexample{GGAKey Slater=1 B86x=1 P86c=1}
%  \index{B86P86}

%\item[B86PW91] is a sum of \exfn{Slater} and \exfn{B86x} exchange functionals and 
%  the \corfn{PW91c} correlation functional.  It is equivalent to 
%  \funexample{GGAKey Slater=1 B86x=1 PW91c=1}
%  \index{B86PW91}

%\item[BHandH] is an simple Half-and-half functional.
%  \funexample{GGAKey HF=0.5 Slater=0.5 LYP=1}
%  \index{BHandH}

%\item[BHandHLYP] is another simple Half-and-half functional.
%  \funexample{GGAKey HF=0.5 Slater=0.5 Becke=0.5 LYP=1}
%  \index{BHandH}

%\item[BW] is the sum of the Becke exchange and Wigner correlation
%  functionals \cite{dft:wigner,dft:bw}.\index{BW}
%  \funexample{GGAKey Slater=1 Becke=1 Wigner=1}

\item[CAMB3LYP] Coulomb Attenuated Method Functional of Yanai, Tew and
Handy \cite{dft:camb3lyp}. This functional accepts additional arguments
\verb|alpha|, \verb|beta| and \verb|mu| to modify the fraction of HF
exchange for short-range interactions, additional fraction of HF
exchange for long-range interaction and the interaction switching
factor $\mu$. This input can be specified as follows:
\begin{verbatim}
.DFT
 CAMB3LYP alpha=0.190 beta=0.460 mu=0.330
\end{verbatim}
\index{CAMB3LYP}

%\item[DBLYP] is a sum of the Double-Becke exchange functional and
%  the LYP correlation functional 
%  \cite{dft:becke88,dft:edf1,dft:lyp1,dft:lyp2}.\index{Double-Becke}
% \funexample{GGAKey Slater=1.030952 Becke=-8.44793 mBecke=10.4017 LYP=1}

%\item[DBP86] is the sum of the Double-Becke exchange functional and
%  the P86 correlation functional \cite{dft:becke88,dft:edf1,dft:p86}.\index{Double-Becke}
% \funexample{GGAKey Slater=1.030952 Becke=-8.44793 mBecke=10.4017 P86c=1 PZ81=1}

%\item[DBPW91] is a sum of the Double-Becke exchange functional and
%  the PW91 correlation functional \cite{dft:becke88,dft:edf1,dft:pw91}.\index{Double-Becke}
% \funexample{GGAKey Slater=1.030952 Becke=-8.44793 mBecke=10.4017 PW91c=1}

%\item[EDF1] is a fitted functional of Adamson, Gill and Pople \cite{dft:edf1}.
%  It is a linear combination of the Double-Becke exchange functional and the revised LYP
%  functional LYPr.\index{EDF1}
% \funexample{GGAKey Slater=1.030952 Becke=-8.44793 mBecke=10.4017 LYPr=1}

%\item[EDF2] is a linear combination of the Hartree-Fock exchange and the Double-Becke 
%  exchange, Slater exchange, LYP correlation, revised LYPr correlation and VWN 
%  correlation functionals \cite{dft:edf2}\index{EDF2}.
% \funexample{GGAKey HF=0.1695 Slater=0.2811 Becke=0.6227 mBecke=-0.0551 VWN=0.3029 LYP=0.5998 LYPr=-0.0053}

%\item[G96VWN] is the sum of the G96 exchange functional and the VWN 
%  correlation functional \cite{dft:g96}.
% \funexample{GGAKey Slater=1 G96x=1 VWN=1}

%\item[G96LYP] is the sum of the G96 exchange functional and the LYP
%  correlation functional \cite{dft:g96}.
% \funexample{GGAKey Slater=1 G96x=1 LYP=1}

%\item[G96P86] is the sum of the G96 exchange functional and the P86
%  correlation functional \cite{dft:g96}.
% \funexample{GGAKey Slater=1 G96x=1 P86c=1}

%\item[G96PW91] is the sum of the G96 exchange functional and the PW91
%  correlation functional \cite{dft:g96}.
% \funexample{GGAKey Slater=1 G96x=1 PW91c=1}

%\item[G961LYP] is a 1-parameter B1LYP type functional with the exchange gradient 
%  correction provided by the G96x functional \cite{dft:g961lyp}.
% \funexample{GGAKey HF=0.25 Slater=0.75 G96x=0.75 LYP=1}

%\item[KMLYP] Kang and Musgrave 2-parameter hybrid functional with a mixture of
%  Slater and Hartree--Fock exchange and VWN and LYP correlation functionals.
%  \cite{dft:kmlyp}.
% \funexample{GGAKey HF=0.557 Slater=0.443 VWN=0.552 LYP=0.448}

\item[KT1] Slater-VWN5 functional with the KT GGA exchange correction
  \cite{dft:kt12,dft:kt12a}.\index{KT1}
 \funexample{GGAKey Slater=1 VWN=1 KT=-0.006}

\item[KT2] differs from KT1 only in that the weights of the Slater and
  VWN5 functionals are from an empirical fit (not equal to 1.0)
  \cite{dft:kt12,dft:kt12a}.\index{KT2}
  \funexample{GGAKey Slater=1.07173 VWN=0.576727 KT=-0.006}

\item[KT3] a hybrid functional of Slater, OPTX and KT exchange with the
  LYP correlation functional \cite{dft:kt3}. The explicit form is
  \funexample{GGAKey Slater=1.092 KT=-0.004 LYP=0.864409 OPTX=-0.925452}
  \index{KT3}

%\item[LG1LYP] is a 1-parameter B1LYP type functional with the exchange gradient
%  correction provided by the LG93x functional \cite{dft:g961lyp}.
% \funexample{GGAKey HF=0.25 Slater=0.75 LG93x=0.75 LYP=1}

%\item[mPWVWN] is the combination of mPW exchange and VWN correlation functionals 
%   \cite{dft:mpw,dft:vwn}.\index{mPWVWN}
%  \funexample{GGAKey Slater=1 mPW=1 VWN=1}.

%\item[mPWLYP] is the combination of mPW exchange and LYP correlation functionals 
%   \cite{dft:mpw,dft:vwn}.\index{mPWLYP}
%  \funexample{GGAKey Slater=1 mPW=1 LYP=1}.

%\item[mPWP86] is the combination of mPW exchange and P86 correlation functionals 
%   \cite{dft:mpw,dft:vwn}.\index{mPWP86}
%  \funexample{GGAKey Slater=1 mPW=1 P86c=1 PZ81=1}.

%\item[mPWPW91] is the combination of mPW exchange and PW91 correlation functionals 
%   \cite{dft:mpw,dft:pw91}.\index{mPWPW91}
%  \funexample{GGAKey Slater=1 mPW=1 PW91c=1}.

%\item[mPW3PW91] is a 3-parameter combination of mPW exchange and PW91 correlation
%  functionals, with the PW91 (PW92c) local correlation~\cite{dft:mpw}.\index{mPW3PW91}
%  \funexample{GGAKey HF=0.2 Slater=0.8 mPW=0.72 PW91c=0.81 PW92c=0.19}.

%\item[mPW1PW91] is a 1-parameter combination mPW exchange and PW91 correlation
%  functionals with 25\% Hartree--Fock exchange \cite{dft:mpw}.\index{mPW1PW91}
%  \funexample{GGAKey HF=0.25 Slater=0.75 mPW=0.75 PW91c=1}.

%\item[mPW1K] optimizes mPW1PW91 for kinetics of H abstractions, with 42.8\% Hartree--Fock
%  exchange \cite{dft:mpw1k}.\index{mPW1PW91}
%  \funexample{GGAKey HF=0.428 Slater=0.572 mPW=0.572 PW91c=1}.

%\item[mPW1N] optimizes mPW1PW91 for kinetics of H abstractions, with 40.6\% Hartree--Fock
%  exchange \cite{dft:mpw1n}.\index{mPW1N}
%  \funexample{GGAKey HF=0.406 Slater=0.594 mPW=0.594 PW91c=1}.

%\item[mPW1S] optimizes mPW1PW91 for kinetics of H abstractions, with 6\% Hartree--Fock
%  exchange \cite{dft:mpw1s}.\index{mPW1S}
%  \funexample{GGAKey HF=0.06 Slater=0.94 mPW=0.94 PW91c=1}.

\item[OLYP] is the sum of the OPTX exchange functional with the
  LYP correlation functional \cite{dft:optx,dft:lyp1,dft:lyp2}.
  \funexample{GGAKey Slater=1.05151 OPTX=-1.43169 LYP=1}
  \index{OLYP}

%\item[OP86] is the sum of the OPTX exchange functional with the
%  P86 correlation functional \cite{dft:optx,dft:p86}.
%  \funexample{GGAKey Slater=1.05151 OPTX=-1.43169 P86c=1 PZ81=1}
%  \index{OP86}

%\item[OPW91] is the sum of the OPTX exchange functional with the
%  PW91 correlation functional \cite{dft:optx,dft:pw91}.
%  \funexample{GGAKey Slater=1.05151 OPTX=-1.43169 PW91c=1}
%  \index{OPW91}

\item[PBE0] a hybrid functional of Perdew, Burke and Ernzerhof with
  0.25 weight of exact exchange, 0.75 of \verb|PBEx| exchange functional and
  the \verb|PBEc| correlation functional \cite{dft:pbe0}.
  Alternative aliases are PBE1PBE or PBE0PBE.\index{PBE0}
  \funexample{GGAKey HF=0.25 PBEx=0.75 PBEc=1}

\item[PBE] same as above but with exchange estimated exclusively by
  \exfn{PBEx} functional \cite{dft:pbe}.\index{PBE} Alias of PBEPBE. 
  This is the form used by CADPAC and NWChem quantum chemistry programs.
  \funexample{GGAKey PBEx=1 PBEc=1}\\
  Note that the Molpro quantum chemistry program uses the \corfn{PW91c}
  non-local correlation functional instead of \corfn{PBEc}, which is 
  equivalent to the following:
  \funexample{GGAKey PBEx=1 PW91c=1}.

%\item[RPBE] is a revised PBE functional that employs the 
%  \exfn{RPBEx} exchange functional.
%  \funexample{GGAKey RPBEx=1 PBEc=1}

%\item[revPBE] is a revised PBE functional that employs the 
%  \exfn{revPBEx} exchange functional.
%  \funexample{GGAKey revPBEx=1 PBEc=1}

%\item[mPBE] is a revised PBE functional that employs the 
%  \exfn{mPBEx} exchange functional.
%  \funexample{GGAKey mPBEx=1 PBEc=1}

%\item[PW91VWN] is the combination of PW91 exchange and VWN correlation functionals 
%   \cite{dft:pw91,dft:vwn}.\index{PW91}
%  \funexample{GGAKey PW91x=1 VWN=1}.

%\item[PW91LYP] is the combination of PW91 exchange and LYP correlation functionals 
%   \cite{dft:pw91,dft:lyp1,dft:lyp2}.\index{PW91}
%  \funexample{GGAKey PW91x=1 LYP=1}.

%\item[PW91P86] is the combination of PW91 exchange and P86 (with Perdew 1981 local) 
%  correlation functionals \cite{dft:pw91,dft:pw86,dft:pz81}.
%  \funexample{GGAKey PW91x=1 P86c=1 PZ81=1}.

%\item[PW91PW91] is the combination of PW91 exchange and PW91 correlation functionals. 
%  Equivalent to PW91 keyword \cite{dft:pw91}.
%  \funexample{GGAKey PW91x=1 PW91c=1}.

%\item[XLYP] is a linear combination of \exfn{Slater}, \exfn{Becke} and \exfn{PW91x}
%  exchange and \corfn{LYP} correlation functionals \cite{dft:xlyp,dft:x3lyp}.\index{XLYP}
%  \funexample{GGAKey Slater=1 Becke=0.722 PW91x=0.347 LYP=1}.

%\item[X3LYP] is a linear combination of Hartree--Fock, \exfn{Slater}, \exfn{Becke} 
%  and \exfn{PW91x} exchange and \corfn{VWN} and \corfn{LYP} correlation functionals 
%  \cite{dft:xlyp,dft:x3lyp}.\index{X3LYP}
%  \funexample{GGAKey HF=0.218 Slater=0.782 Becke=0.542 PW91x=0.167 VWN=0.129 LYP=0.871}

\end{description}

Note that combinations of local and non-local correlation functionals
can also be generated with the GGAKey keyword. For example,
\verb|GGAKey P86c=1 PZ81=1| combines the PZ81 local and P86c non-local 
correlation functional, whereas \verb|GGAKey VWN=1 P86c=1| 
combines the VWN local and P86 non-local correlation functionals.


Linear combinations of all exchange and correlation functionals listed above
are possible with the \verb|GGAKey| keyword.

\end{description}

\subsection{*DFT INPUT}\label{subsec:dftinput}
Controls the XC-integration grid. 
The grid is generated as follows: 
For each atom a radial grid is created (different radial grids available, see below), 
which is multiplied with an angular grid (Lebedev-grids).
The angular grids are by default pruned for radial points close to the nucleus,  
following Murray, Handy and Laming.~\cite{dft-int:pruning} 
Grid weights for the grid points are calculated following different schemes (see below). 
Grid points with weights below $10^{-20}$ are disregarded.  
Please note that the grid construction routines in the \lsdalton\
program changed compared to the \dalton\ program which may result in small deviations in the number of grid points etc.
\begin{description}
\item[\Key{ANGINT}] \verb||\newline
\verb|<ANGINT>|\newline
Determines the quality of the angular Lebedev grid -- the angular
integration of spherical harmonics will be exact up to the specified
order. Default value is $31$. Maximum value is $64$.
Note that the value of \verb|ANGINT| is changed by the following keywords:
\verb|COARSE|, \verb|NORMAL|, \verb|FINE|, \verb|ULTRAFINE|.
The \verb|GRIDX| keywords also imply specific \verb|ANGINT| values.
%%
%%\item[\Key{ANGMIN}] 
%% ANGMIN IS NOT ACTIVE ANYMORE IN LSDALTON 
%% 
\item[\Key{COARSE}]
Shortcut keyword for radial integration accuracy $10^{-11}$ and angular expansion order equal to $35$.
\item[\Key{DFTELS}] \verb||\newline
\verb|<DFTELS>|\newline
safety threshold -- stop if the charge integration error becomes larger then this threshold.
\item[\Key{DFTTHR}]\verb||\newline
\verb|<DFTHR0, DFTHRL, DFTHRI, RHOTHR>|
\begin{description}
\item[DFTHR0] is not used 
\item[DFTHRL] is not used 
\item[DFTHRI] threshold for screening product of gaussian atomic orbitals
\item[RHOTHR] threshold for screening of the electron density 
\end{description}
\item[\Key{DISPER}] 
Activates the addition of the empirical dispersion correction following S. Grimme.~\cite{dft-disp:Grimme1,dft-disp:Grimme2} The S6 factors and van der Waals radii of Ref.~\cite{dft-disp:Grimme2} are used.
Implemented for the functionals BP86, BLYP, PBE, B3LYP for energies and gradients. 
Does not work when functionals are defined with the \verb|combine| command.
\item[\Key{FINE}]
Shortcut keyword for radial integration accuracy $10^{-13}$ and angular expansion order equal to $42$.
\item[\Key{GRID TYPE}] \verb||\newline
\verb|<GC2 LMG TURBO BECKE BECKEORIG SSF BLOCK BLOCKSSF>|\newline
\verb|GC2|, \verb|LMG|, \verb|TURBO| define radial quadrature schemes, only one can be set.
\verb|BECKE|, \verb|BECKEORIG|, \verb|SSF|, \verb|BLOCK|, \verb|BLOCKSSF| define the grid partitioning schemes, only one can be set. 
\begin{description}
\item[GC2] Gauss-Chebyshev quadrature of second kind. 
\item[LMG] As proposed by Lindh, Malmqvist and Gagliardi (default).~\cite{dft-int:LMG}
\item[TURBO] Treutler-Ahlrichs M4-T2 scheme.~\cite{dft-int:treutler-ahlrichs} Implies also that the angular integration quality becomes Z-dependant (see also \verb|ANGINT|) and that pruning is used (see also \verb|NOPRUN|).
\item[BECKE] Becke partitioning scheme with atomic size correction.~\cite{dft-int:becke}
\item[BECKEORIG] Becke partitioning scheme without atomic size correction (default).~\cite{dft-int:becke}
\item[SSF] Stratmann-Scuseria-Frisch partitioning scheme.~\cite{dft-int:ssf}
\item[BLOCK] Becke partitioning scheme with atomic size correction~\cite{dft-int:becke}
combined with a blockwise handling of grid points~\cite{dft-int:dalton-blocked}. Useful for large molecules.
\item[BLOCKSSF] Stratmann-Scuseria-Frisch partitioning scheme~\cite{dft-int:ssf}
combined with a blockwise handling of grid points~\cite{dft-int:dalton-blocked}. Useful for large molecules.
%\item[CARTESIAN]
\end{description}
\item[\Key{GRID1}]
Shortcut for radial integration accuracy $1.0*10^{-5}$, 
angular expansion order equal to $17$, 
radial quadrature \verb|TURBO|, 
grid partitioning scheme \verb|BLOCK|.
\item[\Key{GRID2}]
Shortcut for radial integration accuracy $2.15447*10^{-7}$, 
angular expansion order equal to $23$, 
radial quadrature \verb|TURBO|, 
grid partitioning scheme \verb|BLOCK|.
\item[\Key{GRID3}]
Shortcut for radial integration accuracy $4.64159*10^{-9}$, 
angular expansion order equal to $29$, 
radial quadrature \verb|TURBO|, 
grid partitioning scheme \verb|BLOCK|.
\item[\Key{GRID4}]
Shortcut for radial integration accuracy $5.01187*10^{-14}$,
angular expansion order equal to $35$,
radial quadrature \verb|TURBO|,
grid partitioning scheme \verb|BLOCK|.
\item[\Key{GRID5}]
Shortcut for radial integration accuracy $2.15443*10^{-17}$,
angular expansion order equal to $47$,
radial quadrature \verb|TURBO|,
grid partitioning scheme \verb|BLOCK|.
%\item[\Key{HARTRE}]
%supresses the addition of the XC-contribution to the Fock-matrix/energy.
\item[\Key{HARDNESS}] \verb||\newline
\verb|<HARDNESS>|\newline
sets the hardness of the partitioning function in the Becke weighting scheme. Only positive integer values allowed. 
The higher the hardness the more stepfunction like the partitioning functions. 
Default value is $3$ as proposed by Becke.~\cite{dft-int:becke}
\item[\Key{NOPRUN}]
Supresses the default pruning of the atomic angular integration grids for radial points close to the nucleus. 
\item[\Key{NORMAL}]
Shortcut keyword for radial integration accuracy $10^{-13}$ and angular expansion order equal to $35$.
\item[\Key{RADINT}] \verb||\newline
\verb|<RADINT>|\newline
Determines the quality of the radial integration grid. Default radial integration accuracy is $10^{-11}$.
Note that the value of \verb|RADINT| is changed by the following keywords:
\verb|NORMAL|, \verb|FINE|, \verb|ULTRAFINE|.
The \verb|GRIDX| keywords also imply specific \verb|RADINT| values.
\item[\Key{ULTRAF}]
Shortcut keyword for radial integration accuracy $10^{-15}$ and angular expansion order equal to $64$.
\end{description}

\subsection{*DENSOPT}\label{subsec:densopt}
This section contains the different options for obtaining the SCF wave function
and energy. The default is diagonalization combined with the DIIS scheme for acceleration
of SCF convergence (no damping/level shifting). 
Should have a different name. DENSOPT?
\begin{description}
\item[\Key{2ND\_ALL}] Use second order optimization in all SCF iterations.
\item[\Key{2ND\_LOC}] Use second order optimization in local SCF iterations.
\item[\Key{ARH}] Use Augmented Roothaan-Hall scheme for density optimization 
(default)~\cite{ARH1,ARH2}.\index{Augmented Roothaan-Hall}\index{ARH} 
\item[\Key{ARH FULL}] Use Augmented Roothaan-Hall for density optimization -
no truncation of the reduced space, keep all micro vectors. This is recommended
if the standard scheme (.ARH) fails to converge (see ref.~\cite{crop}).
%\item[\Key{ASYM}] Asymmetrize H1DIAG starting guess (only referenced for unrestricted
%calculations).
%\item[\Key{BLOCK}] I assume that we do not support BSM????
\item[\Key{STABILITY}] Check stability of the optimized wave function by calculation
of the lowest Hessian eigenvalue.
\item[\Key{STAB\_MAXIT}] \verb| | \newline
\verb|<Max. number of stability iterations>|\newline
Max. number of iterations in calculation of lowest Hessian eigenvalue (default is 40).
\item[\Key{CHOLESKY}] Do Cholesky decomposition of overlap matrix (for density optimization
in orthogonal AO basis) - default is L{\"o}wdin decomposition by diagonalization.
\item[\Key{CONTFAC}] \verb| | \newline
\verb|<Contraction factor>|\newline 
For update of trust-radius (used in ARH and second order optimization). If trust-radius
should be contracted,
contract it by this factor (default is 0.7).
\item[\Key{CONTRAC}] \verb| | \newline
\verb|<Contraction criterion>|\newline 
For update of trust-radius (used in ARH and second order optimization). Contract trust-radius
if trust-radius ratio is smaller than this criterion (default is 0.25).
\item[\Key{CONVDYN}] \verb| | \newline
\verb|<Option>|\newline 
Dynamic SCF convergence threshold. This is suitable for large calculations, since the standard SCF
convergence threshold is based on the Frobenius norm of the SCF gradient, which is not size-extensive.
Options are TIGHT, STANDARD, and SLOPPY.
\item[\Key{CONVTHR}] \verb| | \newline
\verb|<Threshold>|\newline
SCF convergence threshold - Frobenius norm of SCF gradient (default is 1.0d-4). 
Note that this convergence criterion
is not size-extensive. For large molecules, it is recommended to use .CONVDYN instead.
\item[\Key{LB94}] Uses the van Leeuwen-Baerends asymptotic correction. Note that the LB94 functional is the same as using the follwing input. 
\begin{verbatim}
**WAVE FUNCTIONS
.DFT
GGAKey SLATER=1.0 VWN=1.0
*DENSOPT
.LB94
**END OF INPUT
\end{verbatim}
However this correction can be combined with all functionals
\item[\Key{CS00}] Using the Casida-Salahub asymptotic correction\cite{CasidaSalahub} 
\begin{eqnarray}
V^{\prime}_{XC}(\textbf{r}) = \max \left(V_{XC} + \Delta , V_{XC} + V_{LB94,correction}\right),  
\end{eqnarray}
with a Zhan-Nichols-Dixon shift \cite{dixon,ZND}
\begin{eqnarray}
\Delta = NZD_{1} \cdot \epsilon_{HOMO} - NZD_{2}
\end{eqnarray}
Where $NZD_{1} = 0.2332$ and $NZD_{2} = 0.315$. Note that NWCHEM have introduced the same correction but uses a $NZD_{2} = 0.0116$. The parameters have been optimized with respect to a B3LYP functional so these parameters can be changed using the following keywords
\item[\Key{CS00 NZD1}] \verb| | \newline
\verb|<NZD1>|\newline
Changes the parameter $NZD_{1}$ (default $NZD_{1} = 0.2332$) see .CS00
\item[\Key{CS00 NZD1}] \verb| | \newline
\verb|<NZD2>|\newline
Changes the parameter $NZD_{2}$ (default $NZD_{1} = 0.315$) see .CS00
\item[\Key{CS00}] \verb| | \newline
\verb|<Delta>|\newline
Using the Casida-Salahub correction with a shift of Delta see .CS00

%\item[\Key{DIAGHESONLY}] Calculate only one SCF energy (i.e., no optimization) 
%and the lowest Hessian eigenvalue for a density constructed by weighted
%average of two input densities. Needs files D1 and D2 (densities). Lowest Hessian
%eigenvalue is found by setting up explicit Hessian and diagonalizing (expensive!).
\item[\Key{DIIS}] Pulay's DIIS scheme is used to speed up SCF convergence~\cite{diis1,diis2}.
\item[\Key{DISK}] Store densities and Fock/KS matrices from previous 
iterations on disk instead of in core when constructing the new Fock/KS matrix ({\it memory-saving option}).
\item[\Key{DISKSOLVER}] Store trial and sigma vectors on disk instead of in core
when solving linear equations ({\it memory-saving option}). Only referenced is density 
optimization method is ARH, Direct Density optimization or second order optimization.
\item[\Key{DORTH}] Do level shift by using the ratio $\vert\vert$Dorth$\vert\vert$/$\vert\vert$D$\vert\vert$ 
(for diagonalization only).
%\item[\Key{DSM}] The Density Subspace Minimization scheme is used to speed up SCF convergence~\cite{TOKJ,TOYJ}.
%\item[\Key{DSMONE}] The Density Subspace Minimization scheme is used to speed up SCF convergence, 
%but only one DSM step is taken in each SCF iteration.
%\item[\Key{DSMXTRA}] The Density Subspace Minimization scheme is used to speed up SCF convergence,
%including extra (more expensive) term.
\item[\Key{DUMPMAT}] Dump Fock/KS and density matrices from all iterations to disk for later investigation.
\item[\Key{EDIIS}] The energy-DIIS scheme is used to speed up SCF convergence~\cite{ediis}.
\item[\Key{EXPAND}] \verb| | \newline
\verb|<Expansion criterion>|\newline 
For update of trust-radius (used in ARH and second order optimization). Expand trust-radius
if trust-radius ratio is larger than this criterion (default is 0.75).
\item[\Key{EXPFAC}] \verb| | \newline
\verb|<Expansion factor>|\newline 
For update of trust-radius (used in ARH and second order optimization). If trust-radius
should be expanded,
expand it by this factor (default is 1.2).
\item[\Key{FIXSHIFT}] \verb| | \newline
\verb|<Shift>|\newline 
Use a fixed level shift in all SCF iterations.
%\item[\Key{HESONLY}] Calculate only one SCF energy (i.e., no optimization) 
%and the lowest Hessian eigenvalue for a density constructed by weighted
%average of two input densities. Needs files D1 and D2 (densities). Lowest Hessian
%eigenvalue is iteratively.
\item[\Key{HESVEC}] \verb| | \newline
\verb|<Number of Hessian eigenvalues>|\newline
Number of lowest Hessian eigenvalues to be calculated with keyword .STABILITY 
(default is 1). 
\item[\Key{LCV}] Compute the Least-Change Valence orbitals after valence density optimization step.
All subsequent calculations are computed using Least-Change Valence orbitals augmented with atomic virtual orbitals of the Atomic density as basis set.
Keyword only effective with TRILEVEL starting guess.
\item[\Key{LCM}]  Compute the Least-Change Molecular orbitals after the Full molecular density calculation.  All subsequent calculations are computed using these orbitals as basis set. .LCV is automatically included. Keyword only meaningful with TRILEVEL starting guess.
\item[\Key{LEVELSH}] \verb| | \newline
\verb|<N> <shift1> <shift2> ...<shiftN> |\newline 
Use custom level shifts in the first {\it N} SCF iterations.
%\item[\Key{LINCOMB}] \verb| | \newline
%\verb|<Weight for linear combination> |\newline
%Weight to use for D1 when linear combination of densities is used as starting
%guess (.START $\rightarrow$ LINCOMB)
\item[\Key{LWITER}] Do L{\"o}wdin decomposition of overlap matrix (for density optimization
in orthogonal AO basis) - iteratively (default is L{\"o}wdin by diagonalization)~\cite{shalf}.
\item[\Key{LWQITER}] Do L{\"o}wdin decomposition of overlap matrix 
in quadruple precision (for density optimization
in orthogonal AO basis) - iteratively.
\item[\Key{MAXELM}] \verb| | \newline
\verb|<Trust radius (max. element)> |\newline
Absolute max. element of step allowed (default is 0.35).
Used in ARH and second order optimization.
\item[\Key{MAXIT}] \verb| | \newline
\verb|<Max. number of iterations> |\newline
Max. number of SCF iterations (default is 100).
\item[\Key{MAXRATIO}] \verb| | \newline
\verb|<Max. ratio for DORTH> |\newline
Largest accepted ratio when using level shift .DORTH.
\item[\Key{MAXSTEP}] \verb| | \newline
\verb|<Trust radius (Frobenius norm)>|\newline
Absolute max. Frobenius norm of step allowed (default is 0.6).
Used in ARH and second order optimization.
\item[\Key{MICTHRS}] \verb| | \newline
\verb|<Threshold for micro iterations>|\newline
The micro iterations are converged to gradient norm times this factor (default is 1.0d-2).
Only referenced if ARH, Direct Density optimization or second order optimization.
\item[\Key{MICROVECS}] \verb| | \newline
\verb|<Max. number of microvectors>|\newline
Max. number of microvectors to be kept in Conjugate Residual Optimal Vectors (CROP) scheme
(default is 2). 
Only referenced if ARH, Direct Density optimization or second order optimization.
\item[\Key{MINDAMP}] \verb| | \newline
\verb|<Minimum damping>|\newline
Never allow level shift to be smaller than this.
\item[\Key{MOCHANGE}] Level shifting is done by use of MO overlaps (diagonalization only).
\item[\Key{MUOPT}] Optimal level shift is chosen by doing a line search in the SCF energy - very expensive! For diagonalization only.
%\item[\Key{NALPHA}] \verb| | \newline
%\verb|<Number of alpha electrons>|\newline
%Explicitly specify number of alpha electrons (automatically set if not specified). If both NALPHA and NBETA are set, they must conform with the total number of electrons!
%\item[\Key{NBETA}] \verb| | \newline
%\verb|<Number of beta electrons>|\newline
%Explicitly specify number of alpha electrons (automatically set if not specified). If both NALPHA and NBETA are set, they must conform with the total number of electrons!
\item[\Key{NOAV}] Turn off Fock matrix averaging in SCF iterations (this is default since the default optimization scheme is ARH, which contains implicit averaging).
%\item[\Key{NEWDAMP}] New level shifting which should be better suited for ARH/CROP. CAREFUL! Still under development!
\item[\Key{NVEC}] \verb| | \newline
\verb|<Max. no of vectors for averaging>|\newline
Maximum number of previous Fock and density matrices to be stored and used for ARH and DIIS (default is 10 for HF and 7 for DFT).
%\item[\Key{NVECDSM}] \verb| | \newline
%\verb|<Max. no of vectors for DSM>|\newline
%\item[\Key{NVECDII}] \verb| | \newline
%\verb|<Max. no of vectors for DIIS>|\newline
\item[\Key{NOINCREM}] Turn off incremental scheme for Fock/KS matrix build.
\item[\Key{NOPREC}] Turn off preconditioning of linear equations (ARH, TrFD, and second order optimization).
\item[\Key{NOSHIFT}] Do no level shifting.
\item[\Key{OAO}] Keep the whole calculation (also Fock/KS matrix construction) in orthonormal AO basis.
\item[\Key{OVERLAP}] \verb| | \newline
\verb|<Overlap>|\newline
Smallest accepted overlap when doing level shift by use of MO overlaps (.MOCHANGE).
%\item[\Key{PURIFY}] \verb| | \newline
%\verb|<Purification method>|\newline
%Use purification scheme for density optimization 
\item[\Key{Restart}] The code automaticly saves the density matrix in each SCF iteration in a file called dens.restart. This option restart the calculation from this density matrix. If the program cannot find the dens.restart file the keyword have no effect. 
\item[\Key{RH}] Use standard Roothaan-Hall scheme (diagonalization) for density optimization.
%\item[\Key{SCALVIR}]
%\item[\Key{SOEO}]
%\item[\Key{SPARSE}]
\item[\Key{SOEO}]
Use second order ensemble optimization. Remember to specify active space and starting occupations. Use only in combination with \Key{NOGCBASIS}. 
Requires \Key{HF} or \Key{DFT} as wave function. After an ensemble optimization, the orbitals are written to file \verb|cmo.out| and the AO 
density matrix is written to \verb|dao.out|, which may be used to plot molecular orbitals and charge density plots.
\item[\Key{SOEOSPACE}] \verb| | \newline
\verb|<core>| \verb|<act>|\newline
Specification of the orbitals in the active space. \verb|<core>| being the number of core orbitals (occupations not optimized), and \verb|<act>| the number 
of active orbitals, where the orbital occupations are optimized.
\item[\Key{SOEOOCC}] \verb| | \newline
\verb|<fully occupied>|\newline 
\verb|<fractionally occupied>|\newline
\verb|<n1>| \verb|<n2>| $\cdots$ \newline
Specification of the distribution of electron pairs in the starting orbitals in a second order ensemble optimization. \verb|<fully occupied>| is the number of 
fully occupied orbitals and \verb|<fractionally occupied>| is the number of fractionally occupied orbitals. \verb|<n1>|, \verb|<n2>| etc. are the fractional 
occupations of the fractionally occupied spin-orbitals in the starting guess. The given occupations must lie between zero and one. If they are either zero 
or one, this orbital occupation is not optimized. Equal distribution may result in wrong results due to symmetry. The sum of the fully occupied orbitals and 
the given orbital occupations \verb|<n1>|, \verb|<n2>| etc., must equal the total number of electron pairs in the system. (NOTE that it is possible to 
specify an active space of zero orbitals, but still include fractional occupations. The optimization will thus optimize the shapes of the orbitals, without 
optimizing the orbital occupations.)
\item[\Key{SOEOSAVE}] 
Saves the AO Fock matrix (and the AO density matrix) to the file \verb|soeosave.out|. Used for restart.
\item[\Key{SOEORST}] 
Restart second order ensemble optimization from orbitals stored in \verb|soeosave.out| (so remember to copy this file to the working directory). 
The molecular geometry need not be the same as in the calculation 
where the stored orbitals were created. The active space and starting occupations still need to be specified using \Key{SOEOSPACE} and \Key{SOEOOCC}.
\item[\Key{SOEOGC}] 
Grand-canonical ensemble optimization. Removes the restriction on the total number of electrons from the second order ensemble optimization. The sum of the 
starting occupations still must be correct.
\item[\Key{SOEOMATHR}] \verb| | \newline
\verb|<macro threshold>|\newline 
Specifies the convergence threshold for the macro iterations in second order ensemble optimization.
\item[\Key{SOEOMITHR}] \verb| | \newline
\verb|<micro threshold>|\newline 
Specifies the convergence threshold for the micro iterations in second order ensemble optimization.
\item[\Key{SOEOTRUST}] \verb| | \newline
\verb|<trust-radius>|\newline 
Specifies the starting trust-radius in the ensemble optimization. Trust-radius will still be updated throughout the optimization.
\item[\Key{SOEODIPOLE}] Use the ensemble density matrix to determine electric dipole moment and static electric polarizability.
\item[\Key{START}] \verb| | \newline
\verb|<Option>|\newline
Starting guess for SCF optimization. Options are:
\begin{itemize}
\item {\bf H1DIAG} Obtain initial guess by diagonalizing one-electron Hamiltonian
\item {\bf H1OAO}  Obtain initial guess by diagonalizing one-electron Hamiltonian in orthonormal AO basis
\item {\bf ATOMS}  Obtain initial guess by atoms-in-molecules approach (default)
\item {\bf TRILEVEL} Optimization in three steps. 1. Atomic densities, 2. Valence molecular density, 3. Full molecular density~\cite{trilevel1, trilevel2}. 
\end{itemize}
Note that Huckel guess is not supported by \lsdalton.
%\item[\Key{TRSCF}] Use Trust-Region SCF scheme, i.e. diagonalization, .DORTH level shift, and DSM~\cite{TOKJ,TOYJ}.
%\item[\Key{TrFD}] Density optimization by minimization of the Roothaan-Hall energy E$_{\rm RH}$ = Tr{\bf FD}({\bf X})~\cite{TrFD}.
%\item[\Key{TrFD FULL}] As above, but keep the full subspace of trial vectors (instead of truncating) when solving linear equations.
%\item[\Key{UNREST}] Force unrestricted calculation (default for open shell systems).
\item[\Key{VanLenthe}] Use Van Lenthe's scheme for level shifting and averaging~\cite{VanLenthe}.

\subsection{\$INFO}\label{subsec:info}
For the different parts of the wave function optimization, it is possible
to get very detailed information.
This section describes these keywords. They must be put
under *LINSCA in a section beginning with
\$INFO and ending with \$END INFO. Note that these keywords
do NOT start with a dot!
\begin{description}
\item[\Keyinfo{INFO\_CROP}] Detailed info from Conjugated Residual OPtimal vectors scheme (Direct Density Optimization, ARH and second order optimization).
\item[\Keyinfo{INFO\_DIIS}] Detailed info from Direct Inversion in the Iterative Subspace algorithm.
%\item[\Keyinfo{INFO\_DSM}] Detailed info from Density Subspace Minimization algorithm.
%\item[\Keyinfo{INFO\_DSM\_DETAIL}] Even more detailed info from Density Subspace Minimization algorithm.
\item[\Keyinfo{INFO\_LEVELSHIFT}] Detailed info from determination of dynamic level shift (Direct Density Optimization, ARH and second order optimization). 
\item[\Keyinfo{INFO\_LINEQ}] Detailed info from solution of linear equations and trust-radius update (Direct Density Optimization, ARH and second order optimization).
\item[\Keyinfo{INFO\_RH}] Detailed info from Roothaan-Hall algorithm (diagonalization).
\item[\Keyinfo{INFO\_RH\_DETAIL}] Even more detailed info from Roothaan-Hall algorithm (diagonalization).
\item[\Keyinfo{INFO\_STABILITY}] Detailed info from calculation of lowest Hessian eigenvalue (stability analysis) and HOMO-LUMO gap.
\item[\Keyinfo{INFO\_STABILITY\_REDSPACE}] Reduced space info from calculation of lowest Hessian eigenvalue (stability analysis) and HOMO-LUMO gap.
%\item[\Keyinfo{INFO\_WEIGHT}] Detailed info about weights of the densities in DIIS and DSM algorithms.
\item[\Keyinfo{}]
\end{description}\end{description}

\section{**OPTIMIZE}\label{sec:optimize}
This input module describes keywords needed to optimize molecular geometry.
In the current release a number of quasi-Newton trust-radius level-shifted techniques for finding 
equilibrium geometries are available. The methods differ in the way approximate Hessians are 
built and updated. Geometric structure can be optimized in redundant internal or 
Cartesian coordinates with two sets of convergence criteria. The default setting is minimization 
in internal coordinates \cite{DaltonOpt}, with model Hessian \cite{ModelHess} updated with BFGS formula. 
By default, new convergence criteria are used, i.e. convergence is declared if  the four quantities - 
the root-mean-square of the gradient, its maximum absolute value, the root-mean square of the step
vector, and its maximum absolute element (in internal or Cartesian coordinates) - 
are smaller than $\epsilon$, 5$\epsilon$, 3$\epsilon$ and 15$\epsilon$ respectively \cite{NewConv}.
The default value of $\epsilon$ is $1.0\cdot 10^{-5}$.

By default, the atoms-in-molecule approach is used to set up the initial density-matrix at each new
geometry (each step). However, it is possible to take as starting guess McWeeny-purified converged
density-matrix at the previous geometry. This is achieved by setting the .RESTART option under
the *DENSOPT subsection.
\newline
\vspace{1 cm}
\noindent
\textbf{Example test cases for **OPTIMIZE calculations}: \newline
These test cases illustrate the main features of the geometry optimization. The test cases are located in LSDALTON/test/geomopt.
\begin{itemize}
\item
\textit{geomopt/cartes\_bfgs\_min}:
\item
\textit{geomopt/Excited\_state\_opt}: Performs a geometry optimization of an excited state. 
\item
\textit{geomopt/redint\_bfgs}:
\item
\textit{geomopt/cartes\_psb\_min}:
\item
\textit{geomopt/geoopt\_constrain}:
\item
\textit{geomopt/cartes\_trilevel\_newconv}: 
\end{itemize}

\begin{description}
\item[\Key{PRINT}]\verb| | \newline
\verb|<Print level>|\newline
Print level for the output. The higher the print level, the more information
is printed to the output file.

\item[\Key{VLOOSE}]
For the default convergence criteria $\epsilon$ is set to $1.0\cdot 10^{-3}$.

\item[\Key{LOOSE}]
For the default convergence criteria $\epsilon$ is set to $1.0\cdot 10^{-4}$.

\item[\Key{TIGHT}]
For the default convergence criteria $\epsilon$ is set to $1.0\cdot 10^{-6}$.

\item[\Key{VTIGHT}]
For the default convergence criteria $\epsilon$ is set to $1.0\cdot 10^{-7}$.

\item[\Key{.MAX IT}]
Maximum number of iterations in geometry optimization scheme.

\item[\Key{BAKER}]
Activates the convergence criteria of Baker \cite{Baker}. The minimum
is then said to be found when the largest element of the gradient
vector (in Cartesian or redundant internal coordinates) falls below
$3.0\cdot 10^{-4}$ and either the energy change from the last
iteration is less than $1.0\cdot 10^{-6}$ or the largest element of
the predicted step vector is less $3.0\cdot 10^{-4}$.

\item[\Key{BFGS}]
Specifies the use of a first-order method\index{first-order optimization}
with the Broyden-Fletcher-Goldfarb-Shanno (BFGS)
update formula for optimization. This is the
preferred first-order method for minimizations, as this update is able
to maintain a positive definite Hessian. 

\item[\Key{PSB}]
Specifies that a first-order method with the
Powell-Symmetric-Broyden (PSB) 
update formula should be used for optimization.

\item[\Key{DFP}]
Specifies that a first-order\index{first-order optimization} method with the
Davidon-Fletcher-Powell (DFP) update formula should be used for optimization. 

\item[\Key{INIMOD}]
Use a simple model Hessian~\cite{ModelHess} diagonal in redundant
internal coordinates as the initial Hessian. All diagonal elements are
determined based on an extremely simplified molecular mechanics model,
yet this model provides Hessians that are good starting points for
most systems, thus avoiding any calculation of the exact Hessian. This
is the default for optimizations in redundant internal coordinates. Currently 
this is not an option for optimization in Cartesian coordinates.

\item[\Key{INIRED}]
Specifies that the initial Hessian should be diagonal in redundant internal 
coordinates. The different diagonal
elements are set equal to 0.5 for bonds, 0.2 for angles and 0.1 for
dihedral angles, unless \Key{INITEV} has been specified. If the
optimization is run in Cartesian coordinates, the diagonal internal
Hessian is transformed to Cartesians.

\item[\Key{MODHES}]
Determine a new model Hessian (see \Key{INIMOD})
at every geometry without doing any updating. The model is thus used
in much the same manner as an exact Hessian, though it is obviously
only a relatively crude approximation to the analytical Hessian.

\item[\Key{INITEV}]\verb| | \newline
\verb|<Read EVLINI, the eigenvalues>|\newline
The default initial Hessian for first-order
minimizations is the identity matrix when Cartesian coordinates are used, and a diagonal
matrix when redundant internal coordinates are used. If \Key{INITEV}
is used, all the diagonal elements (and therefore the eigenvalues) are
set equal to the value EVLINI. 

\item[\Key{REDINT}]
Specifies that redundant internal coordinates coordinates
should be used in the optimization. This is the default.

\item[\Key{CARTES}]
Indicates that Cartesian coordinates\index{Cartesian coordinates}\index{coordinate system!Cartesian coordinates}
should be used in the optimization.

\end{description}

\section{**RESPONS}\label{subsec:respons}
This section describes the keywords needed for obtaining molecular
properties for HF and DFT based on the atomic orbital based response formulation~\cite{thorvaldsen:214108}.
The response section begins with
**RESPONS. 
General response information related to more than one property
(e.g. how many excitation energies)
is put directly under **RESPONS.
After this,
each individual response property (e.g. the polarizability tensor)
is labeled by an asterisk, and the specific (optional) information related
to that property (e.g. which optical frequencies) follows 
below.
All input values are given in atomic units.
The general structure is thus:
\begin{description}
\item[\Keyinfo{**RESPONS}]
\item[\Keyinfo{.General response information}]
\item[\Keyinfo{*Label for property 1}]
\item[\Keyinfo{.Specific (optional) information for property 1}]
\item[\Keyinfo{*Label for property 2}]
\item[\Keyinfo{.Specific (optional) information for property 2}]
\end{description}
Each of the properties below have a test case.
The test cases may be found in the {\bf LSDALTON/test/LSresponse} directory.
To run a test case, go to the
{\bf test/} directory and type: 
\begin{description}
\item
\verb|./TEST  <test case>|
\end{description}
The test case files contains simple examples of input files.

Below, the list of general response input keywords follows.

\begin{description}
\item[\Key{NEXCIT}] \verb| | \newline
\verb|<Number of excitation energies>|\newline
Determines the number of excitation energies to be calculated.
If this keyword is set the excitation energies 
and the corresponding one-photon dipole absorption strengths
for excited states 1 to NEXCIT are always calculated.
\emph{\bf Important:} If properties involving excited states
are requested (e.g. two-photon absorption or the excited state gradient)
this keyword must be listed \emph{before}
any of these properties. \newline
{\bf Test case}: LSresponse/LSresponse\_HF\_opa
\end{description}

\subsection{*SOLVER}\label{subsec:responsesolver}
General information related to the way response equations are solved to obtained property.
By default standard and eigenvalue response equations are solved using the
algorithm with paired trial vectors\cite{coriani:2007} and damped
(complex) response equations are solved using the algorithm with
symmetrized trial vectors\cite{kauczor:2011}.\newline
\begin{description}
\item[\Key{SYM\_SOLVER}] \verb| | \newline
The solver with symmetrized trial vectors is used for solving standard
response equations.\newline
{\bf Test case}: LSresponse/LSresponse\_HF\_alpha\_astv
\item[\Key{PAIR\_SOLVER}] \verb| | \newline
The solver with paired trial vectors is used for solving damped (complex)
response equations.\newline
{\bf Test case}: LSresponse/LSresponse\_DFT\_alpha\_aptv
\item[\Key{CONVTHR}] \verb| | \newline
\verb|<Convergence threshold>|\newline
Convergence threshold to which response equations are solved.
Default value is set equal to $10^{-4}$.
\item[\Key{MAXIT}] \verb| | \newline
\verb|<Maximum number of iterations>|\newline
Maximum number of iterations in the iterative procedure.
Default value set equal to 100.
\item[\Key{MAXRED}] \verb| | \newline
\verb|<Maximum size of the reduced space>|\newline
Maximum size of the reduced space.
Default value set equal to 200.
\item[\Key{AOPREC}] \verb| | \newline
AO preconditioning is used (MO preconditioning by default).
AO preconditioning may only be used within the algorithm with paired trial vectors.
\item[\Key{NOPREC}] \verb| | \newline
No precondtioning is used.
\item[\Key{CONVDYN}] \verb| | \newline
\verb|<Option>|\newline 
Dynamic convergence threshold suitable for large calculations.
Options are TIGHT, STANDARD, and SLOPPY.
\item[\Key{RESTEXC}] \verb| | \newline
\verb|<Number Of excitation Vectors on file>|\newline 
This is a restart option, that allows the user to restart the calculation. 

Assume that you have already done one calculation where you requested 6 excitation 
energies but realize that you need 10, you can provide the file rsp\_eigenvecs and use

.RESTEXC\\
6 

option to restart the calculation from the previous. 
Naturally this option can also be used to bypass the excitation vector step if the previous calculation failed for some property evaluation which needed the excitation vectors.  
\item[\Key{DTHR}] \verb| | \newline
\verb|<Threshold>|\newline 
Threshold for when excited states is considered degenerate
\end{description}
Now follows a list of input keywords for the specific properties
available in \lsdalton.

\subsection{*ALPHA}\label{subsec:alpha}
Calculation of the (possibly complex) 
polarizability tensor $\alpha$ and its isotropic average.
The polarizability equals minus the linear response function
$<< \mu_A; \mu_B >>_{\omega_B}$, where
$\omega_B$ is in general allowed to be complex --
i.e. $\omega_B = \omega_B^R + i \omega_B^I$.
Frequencies not specified are set to zero by default,
i.e. if no frequencies are specified, the static polarizability is calculated.
\newline
{\bf Test case}: LSresponse/LSresponse\_HF\_alpha 
\begin{description}
\item[\Key{BFREQ}] \verb| | \newline
\verb|<Number of real frequencies for B operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Real frequencies $\omega_B^R$ in the corresponding linear response function.
First line after .BFREQ contains the number of frequencies
and the second line contains all frequencies on one line.
\item[\Key{IMBFREQ}] \verb| | \newline
\verb|<Number of imaginary frequencies for B operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Imaginary frequencies $\omega_B^I$ in the corresponding
linear response function.
The imaginary part of the complex polarizability describes a broadened one-photon
absorption spectrum.
If .IMBFREQ is not specified, only the real polarizability is calculated.
Input as for .BFREQ. 
\end{description}
For example, the following input is used 
to calculate complex polarizability tensors
for the frequencies $\omega_B = 0.1 + 0.05i$ and $\omega_B = 0.2$ 
(in a.u.):
\begin{description}
\item[\Keyinfo{**RESPONS}]
\item[\Keyinfo{*ALPHA}]
\item[\Keyinfo{.BFREQ}]
\item[\Keyinfo{2}]
\item[\Keyinfo{0.1   0.2}]
\item[\Keyinfo{.IMBFREQ}]
\item[\Keyinfo{2}]
\item[\Keyinfo{0.05   0.0}]
\end{description}


\subsection{*BETA}\label{subsec:beta}
Calculation of the (possibly complex) first hyperpolarizability tensor $\beta$ and 
the corresponding averages $\beta_{\parallel}$ and
$\beta_{\perp}$. 
The first hyperpolarizability tensor equals minus the quadratic response function
$<< \mu_A; \mu_B, \mu_C >>_{\omega_B, \omega_C}$, where
the frequencies are in general allowed to be complex --
i.e. $\omega_B = \omega_B^R + i \omega_B^I$ and
$\omega_C = \omega_C^R + i \omega_C^I$.
The input is analogous to the *ALPHA input.
Frequencies not specified are set to zero by default,
i.e. if no frequencies are specified, the static first hyperpolarizability is calculated. \newline
{\bf Test case}: LSresponse/LSresponse\_HF\_beta 
\begin{description}
\item[\Key{BFREQ}] \verb| | \newline
\verb|<Number of real frequencies for B operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Real frequencies $\omega_B^R$ in the corresponding quadratic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{IMBFREQ}] \verb| | \newline
\verb|<Number of imaginary frequencies for B operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Imaginary frequencies $\omega_B^I$ in the corresponding quadratic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{CFREQ}] \verb| | \newline
\verb|<Number of real frequencies for C operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Real frequencies $\omega_C^R$ in the corresponding quadratic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{IMCFREQ}] \verb| | \newline
\verb|<Number of imaginary frequencies for C operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Imaginary frequencies $\omega_C^I$ in the corresponding quadratic response function.
Input as for .BFREQ under *ALPHA.
\end{description}

\subsection{*DAMPED\_TPA}\label{subsec:dtpa}
Damped two-photon absorption~\cite{dampedtpa} where both individual photons
have the same energy (= half the excitation energy).
\newline
{\bf Test case}: LSresponse/LSresponse\_HF\_dtpa 
\begin{description}
\item[\Key{OPFREQ}] \verb| | \newline
\verb|<Number of one-photon frequencies>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
The frequencies in the input are one-photon frequencies (=half the
excitation energy in case of resonance).
\item[\Key{GAMMA}] \verb| | \newline
\verb|<Damping parameter>|\newline
The damping parameter $\gamma$ is used in \emph{all} response equations,
i.e. $i \gamma$ is effectively added to all frequencies occuring in response equations.
Default value: 0.005 a.u.
\end{description}

\subsection{*QUASIMCD}\label{subsec:quasimcd}
Calculation of magnetic circular dichroism (MCD) $\mathcal{A}$ and $\mathcal{B}$ terms, based on the method of Ref \cite{KjaergaardMCD} but reformulated using Ref. \cite{thorvaldsen:214108}. The calculation of Damped MCD spectra according to Ref. \cite{KjaergaardDampedMCD} is also possible with this keyword.

{\bf Note that one or more of the 3 keywords \{ .DAMPEDXCOOR  , .MCDEXCIT, .DAMPEDRANGE \} must be specified}

If {\bf .MCDEXCIT} is specified the default is to proceed in the following way. 
\begin{enumerate}
\item Determine the number of excited states as specified. 
\item Determine $\mathcal{B}$ terms for all allowed transitions. Both London atomic orbitals LAO (also called Gauge including atomic orbitals GIAO) and non-LAOs are used to determine the $\mathcal{B}$ terms. LAOs are superior to standards AOs, but the difference can give an indication of how close the result is to the basis set limit. 
\item Simulate the MCD spectra based on the calculated $\mathcal{B}$ terms by associating a Lorentzian lineshape function (with lineshape parameter of 0.005 a.u.) with each $\mathcal{B}$ term (See Ref. \cite{KjaergaardMCD}). 
The simulated spectra is written to a file MCDspectraAU.dat (in atomic units). The first number is the frequency, the second the LAO ellipticity and the third is the non-LAO ellipticity. A corresponding file is generated call MCDspectra.dat using standard units ($cm^{-1}$ for frequencies and molar ellipticity for the ellipticity).
The individuel $\mathcal{B}$ term contribution to the MCD spectra is written to the files BtermAU.dat and Bterm.dat. Per default 5000 points are used for the simulated spectra. 
The standard units for the $\mathcal{B}$ term is given as $\frac{D^{2} \mu_{B}}{cm^{-1}}$, where $D$ is the unit Debye, $\mu_{B}$ is the Bohr magneton. The conversion factor between atomic units and the standard units are $5.88764 \dot 10^{-5}$.
The standard units for the $\mathcal{A}$ term is given as $D^{2} \mu_{B}$ with a conversion factor of $12.920947806163007$.

\item Perform damped calculations based on the Standard MCD calculation. A number of points around each of the MCD peaks (default value: 10) are determined for which to calculate the damped spectra. The result is printed to the files dampedMCDspectraRAU.dat (atomic units) and dampedMCDspectraR.dat.
\end{enumerate}
{\bf Test case}: LSresponse/LSresponse\_mcd\_calc, LSresponse/LSresponse\_mcd\newline
LSresponse/LSresponse\_mcd2, LSresponse/LSresponse\_mcd3  \newline
Note that only the LSresponse/LSresponse\_mcd\_calc test case is a good example for a general MCD calculation

\begin{description}
\item[\Key{MCDEXCIT}] \verb| | \newline
\verb|<Number of excited states to consider>|\newline
The $\mathcal{B}$ terms will be calculated for all states, unless they are zero due to selection rules (dipole forbidden)
\item[\Key{DEGENERATE}] \verb| | \newline
This keyword must be set if the molecule have a degenerate state so that $\mathcal{A}$ terms are possible, otherwise all states are assumed non-degenerate and no $\mathcal{A}$ terms will be calculated. When this keyword is set the $\mathcal{A}$ terms are calculated and a derivative Lorentzian lineshape function is used to simulate the individuel $\mathcal{A}$ term contributions to the MCD spectra (See Ref. \cite{KjaergaardMCD}). The individuel $\mathcal{A}$ terms contributions to the MCD spectra is written to the files AtermAU.dat and Aterm.dat   
\item[\Key{DAMPEDXCOOR}] \verb| | \newline
\verb|<Number of frequencies>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
The frequencies for which to calculate the damped MCD spectra (in atomic units).
\item[\Key{DAMPEDRANGE}] \verb| | \newline
\verb|<Freq1>|\newline
\verb|<FreqN>|\newline
\verb|<Number of frequencies in range between Freq1 and Freq2>|\newline
The frequencies for which to calculate the damped MCD spectra (in atomic units), here specified as an interval.
\item[\Key{NO LONDON}] \verb| | \newline
Deactivates the use of LAOs
\item[\Key{NO LONDON}] \verb| | \newline
Deactivates the use of non-LAOs
\item[\Key{NO SIMULATE}] \verb| | \newline
Deactivates the simulated spectra
\item[\Key{NO ATERM}] \verb| | \newline
Deactivates the calculation of $\mathcal{A}$ terms
\item[\Key{NO BTERM}] \verb| | \newline
Deactivates the calculation of $\mathcal{B}$ terms
\item[\Key{NO DAMPED}] \verb| | \newline
Deactivates the performance of damped MCD spectra
\item[\Key{GAUSSIAN}] \verb| | \newline
Uses Gaussian lineshape functions (with a lineshape parameter of 0.0070851079363103793) instead of the default Lorentzian lineshape functions.
\item[\Key{LINESHAPEPARAM}] \verb| | \newline
\verb|<lineshape parameter>|\newline
Changes the lineshape parameter (default value 0.005 a.u. for lorentz, 0.0070851079363103793 a.u. for gaussian) used for the simulated spectra
\item[\Key{NVECFORPEAK}] \verb| | \newline
\verb|<number of frequencies used around each MCD peak>|\newline
Changes the number of frequencies used around each MCD peak (default 10).
\item[\Key{NSTEPS}] \verb| | \newline
\verb|<number of frequencies used for the simulated MCD spectra>|\newline
Changes the number of frequencies used for the simulated MCD spectra (default 5000).
\end{description}
Note that the keyword {\bf .DTHR} under {\bf *SOLVER} (see section \ref{subsec:responsesolver} ) can be used to define the threshold for when excited states is considered degenerate

\subsection{*SHIELD}\label{nmrshield}
Nuclear magnetic shielding tensors and chemical shift can be calculated with this keyword
{\bf Test case}: LSresponse/LSresponse\_NMR\_SHIELD

\subsection{*ESDIPOLE}\label{subsec:esd}
Permanent dipole moment for excited states.
{\bf Always requires specification of .NEXCIT!}
If .EXSTATES is not specified, the excited state dipole moments
for all excited states from 1 to NEXCIT
are calculated. \newline
{\bf Test case}: LSresponse/LSresponse\_HF\_esd
\begin{description}
\item[\Key{EXSTATES}] \verb| | \newline
\verb|<Number of specific excited states to consider>|\newline
\verb|<Specific excited states to consider>|\newline
Only calculate excited state gradient for selected excited states.
The first line after .EXSTATES contains the number
of excited states where the excited state gradient is to be calculated,
and the second line specifies which states.
{\bf Important:} The position of the highlest lying excited state
specified by .EXSTATES must be smaller than or equal to
the number of excited states specified by .NEXCIT!
\end{description}

\subsection{*ESGRAD}\label{subsec:esg}
Calculation of the molecular gradient for excited states.
{\bf Always requires specification of .NEXCIT!}
If .EXSTATES is not specified, excited state gradients
for all excited states from 1 to NEXCIT
are calculated. \newline
{\bf Test case}: LSresponse/LSresponse\_HF\_esg 
\begin{description}
\item[\Key{EXSTATES}] \verb| | \newline
\verb|<Number of specific excited states to consider>|\newline
\verb|<Specific excited states to consider>|\newline
Input is identical to .EXSTATES under *ESDIPOLE.
\end{description}
For example, the following input is used 
to calculate excited state gradients for excited states number 3 and 6:
\begin{description}
\item[\Keyinfo{**RESPONS}]
\item[\Keyinfo{.NEXCIT}]
\item[\Keyinfo{6}]
\item[\Keyinfo{*ESGRAD}]
\item[\Keyinfo{.EXSTATES}]
\item[\Keyinfo{2}]
\item[\Keyinfo{3   6}]
\end{description}


\subsection{*GAMMA}\label{subsec:gamma}
Calculation of the (possibly complex)  second hyperpolarizability tensor $\gamma$ and 
the corresponding averages $\gamma_{\parallel}$ and
$\gamma_{\perp}$. 
The second hyperpolarizability tensor equals minus the cubic response function
$<< \mu_A; \mu_B, \mu_C, \mu_D >>_{\omega_B, \omega_C, \omega_D}$, where
the frequencies are in general allowed to be complex --
i.e. $\omega_B = \omega_B^R + i \omega_B^I$,
$\omega_C = \omega_C^R + i \omega_C^I$, and
$\omega_D = \omega_D^R + i \omega_D^I$.
The input is analogous to the *ALPHA and *BETA inputs.
Frequencies not specified are set to zero by default,
i.e. if no frequencies are specified the static second hyperpolarizability is calculated. \newline
{\bf Test case}: LSresponse/LSresponse\_HF\_gamma 
\begin{description}
\item[\Key{BFREQ}] \verb| | \newline
\verb|<Number of real frequencies for B operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Real frequencies $\omega_B^R$ in the corresponding cubic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{IMBFREQ}] \verb| | \newline
\verb|<Number of imaginary frequencies for B operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Imaginary frequencies $\omega_B^I$ in the corresponding cubic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{CFREQ}] \verb| | \newline
\verb|<Number of real frequencies for C operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Real frequencies $\omega_C^R$ in the corresponding cubic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{IMCFREQ}] \verb| | \newline
\verb|<Number of imaginary frequencies for C operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Imaginary frequencies $\omega_C^I$ in the corresponding cubic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{DFREQ}] \verb| | \newline
\verb|<Number of real frequencies for D operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Real frequencies $\omega_D^R$ in the corresponding cubic response function.
Input as for .BFREQ under *ALPHA.
\item[\Key{IMDFREQ}] \verb| | \newline
\verb|<Number of imaginary frequencies for D operator>|\newline
\verb|<Freq1, freq2, ... , freqN>|\newline
Imaginary frequencies $\omega_D^I$ in the corresponding cubic response function.
Input as for .BFREQ under *ALPHA.
\end{description}


\subsection{*MOLGRA}\label{subsec:molgra}
Single point calculation of the molecular gradient. \newline
{\bf Test case}: LSresponse/LSresponse\_HF\_molgra 

\subsection{*TPA}\label{subsec:tpa}
Two-photon absorption where both individual photons
have the same energy (= half the excitation energy).
{\bf Always requires specification of .NEXCIT!}
If .EXSTATES is not specified, two-photon absorption
for all excited states from 1 to NEXCIT
are calculated. \newline
{\bf Test case}: LSresponse/LSresponse\_HF\_tpa 
\begin{description}
\item[\Key{EXSTATES}] \verb| | \newline
\verb|<Number of specific excited states to consider>|\newline
\verb|<Specific excited states to consider>|\newline
Input is identical to .EXSTATES under *ESDIPOLE.
\end{description}


\section{**DEC and **CC}\label{sec:dec}
Correlated coupled-cluster (CC) calculations using the Divide-Expand-Consolidate (DEC) scheme~\cite{dec1,dec2,dec3,dec4,dec5,dec6}, where
local orbitals are used to carry out the correlated calculation on a large molecular system in terms of many small local calculations.
Formally, the computational time for the DEC scheme scales linearly with system size.
Currently only second-order M{\o}ller-Plesset (MP2) calculations (energy, density, and geometry optimization) are available using the DEC scheme. 
DEC calculations are invoked using the **DEC keyword.

Furthermore, conventional coupled-cluster energies for the MP2, CC2, and CCSD models are available using the **CC keyword. The computational time for these implementations scale with the system size to the fifth, fifth, and sixth power for MP2, CC2, and CCSD, respectively.

The **DEC and **CC implementations employ massive parallelism and will be highly effective only if many computing nodes are available.

\textbf{Special note}: It is highly recommended that the memory available for the calculation is specified in the input, see \Key{MEMORY} keyword below.

The **DEC section uses local orbitals by default, while the **CC section uses canonical orbitals by default.
Below keywords for the **DEC section and **CC sections and relevant test cases are given. 

\vspace{1 cm}
\noindent
\textbf{**DEC input keywords} (only MP2 model):

\begin{description}
\item[\Key{FOT}]\verb| | \newline
\verb|<FOT level>|\newline
Level for fragment optimization threshold (FOT). The FOT defines the precision of a DEC calculation compared
to a conventional calculation~\cite{dec1,dec2,dec3,dec4,dec5,dec6}.
The input is an integer which defines the negative power of the FOT; e.g. if FOT level=5, then the FOT=$10^{-5}$ a.u.
Thus, the higher the FOT, the smaller is the error of the DEC calculation compared to a conventional calculation (and of course, the more expensive is the calculation). Possible values: 1,2,3,4,5,6,7,8. Default value: 4.


\item[\Key{MEMORY}] \verb| | \newline
\verb|<Memory in gigabytes>| \newline
It is highly recommended to specify the memory (in gigabytes) available for the calculation using this keyword! For an MPI run this is the memory available for each MPI process.
If this keyword is not set, the program will try to estimate the available memory using a system call. While this will usually work fine it might fail on some architectures.
(This keyword can also be used in **CC section).


\item[\Key{PAIRTHR}] \verb| | \newline
\verb|<Pair distance threshold (in a.u.)>|\newline
Pair distance threshold (in a.u.) beyond which pair fragments are omitted from the calculation. By default this value is adapted to the FOT.

\item[\Key{PAIRTHRANGSTROM}]  \verb| | \newline
\verb|<Pair distance threshold (in Angstrom)>|\newline
Pair distance threshold (in {\AA}) beyond which pair fragments are omitted from the calculation. By default this value is adapted to the FOT.


\item[\Key{RESTART}] \verb| | \newline
Restart unfinished DEC calculation. Requires that HF files \emph{dens.restart}, \emph{fock.restart}, \emph{lcm\_orbitals.u}, and \emph{overlapmatrix} and the DEC files (ending with \emph{.info}) are present in the folder where the calculation is restarted. THIS KEYWORD SHOULD NOT BE COMBINED WITH .RESTART IN THE *DENSOPT SECTION SINCE THIS WOULD REPEAT THE HF CALCULATION!


\item[\Key{NOTABSORBH}] \verb| | \newline
By default orbitals originally assigned to hydrogen atoms are reassigned to the nearest heavy atom. This reassigning can be turned off by invoking this keyword.

\item[\Key{FROZENCORE}]  \verb| | \newline
Use the frozen core approximation (can also be used in **CC section).


\item[\Key{DENSITY}] \verb| | \newline
Calculate DEC-MP2 density matrix~\cite{dec5} (stored in MP2.dens). The MP2 electric dipole moment is also calculated if this keyword is invoked.

\item[\Key{GRADIENT}] \verb| | \newline
Calculate MP2 molecular gradient~\cite{dec5} at input geometry (for geometry optimization, see test case examples below). The MP2 density and electric dipole moment is also calculated if this keyword is invoked.

\item[\Key{KAPPATHR}] \verb| | \newline
Threshold for $\bar{kappa}$ multiplier equations solved when DEC-MP2 molecular gradiient is calculation. Default value is 10$^{-4}$.


\item[\Key{CANONICAL}] \verb| | \newline
Use canonical orbitals. This is only recommended for advanced users for testing purposes. In general, the DEC scheme is only meaningful for local orbitals.


\end{description}

\vspace{1 cm}
\noindent
\textbf{Example test cases for **DEC calculations}: \newline
These test cases illustrate the main features of the DEC scheme. The test cases are located in LSDALTON/test/dectests.

\begin{itemize}
\item
\textit{decmp2\_energy}: Calculate DEC-MP2 energy.
\item
\textit{decmp2\_density}: Calculate DEC-MP2 density matrix and electric dipole moment.
\item
\textit{decmp2\_gradient}: Calculate DEC-MP2 molecular gradient.
\item
\textit{decmp2\_geoopt}: Carry out DEC-MP2 geometry optization. Note that the geometry optimization is invoked by the **OPTIMIZE section, while the **DEC section specifies that the geometry optimization should use DEC-MP2 energies and molecular gradients. The DEC-MP2 geometry optimization will automatically estimate the intrinsic energy error of the DEC calculation. If this error is larger than the difference between two geometry, the FOT will be increased to get a more accurate energy and gradient in the next iteration.
\end{itemize}


\vspace{1 cm}
\noindent
\textbf{**CC input keywords}:

\begin{description}

\item[\Key{MP2}]\verb| | \newline
Use MP2 model. This gives the canonical MP2 energy and is not optimized for parallel performance. It is only intended to be used for benchmarking DEC-MP2 calculations on relatively small molecular systems.

\item[\Key{CC2}]\verb| | \newline
Use CC2 model which is not an optimized code, but rather uses the CCSD optimized code with some contributions removed. See CCSD documentation for details.

\item[\Key{CCSD}]\verb| | \newline
Use CCSD model. The code employed is a massively parallel version and flexible with respect to memory. Due to the use of one-sided communication in these models it is recommended to run CCSD with an asynchronous progress engine switched on (how to do that can be found in the documentation of the respective MPI library you are using). When running a CCSD calculation make sure that at least one quantity of size $V^2O^2$ ($O$ = number of occupied orbitals, $V$ = number of virtual orbitals) fits into memory in double precision floating point numbers (with some additional space of course). 

\item[\Key{FROZENCORE}]  \verb| | \newline
Use the frozen core approximation (can also be used in **DEC section).

\item[\Key{MEMORY}] \verb| | \newline
\verb|<Memory in gigabytes>| \newline
It is highly recommended to specify the memory (in gigabytes) available for the calculation using this keyword! For an MPI run this is the memory available for each MPI process.
If this keyword is not set, the program will try to estimate the available memory using a system call. While this will usually work fine it might fail on some architectures.
(This keyword can also be used in **DEC section).

\item[\Key{CCMAXITER}]  \verb| | \newline
Maximum number of iterations in CC solver.

\item[\Key{CCTHR}]  \verb| | \newline
Convergence threshold for residual norm in CC solver.


\item[\Key{SUBSIZE}]  \verb| | \newline
Number of previous vectors to store in CROP scheme~\cite{crop} for CC solver.

\item[\Key{CCSDSAFE}]  \verb| | \newline
Save CCSD amplitudes to be able to restart full CCSD calculation. The files are named t11.restart and t12.restart for the singles amplitudes and t21.restart and t22.restart for the doubles amplitudes. These files are written in in an alternate fashion and the latest amplitudes are read automatically if a CCSD calculation is started in the same folder.

\end{description}


\vspace{1 cm}
\noindent
\textbf{Example test cases for **CC calculations}: \newline
The test cases are located in LSDALTON/test/dectests.

\begin{itemize}
\item
\textit{fullmp2\_energy}: Calculate conventional canonical MP2 energy.
\item
\textit{fullccsd\_high}: Calculate conventional canonical CCSD energy.
\end{itemize}





\section{**PLT}\label{sec:plt}
Generation of .plt files which may be used to visualize densities, orbitals, and electrostatic potentials by calculating these at specific points in space.
The .plt files can be visualized e.g. using the Chimera program~\cite{chimera}.

\textbf{Important note}: This section assumes that an LSDALTON calculation has already been carried out to generate files containing
density matrix elements or molecular orbital coefficients. The .plt files can then be generated by running a new calculation where the LSDALTON.INP file has been modified as exemplified below.

The density matrix from HF and DFT calculation are saved in a file \emph{dens.restart}, while the MP2 density is saved in the file \emph{MP2.dens} (if requested, see **DEC section).
The canonical MO coefficients are saved in the file \emph{cmo\_orbitals.u}, while localized molecular orbitals are saved in a file \emph{lcm\_orbitals.u} (if requested).
The definition of the grid points is described in the **PLTGRID section.

KK fixme: Insert reference to orbital section here!

\begin{description}
\item[\Key{INPUT}] \verb| | \newline
\verb|<Name of input file>| \newline
The name of the input file containing density matrix elements or orbital coefficients. Possible input files include \emph{dens.restart}, \emph{MP2.dens}, \emph{cmo\_orbitals.u}, and \emph{lcm\_orbitals.u}.

\item[\Key{OUTPUT}] \verb| | \newline
\verb|<Name of output file>| \newline
The name of the output plt-file where the calculated values at each grid point are saved. Examples are given below.

\item[\Key{DENS}]\verb| | \newline
Construct .plt file for electron density at grid points.
For example to calculate electron density from the file  \emph{dens.restart} and save information in file  dens.plt,
insert the following section in the LSDALTON.INP file used to generate the  \emph{dens.restart} file in the first place:
 \newline
**PLT \newline
.INPUT \newline
dens.restart \newline
.OUTPUT \newline
dens.plt \newline
.DENS \newline

\item[\Key{EP}]\verb| | \newline
Construct .plt file for electrostatic potential grid points based on input density matrix.
For example to calculate electrostatic potential from the density in the the file  \emph{dens.restart} and save information in file  ep.plt,
insert the following section in the LSDALTON.INP file used to generate the  \emph{dens.restart} file in the first place:
 \newline
**PLT \newline
.INPUT \newline
dens.restart \newline
.OUTPUT \newline
ep.plt \newline
.EP \newline


\item[\Key{ORB}]\verb| | \newline
\verb|<Orbital index>|\newline
Construct .plt file for specific orbital at grid points. For example to calculate values of orbital number 8 at grid points from the file  \emph{lcm\_orbitals.u} and save information in file orb8.plt, insert the following section in the LSDALTON.INP file used to generate the  \emph{lcm\_orbitals.u} file in the first place: \newline
**PLT \newline
.INPUT \newline
lcm\_orbitals.u \newline
.OUTPUT \newline
orb8.plt \newline
.ORB \newline
8

\item[\Key{CHARGEDIST}]\verb| | \newline
\verb|<Orbital index 1     Orbital index 2>|\newline
Construct .plt file for charge distribution of two orbitals at grid points. 
For example to calculate charge distribution between orbitals 5 and 8 at grid points from the file  \emph{lcm\_orbitals.u} and save information in file cd\_5\_8.plt,
insert the following section in the LSDALTON.INP file used to generate the  \emph{lcm\_orbitals.u} file in the first place::
 \newline
**PLT \newline
.INPUT \newline
lcm\_orbitals.u \newline
.OUTPUT \newline
 cd\_5\_8.plt \newline
.CHARGEDIST \newline
5  8

\end{description}



\section{**PLTGRID}\label{sec:pltgrid}
Definition of 3-dimensinal grid used for generation of .plt files in **PLT section.
The default grid choice should suffice for most visualization purposes. This section is only for the advanced user who wishes to modify the default choice of grid.

KK fixme: Insert reference to orbital section here!

The grid box is defined in the following manner:
\begin{itemize}
\item
The first point in the grid box is (X1,Y1,Z1).                                                 
\item
The remaining grid points are then defined by going out in the X, Y, and Z directions with step sizes deltax, deltay, and deltaz, until there are nX, nY, and nZ points in the X,Y, and Z directions (giving a total number of gridpoints $nX\times nY \times nZ$).      
\end{itemize}

There are two options to define the grid box: (i) manual gridbox where X1, Y1, Z1, deltax, deltay, deltaz, nX, nY, nZ are defined explicitly in the input file; (ii)
molecule-specific gridbox where all atoms are contained within the grid box AND there is an additional buffer zone around the outermost atoms in the X, Y, and Z directions. Option (ii) thus requires that the deltax, deltay, deltaz, and buffer values are defined by the input, which implicitly defines X1, Y1, Z1, nX, nY, and nZ based on the molecular structure.

The default gridbox uses option (ii) with {deltax=deltay=deltaz=0.3 a.u.} and {buffer=6.0 a.u}. 
User-defined grid box based on options (i) and (ii) use the following inputs:


\begin{description}
\item[\Key{MANUAL}] \verb| | \newline
\verb|<X1   Y1   Z1>| \newline
\verb|<deltax    deltay    deltaz>| \newline
\verb|<nX    nY    nZ>| \newline
Manual definition of gridbox as described above. All input values are in a.u.

\item[\Key{MOLECULE}] \verb| | \newline
\verb|<buffer>| \newline
\verb|<deltax    deltay    deltaz>| \newline
Molecule-specifc definition of gridbox as described above. All input values are in a.u.

\end{description}

