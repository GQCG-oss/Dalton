MODULE AGC_GPU_OBS_TRMODAtoDGen2
 use IchorPrecisionMod
  
 CONTAINS
 subroutine TransferRecurrenceGPUP4Q1AtoDGen(nPasses,nPrimP,nPrimQ,reducedExponents,&
         & Pexp,Qexp,Pdistance12,Qdistance12,Bexp,Cexp,nPrimA,nPrimB,nPrimC,nPrimD,&
         & MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,Aux,Aux2,iASync)
  implicit none
  integer,intent(in) :: nPasses,nPrimP,nPrimQ,nPrimA,nPrimB,nPrimC,nPrimD,nAtomsA,nAtomsB,MaxPasses
  real(realk),intent(in) :: reducedExponents(nPrimQ,nPrimP),Pexp(nPrimP),Qexp(nPrimQ)
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB),Qdistance12(3)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(in) :: Bexp(nPrimB),Cexp(nPrimC)
  real(realk),intent(in) :: Aux(nPrimQ*nPrimP*nPasses,   56)
  real(realk),intent(inout) :: Aux2(nPrimQ*nPrimP*nPasses,   35,    4)
!  real(realk),intent(inout) :: Aux2(nPrimQ,nPrimP,nPasses,nTUVP,nTUVQ)
  integer(kind=acckind),intent(in) :: iASync
  !Local variables
  real(realk) :: Tmp0( 35,  4)
!  real(realk) :: Tmp(nTUVP,nTUVQ) ordering
  integer :: iPassP,iPrimP,iPrimQ,iPrimQP,IP,iTUVP,iTUVQ,iTUVplus1,ituvpminus1,iAtomA,iAtomB
  integer :: iPrimB,iPrimC
  real(realk),parameter :: D1=1.0E0_realk,D05=0.5E0_realk
  real(realk) :: Xab,Yab,Zab,Xcd,Ycd,Zcd,expP
  real(realk) :: expBX,expBY,expBZ
  real(realk) :: invexpQ,inv2expQ,facX,facY,facZ,pinvq
!$ACC PARALLEL LOOP &
!$ACC PRIVATE(iAtomA,iAtomB,Xab,Yab,Zab,Xcd,Ycd,Zcd,expP,&
!$ACC         iP,iPrimQ,iPrimP,iPassP,&
!$ACC         expBX,expBY,expBZ,&
!$ACC         iPrimB,iPrimC,&
!$ACC         Tmp0,&
!$ACC         invexpQ,inv2expQ,facX,facY,facZ,pinvq,iTUVQ,iTUVP,iTUVplus1) &
!$ACC PRESENT(nPasses,nPrimP,nPrimQ,nPrimA,nPrimB,nPrimC,nPrimD,&
!$ACC        reducedExponents,Pexp,Qexp,Pdistance12,Qdistance12,&
!$ACC       Bexp,Cexp,&
!$ACC        IatomApass,IatomBpass,Aux2,Aux) ASYNC(iASync)
  DO iP = 1,nPrimQ*nPrimP*nPasses
   iPrimQ = mod(IP-1,nPrimQ)+1
   iPrimP = mod((IP-(mod(IP-1,nPrimQ)+1))/nPrimQ,nPrimP)+1
   iPassP = (IP-1)/(nPrimQ*nPrimP) + 1
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = Pdistance12(1,iAtomA,iAtomB)
   Yab = Pdistance12(2,iAtomA,iAtomB)
   Zab = Pdistance12(3,iAtomA,iAtomB)
    expP = Pexp(iPrimP)
    iPrimB = (iPrimP-1)/nPrimA+1                
    expBX = Bexp(iPrimB)*Xab
    expBY = Bexp(iPrimB)*Yab
    expBZ = Bexp(iPrimB)*Zab
     iPrimC = iPrimQ - ((iPrimQ-1)/nPrimC)*nPrimC
     invexpQ = D1/Qexp(iPrimQ)
     inv2expQ = D05*invexpQ
     facX = -(expBX-Cexp(iPrimC)*Xcd)*invexpQ
     facY = -(expBY-Cexp(iPrimC)*Ycd)*invexpQ
     facZ = -(expBZ-Cexp(iPrimC)*Zcd)*invexpQ
     pinvq = -expP*invexpQ
 ! Building for Angular momentum Jq = 0
!$ACC LOOP SEQ
     DO iTUVP=1, 35
      Tmp0(iTUVP,1) = Aux(IP,iTUVP)
     ENDDO
 ! Building for Angular momentum Jq = 1
!$ACC LOOP SEQ
     do iTUVP = 1, 35
      Tmp0(iTUVP,2) = facX*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 35
      Tmp0(iTUVP,3) = facY*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 35
      Tmp0(iTUVP,4) = facZ*Aux(IP,iTUVP)
     enddo
     Tmp0(2,2) = Tmp0(2,2) + inv2expQ*Aux(IP,1) 
     Tmp0(5,2) = Tmp0(5,2) + 2*inv2expQ*Aux(IP,2) 
     Tmp0(6,2) = Tmp0(6,2) + inv2expQ*Aux(IP,3) 
     Tmp0(7,2) = Tmp0(7,2) + inv2expQ*Aux(IP,4) 
     Tmp0(11,2) = Tmp0(11,2) + 3*inv2expQ*Aux(IP,5) 
     Tmp0(12,2) = Tmp0(12,2) + 2*inv2expQ*Aux(IP,6) 
     Tmp0(13,2) = Tmp0(13,2) + 2*inv2expQ*Aux(IP,7) 
     Tmp0(14,2) = Tmp0(14,2) + inv2expQ*Aux(IP,8) 
     Tmp0(15,2) = Tmp0(15,2) + inv2expQ*Aux(IP,9) 
     Tmp0(16,2) = Tmp0(16,2) + inv2expQ*Aux(IP,10) 
     Tmp0(21,2) = Tmp0(21,2) + 4*inv2expQ*Aux(IP,11) 
     Tmp0(22,2) = Tmp0(22,2) + 3*inv2expQ*Aux(IP,12) 
     Tmp0(23,2) = Tmp0(23,2) + 3*inv2expQ*Aux(IP,13) 
     Tmp0(24,2) = Tmp0(24,2) + 2*inv2expQ*Aux(IP,14) 
     Tmp0(25,2) = Tmp0(25,2) + 2*inv2expQ*Aux(IP,15) 
     Tmp0(26,2) = Tmp0(26,2) + 2*inv2expQ*Aux(IP,16) 
     Tmp0(27,2) = Tmp0(27,2) + inv2expQ*Aux(IP,17) 
     Tmp0(28,2) = Tmp0(28,2) + inv2expQ*Aux(IP,18) 
     Tmp0(29,2) = Tmp0(29,2) + inv2expQ*Aux(IP,19) 
     Tmp0(30,2) = Tmp0(30,2) + inv2expQ*Aux(IP,20) 
     Tmp0(3,3) = Tmp0(3,3) + inv2expQ*Aux(IP,1) 
     Tmp0(6,3) = Tmp0(6,3) + inv2expQ*Aux(IP,2) 
     Tmp0(8,3) = Tmp0(8,3) + 2*inv2expQ*Aux(IP,3) 
     Tmp0(9,3) = Tmp0(9,3) + inv2expQ*Aux(IP,4) 
     Tmp0(12,3) = Tmp0(12,3) + inv2expQ*Aux(IP,5) 
     Tmp0(14,3) = Tmp0(14,3) + 2*inv2expQ*Aux(IP,6) 
     Tmp0(15,3) = Tmp0(15,3) + inv2expQ*Aux(IP,7) 
     Tmp0(17,3) = Tmp0(17,3) + 3*inv2expQ*Aux(IP,8) 
     Tmp0(18,3) = Tmp0(18,3) + 2*inv2expQ*Aux(IP,9) 
     Tmp0(19,3) = Tmp0(19,3) + inv2expQ*Aux(IP,10) 
     Tmp0(22,3) = Tmp0(22,3) + inv2expQ*Aux(IP,11) 
     Tmp0(24,3) = Tmp0(24,3) + 2*inv2expQ*Aux(IP,12) 
     Tmp0(25,3) = Tmp0(25,3) + inv2expQ*Aux(IP,13) 
     Tmp0(27,3) = Tmp0(27,3) + 3*inv2expQ*Aux(IP,14) 
     Tmp0(28,3) = Tmp0(28,3) + 2*inv2expQ*Aux(IP,15) 
     Tmp0(29,3) = Tmp0(29,3) + inv2expQ*Aux(IP,16) 
     Tmp0(31,3) = Tmp0(31,3) + 4*inv2expQ*Aux(IP,17) 
     Tmp0(32,3) = Tmp0(32,3) + 3*inv2expQ*Aux(IP,18) 
     Tmp0(33,3) = Tmp0(33,3) + 2*inv2expQ*Aux(IP,19) 
     Tmp0(34,3) = Tmp0(34,3) + inv2expQ*Aux(IP,20) 
     Tmp0(4,4) = Tmp0(4,4) + inv2expQ*Aux(IP,1) 
     Tmp0(7,4) = Tmp0(7,4) + inv2expQ*Aux(IP,2) 
     Tmp0(9,4) = Tmp0(9,4) + inv2expQ*Aux(IP,3) 
     Tmp0(10,4) = Tmp0(10,4) + 2*inv2expQ*Aux(IP,4) 
     Tmp0(13,4) = Tmp0(13,4) + inv2expQ*Aux(IP,5) 
     Tmp0(15,4) = Tmp0(15,4) + inv2expQ*Aux(IP,6) 
     Tmp0(16,4) = Tmp0(16,4) + 2*inv2expQ*Aux(IP,7) 
     Tmp0(18,4) = Tmp0(18,4) + inv2expQ*Aux(IP,8) 
     Tmp0(19,4) = Tmp0(19,4) + 2*inv2expQ*Aux(IP,9) 
     Tmp0(20,4) = Tmp0(20,4) + 3*inv2expQ*Aux(IP,10) 
     Tmp0(23,4) = Tmp0(23,4) + inv2expQ*Aux(IP,11) 
     Tmp0(25,4) = Tmp0(25,4) + inv2expQ*Aux(IP,12) 
     Tmp0(26,4) = Tmp0(26,4) + 2*inv2expQ*Aux(IP,13) 
     Tmp0(28,4) = Tmp0(28,4) + inv2expQ*Aux(IP,14) 
     Tmp0(29,4) = Tmp0(29,4) + 2*inv2expQ*Aux(IP,15) 
     Tmp0(30,4) = Tmp0(30,4) + 3*inv2expQ*Aux(IP,16) 
     Tmp0(32,4) = Tmp0(32,4) + inv2expQ*Aux(IP,17) 
     Tmp0(33,4) = Tmp0(33,4) + 2*inv2expQ*Aux(IP,18) 
     Tmp0(34,4) = Tmp0(34,4) + 3*inv2expQ*Aux(IP,19) 
     Tmp0(35,4) = Tmp0(35,4) + 4*inv2expQ*Aux(IP,20) 
     Tmp0(1,2) = Tmp0(1,2) + pinvq*Aux(IP,2)
     Tmp0(2,2) = Tmp0(2,2) + pinvq*Aux(IP,5)
     Tmp0(3,2) = Tmp0(3,2) + pinvq*Aux(IP,6)
     Tmp0(4,2) = Tmp0(4,2) + pinvq*Aux(IP,7)
     Tmp0(5,2) = Tmp0(5,2) + pinvq*Aux(IP,11)
     Tmp0(6,2) = Tmp0(6,2) + pinvq*Aux(IP,12)
     Tmp0(7,2) = Tmp0(7,2) + pinvq*Aux(IP,13)
     Tmp0(8,2) = Tmp0(8,2) + pinvq*Aux(IP,14)
     Tmp0(9,2) = Tmp0(9,2) + pinvq*Aux(IP,15)
     Tmp0(10,2) = Tmp0(10,2) + pinvq*Aux(IP,16)
     Tmp0(11,2) = Tmp0(11,2) + pinvq*Aux(IP,21)
     Tmp0(12,2) = Tmp0(12,2) + pinvq*Aux(IP,22)
     Tmp0(13,2) = Tmp0(13,2) + pinvq*Aux(IP,23)
     Tmp0(14,2) = Tmp0(14,2) + pinvq*Aux(IP,24)
     Tmp0(15,2) = Tmp0(15,2) + pinvq*Aux(IP,25)
     Tmp0(16,2) = Tmp0(16,2) + pinvq*Aux(IP,26)
     Tmp0(17,2) = Tmp0(17,2) + pinvq*Aux(IP,27)
     Tmp0(18,2) = Tmp0(18,2) + pinvq*Aux(IP,28)
     Tmp0(19,2) = Tmp0(19,2) + pinvq*Aux(IP,29)
     Tmp0(20,2) = Tmp0(20,2) + pinvq*Aux(IP,30)
     Tmp0(21,2) = Tmp0(21,2) + pinvq*Aux(IP,36)
     Tmp0(22,2) = Tmp0(22,2) + pinvq*Aux(IP,37)
     Tmp0(23,2) = Tmp0(23,2) + pinvq*Aux(IP,38)
     Tmp0(24,2) = Tmp0(24,2) + pinvq*Aux(IP,39)
     Tmp0(25,2) = Tmp0(25,2) + pinvq*Aux(IP,40)
     Tmp0(26,2) = Tmp0(26,2) + pinvq*Aux(IP,41)
     Tmp0(27,2) = Tmp0(27,2) + pinvq*Aux(IP,42)
     Tmp0(28,2) = Tmp0(28,2) + pinvq*Aux(IP,43)
     Tmp0(29,2) = Tmp0(29,2) + pinvq*Aux(IP,44)
     Tmp0(30,2) = Tmp0(30,2) + pinvq*Aux(IP,45)
     Tmp0(31,2) = Tmp0(31,2) + pinvq*Aux(IP,46)
     Tmp0(32,2) = Tmp0(32,2) + pinvq*Aux(IP,47)
     Tmp0(33,2) = Tmp0(33,2) + pinvq*Aux(IP,48)
     Tmp0(34,2) = Tmp0(34,2) + pinvq*Aux(IP,49)
     Tmp0(35,2) = Tmp0(35,2) + pinvq*Aux(IP,50)
     Tmp0(1,3) = Tmp0(1,3) + pinvq*Aux(IP,3)
     Tmp0(2,3) = Tmp0(2,3) + pinvq*Aux(IP,6)
     Tmp0(3,3) = Tmp0(3,3) + pinvq*Aux(IP,8)
     Tmp0(4,3) = Tmp0(4,3) + pinvq*Aux(IP,9)
     Tmp0(5,3) = Tmp0(5,3) + pinvq*Aux(IP,12)
     Tmp0(6,3) = Tmp0(6,3) + pinvq*Aux(IP,14)
     Tmp0(7,3) = Tmp0(7,3) + pinvq*Aux(IP,15)
     Tmp0(8,3) = Tmp0(8,3) + pinvq*Aux(IP,17)
     Tmp0(9,3) = Tmp0(9,3) + pinvq*Aux(IP,18)
     Tmp0(10,3) = Tmp0(10,3) + pinvq*Aux(IP,19)
     Tmp0(11,3) = Tmp0(11,3) + pinvq*Aux(IP,22)
     Tmp0(12,3) = Tmp0(12,3) + pinvq*Aux(IP,24)
     Tmp0(13,3) = Tmp0(13,3) + pinvq*Aux(IP,25)
     Tmp0(14,3) = Tmp0(14,3) + pinvq*Aux(IP,27)
     Tmp0(15,3) = Tmp0(15,3) + pinvq*Aux(IP,28)
     Tmp0(16,3) = Tmp0(16,3) + pinvq*Aux(IP,29)
     Tmp0(17,3) = Tmp0(17,3) + pinvq*Aux(IP,31)
     Tmp0(18,3) = Tmp0(18,3) + pinvq*Aux(IP,32)
     Tmp0(19,3) = Tmp0(19,3) + pinvq*Aux(IP,33)
     Tmp0(20,3) = Tmp0(20,3) + pinvq*Aux(IP,34)
     Tmp0(21,3) = Tmp0(21,3) + pinvq*Aux(IP,37)
     Tmp0(22,3) = Tmp0(22,3) + pinvq*Aux(IP,39)
     Tmp0(23,3) = Tmp0(23,3) + pinvq*Aux(IP,40)
     Tmp0(24,3) = Tmp0(24,3) + pinvq*Aux(IP,42)
     Tmp0(25,3) = Tmp0(25,3) + pinvq*Aux(IP,43)
     Tmp0(26,3) = Tmp0(26,3) + pinvq*Aux(IP,44)
     Tmp0(27,3) = Tmp0(27,3) + pinvq*Aux(IP,46)
     Tmp0(28,3) = Tmp0(28,3) + pinvq*Aux(IP,47)
     Tmp0(29,3) = Tmp0(29,3) + pinvq*Aux(IP,48)
     Tmp0(30,3) = Tmp0(30,3) + pinvq*Aux(IP,49)
     Tmp0(31,3) = Tmp0(31,3) + pinvq*Aux(IP,51)
     Tmp0(32,3) = Tmp0(32,3) + pinvq*Aux(IP,52)
     Tmp0(33,3) = Tmp0(33,3) + pinvq*Aux(IP,53)
     Tmp0(34,3) = Tmp0(34,3) + pinvq*Aux(IP,54)
     Tmp0(35,3) = Tmp0(35,3) + pinvq*Aux(IP,55)
     Tmp0(1,4) = Tmp0(1,4) + pinvq*Aux(IP,4)
     Tmp0(2,4) = Tmp0(2,4) + pinvq*Aux(IP,7)
     Tmp0(3,4) = Tmp0(3,4) + pinvq*Aux(IP,9)
     Tmp0(4,4) = Tmp0(4,4) + pinvq*Aux(IP,10)
     Tmp0(5,4) = Tmp0(5,4) + pinvq*Aux(IP,13)
     Tmp0(6,4) = Tmp0(6,4) + pinvq*Aux(IP,15)
     Tmp0(7,4) = Tmp0(7,4) + pinvq*Aux(IP,16)
     Tmp0(8,4) = Tmp0(8,4) + pinvq*Aux(IP,18)
     Tmp0(9,4) = Tmp0(9,4) + pinvq*Aux(IP,19)
     Tmp0(10,4) = Tmp0(10,4) + pinvq*Aux(IP,20)
     Tmp0(11,4) = Tmp0(11,4) + pinvq*Aux(IP,23)
     Tmp0(12,4) = Tmp0(12,4) + pinvq*Aux(IP,25)
     Tmp0(13,4) = Tmp0(13,4) + pinvq*Aux(IP,26)
     Tmp0(14,4) = Tmp0(14,4) + pinvq*Aux(IP,28)
     Tmp0(15,4) = Tmp0(15,4) + pinvq*Aux(IP,29)
     Tmp0(16,4) = Tmp0(16,4) + pinvq*Aux(IP,30)
     Tmp0(17,4) = Tmp0(17,4) + pinvq*Aux(IP,32)
     Tmp0(18,4) = Tmp0(18,4) + pinvq*Aux(IP,33)
     Tmp0(19,4) = Tmp0(19,4) + pinvq*Aux(IP,34)
     Tmp0(20,4) = Tmp0(20,4) + pinvq*Aux(IP,35)
     Tmp0(21,4) = Tmp0(21,4) + pinvq*Aux(IP,38)
     Tmp0(22,4) = Tmp0(22,4) + pinvq*Aux(IP,40)
     Tmp0(23,4) = Tmp0(23,4) + pinvq*Aux(IP,41)
     Tmp0(24,4) = Tmp0(24,4) + pinvq*Aux(IP,43)
     Tmp0(25,4) = Tmp0(25,4) + pinvq*Aux(IP,44)
     Tmp0(26,4) = Tmp0(26,4) + pinvq*Aux(IP,45)
     Tmp0(27,4) = Tmp0(27,4) + pinvq*Aux(IP,47)
     Tmp0(28,4) = Tmp0(28,4) + pinvq*Aux(IP,48)
     Tmp0(29,4) = Tmp0(29,4) + pinvq*Aux(IP,49)
     Tmp0(30,4) = Tmp0(30,4) + pinvq*Aux(IP,50)
     Tmp0(31,4) = Tmp0(31,4) + pinvq*Aux(IP,52)
     Tmp0(32,4) = Tmp0(32,4) + pinvq*Aux(IP,53)
     Tmp0(33,4) = Tmp0(33,4) + pinvq*Aux(IP,54)
     Tmp0(34,4) = Tmp0(34,4) + pinvq*Aux(IP,55)
     Tmp0(35,4) = Tmp0(35,4) + pinvq*Aux(IP,56)
!$ACC LOOP SEQ
     DO iTUVQ=1,  4
!$ACC LOOP SEQ
      DO iTUVP=1, 35
        Aux2(IP,iTUVP,iTUVQ) = Tmp0(iTUVP,iTUVQ)
      ENDDO
     ENDDO
  ENDDO !iP = 1,nPrimQ*nPrimP*nPasses
 end subroutine TransferRecurrenceGPUP4Q1AtoDGen
 subroutine TransferRecurrenceGPUP3Q3AtoDGen(nPasses,nPrimP,nPrimQ,reducedExponents,&
         & Pexp,Qexp,Pdistance12,Qdistance12,Bexp,Cexp,nPrimA,nPrimB,nPrimC,nPrimD,&
         & MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,Aux,Aux2,iASync)
  implicit none
  integer,intent(in) :: nPasses,nPrimP,nPrimQ,nPrimA,nPrimB,nPrimC,nPrimD,nAtomsA,nAtomsB,MaxPasses
  real(realk),intent(in) :: reducedExponents(nPrimQ,nPrimP),Pexp(nPrimP),Qexp(nPrimQ)
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB),Qdistance12(3)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(in) :: Bexp(nPrimB),Cexp(nPrimC)
  real(realk),intent(in) :: Aux(nPrimQ*nPrimP*nPasses,   84)
  real(realk),intent(inout) :: Aux2(nPrimQ*nPrimP*nPasses,   20,   20)
!  real(realk),intent(inout) :: Aux2(nPrimQ,nPrimP,nPasses,nTUVP,nTUVQ)
  integer(kind=acckind),intent(in) :: iASync
  !Local variables
  real(realk) :: Tmp0( 20, 20)
  real(realk) :: Tmp1( 21: 56,  2:  4)
  real(realk) :: Tmp2( 21: 35,  5: 10)
!  real(realk) :: Tmp(nTUVP,nTUVQ) ordering
  integer :: iPassP,iPrimP,iPrimQ,iPrimQP,IP,iTUVP,iTUVQ,iTUVplus1,ituvpminus1,iAtomA,iAtomB
  integer :: iPrimB,iPrimC
  real(realk),parameter :: D1=1.0E0_realk,D05=0.5E0_realk
  real(realk) :: Xab,Yab,Zab,Xcd,Ycd,Zcd,expP
  real(realk) :: expBX,expBY,expBZ
  real(realk) :: invexpQ,inv2expQ,facX,facY,facZ,pinvq
!$ACC PARALLEL LOOP &
!$ACC PRIVATE(iAtomA,iAtomB,Xab,Yab,Zab,Xcd,Ycd,Zcd,expP,&
!$ACC         iP,iPrimQ,iPrimP,iPassP,&
!$ACC         expBX,expBY,expBZ,&
!$ACC         iPrimB,iPrimC,&
!$ACC         Tmp0,&
!$ACC         Tmp1,&
!$ACC         Tmp2,&
!$ACC         invexpQ,inv2expQ,facX,facY,facZ,pinvq,iTUVQ,iTUVP,iTUVplus1) &
!$ACC PRESENT(nPasses,nPrimP,nPrimQ,nPrimA,nPrimB,nPrimC,nPrimD,&
!$ACC        reducedExponents,Pexp,Qexp,Pdistance12,Qdistance12,&
!$ACC       Bexp,Cexp,&
!$ACC        IatomApass,IatomBpass,Aux2,Aux) ASYNC(iASync)
  DO iP = 1,nPrimQ*nPrimP*nPasses
   iPrimQ = mod(IP-1,nPrimQ)+1
   iPrimP = mod((IP-(mod(IP-1,nPrimQ)+1))/nPrimQ,nPrimP)+1
   iPassP = (IP-1)/(nPrimQ*nPrimP) + 1
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = Pdistance12(1,iAtomA,iAtomB)
   Yab = Pdistance12(2,iAtomA,iAtomB)
   Zab = Pdistance12(3,iAtomA,iAtomB)
    expP = Pexp(iPrimP)
    iPrimB = (iPrimP-1)/nPrimA+1                
    expBX = Bexp(iPrimB)*Xab
    expBY = Bexp(iPrimB)*Yab
    expBZ = Bexp(iPrimB)*Zab
     iPrimC = iPrimQ - ((iPrimQ-1)/nPrimC)*nPrimC
     invexpQ = D1/Qexp(iPrimQ)
     inv2expQ = D05*invexpQ
     facX = -(expBX-Cexp(iPrimC)*Xcd)*invexpQ
     facY = -(expBY-Cexp(iPrimC)*Ycd)*invexpQ
     facZ = -(expBZ-Cexp(iPrimC)*Zcd)*invexpQ
     pinvq = -expP*invexpQ
 ! Building for Angular momentum Jq = 0
!$ACC LOOP SEQ
     DO iTUVP=1, 20
      Tmp0(iTUVP,1) = Aux(IP,iTUVP)
     ENDDO
 ! Building for Angular momentum Jq = 1
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,2) = facX*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,3) = facY*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,4) = facZ*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 56
      Tmp1(iTUVP,2) = facX*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 56
      Tmp1(iTUVP,3) = facY*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 56
      Tmp1(iTUVP,4) = facZ*Aux(IP,iTUVP)
     enddo
     Tmp0(2,2) = Tmp0(2,2) + inv2expQ*Aux(IP,1) 
     Tmp0(5,2) = Tmp0(5,2) + 2*inv2expQ*Aux(IP,2) 
     Tmp0(6,2) = Tmp0(6,2) + inv2expQ*Aux(IP,3) 
     Tmp0(7,2) = Tmp0(7,2) + inv2expQ*Aux(IP,4) 
     Tmp0(11,2) = Tmp0(11,2) + 3*inv2expQ*Aux(IP,5) 
     Tmp0(12,2) = Tmp0(12,2) + 2*inv2expQ*Aux(IP,6) 
     Tmp0(13,2) = Tmp0(13,2) + 2*inv2expQ*Aux(IP,7) 
     Tmp0(14,2) = Tmp0(14,2) + inv2expQ*Aux(IP,8) 
     Tmp0(15,2) = Tmp0(15,2) + inv2expQ*Aux(IP,9) 
     Tmp0(16,2) = Tmp0(16,2) + inv2expQ*Aux(IP,10) 
     Tmp0(3,3) = Tmp0(3,3) + inv2expQ*Aux(IP,1) 
     Tmp0(6,3) = Tmp0(6,3) + inv2expQ*Aux(IP,2) 
     Tmp0(8,3) = Tmp0(8,3) + 2*inv2expQ*Aux(IP,3) 
     Tmp0(9,3) = Tmp0(9,3) + inv2expQ*Aux(IP,4) 
     Tmp0(12,3) = Tmp0(12,3) + inv2expQ*Aux(IP,5) 
     Tmp0(14,3) = Tmp0(14,3) + 2*inv2expQ*Aux(IP,6) 
     Tmp0(15,3) = Tmp0(15,3) + inv2expQ*Aux(IP,7) 
     Tmp0(17,3) = Tmp0(17,3) + 3*inv2expQ*Aux(IP,8) 
     Tmp0(18,3) = Tmp0(18,3) + 2*inv2expQ*Aux(IP,9) 
     Tmp0(19,3) = Tmp0(19,3) + inv2expQ*Aux(IP,10) 
     Tmp0(4,4) = Tmp0(4,4) + inv2expQ*Aux(IP,1) 
     Tmp0(7,4) = Tmp0(7,4) + inv2expQ*Aux(IP,2) 
     Tmp0(9,4) = Tmp0(9,4) + inv2expQ*Aux(IP,3) 
     Tmp0(10,4) = Tmp0(10,4) + 2*inv2expQ*Aux(IP,4) 
     Tmp0(13,4) = Tmp0(13,4) + inv2expQ*Aux(IP,5) 
     Tmp0(15,4) = Tmp0(15,4) + inv2expQ*Aux(IP,6) 
     Tmp0(16,4) = Tmp0(16,4) + 2*inv2expQ*Aux(IP,7) 
     Tmp0(18,4) = Tmp0(18,4) + inv2expQ*Aux(IP,8) 
     Tmp0(19,4) = Tmp0(19,4) + 2*inv2expQ*Aux(IP,9) 
     Tmp0(20,4) = Tmp0(20,4) + 3*inv2expQ*Aux(IP,10) 
     Tmp1(21,2) = Tmp1(21,2) + 4*inv2expQ*Aux(IP,11) 
     Tmp1(22,2) = Tmp1(22,2) + 3*inv2expQ*Aux(IP,12) 
     Tmp1(23,2) = Tmp1(23,2) + 3*inv2expQ*Aux(IP,13) 
     Tmp1(24,2) = Tmp1(24,2) + 2*inv2expQ*Aux(IP,14) 
     Tmp1(25,2) = Tmp1(25,2) + 2*inv2expQ*Aux(IP,15) 
     Tmp1(26,2) = Tmp1(26,2) + 2*inv2expQ*Aux(IP,16) 
     Tmp1(27,2) = Tmp1(27,2) + inv2expQ*Aux(IP,17) 
     Tmp1(28,2) = Tmp1(28,2) + inv2expQ*Aux(IP,18) 
     Tmp1(29,2) = Tmp1(29,2) + inv2expQ*Aux(IP,19) 
     Tmp1(30,2) = Tmp1(30,2) + inv2expQ*Aux(IP,20) 
     Tmp1(36,2) = Tmp1(36,2) + 5*inv2expQ*Aux(IP,21) 
     Tmp1(37,2) = Tmp1(37,2) + 4*inv2expQ*Aux(IP,22) 
     Tmp1(38,2) = Tmp1(38,2) + 4*inv2expQ*Aux(IP,23) 
     Tmp1(39,2) = Tmp1(39,2) + 3*inv2expQ*Aux(IP,24) 
     Tmp1(40,2) = Tmp1(40,2) + 3*inv2expQ*Aux(IP,25) 
     Tmp1(41,2) = Tmp1(41,2) + 3*inv2expQ*Aux(IP,26) 
     Tmp1(42,2) = Tmp1(42,2) + 2*inv2expQ*Aux(IP,27) 
     Tmp1(43,2) = Tmp1(43,2) + 2*inv2expQ*Aux(IP,28) 
     Tmp1(44,2) = Tmp1(44,2) + 2*inv2expQ*Aux(IP,29) 
     Tmp1(45,2) = Tmp1(45,2) + 2*inv2expQ*Aux(IP,30) 
     Tmp1(46,2) = Tmp1(46,2) + inv2expQ*Aux(IP,31) 
     Tmp1(47,2) = Tmp1(47,2) + inv2expQ*Aux(IP,32) 
     Tmp1(48,2) = Tmp1(48,2) + inv2expQ*Aux(IP,33) 
     Tmp1(49,2) = Tmp1(49,2) + inv2expQ*Aux(IP,34) 
     Tmp1(50,2) = Tmp1(50,2) + inv2expQ*Aux(IP,35) 
     Tmp1(22,3) = Tmp1(22,3) + inv2expQ*Aux(IP,11) 
     Tmp1(24,3) = Tmp1(24,3) + 2*inv2expQ*Aux(IP,12) 
     Tmp1(25,3) = Tmp1(25,3) + inv2expQ*Aux(IP,13) 
     Tmp1(27,3) = Tmp1(27,3) + 3*inv2expQ*Aux(IP,14) 
     Tmp1(28,3) = Tmp1(28,3) + 2*inv2expQ*Aux(IP,15) 
     Tmp1(29,3) = Tmp1(29,3) + inv2expQ*Aux(IP,16) 
     Tmp1(31,3) = Tmp1(31,3) + 4*inv2expQ*Aux(IP,17) 
     Tmp1(32,3) = Tmp1(32,3) + 3*inv2expQ*Aux(IP,18) 
     Tmp1(33,3) = Tmp1(33,3) + 2*inv2expQ*Aux(IP,19) 
     Tmp1(34,3) = Tmp1(34,3) + inv2expQ*Aux(IP,20) 
     Tmp1(37,3) = Tmp1(37,3) + inv2expQ*Aux(IP,21) 
     Tmp1(39,3) = Tmp1(39,3) + 2*inv2expQ*Aux(IP,22) 
     Tmp1(40,3) = Tmp1(40,3) + inv2expQ*Aux(IP,23) 
     Tmp1(42,3) = Tmp1(42,3) + 3*inv2expQ*Aux(IP,24) 
     Tmp1(43,3) = Tmp1(43,3) + 2*inv2expQ*Aux(IP,25) 
     Tmp1(44,3) = Tmp1(44,3) + inv2expQ*Aux(IP,26) 
     Tmp1(46,3) = Tmp1(46,3) + 4*inv2expQ*Aux(IP,27) 
     Tmp1(47,3) = Tmp1(47,3) + 3*inv2expQ*Aux(IP,28) 
     Tmp1(48,3) = Tmp1(48,3) + 2*inv2expQ*Aux(IP,29) 
     Tmp1(49,3) = Tmp1(49,3) + inv2expQ*Aux(IP,30) 
     Tmp1(51,3) = Tmp1(51,3) + 5*inv2expQ*Aux(IP,31) 
     Tmp1(52,3) = Tmp1(52,3) + 4*inv2expQ*Aux(IP,32) 
     Tmp1(53,3) = Tmp1(53,3) + 3*inv2expQ*Aux(IP,33) 
     Tmp1(54,3) = Tmp1(54,3) + 2*inv2expQ*Aux(IP,34) 
     Tmp1(55,3) = Tmp1(55,3) + inv2expQ*Aux(IP,35) 
     Tmp1(23,4) = Tmp1(23,4) + inv2expQ*Aux(IP,11) 
     Tmp1(25,4) = Tmp1(25,4) + inv2expQ*Aux(IP,12) 
     Tmp1(26,4) = Tmp1(26,4) + 2*inv2expQ*Aux(IP,13) 
     Tmp1(28,4) = Tmp1(28,4) + inv2expQ*Aux(IP,14) 
     Tmp1(29,4) = Tmp1(29,4) + 2*inv2expQ*Aux(IP,15) 
     Tmp1(30,4) = Tmp1(30,4) + 3*inv2expQ*Aux(IP,16) 
     Tmp1(32,4) = Tmp1(32,4) + inv2expQ*Aux(IP,17) 
     Tmp1(33,4) = Tmp1(33,4) + 2*inv2expQ*Aux(IP,18) 
     Tmp1(34,4) = Tmp1(34,4) + 3*inv2expQ*Aux(IP,19) 
     Tmp1(35,4) = Tmp1(35,4) + 4*inv2expQ*Aux(IP,20) 
     Tmp1(38,4) = Tmp1(38,4) + inv2expQ*Aux(IP,21) 
     Tmp1(40,4) = Tmp1(40,4) + inv2expQ*Aux(IP,22) 
     Tmp1(41,4) = Tmp1(41,4) + 2*inv2expQ*Aux(IP,23) 
     Tmp1(43,4) = Tmp1(43,4) + inv2expQ*Aux(IP,24) 
     Tmp1(44,4) = Tmp1(44,4) + 2*inv2expQ*Aux(IP,25) 
     Tmp1(45,4) = Tmp1(45,4) + 3*inv2expQ*Aux(IP,26) 
     Tmp1(47,4) = Tmp1(47,4) + inv2expQ*Aux(IP,27) 
     Tmp1(48,4) = Tmp1(48,4) + 2*inv2expQ*Aux(IP,28) 
     Tmp1(49,4) = Tmp1(49,4) + 3*inv2expQ*Aux(IP,29) 
     Tmp1(50,4) = Tmp1(50,4) + 4*inv2expQ*Aux(IP,30) 
     Tmp1(52,4) = Tmp1(52,4) + inv2expQ*Aux(IP,31) 
     Tmp1(53,4) = Tmp1(53,4) + 2*inv2expQ*Aux(IP,32) 
     Tmp1(54,4) = Tmp1(54,4) + 3*inv2expQ*Aux(IP,33) 
     Tmp1(55,4) = Tmp1(55,4) + 4*inv2expQ*Aux(IP,34) 
     Tmp1(56,4) = Tmp1(56,4) + 5*inv2expQ*Aux(IP,35) 
     Tmp0(1,2) = Tmp0(1,2) + pinvq*Aux(IP,2)
     Tmp0(2,2) = Tmp0(2,2) + pinvq*Aux(IP,5)
     Tmp0(3,2) = Tmp0(3,2) + pinvq*Aux(IP,6)
     Tmp0(4,2) = Tmp0(4,2) + pinvq*Aux(IP,7)
     Tmp0(5,2) = Tmp0(5,2) + pinvq*Aux(IP,11)
     Tmp0(6,2) = Tmp0(6,2) + pinvq*Aux(IP,12)
     Tmp0(7,2) = Tmp0(7,2) + pinvq*Aux(IP,13)
     Tmp0(8,2) = Tmp0(8,2) + pinvq*Aux(IP,14)
     Tmp0(9,2) = Tmp0(9,2) + pinvq*Aux(IP,15)
     Tmp0(10,2) = Tmp0(10,2) + pinvq*Aux(IP,16)
     Tmp0(11,2) = Tmp0(11,2) + pinvq*Aux(IP,21)
     Tmp0(12,2) = Tmp0(12,2) + pinvq*Aux(IP,22)
     Tmp0(13,2) = Tmp0(13,2) + pinvq*Aux(IP,23)
     Tmp0(14,2) = Tmp0(14,2) + pinvq*Aux(IP,24)
     Tmp0(15,2) = Tmp0(15,2) + pinvq*Aux(IP,25)
     Tmp0(16,2) = Tmp0(16,2) + pinvq*Aux(IP,26)
     Tmp0(17,2) = Tmp0(17,2) + pinvq*Aux(IP,27)
     Tmp0(18,2) = Tmp0(18,2) + pinvq*Aux(IP,28)
     Tmp0(19,2) = Tmp0(19,2) + pinvq*Aux(IP,29)
     Tmp0(20,2) = Tmp0(20,2) + pinvq*Aux(IP,30)
     Tmp1(21,2) = Tmp1(21,2) + pinvq*Aux(IP,36)
     Tmp1(22,2) = Tmp1(22,2) + pinvq*Aux(IP,37)
     Tmp1(23,2) = Tmp1(23,2) + pinvq*Aux(IP,38)
     Tmp1(24,2) = Tmp1(24,2) + pinvq*Aux(IP,39)
     Tmp1(25,2) = Tmp1(25,2) + pinvq*Aux(IP,40)
     Tmp1(26,2) = Tmp1(26,2) + pinvq*Aux(IP,41)
     Tmp1(27,2) = Tmp1(27,2) + pinvq*Aux(IP,42)
     Tmp1(28,2) = Tmp1(28,2) + pinvq*Aux(IP,43)
     Tmp1(29,2) = Tmp1(29,2) + pinvq*Aux(IP,44)
     Tmp1(30,2) = Tmp1(30,2) + pinvq*Aux(IP,45)
     Tmp1(31,2) = Tmp1(31,2) + pinvq*Aux(IP,46)
     Tmp1(32,2) = Tmp1(32,2) + pinvq*Aux(IP,47)
     Tmp1(33,2) = Tmp1(33,2) + pinvq*Aux(IP,48)
     Tmp1(34,2) = Tmp1(34,2) + pinvq*Aux(IP,49)
     Tmp1(35,2) = Tmp1(35,2) + pinvq*Aux(IP,50)
     Tmp1(36,2) = Tmp1(36,2) + pinvq*Aux(IP,57)
     Tmp1(37,2) = Tmp1(37,2) + pinvq*Aux(IP,58)
     Tmp1(38,2) = Tmp1(38,2) + pinvq*Aux(IP,59)
     Tmp1(39,2) = Tmp1(39,2) + pinvq*Aux(IP,60)
     Tmp1(40,2) = Tmp1(40,2) + pinvq*Aux(IP,61)
     Tmp1(41,2) = Tmp1(41,2) + pinvq*Aux(IP,62)
     Tmp1(42,2) = Tmp1(42,2) + pinvq*Aux(IP,63)
     Tmp1(43,2) = Tmp1(43,2) + pinvq*Aux(IP,64)
     Tmp1(44,2) = Tmp1(44,2) + pinvq*Aux(IP,65)
     Tmp1(45,2) = Tmp1(45,2) + pinvq*Aux(IP,66)
     Tmp1(46,2) = Tmp1(46,2) + pinvq*Aux(IP,67)
     Tmp1(47,2) = Tmp1(47,2) + pinvq*Aux(IP,68)
     Tmp1(48,2) = Tmp1(48,2) + pinvq*Aux(IP,69)
     Tmp1(49,2) = Tmp1(49,2) + pinvq*Aux(IP,70)
     Tmp1(50,2) = Tmp1(50,2) + pinvq*Aux(IP,71)
     Tmp1(51,2) = Tmp1(51,2) + pinvq*Aux(IP,72)
     Tmp1(52,2) = Tmp1(52,2) + pinvq*Aux(IP,73)
     Tmp1(53,2) = Tmp1(53,2) + pinvq*Aux(IP,74)
     Tmp1(54,2) = Tmp1(54,2) + pinvq*Aux(IP,75)
     Tmp1(55,2) = Tmp1(55,2) + pinvq*Aux(IP,76)
     Tmp1(56,2) = Tmp1(56,2) + pinvq*Aux(IP,77)
     Tmp0(1,3) = Tmp0(1,3) + pinvq*Aux(IP,3)
     Tmp0(2,3) = Tmp0(2,3) + pinvq*Aux(IP,6)
     Tmp0(3,3) = Tmp0(3,3) + pinvq*Aux(IP,8)
     Tmp0(4,3) = Tmp0(4,3) + pinvq*Aux(IP,9)
     Tmp0(5,3) = Tmp0(5,3) + pinvq*Aux(IP,12)
     Tmp0(6,3) = Tmp0(6,3) + pinvq*Aux(IP,14)
     Tmp0(7,3) = Tmp0(7,3) + pinvq*Aux(IP,15)
     Tmp0(8,3) = Tmp0(8,3) + pinvq*Aux(IP,17)
     Tmp0(9,3) = Tmp0(9,3) + pinvq*Aux(IP,18)
     Tmp0(10,3) = Tmp0(10,3) + pinvq*Aux(IP,19)
     Tmp0(11,3) = Tmp0(11,3) + pinvq*Aux(IP,22)
     Tmp0(12,3) = Tmp0(12,3) + pinvq*Aux(IP,24)
     Tmp0(13,3) = Tmp0(13,3) + pinvq*Aux(IP,25)
     Tmp0(14,3) = Tmp0(14,3) + pinvq*Aux(IP,27)
     Tmp0(15,3) = Tmp0(15,3) + pinvq*Aux(IP,28)
     Tmp0(16,3) = Tmp0(16,3) + pinvq*Aux(IP,29)
     Tmp0(17,3) = Tmp0(17,3) + pinvq*Aux(IP,31)
     Tmp0(18,3) = Tmp0(18,3) + pinvq*Aux(IP,32)
     Tmp0(19,3) = Tmp0(19,3) + pinvq*Aux(IP,33)
     Tmp0(20,3) = Tmp0(20,3) + pinvq*Aux(IP,34)
     Tmp1(21,3) = Tmp1(21,3) + pinvq*Aux(IP,37)
     Tmp1(22,3) = Tmp1(22,3) + pinvq*Aux(IP,39)
     Tmp1(23,3) = Tmp1(23,3) + pinvq*Aux(IP,40)
     Tmp1(24,3) = Tmp1(24,3) + pinvq*Aux(IP,42)
     Tmp1(25,3) = Tmp1(25,3) + pinvq*Aux(IP,43)
     Tmp1(26,3) = Tmp1(26,3) + pinvq*Aux(IP,44)
     Tmp1(27,3) = Tmp1(27,3) + pinvq*Aux(IP,46)
     Tmp1(28,3) = Tmp1(28,3) + pinvq*Aux(IP,47)
     Tmp1(29,3) = Tmp1(29,3) + pinvq*Aux(IP,48)
     Tmp1(30,3) = Tmp1(30,3) + pinvq*Aux(IP,49)
     Tmp1(31,3) = Tmp1(31,3) + pinvq*Aux(IP,51)
     Tmp1(32,3) = Tmp1(32,3) + pinvq*Aux(IP,52)
     Tmp1(33,3) = Tmp1(33,3) + pinvq*Aux(IP,53)
     Tmp1(34,3) = Tmp1(34,3) + pinvq*Aux(IP,54)
     Tmp1(35,3) = Tmp1(35,3) + pinvq*Aux(IP,55)
     Tmp1(36,3) = Tmp1(36,3) + pinvq*Aux(IP,58)
     Tmp1(37,3) = Tmp1(37,3) + pinvq*Aux(IP,60)
     Tmp1(38,3) = Tmp1(38,3) + pinvq*Aux(IP,61)
     Tmp1(39,3) = Tmp1(39,3) + pinvq*Aux(IP,63)
     Tmp1(40,3) = Tmp1(40,3) + pinvq*Aux(IP,64)
     Tmp1(41,3) = Tmp1(41,3) + pinvq*Aux(IP,65)
     Tmp1(42,3) = Tmp1(42,3) + pinvq*Aux(IP,67)
     Tmp1(43,3) = Tmp1(43,3) + pinvq*Aux(IP,68)
     Tmp1(44,3) = Tmp1(44,3) + pinvq*Aux(IP,69)
     Tmp1(45,3) = Tmp1(45,3) + pinvq*Aux(IP,70)
     Tmp1(46,3) = Tmp1(46,3) + pinvq*Aux(IP,72)
     Tmp1(47,3) = Tmp1(47,3) + pinvq*Aux(IP,73)
     Tmp1(48,3) = Tmp1(48,3) + pinvq*Aux(IP,74)
     Tmp1(49,3) = Tmp1(49,3) + pinvq*Aux(IP,75)
     Tmp1(50,3) = Tmp1(50,3) + pinvq*Aux(IP,76)
     Tmp1(51,3) = Tmp1(51,3) + pinvq*Aux(IP,78)
     Tmp1(52,3) = Tmp1(52,3) + pinvq*Aux(IP,79)
     Tmp1(53,3) = Tmp1(53,3) + pinvq*Aux(IP,80)
     Tmp1(54,3) = Tmp1(54,3) + pinvq*Aux(IP,81)
     Tmp1(55,3) = Tmp1(55,3) + pinvq*Aux(IP,82)
     Tmp1(56,3) = Tmp1(56,3) + pinvq*Aux(IP,83)
     Tmp0(1,4) = Tmp0(1,4) + pinvq*Aux(IP,4)
     Tmp0(2,4) = Tmp0(2,4) + pinvq*Aux(IP,7)
     Tmp0(3,4) = Tmp0(3,4) + pinvq*Aux(IP,9)
     Tmp0(4,4) = Tmp0(4,4) + pinvq*Aux(IP,10)
     Tmp0(5,4) = Tmp0(5,4) + pinvq*Aux(IP,13)
     Tmp0(6,4) = Tmp0(6,4) + pinvq*Aux(IP,15)
     Tmp0(7,4) = Tmp0(7,4) + pinvq*Aux(IP,16)
     Tmp0(8,4) = Tmp0(8,4) + pinvq*Aux(IP,18)
     Tmp0(9,4) = Tmp0(9,4) + pinvq*Aux(IP,19)
     Tmp0(10,4) = Tmp0(10,4) + pinvq*Aux(IP,20)
     Tmp0(11,4) = Tmp0(11,4) + pinvq*Aux(IP,23)
     Tmp0(12,4) = Tmp0(12,4) + pinvq*Aux(IP,25)
     Tmp0(13,4) = Tmp0(13,4) + pinvq*Aux(IP,26)
     Tmp0(14,4) = Tmp0(14,4) + pinvq*Aux(IP,28)
     Tmp0(15,4) = Tmp0(15,4) + pinvq*Aux(IP,29)
     Tmp0(16,4) = Tmp0(16,4) + pinvq*Aux(IP,30)
     Tmp0(17,4) = Tmp0(17,4) + pinvq*Aux(IP,32)
     Tmp0(18,4) = Tmp0(18,4) + pinvq*Aux(IP,33)
     Tmp0(19,4) = Tmp0(19,4) + pinvq*Aux(IP,34)
     Tmp0(20,4) = Tmp0(20,4) + pinvq*Aux(IP,35)
     Tmp1(21,4) = Tmp1(21,4) + pinvq*Aux(IP,38)
     Tmp1(22,4) = Tmp1(22,4) + pinvq*Aux(IP,40)
     Tmp1(23,4) = Tmp1(23,4) + pinvq*Aux(IP,41)
     Tmp1(24,4) = Tmp1(24,4) + pinvq*Aux(IP,43)
     Tmp1(25,4) = Tmp1(25,4) + pinvq*Aux(IP,44)
     Tmp1(26,4) = Tmp1(26,4) + pinvq*Aux(IP,45)
     Tmp1(27,4) = Tmp1(27,4) + pinvq*Aux(IP,47)
     Tmp1(28,4) = Tmp1(28,4) + pinvq*Aux(IP,48)
     Tmp1(29,4) = Tmp1(29,4) + pinvq*Aux(IP,49)
     Tmp1(30,4) = Tmp1(30,4) + pinvq*Aux(IP,50)
     Tmp1(31,4) = Tmp1(31,4) + pinvq*Aux(IP,52)
     Tmp1(32,4) = Tmp1(32,4) + pinvq*Aux(IP,53)
     Tmp1(33,4) = Tmp1(33,4) + pinvq*Aux(IP,54)
     Tmp1(34,4) = Tmp1(34,4) + pinvq*Aux(IP,55)
     Tmp1(35,4) = Tmp1(35,4) + pinvq*Aux(IP,56)
     Tmp1(36,4) = Tmp1(36,4) + pinvq*Aux(IP,59)
     Tmp1(37,4) = Tmp1(37,4) + pinvq*Aux(IP,61)
     Tmp1(38,4) = Tmp1(38,4) + pinvq*Aux(IP,62)
     Tmp1(39,4) = Tmp1(39,4) + pinvq*Aux(IP,64)
     Tmp1(40,4) = Tmp1(40,4) + pinvq*Aux(IP,65)
     Tmp1(41,4) = Tmp1(41,4) + pinvq*Aux(IP,66)
     Tmp1(42,4) = Tmp1(42,4) + pinvq*Aux(IP,68)
     Tmp1(43,4) = Tmp1(43,4) + pinvq*Aux(IP,69)
     Tmp1(44,4) = Tmp1(44,4) + pinvq*Aux(IP,70)
     Tmp1(45,4) = Tmp1(45,4) + pinvq*Aux(IP,71)
     Tmp1(46,4) = Tmp1(46,4) + pinvq*Aux(IP,73)
     Tmp1(47,4) = Tmp1(47,4) + pinvq*Aux(IP,74)
     Tmp1(48,4) = Tmp1(48,4) + pinvq*Aux(IP,75)
     Tmp1(49,4) = Tmp1(49,4) + pinvq*Aux(IP,76)
     Tmp1(50,4) = Tmp1(50,4) + pinvq*Aux(IP,77)
     Tmp1(51,4) = Tmp1(51,4) + pinvq*Aux(IP,79)
     Tmp1(52,4) = Tmp1(52,4) + pinvq*Aux(IP,80)
     Tmp1(53,4) = Tmp1(53,4) + pinvq*Aux(IP,81)
     Tmp1(54,4) = Tmp1(54,4) + pinvq*Aux(IP,82)
     Tmp1(55,4) = Tmp1(55,4) + pinvq*Aux(IP,83)
     Tmp1(56,4) = Tmp1(56,4) + pinvq*Aux(IP,84)
 ! Building for Angular momentum Jq = 2
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,5) = facX*Tmp0(iTUVP,2)+ inv2expQ*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,6) = facX*Tmp0(iTUVP,3)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,7) = facX*Tmp0(iTUVP,4)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,8) = facY*Tmp0(iTUVP,3)+ inv2expQ*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,9) = facY*Tmp0(iTUVP,4)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,10) = facZ*Tmp0(iTUVP,4)+ inv2expQ*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 35
      Tmp2(iTUVP,5) = facX*Tmp1(iTUVP,2)+ inv2expQ*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 35
      Tmp2(iTUVP,6) = facX*Tmp1(iTUVP,3)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 35
      Tmp2(iTUVP,7) = facX*Tmp1(iTUVP,4)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 35
      Tmp2(iTUVP,8) = facY*Tmp1(iTUVP,3)+ inv2expQ*Aux(IP,iTUVP)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 35
      Tmp2(iTUVP,9) = facY*Tmp1(iTUVP,4)
     enddo
!$ACC LOOP SEQ
     do iTUVP =  21, 35
      Tmp2(iTUVP,10) = facZ*Tmp1(iTUVP,4)+ inv2expQ*Aux(IP,iTUVP)
     enddo
     Tmp0(2,5) = Tmp0(2,5) + inv2expQ*Tmp0(1,2) 
     Tmp0(5,5) = Tmp0(5,5) + 2*inv2expQ*Tmp0(2,2) 
     Tmp0(6,5) = Tmp0(6,5) + inv2expQ*Tmp0(3,2) 
     Tmp0(7,5) = Tmp0(7,5) + inv2expQ*Tmp0(4,2) 
     Tmp0(11,5) = Tmp0(11,5) + 3*inv2expQ*Tmp0(5,2) 
     Tmp0(12,5) = Tmp0(12,5) + 2*inv2expQ*Tmp0(6,2) 
     Tmp0(13,5) = Tmp0(13,5) + 2*inv2expQ*Tmp0(7,2) 
     Tmp0(14,5) = Tmp0(14,5) + inv2expQ*Tmp0(8,2) 
     Tmp0(15,5) = Tmp0(15,5) + inv2expQ*Tmp0(9,2) 
     Tmp0(16,5) = Tmp0(16,5) + inv2expQ*Tmp0(10,2) 
     Tmp0(2,6) = Tmp0(2,6) + inv2expQ*Tmp0(1,3) 
     Tmp0(5,6) = Tmp0(5,6) + 2*inv2expQ*Tmp0(2,3) 
     Tmp0(6,6) = Tmp0(6,6) + inv2expQ*Tmp0(3,3) 
     Tmp0(7,6) = Tmp0(7,6) + inv2expQ*Tmp0(4,3) 
     Tmp0(11,6) = Tmp0(11,6) + 3*inv2expQ*Tmp0(5,3) 
     Tmp0(12,6) = Tmp0(12,6) + 2*inv2expQ*Tmp0(6,3) 
     Tmp0(13,6) = Tmp0(13,6) + 2*inv2expQ*Tmp0(7,3) 
     Tmp0(14,6) = Tmp0(14,6) + inv2expQ*Tmp0(8,3) 
     Tmp0(15,6) = Tmp0(15,6) + inv2expQ*Tmp0(9,3) 
     Tmp0(16,6) = Tmp0(16,6) + inv2expQ*Tmp0(10,3) 
     Tmp0(2,7) = Tmp0(2,7) + inv2expQ*Tmp0(1,4) 
     Tmp0(5,7) = Tmp0(5,7) + 2*inv2expQ*Tmp0(2,4) 
     Tmp0(6,7) = Tmp0(6,7) + inv2expQ*Tmp0(3,4) 
     Tmp0(7,7) = Tmp0(7,7) + inv2expQ*Tmp0(4,4) 
     Tmp0(11,7) = Tmp0(11,7) + 3*inv2expQ*Tmp0(5,4) 
     Tmp0(12,7) = Tmp0(12,7) + 2*inv2expQ*Tmp0(6,4) 
     Tmp0(13,7) = Tmp0(13,7) + 2*inv2expQ*Tmp0(7,4) 
     Tmp0(14,7) = Tmp0(14,7) + inv2expQ*Tmp0(8,4) 
     Tmp0(15,7) = Tmp0(15,7) + inv2expQ*Tmp0(9,4) 
     Tmp0(16,7) = Tmp0(16,7) + inv2expQ*Tmp0(10,4) 
     Tmp0(3,8) = Tmp0(3,8) + inv2expQ*Tmp0(1,3) 
     Tmp0(6,8) = Tmp0(6,8) + inv2expQ*Tmp0(2,3) 
     Tmp0(8,8) = Tmp0(8,8) + 2*inv2expQ*Tmp0(3,3) 
     Tmp0(9,8) = Tmp0(9,8) + inv2expQ*Tmp0(4,3) 
     Tmp0(12,8) = Tmp0(12,8) + inv2expQ*Tmp0(5,3) 
     Tmp0(14,8) = Tmp0(14,8) + 2*inv2expQ*Tmp0(6,3) 
     Tmp0(15,8) = Tmp0(15,8) + inv2expQ*Tmp0(7,3) 
     Tmp0(17,8) = Tmp0(17,8) + 3*inv2expQ*Tmp0(8,3) 
     Tmp0(18,8) = Tmp0(18,8) + 2*inv2expQ*Tmp0(9,3) 
     Tmp0(19,8) = Tmp0(19,8) + inv2expQ*Tmp0(10,3) 
     Tmp0(3,9) = Tmp0(3,9) + inv2expQ*Tmp0(1,4) 
     Tmp0(6,9) = Tmp0(6,9) + inv2expQ*Tmp0(2,4) 
     Tmp0(8,9) = Tmp0(8,9) + 2*inv2expQ*Tmp0(3,4) 
     Tmp0(9,9) = Tmp0(9,9) + inv2expQ*Tmp0(4,4) 
     Tmp0(12,9) = Tmp0(12,9) + inv2expQ*Tmp0(5,4) 
     Tmp0(14,9) = Tmp0(14,9) + 2*inv2expQ*Tmp0(6,4) 
     Tmp0(15,9) = Tmp0(15,9) + inv2expQ*Tmp0(7,4) 
     Tmp0(17,9) = Tmp0(17,9) + 3*inv2expQ*Tmp0(8,4) 
     Tmp0(18,9) = Tmp0(18,9) + 2*inv2expQ*Tmp0(9,4) 
     Tmp0(19,9) = Tmp0(19,9) + inv2expQ*Tmp0(10,4) 
     Tmp0(4,10) = Tmp0(4,10) + inv2expQ*Tmp0(1,4) 
     Tmp0(7,10) = Tmp0(7,10) + inv2expQ*Tmp0(2,4) 
     Tmp0(9,10) = Tmp0(9,10) + inv2expQ*Tmp0(3,4) 
     Tmp0(10,10) = Tmp0(10,10) + 2*inv2expQ*Tmp0(4,4) 
     Tmp0(13,10) = Tmp0(13,10) + inv2expQ*Tmp0(5,4) 
     Tmp0(15,10) = Tmp0(15,10) + inv2expQ*Tmp0(6,4) 
     Tmp0(16,10) = Tmp0(16,10) + 2*inv2expQ*Tmp0(7,4) 
     Tmp0(18,10) = Tmp0(18,10) + inv2expQ*Tmp0(8,4) 
     Tmp0(19,10) = Tmp0(19,10) + 2*inv2expQ*Tmp0(9,4) 
     Tmp0(20,10) = Tmp0(20,10) + 3*inv2expQ*Tmp0(10,4) 
     Tmp2(21,5) = Tmp2(21,5) + 4*inv2expQ*Tmp0(11,2) 
     Tmp2(22,5) = Tmp2(22,5) + 3*inv2expQ*Tmp0(12,2) 
     Tmp2(23,5) = Tmp2(23,5) + 3*inv2expQ*Tmp0(13,2) 
     Tmp2(24,5) = Tmp2(24,5) + 2*inv2expQ*Tmp0(14,2) 
     Tmp2(25,5) = Tmp2(25,5) + 2*inv2expQ*Tmp0(15,2) 
     Tmp2(26,5) = Tmp2(26,5) + 2*inv2expQ*Tmp0(16,2) 
     Tmp2(27,5) = Tmp2(27,5) + inv2expQ*Tmp0(17,2) 
     Tmp2(28,5) = Tmp2(28,5) + inv2expQ*Tmp0(18,2) 
     Tmp2(29,5) = Tmp2(29,5) + inv2expQ*Tmp0(19,2) 
     Tmp2(30,5) = Tmp2(30,5) + inv2expQ*Tmp0(20,2) 
     Tmp2(21,6) = Tmp2(21,6) + 4*inv2expQ*Tmp0(11,3) 
     Tmp2(22,6) = Tmp2(22,6) + 3*inv2expQ*Tmp0(12,3) 
     Tmp2(23,6) = Tmp2(23,6) + 3*inv2expQ*Tmp0(13,3) 
     Tmp2(24,6) = Tmp2(24,6) + 2*inv2expQ*Tmp0(14,3) 
     Tmp2(25,6) = Tmp2(25,6) + 2*inv2expQ*Tmp0(15,3) 
     Tmp2(26,6) = Tmp2(26,6) + 2*inv2expQ*Tmp0(16,3) 
     Tmp2(27,6) = Tmp2(27,6) + inv2expQ*Tmp0(17,3) 
     Tmp2(28,6) = Tmp2(28,6) + inv2expQ*Tmp0(18,3) 
     Tmp2(29,6) = Tmp2(29,6) + inv2expQ*Tmp0(19,3) 
     Tmp2(30,6) = Tmp2(30,6) + inv2expQ*Tmp0(20,3) 
     Tmp2(21,7) = Tmp2(21,7) + 4*inv2expQ*Tmp0(11,4) 
     Tmp2(22,7) = Tmp2(22,7) + 3*inv2expQ*Tmp0(12,4) 
     Tmp2(23,7) = Tmp2(23,7) + 3*inv2expQ*Tmp0(13,4) 
     Tmp2(24,7) = Tmp2(24,7) + 2*inv2expQ*Tmp0(14,4) 
     Tmp2(25,7) = Tmp2(25,7) + 2*inv2expQ*Tmp0(15,4) 
     Tmp2(26,7) = Tmp2(26,7) + 2*inv2expQ*Tmp0(16,4) 
     Tmp2(27,7) = Tmp2(27,7) + inv2expQ*Tmp0(17,4) 
     Tmp2(28,7) = Tmp2(28,7) + inv2expQ*Tmp0(18,4) 
     Tmp2(29,7) = Tmp2(29,7) + inv2expQ*Tmp0(19,4) 
     Tmp2(30,7) = Tmp2(30,7) + inv2expQ*Tmp0(20,4) 
     Tmp2(22,8) = Tmp2(22,8) + inv2expQ*Tmp0(11,3) 
     Tmp2(24,8) = Tmp2(24,8) + 2*inv2expQ*Tmp0(12,3) 
     Tmp2(25,8) = Tmp2(25,8) + inv2expQ*Tmp0(13,3) 
     Tmp2(27,8) = Tmp2(27,8) + 3*inv2expQ*Tmp0(14,3) 
     Tmp2(28,8) = Tmp2(28,8) + 2*inv2expQ*Tmp0(15,3) 
     Tmp2(29,8) = Tmp2(29,8) + inv2expQ*Tmp0(16,3) 
     Tmp2(31,8) = Tmp2(31,8) + 4*inv2expQ*Tmp0(17,3) 
     Tmp2(32,8) = Tmp2(32,8) + 3*inv2expQ*Tmp0(18,3) 
     Tmp2(33,8) = Tmp2(33,8) + 2*inv2expQ*Tmp0(19,3) 
     Tmp2(34,8) = Tmp2(34,8) + inv2expQ*Tmp0(20,3) 
     Tmp2(22,9) = Tmp2(22,9) + inv2expQ*Tmp0(11,4) 
     Tmp2(24,9) = Tmp2(24,9) + 2*inv2expQ*Tmp0(12,4) 
     Tmp2(25,9) = Tmp2(25,9) + inv2expQ*Tmp0(13,4) 
     Tmp2(27,9) = Tmp2(27,9) + 3*inv2expQ*Tmp0(14,4) 
     Tmp2(28,9) = Tmp2(28,9) + 2*inv2expQ*Tmp0(15,4) 
     Tmp2(29,9) = Tmp2(29,9) + inv2expQ*Tmp0(16,4) 
     Tmp2(31,9) = Tmp2(31,9) + 4*inv2expQ*Tmp0(17,4) 
     Tmp2(32,9) = Tmp2(32,9) + 3*inv2expQ*Tmp0(18,4) 
     Tmp2(33,9) = Tmp2(33,9) + 2*inv2expQ*Tmp0(19,4) 
     Tmp2(34,9) = Tmp2(34,9) + inv2expQ*Tmp0(20,4) 
     Tmp2(23,10) = Tmp2(23,10) + inv2expQ*Tmp0(11,4) 
     Tmp2(25,10) = Tmp2(25,10) + inv2expQ*Tmp0(12,4) 
     Tmp2(26,10) = Tmp2(26,10) + 2*inv2expQ*Tmp0(13,4) 
     Tmp2(28,10) = Tmp2(28,10) + inv2expQ*Tmp0(14,4) 
     Tmp2(29,10) = Tmp2(29,10) + 2*inv2expQ*Tmp0(15,4) 
     Tmp2(30,10) = Tmp2(30,10) + 3*inv2expQ*Tmp0(16,4) 
     Tmp2(32,10) = Tmp2(32,10) + inv2expQ*Tmp0(17,4) 
     Tmp2(33,10) = Tmp2(33,10) + 2*inv2expQ*Tmp0(18,4) 
     Tmp2(34,10) = Tmp2(34,10) + 3*inv2expQ*Tmp0(19,4) 
     Tmp2(35,10) = Tmp2(35,10) + 4*inv2expQ*Tmp0(20,4) 
     Tmp0(1,5) = Tmp0(1,5) + pinvq*Tmp0(2,2)
     Tmp0(2,5) = Tmp0(2,5) + pinvq*Tmp0(5,2)
     Tmp0(3,5) = Tmp0(3,5) + pinvq*Tmp0(6,2)
     Tmp0(4,5) = Tmp0(4,5) + pinvq*Tmp0(7,2)
     Tmp0(5,5) = Tmp0(5,5) + pinvq*Tmp0(11,2)
     Tmp0(6,5) = Tmp0(6,5) + pinvq*Tmp0(12,2)
     Tmp0(7,5) = Tmp0(7,5) + pinvq*Tmp0(13,2)
     Tmp0(8,5) = Tmp0(8,5) + pinvq*Tmp0(14,2)
     Tmp0(9,5) = Tmp0(9,5) + pinvq*Tmp0(15,2)
     Tmp0(10,5) = Tmp0(10,5) + pinvq*Tmp0(16,2)
     Tmp0(11,5) = Tmp0(11,5) + pinvq*Tmp1(21,2)
     Tmp0(12,5) = Tmp0(12,5) + pinvq*Tmp1(22,2)
     Tmp0(13,5) = Tmp0(13,5) + pinvq*Tmp1(23,2)
     Tmp0(14,5) = Tmp0(14,5) + pinvq*Tmp1(24,2)
     Tmp0(15,5) = Tmp0(15,5) + pinvq*Tmp1(25,2)
     Tmp0(16,5) = Tmp0(16,5) + pinvq*Tmp1(26,2)
     Tmp0(17,5) = Tmp0(17,5) + pinvq*Tmp1(27,2)
     Tmp0(18,5) = Tmp0(18,5) + pinvq*Tmp1(28,2)
     Tmp0(19,5) = Tmp0(19,5) + pinvq*Tmp1(29,2)
     Tmp0(20,5) = Tmp0(20,5) + pinvq*Tmp1(30,2)
     Tmp2(21,5) = Tmp2(21,5) + pinvq*Tmp1(36,2)
     Tmp2(22,5) = Tmp2(22,5) + pinvq*Tmp1(37,2)
     Tmp2(23,5) = Tmp2(23,5) + pinvq*Tmp1(38,2)
     Tmp2(24,5) = Tmp2(24,5) + pinvq*Tmp1(39,2)
     Tmp2(25,5) = Tmp2(25,5) + pinvq*Tmp1(40,2)
     Tmp2(26,5) = Tmp2(26,5) + pinvq*Tmp1(41,2)
     Tmp2(27,5) = Tmp2(27,5) + pinvq*Tmp1(42,2)
     Tmp2(28,5) = Tmp2(28,5) + pinvq*Tmp1(43,2)
     Tmp2(29,5) = Tmp2(29,5) + pinvq*Tmp1(44,2)
     Tmp2(30,5) = Tmp2(30,5) + pinvq*Tmp1(45,2)
     Tmp2(31,5) = Tmp2(31,5) + pinvq*Tmp1(46,2)
     Tmp2(32,5) = Tmp2(32,5) + pinvq*Tmp1(47,2)
     Tmp2(33,5) = Tmp2(33,5) + pinvq*Tmp1(48,2)
     Tmp2(34,5) = Tmp2(34,5) + pinvq*Tmp1(49,2)
     Tmp2(35,5) = Tmp2(35,5) + pinvq*Tmp1(50,2)
     Tmp0(1,6) = Tmp0(1,6) + pinvq*Tmp0(2,3)
     Tmp0(2,6) = Tmp0(2,6) + pinvq*Tmp0(5,3)
     Tmp0(3,6) = Tmp0(3,6) + pinvq*Tmp0(6,3)
     Tmp0(4,6) = Tmp0(4,6) + pinvq*Tmp0(7,3)
     Tmp0(5,6) = Tmp0(5,6) + pinvq*Tmp0(11,3)
     Tmp0(6,6) = Tmp0(6,6) + pinvq*Tmp0(12,3)
     Tmp0(7,6) = Tmp0(7,6) + pinvq*Tmp0(13,3)
     Tmp0(8,6) = Tmp0(8,6) + pinvq*Tmp0(14,3)
     Tmp0(9,6) = Tmp0(9,6) + pinvq*Tmp0(15,3)
     Tmp0(10,6) = Tmp0(10,6) + pinvq*Tmp0(16,3)
     Tmp0(11,6) = Tmp0(11,6) + pinvq*Tmp1(21,3)
     Tmp0(12,6) = Tmp0(12,6) + pinvq*Tmp1(22,3)
     Tmp0(13,6) = Tmp0(13,6) + pinvq*Tmp1(23,3)
     Tmp0(14,6) = Tmp0(14,6) + pinvq*Tmp1(24,3)
     Tmp0(15,6) = Tmp0(15,6) + pinvq*Tmp1(25,3)
     Tmp0(16,6) = Tmp0(16,6) + pinvq*Tmp1(26,3)
     Tmp0(17,6) = Tmp0(17,6) + pinvq*Tmp1(27,3)
     Tmp0(18,6) = Tmp0(18,6) + pinvq*Tmp1(28,3)
     Tmp0(19,6) = Tmp0(19,6) + pinvq*Tmp1(29,3)
     Tmp0(20,6) = Tmp0(20,6) + pinvq*Tmp1(30,3)
     Tmp2(21,6) = Tmp2(21,6) + pinvq*Tmp1(36,3)
     Tmp2(22,6) = Tmp2(22,6) + pinvq*Tmp1(37,3)
     Tmp2(23,6) = Tmp2(23,6) + pinvq*Tmp1(38,3)
     Tmp2(24,6) = Tmp2(24,6) + pinvq*Tmp1(39,3)
     Tmp2(25,6) = Tmp2(25,6) + pinvq*Tmp1(40,3)
     Tmp2(26,6) = Tmp2(26,6) + pinvq*Tmp1(41,3)
     Tmp2(27,6) = Tmp2(27,6) + pinvq*Tmp1(42,3)
     Tmp2(28,6) = Tmp2(28,6) + pinvq*Tmp1(43,3)
     Tmp2(29,6) = Tmp2(29,6) + pinvq*Tmp1(44,3)
     Tmp2(30,6) = Tmp2(30,6) + pinvq*Tmp1(45,3)
     Tmp2(31,6) = Tmp2(31,6) + pinvq*Tmp1(46,3)
     Tmp2(32,6) = Tmp2(32,6) + pinvq*Tmp1(47,3)
     Tmp2(33,6) = Tmp2(33,6) + pinvq*Tmp1(48,3)
     Tmp2(34,6) = Tmp2(34,6) + pinvq*Tmp1(49,3)
     Tmp2(35,6) = Tmp2(35,6) + pinvq*Tmp1(50,3)
     Tmp0(1,7) = Tmp0(1,7) + pinvq*Tmp0(2,4)
     Tmp0(2,7) = Tmp0(2,7) + pinvq*Tmp0(5,4)
     Tmp0(3,7) = Tmp0(3,7) + pinvq*Tmp0(6,4)
     Tmp0(4,7) = Tmp0(4,7) + pinvq*Tmp0(7,4)
     Tmp0(5,7) = Tmp0(5,7) + pinvq*Tmp0(11,4)
     Tmp0(6,7) = Tmp0(6,7) + pinvq*Tmp0(12,4)
     Tmp0(7,7) = Tmp0(7,7) + pinvq*Tmp0(13,4)
     Tmp0(8,7) = Tmp0(8,7) + pinvq*Tmp0(14,4)
     Tmp0(9,7) = Tmp0(9,7) + pinvq*Tmp0(15,4)
     Tmp0(10,7) = Tmp0(10,7) + pinvq*Tmp0(16,4)
     Tmp0(11,7) = Tmp0(11,7) + pinvq*Tmp1(21,4)
     Tmp0(12,7) = Tmp0(12,7) + pinvq*Tmp1(22,4)
     Tmp0(13,7) = Tmp0(13,7) + pinvq*Tmp1(23,4)
     Tmp0(14,7) = Tmp0(14,7) + pinvq*Tmp1(24,4)
     Tmp0(15,7) = Tmp0(15,7) + pinvq*Tmp1(25,4)
     Tmp0(16,7) = Tmp0(16,7) + pinvq*Tmp1(26,4)
     Tmp0(17,7) = Tmp0(17,7) + pinvq*Tmp1(27,4)
     Tmp0(18,7) = Tmp0(18,7) + pinvq*Tmp1(28,4)
     Tmp0(19,7) = Tmp0(19,7) + pinvq*Tmp1(29,4)
     Tmp0(20,7) = Tmp0(20,7) + pinvq*Tmp1(30,4)
     Tmp2(21,7) = Tmp2(21,7) + pinvq*Tmp1(36,4)
     Tmp2(22,7) = Tmp2(22,7) + pinvq*Tmp1(37,4)
     Tmp2(23,7) = Tmp2(23,7) + pinvq*Tmp1(38,4)
     Tmp2(24,7) = Tmp2(24,7) + pinvq*Tmp1(39,4)
     Tmp2(25,7) = Tmp2(25,7) + pinvq*Tmp1(40,4)
     Tmp2(26,7) = Tmp2(26,7) + pinvq*Tmp1(41,4)
     Tmp2(27,7) = Tmp2(27,7) + pinvq*Tmp1(42,4)
     Tmp2(28,7) = Tmp2(28,7) + pinvq*Tmp1(43,4)
     Tmp2(29,7) = Tmp2(29,7) + pinvq*Tmp1(44,4)
     Tmp2(30,7) = Tmp2(30,7) + pinvq*Tmp1(45,4)
     Tmp2(31,7) = Tmp2(31,7) + pinvq*Tmp1(46,4)
     Tmp2(32,7) = Tmp2(32,7) + pinvq*Tmp1(47,4)
     Tmp2(33,7) = Tmp2(33,7) + pinvq*Tmp1(48,4)
     Tmp2(34,7) = Tmp2(34,7) + pinvq*Tmp1(49,4)
     Tmp2(35,7) = Tmp2(35,7) + pinvq*Tmp1(50,4)
     Tmp0(1,8) = Tmp0(1,8) + pinvq*Tmp0(3,3)
     Tmp0(2,8) = Tmp0(2,8) + pinvq*Tmp0(6,3)
     Tmp0(3,8) = Tmp0(3,8) + pinvq*Tmp0(8,3)
     Tmp0(4,8) = Tmp0(4,8) + pinvq*Tmp0(9,3)
     Tmp0(5,8) = Tmp0(5,8) + pinvq*Tmp0(12,3)
     Tmp0(6,8) = Tmp0(6,8) + pinvq*Tmp0(14,3)
     Tmp0(7,8) = Tmp0(7,8) + pinvq*Tmp0(15,3)
     Tmp0(8,8) = Tmp0(8,8) + pinvq*Tmp0(17,3)
     Tmp0(9,8) = Tmp0(9,8) + pinvq*Tmp0(18,3)
     Tmp0(10,8) = Tmp0(10,8) + pinvq*Tmp0(19,3)
     Tmp0(11,8) = Tmp0(11,8) + pinvq*Tmp1(22,3)
     Tmp0(12,8) = Tmp0(12,8) + pinvq*Tmp1(24,3)
     Tmp0(13,8) = Tmp0(13,8) + pinvq*Tmp1(25,3)
     Tmp0(14,8) = Tmp0(14,8) + pinvq*Tmp1(27,3)
     Tmp0(15,8) = Tmp0(15,8) + pinvq*Tmp1(28,3)
     Tmp0(16,8) = Tmp0(16,8) + pinvq*Tmp1(29,3)
     Tmp0(17,8) = Tmp0(17,8) + pinvq*Tmp1(31,3)
     Tmp0(18,8) = Tmp0(18,8) + pinvq*Tmp1(32,3)
     Tmp0(19,8) = Tmp0(19,8) + pinvq*Tmp1(33,3)
     Tmp0(20,8) = Tmp0(20,8) + pinvq*Tmp1(34,3)
     Tmp2(21,8) = Tmp2(21,8) + pinvq*Tmp1(37,3)
     Tmp2(22,8) = Tmp2(22,8) + pinvq*Tmp1(39,3)
     Tmp2(23,8) = Tmp2(23,8) + pinvq*Tmp1(40,3)
     Tmp2(24,8) = Tmp2(24,8) + pinvq*Tmp1(42,3)
     Tmp2(25,8) = Tmp2(25,8) + pinvq*Tmp1(43,3)
     Tmp2(26,8) = Tmp2(26,8) + pinvq*Tmp1(44,3)
     Tmp2(27,8) = Tmp2(27,8) + pinvq*Tmp1(46,3)
     Tmp2(28,8) = Tmp2(28,8) + pinvq*Tmp1(47,3)
     Tmp2(29,8) = Tmp2(29,8) + pinvq*Tmp1(48,3)
     Tmp2(30,8) = Tmp2(30,8) + pinvq*Tmp1(49,3)
     Tmp2(31,8) = Tmp2(31,8) + pinvq*Tmp1(51,3)
     Tmp2(32,8) = Tmp2(32,8) + pinvq*Tmp1(52,3)
     Tmp2(33,8) = Tmp2(33,8) + pinvq*Tmp1(53,3)
     Tmp2(34,8) = Tmp2(34,8) + pinvq*Tmp1(54,3)
     Tmp2(35,8) = Tmp2(35,8) + pinvq*Tmp1(55,3)
     Tmp0(1,9) = Tmp0(1,9) + pinvq*Tmp0(3,4)
     Tmp0(2,9) = Tmp0(2,9) + pinvq*Tmp0(6,4)
     Tmp0(3,9) = Tmp0(3,9) + pinvq*Tmp0(8,4)
     Tmp0(4,9) = Tmp0(4,9) + pinvq*Tmp0(9,4)
     Tmp0(5,9) = Tmp0(5,9) + pinvq*Tmp0(12,4)
     Tmp0(6,9) = Tmp0(6,9) + pinvq*Tmp0(14,4)
     Tmp0(7,9) = Tmp0(7,9) + pinvq*Tmp0(15,4)
     Tmp0(8,9) = Tmp0(8,9) + pinvq*Tmp0(17,4)
     Tmp0(9,9) = Tmp0(9,9) + pinvq*Tmp0(18,4)
     Tmp0(10,9) = Tmp0(10,9) + pinvq*Tmp0(19,4)
     Tmp0(11,9) = Tmp0(11,9) + pinvq*Tmp1(22,4)
     Tmp0(12,9) = Tmp0(12,9) + pinvq*Tmp1(24,4)
     Tmp0(13,9) = Tmp0(13,9) + pinvq*Tmp1(25,4)
     Tmp0(14,9) = Tmp0(14,9) + pinvq*Tmp1(27,4)
     Tmp0(15,9) = Tmp0(15,9) + pinvq*Tmp1(28,4)
     Tmp0(16,9) = Tmp0(16,9) + pinvq*Tmp1(29,4)
     Tmp0(17,9) = Tmp0(17,9) + pinvq*Tmp1(31,4)
     Tmp0(18,9) = Tmp0(18,9) + pinvq*Tmp1(32,4)
     Tmp0(19,9) = Tmp0(19,9) + pinvq*Tmp1(33,4)
     Tmp0(20,9) = Tmp0(20,9) + pinvq*Tmp1(34,4)
     Tmp2(21,9) = Tmp2(21,9) + pinvq*Tmp1(37,4)
     Tmp2(22,9) = Tmp2(22,9) + pinvq*Tmp1(39,4)
     Tmp2(23,9) = Tmp2(23,9) + pinvq*Tmp1(40,4)
     Tmp2(24,9) = Tmp2(24,9) + pinvq*Tmp1(42,4)
     Tmp2(25,9) = Tmp2(25,9) + pinvq*Tmp1(43,4)
     Tmp2(26,9) = Tmp2(26,9) + pinvq*Tmp1(44,4)
     Tmp2(27,9) = Tmp2(27,9) + pinvq*Tmp1(46,4)
     Tmp2(28,9) = Tmp2(28,9) + pinvq*Tmp1(47,4)
     Tmp2(29,9) = Tmp2(29,9) + pinvq*Tmp1(48,4)
     Tmp2(30,9) = Tmp2(30,9) + pinvq*Tmp1(49,4)
     Tmp2(31,9) = Tmp2(31,9) + pinvq*Tmp1(51,4)
     Tmp2(32,9) = Tmp2(32,9) + pinvq*Tmp1(52,4)
     Tmp2(33,9) = Tmp2(33,9) + pinvq*Tmp1(53,4)
     Tmp2(34,9) = Tmp2(34,9) + pinvq*Tmp1(54,4)
     Tmp2(35,9) = Tmp2(35,9) + pinvq*Tmp1(55,4)
     Tmp0(1,10) = Tmp0(1,10) + pinvq*Tmp0(4,4)
     Tmp0(2,10) = Tmp0(2,10) + pinvq*Tmp0(7,4)
     Tmp0(3,10) = Tmp0(3,10) + pinvq*Tmp0(9,4)
     Tmp0(4,10) = Tmp0(4,10) + pinvq*Tmp0(10,4)
     Tmp0(5,10) = Tmp0(5,10) + pinvq*Tmp0(13,4)
     Tmp0(6,10) = Tmp0(6,10) + pinvq*Tmp0(15,4)
     Tmp0(7,10) = Tmp0(7,10) + pinvq*Tmp0(16,4)
     Tmp0(8,10) = Tmp0(8,10) + pinvq*Tmp0(18,4)
     Tmp0(9,10) = Tmp0(9,10) + pinvq*Tmp0(19,4)
     Tmp0(10,10) = Tmp0(10,10) + pinvq*Tmp0(20,4)
     Tmp0(11,10) = Tmp0(11,10) + pinvq*Tmp1(23,4)
     Tmp0(12,10) = Tmp0(12,10) + pinvq*Tmp1(25,4)
     Tmp0(13,10) = Tmp0(13,10) + pinvq*Tmp1(26,4)
     Tmp0(14,10) = Tmp0(14,10) + pinvq*Tmp1(28,4)
     Tmp0(15,10) = Tmp0(15,10) + pinvq*Tmp1(29,4)
     Tmp0(16,10) = Tmp0(16,10) + pinvq*Tmp1(30,4)
     Tmp0(17,10) = Tmp0(17,10) + pinvq*Tmp1(32,4)
     Tmp0(18,10) = Tmp0(18,10) + pinvq*Tmp1(33,4)
     Tmp0(19,10) = Tmp0(19,10) + pinvq*Tmp1(34,4)
     Tmp0(20,10) = Tmp0(20,10) + pinvq*Tmp1(35,4)
     Tmp2(21,10) = Tmp2(21,10) + pinvq*Tmp1(38,4)
     Tmp2(22,10) = Tmp2(22,10) + pinvq*Tmp1(40,4)
     Tmp2(23,10) = Tmp2(23,10) + pinvq*Tmp1(41,4)
     Tmp2(24,10) = Tmp2(24,10) + pinvq*Tmp1(43,4)
     Tmp2(25,10) = Tmp2(25,10) + pinvq*Tmp1(44,4)
     Tmp2(26,10) = Tmp2(26,10) + pinvq*Tmp1(45,4)
     Tmp2(27,10) = Tmp2(27,10) + pinvq*Tmp1(47,4)
     Tmp2(28,10) = Tmp2(28,10) + pinvq*Tmp1(48,4)
     Tmp2(29,10) = Tmp2(29,10) + pinvq*Tmp1(49,4)
     Tmp2(30,10) = Tmp2(30,10) + pinvq*Tmp1(50,4)
     Tmp2(31,10) = Tmp2(31,10) + pinvq*Tmp1(52,4)
     Tmp2(32,10) = Tmp2(32,10) + pinvq*Tmp1(53,4)
     Tmp2(33,10) = Tmp2(33,10) + pinvq*Tmp1(54,4)
     Tmp2(34,10) = Tmp2(34,10) + pinvq*Tmp1(55,4)
     Tmp2(35,10) = Tmp2(35,10) + pinvq*Tmp1(56,4)
 ! Building for Angular momentum Jq = 3
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,11) = facX*Tmp0(iTUVP,5)+2*inv2expQ*Tmp0(iTUVP,2)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,12) = facY*Tmp0(iTUVP,5)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,13) = facZ*Tmp0(iTUVP,5)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,14) = facX*Tmp0(iTUVP,8)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,15) = facX*Tmp0(iTUVP,9)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,16) = facX*Tmp0(iTUVP,10)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,17) = facY*Tmp0(iTUVP,8)+2*inv2expQ*Tmp0(iTUVP,3)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,18) = facZ*Tmp0(iTUVP,8)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,19) = facY*Tmp0(iTUVP,10)
     enddo
!$ACC LOOP SEQ
     do iTUVP = 1, 20
      Tmp0(iTUVP,20) = facZ*Tmp0(iTUVP,10)+2*inv2expQ*Tmp0(iTUVP,4)
     enddo
     Tmp0(2,11) = Tmp0(2,11) + inv2expQ*Tmp0(1,5) 
     Tmp0(5,11) = Tmp0(5,11) + 2*inv2expQ*Tmp0(2,5) 
     Tmp0(6,11) = Tmp0(6,11) + inv2expQ*Tmp0(3,5) 
     Tmp0(7,11) = Tmp0(7,11) + inv2expQ*Tmp0(4,5) 
     Tmp0(11,11) = Tmp0(11,11) + 3*inv2expQ*Tmp0(5,5) 
     Tmp0(12,11) = Tmp0(12,11) + 2*inv2expQ*Tmp0(6,5) 
     Tmp0(13,11) = Tmp0(13,11) + 2*inv2expQ*Tmp0(7,5) 
     Tmp0(14,11) = Tmp0(14,11) + inv2expQ*Tmp0(8,5) 
     Tmp0(15,11) = Tmp0(15,11) + inv2expQ*Tmp0(9,5) 
     Tmp0(16,11) = Tmp0(16,11) + inv2expQ*Tmp0(10,5) 
     Tmp0(3,12) = Tmp0(3,12) + inv2expQ*Tmp0(1,5) 
     Tmp0(6,12) = Tmp0(6,12) + inv2expQ*Tmp0(2,5) 
     Tmp0(8,12) = Tmp0(8,12) + 2*inv2expQ*Tmp0(3,5) 
     Tmp0(9,12) = Tmp0(9,12) + inv2expQ*Tmp0(4,5) 
     Tmp0(12,12) = Tmp0(12,12) + inv2expQ*Tmp0(5,5) 
     Tmp0(14,12) = Tmp0(14,12) + 2*inv2expQ*Tmp0(6,5) 
     Tmp0(15,12) = Tmp0(15,12) + inv2expQ*Tmp0(7,5) 
     Tmp0(17,12) = Tmp0(17,12) + 3*inv2expQ*Tmp0(8,5) 
     Tmp0(18,12) = Tmp0(18,12) + 2*inv2expQ*Tmp0(9,5) 
     Tmp0(19,12) = Tmp0(19,12) + inv2expQ*Tmp0(10,5) 
     Tmp0(4,13) = Tmp0(4,13) + inv2expQ*Tmp0(1,5) 
     Tmp0(7,13) = Tmp0(7,13) + inv2expQ*Tmp0(2,5) 
     Tmp0(9,13) = Tmp0(9,13) + inv2expQ*Tmp0(3,5) 
     Tmp0(10,13) = Tmp0(10,13) + 2*inv2expQ*Tmp0(4,5) 
     Tmp0(13,13) = Tmp0(13,13) + inv2expQ*Tmp0(5,5) 
     Tmp0(15,13) = Tmp0(15,13) + inv2expQ*Tmp0(6,5) 
     Tmp0(16,13) = Tmp0(16,13) + 2*inv2expQ*Tmp0(7,5) 
     Tmp0(18,13) = Tmp0(18,13) + inv2expQ*Tmp0(8,5) 
     Tmp0(19,13) = Tmp0(19,13) + 2*inv2expQ*Tmp0(9,5) 
     Tmp0(20,13) = Tmp0(20,13) + 3*inv2expQ*Tmp0(10,5) 
     Tmp0(2,14) = Tmp0(2,14) + inv2expQ*Tmp0(1,8) 
     Tmp0(5,14) = Tmp0(5,14) + 2*inv2expQ*Tmp0(2,8) 
     Tmp0(6,14) = Tmp0(6,14) + inv2expQ*Tmp0(3,8) 
     Tmp0(7,14) = Tmp0(7,14) + inv2expQ*Tmp0(4,8) 
     Tmp0(11,14) = Tmp0(11,14) + 3*inv2expQ*Tmp0(5,8) 
     Tmp0(12,14) = Tmp0(12,14) + 2*inv2expQ*Tmp0(6,8) 
     Tmp0(13,14) = Tmp0(13,14) + 2*inv2expQ*Tmp0(7,8) 
     Tmp0(14,14) = Tmp0(14,14) + inv2expQ*Tmp0(8,8) 
     Tmp0(15,14) = Tmp0(15,14) + inv2expQ*Tmp0(9,8) 
     Tmp0(16,14) = Tmp0(16,14) + inv2expQ*Tmp0(10,8) 
     Tmp0(2,15) = Tmp0(2,15) + inv2expQ*Tmp0(1,9) 
     Tmp0(5,15) = Tmp0(5,15) + 2*inv2expQ*Tmp0(2,9) 
     Tmp0(6,15) = Tmp0(6,15) + inv2expQ*Tmp0(3,9) 
     Tmp0(7,15) = Tmp0(7,15) + inv2expQ*Tmp0(4,9) 
     Tmp0(11,15) = Tmp0(11,15) + 3*inv2expQ*Tmp0(5,9) 
     Tmp0(12,15) = Tmp0(12,15) + 2*inv2expQ*Tmp0(6,9) 
     Tmp0(13,15) = Tmp0(13,15) + 2*inv2expQ*Tmp0(7,9) 
     Tmp0(14,15) = Tmp0(14,15) + inv2expQ*Tmp0(8,9) 
     Tmp0(15,15) = Tmp0(15,15) + inv2expQ*Tmp0(9,9) 
     Tmp0(16,15) = Tmp0(16,15) + inv2expQ*Tmp0(10,9) 
     Tmp0(2,16) = Tmp0(2,16) + inv2expQ*Tmp0(1,10) 
     Tmp0(5,16) = Tmp0(5,16) + 2*inv2expQ*Tmp0(2,10) 
     Tmp0(6,16) = Tmp0(6,16) + inv2expQ*Tmp0(3,10) 
     Tmp0(7,16) = Tmp0(7,16) + inv2expQ*Tmp0(4,10) 
     Tmp0(11,16) = Tmp0(11,16) + 3*inv2expQ*Tmp0(5,10) 
     Tmp0(12,16) = Tmp0(12,16) + 2*inv2expQ*Tmp0(6,10) 
     Tmp0(13,16) = Tmp0(13,16) + 2*inv2expQ*Tmp0(7,10) 
     Tmp0(14,16) = Tmp0(14,16) + inv2expQ*Tmp0(8,10) 
     Tmp0(15,16) = Tmp0(15,16) + inv2expQ*Tmp0(9,10) 
     Tmp0(16,16) = Tmp0(16,16) + inv2expQ*Tmp0(10,10) 
     Tmp0(3,17) = Tmp0(3,17) + inv2expQ*Tmp0(1,8) 
     Tmp0(6,17) = Tmp0(6,17) + inv2expQ*Tmp0(2,8) 
     Tmp0(8,17) = Tmp0(8,17) + 2*inv2expQ*Tmp0(3,8) 
     Tmp0(9,17) = Tmp0(9,17) + inv2expQ*Tmp0(4,8) 
     Tmp0(12,17) = Tmp0(12,17) + inv2expQ*Tmp0(5,8) 
     Tmp0(14,17) = Tmp0(14,17) + 2*inv2expQ*Tmp0(6,8) 
     Tmp0(15,17) = Tmp0(15,17) + inv2expQ*Tmp0(7,8) 
     Tmp0(17,17) = Tmp0(17,17) + 3*inv2expQ*Tmp0(8,8) 
     Tmp0(18,17) = Tmp0(18,17) + 2*inv2expQ*Tmp0(9,8) 
     Tmp0(19,17) = Tmp0(19,17) + inv2expQ*Tmp0(10,8) 
     Tmp0(4,18) = Tmp0(4,18) + inv2expQ*Tmp0(1,8) 
     Tmp0(7,18) = Tmp0(7,18) + inv2expQ*Tmp0(2,8) 
     Tmp0(9,18) = Tmp0(9,18) + inv2expQ*Tmp0(3,8) 
     Tmp0(10,18) = Tmp0(10,18) + 2*inv2expQ*Tmp0(4,8) 
     Tmp0(13,18) = Tmp0(13,18) + inv2expQ*Tmp0(5,8) 
     Tmp0(15,18) = Tmp0(15,18) + inv2expQ*Tmp0(6,8) 
     Tmp0(16,18) = Tmp0(16,18) + 2*inv2expQ*Tmp0(7,8) 
     Tmp0(18,18) = Tmp0(18,18) + inv2expQ*Tmp0(8,8) 
     Tmp0(19,18) = Tmp0(19,18) + 2*inv2expQ*Tmp0(9,8) 
     Tmp0(20,18) = Tmp0(20,18) + 3*inv2expQ*Tmp0(10,8) 
     Tmp0(3,19) = Tmp0(3,19) + inv2expQ*Tmp0(1,10) 
     Tmp0(6,19) = Tmp0(6,19) + inv2expQ*Tmp0(2,10) 
     Tmp0(8,19) = Tmp0(8,19) + 2*inv2expQ*Tmp0(3,10) 
     Tmp0(9,19) = Tmp0(9,19) + inv2expQ*Tmp0(4,10) 
     Tmp0(12,19) = Tmp0(12,19) + inv2expQ*Tmp0(5,10) 
     Tmp0(14,19) = Tmp0(14,19) + 2*inv2expQ*Tmp0(6,10) 
     Tmp0(15,19) = Tmp0(15,19) + inv2expQ*Tmp0(7,10) 
     Tmp0(17,19) = Tmp0(17,19) + 3*inv2expQ*Tmp0(8,10) 
     Tmp0(18,19) = Tmp0(18,19) + 2*inv2expQ*Tmp0(9,10) 
     Tmp0(19,19) = Tmp0(19,19) + inv2expQ*Tmp0(10,10) 
     Tmp0(4,20) = Tmp0(4,20) + inv2expQ*Tmp0(1,10) 
     Tmp0(7,20) = Tmp0(7,20) + inv2expQ*Tmp0(2,10) 
     Tmp0(9,20) = Tmp0(9,20) + inv2expQ*Tmp0(3,10) 
     Tmp0(10,20) = Tmp0(10,20) + 2*inv2expQ*Tmp0(4,10) 
     Tmp0(13,20) = Tmp0(13,20) + inv2expQ*Tmp0(5,10) 
     Tmp0(15,20) = Tmp0(15,20) + inv2expQ*Tmp0(6,10) 
     Tmp0(16,20) = Tmp0(16,20) + 2*inv2expQ*Tmp0(7,10) 
     Tmp0(18,20) = Tmp0(18,20) + inv2expQ*Tmp0(8,10) 
     Tmp0(19,20) = Tmp0(19,20) + 2*inv2expQ*Tmp0(9,10) 
     Tmp0(20,20) = Tmp0(20,20) + 3*inv2expQ*Tmp0(10,10) 
     Tmp0(1,11) = Tmp0(1,11) + pinvq*Tmp0(2,5)
     Tmp0(2,11) = Tmp0(2,11) + pinvq*Tmp0(5,5)
     Tmp0(3,11) = Tmp0(3,11) + pinvq*Tmp0(6,5)
     Tmp0(4,11) = Tmp0(4,11) + pinvq*Tmp0(7,5)
     Tmp0(5,11) = Tmp0(5,11) + pinvq*Tmp0(11,5)
     Tmp0(6,11) = Tmp0(6,11) + pinvq*Tmp0(12,5)
     Tmp0(7,11) = Tmp0(7,11) + pinvq*Tmp0(13,5)
     Tmp0(8,11) = Tmp0(8,11) + pinvq*Tmp0(14,5)
     Tmp0(9,11) = Tmp0(9,11) + pinvq*Tmp0(15,5)
     Tmp0(10,11) = Tmp0(10,11) + pinvq*Tmp0(16,5)
     Tmp0(11,11) = Tmp0(11,11) + pinvq*Tmp2(21,5)
     Tmp0(12,11) = Tmp0(12,11) + pinvq*Tmp2(22,5)
     Tmp0(13,11) = Tmp0(13,11) + pinvq*Tmp2(23,5)
     Tmp0(14,11) = Tmp0(14,11) + pinvq*Tmp2(24,5)
     Tmp0(15,11) = Tmp0(15,11) + pinvq*Tmp2(25,5)
     Tmp0(16,11) = Tmp0(16,11) + pinvq*Tmp2(26,5)
     Tmp0(17,11) = Tmp0(17,11) + pinvq*Tmp2(27,5)
     Tmp0(18,11) = Tmp0(18,11) + pinvq*Tmp2(28,5)
     Tmp0(19,11) = Tmp0(19,11) + pinvq*Tmp2(29,5)
     Tmp0(20,11) = Tmp0(20,11) + pinvq*Tmp2(30,5)
     Tmp0(1,12) = Tmp0(1,12) + pinvq*Tmp0(3,5)
     Tmp0(2,12) = Tmp0(2,12) + pinvq*Tmp0(6,5)
     Tmp0(3,12) = Tmp0(3,12) + pinvq*Tmp0(8,5)
     Tmp0(4,12) = Tmp0(4,12) + pinvq*Tmp0(9,5)
     Tmp0(5,12) = Tmp0(5,12) + pinvq*Tmp0(12,5)
     Tmp0(6,12) = Tmp0(6,12) + pinvq*Tmp0(14,5)
     Tmp0(7,12) = Tmp0(7,12) + pinvq*Tmp0(15,5)
     Tmp0(8,12) = Tmp0(8,12) + pinvq*Tmp0(17,5)
     Tmp0(9,12) = Tmp0(9,12) + pinvq*Tmp0(18,5)
     Tmp0(10,12) = Tmp0(10,12) + pinvq*Tmp0(19,5)
     Tmp0(11,12) = Tmp0(11,12) + pinvq*Tmp2(22,5)
     Tmp0(12,12) = Tmp0(12,12) + pinvq*Tmp2(24,5)
     Tmp0(13,12) = Tmp0(13,12) + pinvq*Tmp2(25,5)
     Tmp0(14,12) = Tmp0(14,12) + pinvq*Tmp2(27,5)
     Tmp0(15,12) = Tmp0(15,12) + pinvq*Tmp2(28,5)
     Tmp0(16,12) = Tmp0(16,12) + pinvq*Tmp2(29,5)
     Tmp0(17,12) = Tmp0(17,12) + pinvq*Tmp2(31,5)
     Tmp0(18,12) = Tmp0(18,12) + pinvq*Tmp2(32,5)
     Tmp0(19,12) = Tmp0(19,12) + pinvq*Tmp2(33,5)
     Tmp0(20,12) = Tmp0(20,12) + pinvq*Tmp2(34,5)
     Tmp0(1,13) = Tmp0(1,13) + pinvq*Tmp0(4,5)
     Tmp0(2,13) = Tmp0(2,13) + pinvq*Tmp0(7,5)
     Tmp0(3,13) = Tmp0(3,13) + pinvq*Tmp0(9,5)
     Tmp0(4,13) = Tmp0(4,13) + pinvq*Tmp0(10,5)
     Tmp0(5,13) = Tmp0(5,13) + pinvq*Tmp0(13,5)
     Tmp0(6,13) = Tmp0(6,13) + pinvq*Tmp0(15,5)
     Tmp0(7,13) = Tmp0(7,13) + pinvq*Tmp0(16,5)
     Tmp0(8,13) = Tmp0(8,13) + pinvq*Tmp0(18,5)
     Tmp0(9,13) = Tmp0(9,13) + pinvq*Tmp0(19,5)
     Tmp0(10,13) = Tmp0(10,13) + pinvq*Tmp0(20,5)
     Tmp0(11,13) = Tmp0(11,13) + pinvq*Tmp2(23,5)
     Tmp0(12,13) = Tmp0(12,13) + pinvq*Tmp2(25,5)
     Tmp0(13,13) = Tmp0(13,13) + pinvq*Tmp2(26,5)
     Tmp0(14,13) = Tmp0(14,13) + pinvq*Tmp2(28,5)
     Tmp0(15,13) = Tmp0(15,13) + pinvq*Tmp2(29,5)
     Tmp0(16,13) = Tmp0(16,13) + pinvq*Tmp2(30,5)
     Tmp0(17,13) = Tmp0(17,13) + pinvq*Tmp2(32,5)
     Tmp0(18,13) = Tmp0(18,13) + pinvq*Tmp2(33,5)
     Tmp0(19,13) = Tmp0(19,13) + pinvq*Tmp2(34,5)
     Tmp0(20,13) = Tmp0(20,13) + pinvq*Tmp2(35,5)
     Tmp0(1,14) = Tmp0(1,14) + pinvq*Tmp0(2,8)
     Tmp0(2,14) = Tmp0(2,14) + pinvq*Tmp0(5,8)
     Tmp0(3,14) = Tmp0(3,14) + pinvq*Tmp0(6,8)
     Tmp0(4,14) = Tmp0(4,14) + pinvq*Tmp0(7,8)
     Tmp0(5,14) = Tmp0(5,14) + pinvq*Tmp0(11,8)
     Tmp0(6,14) = Tmp0(6,14) + pinvq*Tmp0(12,8)
     Tmp0(7,14) = Tmp0(7,14) + pinvq*Tmp0(13,8)
     Tmp0(8,14) = Tmp0(8,14) + pinvq*Tmp0(14,8)
     Tmp0(9,14) = Tmp0(9,14) + pinvq*Tmp0(15,8)
     Tmp0(10,14) = Tmp0(10,14) + pinvq*Tmp0(16,8)
     Tmp0(11,14) = Tmp0(11,14) + pinvq*Tmp2(21,8)
     Tmp0(12,14) = Tmp0(12,14) + pinvq*Tmp2(22,8)
     Tmp0(13,14) = Tmp0(13,14) + pinvq*Tmp2(23,8)
     Tmp0(14,14) = Tmp0(14,14) + pinvq*Tmp2(24,8)
     Tmp0(15,14) = Tmp0(15,14) + pinvq*Tmp2(25,8)
     Tmp0(16,14) = Tmp0(16,14) + pinvq*Tmp2(26,8)
     Tmp0(17,14) = Tmp0(17,14) + pinvq*Tmp2(27,8)
     Tmp0(18,14) = Tmp0(18,14) + pinvq*Tmp2(28,8)
     Tmp0(19,14) = Tmp0(19,14) + pinvq*Tmp2(29,8)
     Tmp0(20,14) = Tmp0(20,14) + pinvq*Tmp2(30,8)
     Tmp0(1,15) = Tmp0(1,15) + pinvq*Tmp0(2,9)
     Tmp0(2,15) = Tmp0(2,15) + pinvq*Tmp0(5,9)
     Tmp0(3,15) = Tmp0(3,15) + pinvq*Tmp0(6,9)
     Tmp0(4,15) = Tmp0(4,15) + pinvq*Tmp0(7,9)
     Tmp0(5,15) = Tmp0(5,15) + pinvq*Tmp0(11,9)
     Tmp0(6,15) = Tmp0(6,15) + pinvq*Tmp0(12,9)
     Tmp0(7,15) = Tmp0(7,15) + pinvq*Tmp0(13,9)
     Tmp0(8,15) = Tmp0(8,15) + pinvq*Tmp0(14,9)
     Tmp0(9,15) = Tmp0(9,15) + pinvq*Tmp0(15,9)
     Tmp0(10,15) = Tmp0(10,15) + pinvq*Tmp0(16,9)
     Tmp0(11,15) = Tmp0(11,15) + pinvq*Tmp2(21,9)
     Tmp0(12,15) = Tmp0(12,15) + pinvq*Tmp2(22,9)
     Tmp0(13,15) = Tmp0(13,15) + pinvq*Tmp2(23,9)
     Tmp0(14,15) = Tmp0(14,15) + pinvq*Tmp2(24,9)
     Tmp0(15,15) = Tmp0(15,15) + pinvq*Tmp2(25,9)
     Tmp0(16,15) = Tmp0(16,15) + pinvq*Tmp2(26,9)
     Tmp0(17,15) = Tmp0(17,15) + pinvq*Tmp2(27,9)
     Tmp0(18,15) = Tmp0(18,15) + pinvq*Tmp2(28,9)
     Tmp0(19,15) = Tmp0(19,15) + pinvq*Tmp2(29,9)
     Tmp0(20,15) = Tmp0(20,15) + pinvq*Tmp2(30,9)
     Tmp0(1,16) = Tmp0(1,16) + pinvq*Tmp0(2,10)
     Tmp0(2,16) = Tmp0(2,16) + pinvq*Tmp0(5,10)
     Tmp0(3,16) = Tmp0(3,16) + pinvq*Tmp0(6,10)
     Tmp0(4,16) = Tmp0(4,16) + pinvq*Tmp0(7,10)
     Tmp0(5,16) = Tmp0(5,16) + pinvq*Tmp0(11,10)
     Tmp0(6,16) = Tmp0(6,16) + pinvq*Tmp0(12,10)
     Tmp0(7,16) = Tmp0(7,16) + pinvq*Tmp0(13,10)
     Tmp0(8,16) = Tmp0(8,16) + pinvq*Tmp0(14,10)
     Tmp0(9,16) = Tmp0(9,16) + pinvq*Tmp0(15,10)
     Tmp0(10,16) = Tmp0(10,16) + pinvq*Tmp0(16,10)
     Tmp0(11,16) = Tmp0(11,16) + pinvq*Tmp2(21,10)
     Tmp0(12,16) = Tmp0(12,16) + pinvq*Tmp2(22,10)
     Tmp0(13,16) = Tmp0(13,16) + pinvq*Tmp2(23,10)
     Tmp0(14,16) = Tmp0(14,16) + pinvq*Tmp2(24,10)
     Tmp0(15,16) = Tmp0(15,16) + pinvq*Tmp2(25,10)
     Tmp0(16,16) = Tmp0(16,16) + pinvq*Tmp2(26,10)
     Tmp0(17,16) = Tmp0(17,16) + pinvq*Tmp2(27,10)
     Tmp0(18,16) = Tmp0(18,16) + pinvq*Tmp2(28,10)
     Tmp0(19,16) = Tmp0(19,16) + pinvq*Tmp2(29,10)
     Tmp0(20,16) = Tmp0(20,16) + pinvq*Tmp2(30,10)
     Tmp0(1,17) = Tmp0(1,17) + pinvq*Tmp0(3,8)
     Tmp0(2,17) = Tmp0(2,17) + pinvq*Tmp0(6,8)
     Tmp0(3,17) = Tmp0(3,17) + pinvq*Tmp0(8,8)
     Tmp0(4,17) = Tmp0(4,17) + pinvq*Tmp0(9,8)
     Tmp0(5,17) = Tmp0(5,17) + pinvq*Tmp0(12,8)
     Tmp0(6,17) = Tmp0(6,17) + pinvq*Tmp0(14,8)
     Tmp0(7,17) = Tmp0(7,17) + pinvq*Tmp0(15,8)
     Tmp0(8,17) = Tmp0(8,17) + pinvq*Tmp0(17,8)
     Tmp0(9,17) = Tmp0(9,17) + pinvq*Tmp0(18,8)
     Tmp0(10,17) = Tmp0(10,17) + pinvq*Tmp0(19,8)
     Tmp0(11,17) = Tmp0(11,17) + pinvq*Tmp2(22,8)
     Tmp0(12,17) = Tmp0(12,17) + pinvq*Tmp2(24,8)
     Tmp0(13,17) = Tmp0(13,17) + pinvq*Tmp2(25,8)
     Tmp0(14,17) = Tmp0(14,17) + pinvq*Tmp2(27,8)
     Tmp0(15,17) = Tmp0(15,17) + pinvq*Tmp2(28,8)
     Tmp0(16,17) = Tmp0(16,17) + pinvq*Tmp2(29,8)
     Tmp0(17,17) = Tmp0(17,17) + pinvq*Tmp2(31,8)
     Tmp0(18,17) = Tmp0(18,17) + pinvq*Tmp2(32,8)
     Tmp0(19,17) = Tmp0(19,17) + pinvq*Tmp2(33,8)
     Tmp0(20,17) = Tmp0(20,17) + pinvq*Tmp2(34,8)
     Tmp0(1,18) = Tmp0(1,18) + pinvq*Tmp0(4,8)
     Tmp0(2,18) = Tmp0(2,18) + pinvq*Tmp0(7,8)
     Tmp0(3,18) = Tmp0(3,18) + pinvq*Tmp0(9,8)
     Tmp0(4,18) = Tmp0(4,18) + pinvq*Tmp0(10,8)
     Tmp0(5,18) = Tmp0(5,18) + pinvq*Tmp0(13,8)
     Tmp0(6,18) = Tmp0(6,18) + pinvq*Tmp0(15,8)
     Tmp0(7,18) = Tmp0(7,18) + pinvq*Tmp0(16,8)
     Tmp0(8,18) = Tmp0(8,18) + pinvq*Tmp0(18,8)
     Tmp0(9,18) = Tmp0(9,18) + pinvq*Tmp0(19,8)
     Tmp0(10,18) = Tmp0(10,18) + pinvq*Tmp0(20,8)
     Tmp0(11,18) = Tmp0(11,18) + pinvq*Tmp2(23,8)
     Tmp0(12,18) = Tmp0(12,18) + pinvq*Tmp2(25,8)
     Tmp0(13,18) = Tmp0(13,18) + pinvq*Tmp2(26,8)
     Tmp0(14,18) = Tmp0(14,18) + pinvq*Tmp2(28,8)
     Tmp0(15,18) = Tmp0(15,18) + pinvq*Tmp2(29,8)
     Tmp0(16,18) = Tmp0(16,18) + pinvq*Tmp2(30,8)
     Tmp0(17,18) = Tmp0(17,18) + pinvq*Tmp2(32,8)
     Tmp0(18,18) = Tmp0(18,18) + pinvq*Tmp2(33,8)
     Tmp0(19,18) = Tmp0(19,18) + pinvq*Tmp2(34,8)
     Tmp0(20,18) = Tmp0(20,18) + pinvq*Tmp2(35,8)
     Tmp0(1,19) = Tmp0(1,19) + pinvq*Tmp0(3,10)
     Tmp0(2,19) = Tmp0(2,19) + pinvq*Tmp0(6,10)
     Tmp0(3,19) = Tmp0(3,19) + pinvq*Tmp0(8,10)
     Tmp0(4,19) = Tmp0(4,19) + pinvq*Tmp0(9,10)
     Tmp0(5,19) = Tmp0(5,19) + pinvq*Tmp0(12,10)
     Tmp0(6,19) = Tmp0(6,19) + pinvq*Tmp0(14,10)
     Tmp0(7,19) = Tmp0(7,19) + pinvq*Tmp0(15,10)
     Tmp0(8,19) = Tmp0(8,19) + pinvq*Tmp0(17,10)
     Tmp0(9,19) = Tmp0(9,19) + pinvq*Tmp0(18,10)
     Tmp0(10,19) = Tmp0(10,19) + pinvq*Tmp0(19,10)
     Tmp0(11,19) = Tmp0(11,19) + pinvq*Tmp2(22,10)
     Tmp0(12,19) = Tmp0(12,19) + pinvq*Tmp2(24,10)
     Tmp0(13,19) = Tmp0(13,19) + pinvq*Tmp2(25,10)
     Tmp0(14,19) = Tmp0(14,19) + pinvq*Tmp2(27,10)
     Tmp0(15,19) = Tmp0(15,19) + pinvq*Tmp2(28,10)
     Tmp0(16,19) = Tmp0(16,19) + pinvq*Tmp2(29,10)
     Tmp0(17,19) = Tmp0(17,19) + pinvq*Tmp2(31,10)
     Tmp0(18,19) = Tmp0(18,19) + pinvq*Tmp2(32,10)
     Tmp0(19,19) = Tmp0(19,19) + pinvq*Tmp2(33,10)
     Tmp0(20,19) = Tmp0(20,19) + pinvq*Tmp2(34,10)
     Tmp0(1,20) = Tmp0(1,20) + pinvq*Tmp0(4,10)
     Tmp0(2,20) = Tmp0(2,20) + pinvq*Tmp0(7,10)
     Tmp0(3,20) = Tmp0(3,20) + pinvq*Tmp0(9,10)
     Tmp0(4,20) = Tmp0(4,20) + pinvq*Tmp0(10,10)
     Tmp0(5,20) = Tmp0(5,20) + pinvq*Tmp0(13,10)
     Tmp0(6,20) = Tmp0(6,20) + pinvq*Tmp0(15,10)
     Tmp0(7,20) = Tmp0(7,20) + pinvq*Tmp0(16,10)
     Tmp0(8,20) = Tmp0(8,20) + pinvq*Tmp0(18,10)
     Tmp0(9,20) = Tmp0(9,20) + pinvq*Tmp0(19,10)
     Tmp0(10,20) = Tmp0(10,20) + pinvq*Tmp0(20,10)
     Tmp0(11,20) = Tmp0(11,20) + pinvq*Tmp2(23,10)
     Tmp0(12,20) = Tmp0(12,20) + pinvq*Tmp2(25,10)
     Tmp0(13,20) = Tmp0(13,20) + pinvq*Tmp2(26,10)
     Tmp0(14,20) = Tmp0(14,20) + pinvq*Tmp2(28,10)
     Tmp0(15,20) = Tmp0(15,20) + pinvq*Tmp2(29,10)
     Tmp0(16,20) = Tmp0(16,20) + pinvq*Tmp2(30,10)
     Tmp0(17,20) = Tmp0(17,20) + pinvq*Tmp2(32,10)
     Tmp0(18,20) = Tmp0(18,20) + pinvq*Tmp2(33,10)
     Tmp0(19,20) = Tmp0(19,20) + pinvq*Tmp2(34,10)
     Tmp0(20,20) = Tmp0(20,20) + pinvq*Tmp2(35,10)
!$ACC LOOP SEQ
     DO iTUVQ=1, 20
!$ACC LOOP SEQ
      DO iTUVP=1, 20
        Aux2(IP,iTUVP,iTUVQ) = Tmp0(iTUVP,iTUVQ)
      ENDDO
     ENDDO
  ENDDO !iP = 1,nPrimQ*nPrimP*nPasses
 end subroutine TransferRecurrenceGPUP3Q3AtoDGen
END MODULE AGC_GPU_OBS_TRMODAtoDGen2
