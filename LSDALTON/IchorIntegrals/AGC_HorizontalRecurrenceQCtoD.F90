MODULE AGC_OBS_HorizontalRecurrenceRHSModCtoD
 use IchorPrecisionModule
  
 CONTAINS

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q1C1D0CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,    4,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,    2:    4,    1:    1,nContPQ*nPasses)
  !Local variables
  integer :: iP,ilmP,iTUVC
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,iTUVC,ilmP) &
!$OMP SHARED(nlmP,nContPQ,nPasses,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
    DO iTUVC=  2,  4
     DO ilmP = 1,nlmP
        ThetaP(ilmP,iTUVC,1,IP) = ThetaP2(ilmP,iTUVC,IP)
     ENDDO
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q1C1D0CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q2C1D1CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   10,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,    2:    4,    2:    4,nContPQ*nPasses)
  !Local variables
  integer :: iP,iC,iPassQ,ilmP,iTUVC
  real(realk) :: Xcd,Ycd,Zcd
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,&
!$OMP         iTUVC,ilmP,Xcd,Ycd,Zcd) &
!$OMP SHARED(nlmP,nContPQ,nPasses,Qdistance12,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
    DO ilmP = 1,nlmP
     ThetaP(ilmP, 2, 2,IP) = ThetaP2(ilmP, 5,IP) + Xcd*ThetaP2(ilmP, 2,IP) 
     ThetaP(ilmP, 3, 2,IP) = ThetaP2(ilmP, 6,IP) + Xcd*ThetaP2(ilmP, 3,IP) 
     ThetaP(ilmP, 4, 2,IP) = ThetaP2(ilmP, 7,IP) + Xcd*ThetaP2(ilmP, 4,IP) 
     ThetaP(ilmP, 2, 3,IP) = ThetaP2(ilmP, 6,IP) + Ycd*ThetaP2(ilmP, 2,IP) 
     ThetaP(ilmP, 3, 3,IP) = ThetaP2(ilmP, 8,IP) + Ycd*ThetaP2(ilmP, 3,IP) 
     ThetaP(ilmP, 4, 3,IP) = ThetaP2(ilmP, 9,IP) + Ycd*ThetaP2(ilmP, 4,IP) 
     ThetaP(ilmP, 2, 4,IP) = ThetaP2(ilmP, 7,IP) + Zcd*ThetaP2(ilmP, 2,IP) 
     ThetaP(ilmP, 3, 4,IP) = ThetaP2(ilmP, 9,IP) + Zcd*ThetaP2(ilmP, 3,IP) 
     ThetaP(ilmP, 4, 4,IP) = ThetaP2(ilmP,10,IP) + Zcd*ThetaP2(ilmP, 4,IP) 
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q2C1D1CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q2C2D0CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   10,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,    5:   10,    1:    1,nContPQ*nPasses)
  !Local variables
  integer :: iP,ilmP,iTUVC
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,iTUVC,ilmP) &
!$OMP SHARED(nlmP,nContPQ,nPasses,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
    DO iTUVC=  5, 10
     DO ilmP = 1,nlmP
        ThetaP(ilmP,iTUVC,1,IP) = ThetaP2(ilmP,iTUVC,IP)
     ENDDO
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q2C2D0CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q3C2D1CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   20,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,    5:   10,    2:    4,nContPQ*nPasses)
  !Local variables
  integer :: iP,iC,iPassQ,ilmP,iTUVC
  real(realk) :: Xcd,Ycd,Zcd
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,&
!$OMP         iTUVC,ilmP,Xcd,Ycd,Zcd) &
!$OMP SHARED(nlmP,nContPQ,nPasses,Qdistance12,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
    DO ilmP = 1,nlmP
     ThetaP(ilmP, 5, 2,IP) = ThetaP2(ilmP,11,IP) + Xcd*ThetaP2(ilmP, 5,IP) 
     ThetaP(ilmP, 6, 2,IP) = ThetaP2(ilmP,12,IP) + Xcd*ThetaP2(ilmP, 6,IP) 
     ThetaP(ilmP, 7, 2,IP) = ThetaP2(ilmP,13,IP) + Xcd*ThetaP2(ilmP, 7,IP) 
     ThetaP(ilmP, 8, 2,IP) = ThetaP2(ilmP,14,IP) + Xcd*ThetaP2(ilmP, 8,IP) 
     ThetaP(ilmP, 9, 2,IP) = ThetaP2(ilmP,15,IP) + Xcd*ThetaP2(ilmP, 9,IP) 
     ThetaP(ilmP,10, 2,IP) = ThetaP2(ilmP,16,IP) + Xcd*ThetaP2(ilmP,10,IP) 
     ThetaP(ilmP, 5, 3,IP) = ThetaP2(ilmP,12,IP) + Ycd*ThetaP2(ilmP, 5,IP) 
     ThetaP(ilmP, 6, 3,IP) = ThetaP2(ilmP,14,IP) + Ycd*ThetaP2(ilmP, 6,IP) 
     ThetaP(ilmP, 7, 3,IP) = ThetaP2(ilmP,15,IP) + Ycd*ThetaP2(ilmP, 7,IP) 
     ThetaP(ilmP, 8, 3,IP) = ThetaP2(ilmP,17,IP) + Ycd*ThetaP2(ilmP, 8,IP) 
     ThetaP(ilmP, 9, 3,IP) = ThetaP2(ilmP,18,IP) + Ycd*ThetaP2(ilmP, 9,IP) 
     ThetaP(ilmP,10, 3,IP) = ThetaP2(ilmP,19,IP) + Ycd*ThetaP2(ilmP,10,IP) 
     ThetaP(ilmP, 5, 4,IP) = ThetaP2(ilmP,13,IP) + Zcd*ThetaP2(ilmP, 5,IP) 
     ThetaP(ilmP, 6, 4,IP) = ThetaP2(ilmP,15,IP) + Zcd*ThetaP2(ilmP, 6,IP) 
     ThetaP(ilmP, 7, 4,IP) = ThetaP2(ilmP,16,IP) + Zcd*ThetaP2(ilmP, 7,IP) 
     ThetaP(ilmP, 8, 4,IP) = ThetaP2(ilmP,18,IP) + Zcd*ThetaP2(ilmP, 8,IP) 
     ThetaP(ilmP, 9, 4,IP) = ThetaP2(ilmP,19,IP) + Zcd*ThetaP2(ilmP, 9,IP) 
     ThetaP(ilmP,10, 4,IP) = ThetaP2(ilmP,20,IP) + Zcd*ThetaP2(ilmP,10,IP) 
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q3C2D1CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q3C3D0CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   20,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,   11:   20,    1:    1,nContPQ*nPasses)
  !Local variables
  integer :: iP,ilmP,iTUVC
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,iTUVC,ilmP) &
!$OMP SHARED(nlmP,nContPQ,nPasses,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
    DO iTUVC= 11, 20
     DO ilmP = 1,nlmP
        ThetaP(ilmP,iTUVC,1,IP) = ThetaP2(ilmP,iTUVC,IP)
     ENDDO
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q3C3D0CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q4C2D2CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   35,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,    5:   10,    5:   10,nContPQ*nPasses)
  !Local variables
  integer :: iP,iC,iPassQ,ilmP,iTUVC
  real(realk) :: Xcd,Ycd,Zcd
  real(realk) :: Tmp1(  5: 20,  2:  4)
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,&
!$OMP         Tmp1,&
!$OMP         iTUVC,ilmP,Xcd,Ycd,Zcd) &
!$OMP SHARED(nlmP,nContPQ,nPasses,Qdistance12,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
    DO ilmP = 1,nlmP
     Tmp1( 5, 2) = ThetaP2(ilmP,11,IP) + Xcd*ThetaP2(ilmP, 5,IP) 
     Tmp1( 6, 2) = ThetaP2(ilmP,12,IP) + Xcd*ThetaP2(ilmP, 6,IP) 
     Tmp1( 7, 2) = ThetaP2(ilmP,13,IP) + Xcd*ThetaP2(ilmP, 7,IP) 
     Tmp1( 8, 2) = ThetaP2(ilmP,14,IP) + Xcd*ThetaP2(ilmP, 8,IP) 
     Tmp1( 9, 2) = ThetaP2(ilmP,15,IP) + Xcd*ThetaP2(ilmP, 9,IP) 
     Tmp1(10, 2) = ThetaP2(ilmP,16,IP) + Xcd*ThetaP2(ilmP,10,IP) 
     Tmp1(11, 2) = ThetaP2(ilmP,21,IP) + Xcd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 2) = ThetaP2(ilmP,22,IP) + Xcd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 2) = ThetaP2(ilmP,23,IP) + Xcd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 2) = ThetaP2(ilmP,24,IP) + Xcd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 2) = ThetaP2(ilmP,25,IP) + Xcd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 2) = ThetaP2(ilmP,26,IP) + Xcd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 2) = ThetaP2(ilmP,27,IP) + Xcd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 2) = ThetaP2(ilmP,28,IP) + Xcd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 2) = ThetaP2(ilmP,29,IP) + Xcd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 2) = ThetaP2(ilmP,30,IP) + Xcd*ThetaP2(ilmP,20,IP) 
     Tmp1( 5, 3) = ThetaP2(ilmP,12,IP) + Ycd*ThetaP2(ilmP, 5,IP) 
     Tmp1( 6, 3) = ThetaP2(ilmP,14,IP) + Ycd*ThetaP2(ilmP, 6,IP) 
     Tmp1( 7, 3) = ThetaP2(ilmP,15,IP) + Ycd*ThetaP2(ilmP, 7,IP) 
     Tmp1( 8, 3) = ThetaP2(ilmP,17,IP) + Ycd*ThetaP2(ilmP, 8,IP) 
     Tmp1( 9, 3) = ThetaP2(ilmP,18,IP) + Ycd*ThetaP2(ilmP, 9,IP) 
     Tmp1(10, 3) = ThetaP2(ilmP,19,IP) + Ycd*ThetaP2(ilmP,10,IP) 
     Tmp1(11, 3) = ThetaP2(ilmP,22,IP) + Ycd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 3) = ThetaP2(ilmP,24,IP) + Ycd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 3) = ThetaP2(ilmP,25,IP) + Ycd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 3) = ThetaP2(ilmP,27,IP) + Ycd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 3) = ThetaP2(ilmP,28,IP) + Ycd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 3) = ThetaP2(ilmP,29,IP) + Ycd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 3) = ThetaP2(ilmP,31,IP) + Ycd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 3) = ThetaP2(ilmP,32,IP) + Ycd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 3) = ThetaP2(ilmP,33,IP) + Ycd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 3) = ThetaP2(ilmP,34,IP) + Ycd*ThetaP2(ilmP,20,IP) 
     Tmp1( 5, 4) = ThetaP2(ilmP,13,IP) + Zcd*ThetaP2(ilmP, 5,IP) 
     Tmp1( 6, 4) = ThetaP2(ilmP,15,IP) + Zcd*ThetaP2(ilmP, 6,IP) 
     Tmp1( 7, 4) = ThetaP2(ilmP,16,IP) + Zcd*ThetaP2(ilmP, 7,IP) 
     Tmp1( 8, 4) = ThetaP2(ilmP,18,IP) + Zcd*ThetaP2(ilmP, 8,IP) 
     Tmp1( 9, 4) = ThetaP2(ilmP,19,IP) + Zcd*ThetaP2(ilmP, 9,IP) 
     Tmp1(10, 4) = ThetaP2(ilmP,20,IP) + Zcd*ThetaP2(ilmP,10,IP) 
     Tmp1(11, 4) = ThetaP2(ilmP,23,IP) + Zcd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 4) = ThetaP2(ilmP,25,IP) + Zcd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 4) = ThetaP2(ilmP,26,IP) + Zcd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 4) = ThetaP2(ilmP,28,IP) + Zcd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 4) = ThetaP2(ilmP,29,IP) + Zcd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 4) = ThetaP2(ilmP,30,IP) + Zcd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 4) = ThetaP2(ilmP,32,IP) + Zcd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 4) = ThetaP2(ilmP,33,IP) + Zcd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 4) = ThetaP2(ilmP,34,IP) + Zcd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 4) = ThetaP2(ilmP,35,IP) + Zcd*ThetaP2(ilmP,20,IP) 
     ThetaP(ilmP, 5, 5,IP) = Tmp1(11, 2) + Xcd*Tmp1( 5, 2) 
     ThetaP(ilmP, 6, 5,IP) = Tmp1(12, 2) + Xcd*Tmp1( 6, 2) 
     ThetaP(ilmP, 7, 5,IP) = Tmp1(13, 2) + Xcd*Tmp1( 7, 2) 
     ThetaP(ilmP, 8, 5,IP) = Tmp1(14, 2) + Xcd*Tmp1( 8, 2) 
     ThetaP(ilmP, 9, 5,IP) = Tmp1(15, 2) + Xcd*Tmp1( 9, 2) 
     ThetaP(ilmP,10, 5,IP) = Tmp1(16, 2) + Xcd*Tmp1(10, 2) 
     ThetaP(ilmP, 5, 6,IP) = Tmp1(11, 3) + Xcd*Tmp1( 5, 3) 
     ThetaP(ilmP, 6, 6,IP) = Tmp1(12, 3) + Xcd*Tmp1( 6, 3) 
     ThetaP(ilmP, 7, 6,IP) = Tmp1(13, 3) + Xcd*Tmp1( 7, 3) 
     ThetaP(ilmP, 8, 6,IP) = Tmp1(14, 3) + Xcd*Tmp1( 8, 3) 
     ThetaP(ilmP, 9, 6,IP) = Tmp1(15, 3) + Xcd*Tmp1( 9, 3) 
     ThetaP(ilmP,10, 6,IP) = Tmp1(16, 3) + Xcd*Tmp1(10, 3) 
     ThetaP(ilmP, 5, 7,IP) = Tmp1(11, 4) + Xcd*Tmp1( 5, 4) 
     ThetaP(ilmP, 6, 7,IP) = Tmp1(12, 4) + Xcd*Tmp1( 6, 4) 
     ThetaP(ilmP, 7, 7,IP) = Tmp1(13, 4) + Xcd*Tmp1( 7, 4) 
     ThetaP(ilmP, 8, 7,IP) = Tmp1(14, 4) + Xcd*Tmp1( 8, 4) 
     ThetaP(ilmP, 9, 7,IP) = Tmp1(15, 4) + Xcd*Tmp1( 9, 4) 
     ThetaP(ilmP,10, 7,IP) = Tmp1(16, 4) + Xcd*Tmp1(10, 4) 
     ThetaP(ilmP, 5, 8,IP) = Tmp1(12, 3) + Ycd*Tmp1( 5, 3) 
     ThetaP(ilmP, 6, 8,IP) = Tmp1(14, 3) + Ycd*Tmp1( 6, 3) 
     ThetaP(ilmP, 7, 8,IP) = Tmp1(15, 3) + Ycd*Tmp1( 7, 3) 
     ThetaP(ilmP, 8, 8,IP) = Tmp1(17, 3) + Ycd*Tmp1( 8, 3) 
     ThetaP(ilmP, 9, 8,IP) = Tmp1(18, 3) + Ycd*Tmp1( 9, 3) 
     ThetaP(ilmP,10, 8,IP) = Tmp1(19, 3) + Ycd*Tmp1(10, 3) 
     ThetaP(ilmP, 5, 9,IP) = Tmp1(12, 4) + Ycd*Tmp1( 5, 4) 
     ThetaP(ilmP, 6, 9,IP) = Tmp1(14, 4) + Ycd*Tmp1( 6, 4) 
     ThetaP(ilmP, 7, 9,IP) = Tmp1(15, 4) + Ycd*Tmp1( 7, 4) 
     ThetaP(ilmP, 8, 9,IP) = Tmp1(17, 4) + Ycd*Tmp1( 8, 4) 
     ThetaP(ilmP, 9, 9,IP) = Tmp1(18, 4) + Ycd*Tmp1( 9, 4) 
     ThetaP(ilmP,10, 9,IP) = Tmp1(19, 4) + Ycd*Tmp1(10, 4) 
     ThetaP(ilmP, 5,10,IP) = Tmp1(13, 4) + Zcd*Tmp1( 5, 4) 
     ThetaP(ilmP, 6,10,IP) = Tmp1(15, 4) + Zcd*Tmp1( 6, 4) 
     ThetaP(ilmP, 7,10,IP) = Tmp1(16, 4) + Zcd*Tmp1( 7, 4) 
     ThetaP(ilmP, 8,10,IP) = Tmp1(18, 4) + Zcd*Tmp1( 8, 4) 
     ThetaP(ilmP, 9,10,IP) = Tmp1(19, 4) + Zcd*Tmp1( 9, 4) 
     ThetaP(ilmP,10,10,IP) = Tmp1(20, 4) + Zcd*Tmp1(10, 4) 
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q4C2D2CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q4C3D1CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   35,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,   11:   20,    2:    4,nContPQ*nPasses)
  !Local variables
  integer :: iP,iC,iPassQ,ilmP,iTUVC
  real(realk) :: Xcd,Ycd,Zcd
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,&
!$OMP         iTUVC,ilmP,Xcd,Ycd,Zcd) &
!$OMP SHARED(nlmP,nContPQ,nPasses,Qdistance12,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
    DO ilmP = 1,nlmP
     ThetaP(ilmP,11, 2,IP) = ThetaP2(ilmP,21,IP) + Xcd*ThetaP2(ilmP,11,IP) 
     ThetaP(ilmP,12, 2,IP) = ThetaP2(ilmP,22,IP) + Xcd*ThetaP2(ilmP,12,IP) 
     ThetaP(ilmP,13, 2,IP) = ThetaP2(ilmP,23,IP) + Xcd*ThetaP2(ilmP,13,IP) 
     ThetaP(ilmP,14, 2,IP) = ThetaP2(ilmP,24,IP) + Xcd*ThetaP2(ilmP,14,IP) 
     ThetaP(ilmP,15, 2,IP) = ThetaP2(ilmP,25,IP) + Xcd*ThetaP2(ilmP,15,IP) 
     ThetaP(ilmP,16, 2,IP) = ThetaP2(ilmP,26,IP) + Xcd*ThetaP2(ilmP,16,IP) 
     ThetaP(ilmP,17, 2,IP) = ThetaP2(ilmP,27,IP) + Xcd*ThetaP2(ilmP,17,IP) 
     ThetaP(ilmP,18, 2,IP) = ThetaP2(ilmP,28,IP) + Xcd*ThetaP2(ilmP,18,IP) 
     ThetaP(ilmP,19, 2,IP) = ThetaP2(ilmP,29,IP) + Xcd*ThetaP2(ilmP,19,IP) 
     ThetaP(ilmP,20, 2,IP) = ThetaP2(ilmP,30,IP) + Xcd*ThetaP2(ilmP,20,IP) 
     ThetaP(ilmP,11, 3,IP) = ThetaP2(ilmP,22,IP) + Ycd*ThetaP2(ilmP,11,IP) 
     ThetaP(ilmP,12, 3,IP) = ThetaP2(ilmP,24,IP) + Ycd*ThetaP2(ilmP,12,IP) 
     ThetaP(ilmP,13, 3,IP) = ThetaP2(ilmP,25,IP) + Ycd*ThetaP2(ilmP,13,IP) 
     ThetaP(ilmP,14, 3,IP) = ThetaP2(ilmP,27,IP) + Ycd*ThetaP2(ilmP,14,IP) 
     ThetaP(ilmP,15, 3,IP) = ThetaP2(ilmP,28,IP) + Ycd*ThetaP2(ilmP,15,IP) 
     ThetaP(ilmP,16, 3,IP) = ThetaP2(ilmP,29,IP) + Ycd*ThetaP2(ilmP,16,IP) 
     ThetaP(ilmP,17, 3,IP) = ThetaP2(ilmP,31,IP) + Ycd*ThetaP2(ilmP,17,IP) 
     ThetaP(ilmP,18, 3,IP) = ThetaP2(ilmP,32,IP) + Ycd*ThetaP2(ilmP,18,IP) 
     ThetaP(ilmP,19, 3,IP) = ThetaP2(ilmP,33,IP) + Ycd*ThetaP2(ilmP,19,IP) 
     ThetaP(ilmP,20, 3,IP) = ThetaP2(ilmP,34,IP) + Ycd*ThetaP2(ilmP,20,IP) 
     ThetaP(ilmP,11, 4,IP) = ThetaP2(ilmP,23,IP) + Zcd*ThetaP2(ilmP,11,IP) 
     ThetaP(ilmP,12, 4,IP) = ThetaP2(ilmP,25,IP) + Zcd*ThetaP2(ilmP,12,IP) 
     ThetaP(ilmP,13, 4,IP) = ThetaP2(ilmP,26,IP) + Zcd*ThetaP2(ilmP,13,IP) 
     ThetaP(ilmP,14, 4,IP) = ThetaP2(ilmP,28,IP) + Zcd*ThetaP2(ilmP,14,IP) 
     ThetaP(ilmP,15, 4,IP) = ThetaP2(ilmP,29,IP) + Zcd*ThetaP2(ilmP,15,IP) 
     ThetaP(ilmP,16, 4,IP) = ThetaP2(ilmP,30,IP) + Zcd*ThetaP2(ilmP,16,IP) 
     ThetaP(ilmP,17, 4,IP) = ThetaP2(ilmP,32,IP) + Zcd*ThetaP2(ilmP,17,IP) 
     ThetaP(ilmP,18, 4,IP) = ThetaP2(ilmP,33,IP) + Zcd*ThetaP2(ilmP,18,IP) 
     ThetaP(ilmP,19, 4,IP) = ThetaP2(ilmP,34,IP) + Zcd*ThetaP2(ilmP,19,IP) 
     ThetaP(ilmP,20, 4,IP) = ThetaP2(ilmP,35,IP) + Zcd*ThetaP2(ilmP,20,IP) 
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q4C3D1CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q5C3D2CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   56,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,   11:   20,    5:   10,nContPQ*nPasses)
  !Local variables
  integer :: iP,iC,iPassQ,ilmP,iTUVC
  real(realk) :: Xcd,Ycd,Zcd
  real(realk) :: Tmp1( 11: 35,  2:  4)
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,&
!$OMP         Tmp1,&
!$OMP         iTUVC,ilmP,Xcd,Ycd,Zcd) &
!$OMP SHARED(nlmP,nContPQ,nPasses,Qdistance12,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
    DO ilmP = 1,nlmP
     Tmp1(11, 2) = ThetaP2(ilmP,21,IP) + Xcd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 2) = ThetaP2(ilmP,22,IP) + Xcd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 2) = ThetaP2(ilmP,23,IP) + Xcd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 2) = ThetaP2(ilmP,24,IP) + Xcd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 2) = ThetaP2(ilmP,25,IP) + Xcd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 2) = ThetaP2(ilmP,26,IP) + Xcd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 2) = ThetaP2(ilmP,27,IP) + Xcd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 2) = ThetaP2(ilmP,28,IP) + Xcd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 2) = ThetaP2(ilmP,29,IP) + Xcd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 2) = ThetaP2(ilmP,30,IP) + Xcd*ThetaP2(ilmP,20,IP) 
     Tmp1(21, 2) = ThetaP2(ilmP,36,IP) + Xcd*ThetaP2(ilmP,21,IP) 
     Tmp1(22, 2) = ThetaP2(ilmP,37,IP) + Xcd*ThetaP2(ilmP,22,IP) 
     Tmp1(23, 2) = ThetaP2(ilmP,38,IP) + Xcd*ThetaP2(ilmP,23,IP) 
     Tmp1(24, 2) = ThetaP2(ilmP,39,IP) + Xcd*ThetaP2(ilmP,24,IP) 
     Tmp1(25, 2) = ThetaP2(ilmP,40,IP) + Xcd*ThetaP2(ilmP,25,IP) 
     Tmp1(26, 2) = ThetaP2(ilmP,41,IP) + Xcd*ThetaP2(ilmP,26,IP) 
     Tmp1(27, 2) = ThetaP2(ilmP,42,IP) + Xcd*ThetaP2(ilmP,27,IP) 
     Tmp1(28, 2) = ThetaP2(ilmP,43,IP) + Xcd*ThetaP2(ilmP,28,IP) 
     Tmp1(29, 2) = ThetaP2(ilmP,44,IP) + Xcd*ThetaP2(ilmP,29,IP) 
     Tmp1(30, 2) = ThetaP2(ilmP,45,IP) + Xcd*ThetaP2(ilmP,30,IP) 
     Tmp1(31, 2) = ThetaP2(ilmP,46,IP) + Xcd*ThetaP2(ilmP,31,IP) 
     Tmp1(32, 2) = ThetaP2(ilmP,47,IP) + Xcd*ThetaP2(ilmP,32,IP) 
     Tmp1(33, 2) = ThetaP2(ilmP,48,IP) + Xcd*ThetaP2(ilmP,33,IP) 
     Tmp1(34, 2) = ThetaP2(ilmP,49,IP) + Xcd*ThetaP2(ilmP,34,IP) 
     Tmp1(35, 2) = ThetaP2(ilmP,50,IP) + Xcd*ThetaP2(ilmP,35,IP) 
     Tmp1(11, 3) = ThetaP2(ilmP,22,IP) + Ycd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 3) = ThetaP2(ilmP,24,IP) + Ycd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 3) = ThetaP2(ilmP,25,IP) + Ycd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 3) = ThetaP2(ilmP,27,IP) + Ycd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 3) = ThetaP2(ilmP,28,IP) + Ycd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 3) = ThetaP2(ilmP,29,IP) + Ycd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 3) = ThetaP2(ilmP,31,IP) + Ycd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 3) = ThetaP2(ilmP,32,IP) + Ycd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 3) = ThetaP2(ilmP,33,IP) + Ycd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 3) = ThetaP2(ilmP,34,IP) + Ycd*ThetaP2(ilmP,20,IP) 
     Tmp1(21, 3) = ThetaP2(ilmP,37,IP) + Ycd*ThetaP2(ilmP,21,IP) 
     Tmp1(22, 3) = ThetaP2(ilmP,39,IP) + Ycd*ThetaP2(ilmP,22,IP) 
     Tmp1(23, 3) = ThetaP2(ilmP,40,IP) + Ycd*ThetaP2(ilmP,23,IP) 
     Tmp1(24, 3) = ThetaP2(ilmP,42,IP) + Ycd*ThetaP2(ilmP,24,IP) 
     Tmp1(25, 3) = ThetaP2(ilmP,43,IP) + Ycd*ThetaP2(ilmP,25,IP) 
     Tmp1(26, 3) = ThetaP2(ilmP,44,IP) + Ycd*ThetaP2(ilmP,26,IP) 
     Tmp1(27, 3) = ThetaP2(ilmP,46,IP) + Ycd*ThetaP2(ilmP,27,IP) 
     Tmp1(28, 3) = ThetaP2(ilmP,47,IP) + Ycd*ThetaP2(ilmP,28,IP) 
     Tmp1(29, 3) = ThetaP2(ilmP,48,IP) + Ycd*ThetaP2(ilmP,29,IP) 
     Tmp1(30, 3) = ThetaP2(ilmP,49,IP) + Ycd*ThetaP2(ilmP,30,IP) 
     Tmp1(31, 3) = ThetaP2(ilmP,51,IP) + Ycd*ThetaP2(ilmP,31,IP) 
     Tmp1(32, 3) = ThetaP2(ilmP,52,IP) + Ycd*ThetaP2(ilmP,32,IP) 
     Tmp1(33, 3) = ThetaP2(ilmP,53,IP) + Ycd*ThetaP2(ilmP,33,IP) 
     Tmp1(34, 3) = ThetaP2(ilmP,54,IP) + Ycd*ThetaP2(ilmP,34,IP) 
     Tmp1(35, 3) = ThetaP2(ilmP,55,IP) + Ycd*ThetaP2(ilmP,35,IP) 
     Tmp1(11, 4) = ThetaP2(ilmP,23,IP) + Zcd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 4) = ThetaP2(ilmP,25,IP) + Zcd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 4) = ThetaP2(ilmP,26,IP) + Zcd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 4) = ThetaP2(ilmP,28,IP) + Zcd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 4) = ThetaP2(ilmP,29,IP) + Zcd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 4) = ThetaP2(ilmP,30,IP) + Zcd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 4) = ThetaP2(ilmP,32,IP) + Zcd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 4) = ThetaP2(ilmP,33,IP) + Zcd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 4) = ThetaP2(ilmP,34,IP) + Zcd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 4) = ThetaP2(ilmP,35,IP) + Zcd*ThetaP2(ilmP,20,IP) 
     Tmp1(21, 4) = ThetaP2(ilmP,38,IP) + Zcd*ThetaP2(ilmP,21,IP) 
     Tmp1(22, 4) = ThetaP2(ilmP,40,IP) + Zcd*ThetaP2(ilmP,22,IP) 
     Tmp1(23, 4) = ThetaP2(ilmP,41,IP) + Zcd*ThetaP2(ilmP,23,IP) 
     Tmp1(24, 4) = ThetaP2(ilmP,43,IP) + Zcd*ThetaP2(ilmP,24,IP) 
     Tmp1(25, 4) = ThetaP2(ilmP,44,IP) + Zcd*ThetaP2(ilmP,25,IP) 
     Tmp1(26, 4) = ThetaP2(ilmP,45,IP) + Zcd*ThetaP2(ilmP,26,IP) 
     Tmp1(27, 4) = ThetaP2(ilmP,47,IP) + Zcd*ThetaP2(ilmP,27,IP) 
     Tmp1(28, 4) = ThetaP2(ilmP,48,IP) + Zcd*ThetaP2(ilmP,28,IP) 
     Tmp1(29, 4) = ThetaP2(ilmP,49,IP) + Zcd*ThetaP2(ilmP,29,IP) 
     Tmp1(30, 4) = ThetaP2(ilmP,50,IP) + Zcd*ThetaP2(ilmP,30,IP) 
     Tmp1(31, 4) = ThetaP2(ilmP,52,IP) + Zcd*ThetaP2(ilmP,31,IP) 
     Tmp1(32, 4) = ThetaP2(ilmP,53,IP) + Zcd*ThetaP2(ilmP,32,IP) 
     Tmp1(33, 4) = ThetaP2(ilmP,54,IP) + Zcd*ThetaP2(ilmP,33,IP) 
     Tmp1(34, 4) = ThetaP2(ilmP,55,IP) + Zcd*ThetaP2(ilmP,34,IP) 
     Tmp1(35, 4) = ThetaP2(ilmP,56,IP) + Zcd*ThetaP2(ilmP,35,IP) 
     ThetaP(ilmP,11, 5,IP) = Tmp1(21, 2) + Xcd*Tmp1(11, 2) 
     ThetaP(ilmP,12, 5,IP) = Tmp1(22, 2) + Xcd*Tmp1(12, 2) 
     ThetaP(ilmP,13, 5,IP) = Tmp1(23, 2) + Xcd*Tmp1(13, 2) 
     ThetaP(ilmP,14, 5,IP) = Tmp1(24, 2) + Xcd*Tmp1(14, 2) 
     ThetaP(ilmP,15, 5,IP) = Tmp1(25, 2) + Xcd*Tmp1(15, 2) 
     ThetaP(ilmP,16, 5,IP) = Tmp1(26, 2) + Xcd*Tmp1(16, 2) 
     ThetaP(ilmP,17, 5,IP) = Tmp1(27, 2) + Xcd*Tmp1(17, 2) 
     ThetaP(ilmP,18, 5,IP) = Tmp1(28, 2) + Xcd*Tmp1(18, 2) 
     ThetaP(ilmP,19, 5,IP) = Tmp1(29, 2) + Xcd*Tmp1(19, 2) 
     ThetaP(ilmP,20, 5,IP) = Tmp1(30, 2) + Xcd*Tmp1(20, 2) 
     ThetaP(ilmP,11, 6,IP) = Tmp1(21, 3) + Xcd*Tmp1(11, 3) 
     ThetaP(ilmP,12, 6,IP) = Tmp1(22, 3) + Xcd*Tmp1(12, 3) 
     ThetaP(ilmP,13, 6,IP) = Tmp1(23, 3) + Xcd*Tmp1(13, 3) 
     ThetaP(ilmP,14, 6,IP) = Tmp1(24, 3) + Xcd*Tmp1(14, 3) 
     ThetaP(ilmP,15, 6,IP) = Tmp1(25, 3) + Xcd*Tmp1(15, 3) 
     ThetaP(ilmP,16, 6,IP) = Tmp1(26, 3) + Xcd*Tmp1(16, 3) 
     ThetaP(ilmP,17, 6,IP) = Tmp1(27, 3) + Xcd*Tmp1(17, 3) 
     ThetaP(ilmP,18, 6,IP) = Tmp1(28, 3) + Xcd*Tmp1(18, 3) 
     ThetaP(ilmP,19, 6,IP) = Tmp1(29, 3) + Xcd*Tmp1(19, 3) 
     ThetaP(ilmP,20, 6,IP) = Tmp1(30, 3) + Xcd*Tmp1(20, 3) 
     ThetaP(ilmP,11, 7,IP) = Tmp1(21, 4) + Xcd*Tmp1(11, 4) 
     ThetaP(ilmP,12, 7,IP) = Tmp1(22, 4) + Xcd*Tmp1(12, 4) 
     ThetaP(ilmP,13, 7,IP) = Tmp1(23, 4) + Xcd*Tmp1(13, 4) 
     ThetaP(ilmP,14, 7,IP) = Tmp1(24, 4) + Xcd*Tmp1(14, 4) 
     ThetaP(ilmP,15, 7,IP) = Tmp1(25, 4) + Xcd*Tmp1(15, 4) 
     ThetaP(ilmP,16, 7,IP) = Tmp1(26, 4) + Xcd*Tmp1(16, 4) 
     ThetaP(ilmP,17, 7,IP) = Tmp1(27, 4) + Xcd*Tmp1(17, 4) 
     ThetaP(ilmP,18, 7,IP) = Tmp1(28, 4) + Xcd*Tmp1(18, 4) 
     ThetaP(ilmP,19, 7,IP) = Tmp1(29, 4) + Xcd*Tmp1(19, 4) 
     ThetaP(ilmP,20, 7,IP) = Tmp1(30, 4) + Xcd*Tmp1(20, 4) 
     ThetaP(ilmP,11, 8,IP) = Tmp1(22, 3) + Ycd*Tmp1(11, 3) 
     ThetaP(ilmP,12, 8,IP) = Tmp1(24, 3) + Ycd*Tmp1(12, 3) 
     ThetaP(ilmP,13, 8,IP) = Tmp1(25, 3) + Ycd*Tmp1(13, 3) 
     ThetaP(ilmP,14, 8,IP) = Tmp1(27, 3) + Ycd*Tmp1(14, 3) 
     ThetaP(ilmP,15, 8,IP) = Tmp1(28, 3) + Ycd*Tmp1(15, 3) 
     ThetaP(ilmP,16, 8,IP) = Tmp1(29, 3) + Ycd*Tmp1(16, 3) 
     ThetaP(ilmP,17, 8,IP) = Tmp1(31, 3) + Ycd*Tmp1(17, 3) 
     ThetaP(ilmP,18, 8,IP) = Tmp1(32, 3) + Ycd*Tmp1(18, 3) 
     ThetaP(ilmP,19, 8,IP) = Tmp1(33, 3) + Ycd*Tmp1(19, 3) 
     ThetaP(ilmP,20, 8,IP) = Tmp1(34, 3) + Ycd*Tmp1(20, 3) 
     ThetaP(ilmP,11, 9,IP) = Tmp1(22, 4) + Ycd*Tmp1(11, 4) 
     ThetaP(ilmP,12, 9,IP) = Tmp1(24, 4) + Ycd*Tmp1(12, 4) 
     ThetaP(ilmP,13, 9,IP) = Tmp1(25, 4) + Ycd*Tmp1(13, 4) 
     ThetaP(ilmP,14, 9,IP) = Tmp1(27, 4) + Ycd*Tmp1(14, 4) 
     ThetaP(ilmP,15, 9,IP) = Tmp1(28, 4) + Ycd*Tmp1(15, 4) 
     ThetaP(ilmP,16, 9,IP) = Tmp1(29, 4) + Ycd*Tmp1(16, 4) 
     ThetaP(ilmP,17, 9,IP) = Tmp1(31, 4) + Ycd*Tmp1(17, 4) 
     ThetaP(ilmP,18, 9,IP) = Tmp1(32, 4) + Ycd*Tmp1(18, 4) 
     ThetaP(ilmP,19, 9,IP) = Tmp1(33, 4) + Ycd*Tmp1(19, 4) 
     ThetaP(ilmP,20, 9,IP) = Tmp1(34, 4) + Ycd*Tmp1(20, 4) 
     ThetaP(ilmP,11,10,IP) = Tmp1(23, 4) + Zcd*Tmp1(11, 4) 
     ThetaP(ilmP,12,10,IP) = Tmp1(25, 4) + Zcd*Tmp1(12, 4) 
     ThetaP(ilmP,13,10,IP) = Tmp1(26, 4) + Zcd*Tmp1(13, 4) 
     ThetaP(ilmP,14,10,IP) = Tmp1(28, 4) + Zcd*Tmp1(14, 4) 
     ThetaP(ilmP,15,10,IP) = Tmp1(29, 4) + Zcd*Tmp1(15, 4) 
     ThetaP(ilmP,16,10,IP) = Tmp1(30, 4) + Zcd*Tmp1(16, 4) 
     ThetaP(ilmP,17,10,IP) = Tmp1(32, 4) + Zcd*Tmp1(17, 4) 
     ThetaP(ilmP,18,10,IP) = Tmp1(33, 4) + Zcd*Tmp1(18, 4) 
     ThetaP(ilmP,19,10,IP) = Tmp1(34, 4) + Zcd*Tmp1(19, 4) 
     ThetaP(ilmP,20,10,IP) = Tmp1(35, 4) + Zcd*Tmp1(20, 4) 
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q5C3D2CtoD

!Transfer angmom from C to D
subroutine HorizontalRR_RHS_Q6C3D3CtoD(nContPQ,nPasses,nlmP,&
         & Qdistance12,ThetaP2,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContPQ,nPasses,nlmP,lupri
  real(realk),intent(in) :: Qdistance12(3)
  real(realk),intent(in) :: ThetaP2(nlmP,   84,nContPQ*nPasses)
  real(realk),intent(inout) :: ThetaP(nlmP,   11:   20,   11:   20,nContPQ*nPasses)
  !Local variables
  integer :: iP,iC,iPassQ,ilmP,iTUVC
  real(realk) :: Xcd,Ycd,Zcd
  real(realk) :: Tmp1( 11: 56,  2:  4)
  real(realk) :: Tmp2( 11: 35,  5: 10)
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none) &
!$OMP PRIVATE(iP,&
!$OMP         Tmp1,&
!$OMP         Tmp2,&
!$OMP         iTUVC,ilmP,Xcd,Ycd,Zcd) &
!$OMP SHARED(nlmP,nContPQ,nPasses,Qdistance12,ThetaP,ThetaP2)
  DO iP = 1,nContPQ*nPasses
   Xcd = Qdistance12(1)
   Ycd = Qdistance12(2)
   Zcd = Qdistance12(3)
    DO ilmP = 1,nlmP
     Tmp1(11, 2) = ThetaP2(ilmP,21,IP) + Xcd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 2) = ThetaP2(ilmP,22,IP) + Xcd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 2) = ThetaP2(ilmP,23,IP) + Xcd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 2) = ThetaP2(ilmP,24,IP) + Xcd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 2) = ThetaP2(ilmP,25,IP) + Xcd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 2) = ThetaP2(ilmP,26,IP) + Xcd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 2) = ThetaP2(ilmP,27,IP) + Xcd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 2) = ThetaP2(ilmP,28,IP) + Xcd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 2) = ThetaP2(ilmP,29,IP) + Xcd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 2) = ThetaP2(ilmP,30,IP) + Xcd*ThetaP2(ilmP,20,IP) 
     Tmp1(21, 2) = ThetaP2(ilmP,36,IP) + Xcd*ThetaP2(ilmP,21,IP) 
     Tmp1(22, 2) = ThetaP2(ilmP,37,IP) + Xcd*ThetaP2(ilmP,22,IP) 
     Tmp1(23, 2) = ThetaP2(ilmP,38,IP) + Xcd*ThetaP2(ilmP,23,IP) 
     Tmp1(24, 2) = ThetaP2(ilmP,39,IP) + Xcd*ThetaP2(ilmP,24,IP) 
     Tmp1(25, 2) = ThetaP2(ilmP,40,IP) + Xcd*ThetaP2(ilmP,25,IP) 
     Tmp1(26, 2) = ThetaP2(ilmP,41,IP) + Xcd*ThetaP2(ilmP,26,IP) 
     Tmp1(27, 2) = ThetaP2(ilmP,42,IP) + Xcd*ThetaP2(ilmP,27,IP) 
     Tmp1(28, 2) = ThetaP2(ilmP,43,IP) + Xcd*ThetaP2(ilmP,28,IP) 
     Tmp1(29, 2) = ThetaP2(ilmP,44,IP) + Xcd*ThetaP2(ilmP,29,IP) 
     Tmp1(30, 2) = ThetaP2(ilmP,45,IP) + Xcd*ThetaP2(ilmP,30,IP) 
     Tmp1(31, 2) = ThetaP2(ilmP,46,IP) + Xcd*ThetaP2(ilmP,31,IP) 
     Tmp1(32, 2) = ThetaP2(ilmP,47,IP) + Xcd*ThetaP2(ilmP,32,IP) 
     Tmp1(33, 2) = ThetaP2(ilmP,48,IP) + Xcd*ThetaP2(ilmP,33,IP) 
     Tmp1(34, 2) = ThetaP2(ilmP,49,IP) + Xcd*ThetaP2(ilmP,34,IP) 
     Tmp1(35, 2) = ThetaP2(ilmP,50,IP) + Xcd*ThetaP2(ilmP,35,IP) 
     Tmp1(36, 2) = ThetaP2(ilmP,57,IP) + Xcd*ThetaP2(ilmP,36,IP) 
     Tmp1(37, 2) = ThetaP2(ilmP,58,IP) + Xcd*ThetaP2(ilmP,37,IP) 
     Tmp1(38, 2) = ThetaP2(ilmP,59,IP) + Xcd*ThetaP2(ilmP,38,IP) 
     Tmp1(39, 2) = ThetaP2(ilmP,60,IP) + Xcd*ThetaP2(ilmP,39,IP) 
     Tmp1(40, 2) = ThetaP2(ilmP,61,IP) + Xcd*ThetaP2(ilmP,40,IP) 
     Tmp1(41, 2) = ThetaP2(ilmP,62,IP) + Xcd*ThetaP2(ilmP,41,IP) 
     Tmp1(42, 2) = ThetaP2(ilmP,63,IP) + Xcd*ThetaP2(ilmP,42,IP) 
     Tmp1(43, 2) = ThetaP2(ilmP,64,IP) + Xcd*ThetaP2(ilmP,43,IP) 
     Tmp1(44, 2) = ThetaP2(ilmP,65,IP) + Xcd*ThetaP2(ilmP,44,IP) 
     Tmp1(45, 2) = ThetaP2(ilmP,66,IP) + Xcd*ThetaP2(ilmP,45,IP) 
     Tmp1(46, 2) = ThetaP2(ilmP,67,IP) + Xcd*ThetaP2(ilmP,46,IP) 
     Tmp1(47, 2) = ThetaP2(ilmP,68,IP) + Xcd*ThetaP2(ilmP,47,IP) 
     Tmp1(48, 2) = ThetaP2(ilmP,69,IP) + Xcd*ThetaP2(ilmP,48,IP) 
     Tmp1(49, 2) = ThetaP2(ilmP,70,IP) + Xcd*ThetaP2(ilmP,49,IP) 
     Tmp1(50, 2) = ThetaP2(ilmP,71,IP) + Xcd*ThetaP2(ilmP,50,IP) 
     Tmp1(51, 2) = ThetaP2(ilmP,72,IP) + Xcd*ThetaP2(ilmP,51,IP) 
     Tmp1(52, 2) = ThetaP2(ilmP,73,IP) + Xcd*ThetaP2(ilmP,52,IP) 
     Tmp1(53, 2) = ThetaP2(ilmP,74,IP) + Xcd*ThetaP2(ilmP,53,IP) 
     Tmp1(54, 2) = ThetaP2(ilmP,75,IP) + Xcd*ThetaP2(ilmP,54,IP) 
     Tmp1(55, 2) = ThetaP2(ilmP,76,IP) + Xcd*ThetaP2(ilmP,55,IP) 
     Tmp1(56, 2) = ThetaP2(ilmP,77,IP) + Xcd*ThetaP2(ilmP,56,IP) 
     Tmp1(11, 3) = ThetaP2(ilmP,22,IP) + Ycd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 3) = ThetaP2(ilmP,24,IP) + Ycd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 3) = ThetaP2(ilmP,25,IP) + Ycd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 3) = ThetaP2(ilmP,27,IP) + Ycd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 3) = ThetaP2(ilmP,28,IP) + Ycd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 3) = ThetaP2(ilmP,29,IP) + Ycd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 3) = ThetaP2(ilmP,31,IP) + Ycd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 3) = ThetaP2(ilmP,32,IP) + Ycd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 3) = ThetaP2(ilmP,33,IP) + Ycd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 3) = ThetaP2(ilmP,34,IP) + Ycd*ThetaP2(ilmP,20,IP) 
     Tmp1(21, 3) = ThetaP2(ilmP,37,IP) + Ycd*ThetaP2(ilmP,21,IP) 
     Tmp1(22, 3) = ThetaP2(ilmP,39,IP) + Ycd*ThetaP2(ilmP,22,IP) 
     Tmp1(23, 3) = ThetaP2(ilmP,40,IP) + Ycd*ThetaP2(ilmP,23,IP) 
     Tmp1(24, 3) = ThetaP2(ilmP,42,IP) + Ycd*ThetaP2(ilmP,24,IP) 
     Tmp1(25, 3) = ThetaP2(ilmP,43,IP) + Ycd*ThetaP2(ilmP,25,IP) 
     Tmp1(26, 3) = ThetaP2(ilmP,44,IP) + Ycd*ThetaP2(ilmP,26,IP) 
     Tmp1(27, 3) = ThetaP2(ilmP,46,IP) + Ycd*ThetaP2(ilmP,27,IP) 
     Tmp1(28, 3) = ThetaP2(ilmP,47,IP) + Ycd*ThetaP2(ilmP,28,IP) 
     Tmp1(29, 3) = ThetaP2(ilmP,48,IP) + Ycd*ThetaP2(ilmP,29,IP) 
     Tmp1(30, 3) = ThetaP2(ilmP,49,IP) + Ycd*ThetaP2(ilmP,30,IP) 
     Tmp1(31, 3) = ThetaP2(ilmP,51,IP) + Ycd*ThetaP2(ilmP,31,IP) 
     Tmp1(32, 3) = ThetaP2(ilmP,52,IP) + Ycd*ThetaP2(ilmP,32,IP) 
     Tmp1(33, 3) = ThetaP2(ilmP,53,IP) + Ycd*ThetaP2(ilmP,33,IP) 
     Tmp1(34, 3) = ThetaP2(ilmP,54,IP) + Ycd*ThetaP2(ilmP,34,IP) 
     Tmp1(35, 3) = ThetaP2(ilmP,55,IP) + Ycd*ThetaP2(ilmP,35,IP) 
     Tmp1(36, 3) = ThetaP2(ilmP,58,IP) + Ycd*ThetaP2(ilmP,36,IP) 
     Tmp1(37, 3) = ThetaP2(ilmP,60,IP) + Ycd*ThetaP2(ilmP,37,IP) 
     Tmp1(38, 3) = ThetaP2(ilmP,61,IP) + Ycd*ThetaP2(ilmP,38,IP) 
     Tmp1(39, 3) = ThetaP2(ilmP,63,IP) + Ycd*ThetaP2(ilmP,39,IP) 
     Tmp1(40, 3) = ThetaP2(ilmP,64,IP) + Ycd*ThetaP2(ilmP,40,IP) 
     Tmp1(41, 3) = ThetaP2(ilmP,65,IP) + Ycd*ThetaP2(ilmP,41,IP) 
     Tmp1(42, 3) = ThetaP2(ilmP,67,IP) + Ycd*ThetaP2(ilmP,42,IP) 
     Tmp1(43, 3) = ThetaP2(ilmP,68,IP) + Ycd*ThetaP2(ilmP,43,IP) 
     Tmp1(44, 3) = ThetaP2(ilmP,69,IP) + Ycd*ThetaP2(ilmP,44,IP) 
     Tmp1(45, 3) = ThetaP2(ilmP,70,IP) + Ycd*ThetaP2(ilmP,45,IP) 
     Tmp1(46, 3) = ThetaP2(ilmP,72,IP) + Ycd*ThetaP2(ilmP,46,IP) 
     Tmp1(47, 3) = ThetaP2(ilmP,73,IP) + Ycd*ThetaP2(ilmP,47,IP) 
     Tmp1(48, 3) = ThetaP2(ilmP,74,IP) + Ycd*ThetaP2(ilmP,48,IP) 
     Tmp1(49, 3) = ThetaP2(ilmP,75,IP) + Ycd*ThetaP2(ilmP,49,IP) 
     Tmp1(50, 3) = ThetaP2(ilmP,76,IP) + Ycd*ThetaP2(ilmP,50,IP) 
     Tmp1(51, 3) = ThetaP2(ilmP,78,IP) + Ycd*ThetaP2(ilmP,51,IP) 
     Tmp1(52, 3) = ThetaP2(ilmP,79,IP) + Ycd*ThetaP2(ilmP,52,IP) 
     Tmp1(53, 3) = ThetaP2(ilmP,80,IP) + Ycd*ThetaP2(ilmP,53,IP) 
     Tmp1(54, 3) = ThetaP2(ilmP,81,IP) + Ycd*ThetaP2(ilmP,54,IP) 
     Tmp1(55, 3) = ThetaP2(ilmP,82,IP) + Ycd*ThetaP2(ilmP,55,IP) 
     Tmp1(56, 3) = ThetaP2(ilmP,83,IP) + Ycd*ThetaP2(ilmP,56,IP) 
     Tmp1(11, 4) = ThetaP2(ilmP,23,IP) + Zcd*ThetaP2(ilmP,11,IP) 
     Tmp1(12, 4) = ThetaP2(ilmP,25,IP) + Zcd*ThetaP2(ilmP,12,IP) 
     Tmp1(13, 4) = ThetaP2(ilmP,26,IP) + Zcd*ThetaP2(ilmP,13,IP) 
     Tmp1(14, 4) = ThetaP2(ilmP,28,IP) + Zcd*ThetaP2(ilmP,14,IP) 
     Tmp1(15, 4) = ThetaP2(ilmP,29,IP) + Zcd*ThetaP2(ilmP,15,IP) 
     Tmp1(16, 4) = ThetaP2(ilmP,30,IP) + Zcd*ThetaP2(ilmP,16,IP) 
     Tmp1(17, 4) = ThetaP2(ilmP,32,IP) + Zcd*ThetaP2(ilmP,17,IP) 
     Tmp1(18, 4) = ThetaP2(ilmP,33,IP) + Zcd*ThetaP2(ilmP,18,IP) 
     Tmp1(19, 4) = ThetaP2(ilmP,34,IP) + Zcd*ThetaP2(ilmP,19,IP) 
     Tmp1(20, 4) = ThetaP2(ilmP,35,IP) + Zcd*ThetaP2(ilmP,20,IP) 
     Tmp1(21, 4) = ThetaP2(ilmP,38,IP) + Zcd*ThetaP2(ilmP,21,IP) 
     Tmp1(22, 4) = ThetaP2(ilmP,40,IP) + Zcd*ThetaP2(ilmP,22,IP) 
     Tmp1(23, 4) = ThetaP2(ilmP,41,IP) + Zcd*ThetaP2(ilmP,23,IP) 
     Tmp1(24, 4) = ThetaP2(ilmP,43,IP) + Zcd*ThetaP2(ilmP,24,IP) 
     Tmp1(25, 4) = ThetaP2(ilmP,44,IP) + Zcd*ThetaP2(ilmP,25,IP) 
     Tmp1(26, 4) = ThetaP2(ilmP,45,IP) + Zcd*ThetaP2(ilmP,26,IP) 
     Tmp1(27, 4) = ThetaP2(ilmP,47,IP) + Zcd*ThetaP2(ilmP,27,IP) 
     Tmp1(28, 4) = ThetaP2(ilmP,48,IP) + Zcd*ThetaP2(ilmP,28,IP) 
     Tmp1(29, 4) = ThetaP2(ilmP,49,IP) + Zcd*ThetaP2(ilmP,29,IP) 
     Tmp1(30, 4) = ThetaP2(ilmP,50,IP) + Zcd*ThetaP2(ilmP,30,IP) 
     Tmp1(31, 4) = ThetaP2(ilmP,52,IP) + Zcd*ThetaP2(ilmP,31,IP) 
     Tmp1(32, 4) = ThetaP2(ilmP,53,IP) + Zcd*ThetaP2(ilmP,32,IP) 
     Tmp1(33, 4) = ThetaP2(ilmP,54,IP) + Zcd*ThetaP2(ilmP,33,IP) 
     Tmp1(34, 4) = ThetaP2(ilmP,55,IP) + Zcd*ThetaP2(ilmP,34,IP) 
     Tmp1(35, 4) = ThetaP2(ilmP,56,IP) + Zcd*ThetaP2(ilmP,35,IP) 
     Tmp1(36, 4) = ThetaP2(ilmP,59,IP) + Zcd*ThetaP2(ilmP,36,IP) 
     Tmp1(37, 4) = ThetaP2(ilmP,61,IP) + Zcd*ThetaP2(ilmP,37,IP) 
     Tmp1(38, 4) = ThetaP2(ilmP,62,IP) + Zcd*ThetaP2(ilmP,38,IP) 
     Tmp1(39, 4) = ThetaP2(ilmP,64,IP) + Zcd*ThetaP2(ilmP,39,IP) 
     Tmp1(40, 4) = ThetaP2(ilmP,65,IP) + Zcd*ThetaP2(ilmP,40,IP) 
     Tmp1(41, 4) = ThetaP2(ilmP,66,IP) + Zcd*ThetaP2(ilmP,41,IP) 
     Tmp1(42, 4) = ThetaP2(ilmP,68,IP) + Zcd*ThetaP2(ilmP,42,IP) 
     Tmp1(43, 4) = ThetaP2(ilmP,69,IP) + Zcd*ThetaP2(ilmP,43,IP) 
     Tmp1(44, 4) = ThetaP2(ilmP,70,IP) + Zcd*ThetaP2(ilmP,44,IP) 
     Tmp1(45, 4) = ThetaP2(ilmP,71,IP) + Zcd*ThetaP2(ilmP,45,IP) 
     Tmp1(46, 4) = ThetaP2(ilmP,73,IP) + Zcd*ThetaP2(ilmP,46,IP) 
     Tmp1(47, 4) = ThetaP2(ilmP,74,IP) + Zcd*ThetaP2(ilmP,47,IP) 
     Tmp1(48, 4) = ThetaP2(ilmP,75,IP) + Zcd*ThetaP2(ilmP,48,IP) 
     Tmp1(49, 4) = ThetaP2(ilmP,76,IP) + Zcd*ThetaP2(ilmP,49,IP) 
     Tmp1(50, 4) = ThetaP2(ilmP,77,IP) + Zcd*ThetaP2(ilmP,50,IP) 
     Tmp1(51, 4) = ThetaP2(ilmP,79,IP) + Zcd*ThetaP2(ilmP,51,IP) 
     Tmp1(52, 4) = ThetaP2(ilmP,80,IP) + Zcd*ThetaP2(ilmP,52,IP) 
     Tmp1(53, 4) = ThetaP2(ilmP,81,IP) + Zcd*ThetaP2(ilmP,53,IP) 
     Tmp1(54, 4) = ThetaP2(ilmP,82,IP) + Zcd*ThetaP2(ilmP,54,IP) 
     Tmp1(55, 4) = ThetaP2(ilmP,83,IP) + Zcd*ThetaP2(ilmP,55,IP) 
     Tmp1(56, 4) = ThetaP2(ilmP,84,IP) + Zcd*ThetaP2(ilmP,56,IP) 
     Tmp2(11, 5) = Tmp1(21, 2) + Xcd*Tmp1(11, 2) 
     Tmp2(12, 5) = Tmp1(22, 2) + Xcd*Tmp1(12, 2) 
     Tmp2(13, 5) = Tmp1(23, 2) + Xcd*Tmp1(13, 2) 
     Tmp2(14, 5) = Tmp1(24, 2) + Xcd*Tmp1(14, 2) 
     Tmp2(15, 5) = Tmp1(25, 2) + Xcd*Tmp1(15, 2) 
     Tmp2(16, 5) = Tmp1(26, 2) + Xcd*Tmp1(16, 2) 
     Tmp2(17, 5) = Tmp1(27, 2) + Xcd*Tmp1(17, 2) 
     Tmp2(18, 5) = Tmp1(28, 2) + Xcd*Tmp1(18, 2) 
     Tmp2(19, 5) = Tmp1(29, 2) + Xcd*Tmp1(19, 2) 
     Tmp2(20, 5) = Tmp1(30, 2) + Xcd*Tmp1(20, 2) 
     Tmp2(21, 5) = Tmp1(36, 2) + Xcd*Tmp1(21, 2) 
     Tmp2(22, 5) = Tmp1(37, 2) + Xcd*Tmp1(22, 2) 
     Tmp2(23, 5) = Tmp1(38, 2) + Xcd*Tmp1(23, 2) 
     Tmp2(24, 5) = Tmp1(39, 2) + Xcd*Tmp1(24, 2) 
     Tmp2(25, 5) = Tmp1(40, 2) + Xcd*Tmp1(25, 2) 
     Tmp2(26, 5) = Tmp1(41, 2) + Xcd*Tmp1(26, 2) 
     Tmp2(27, 5) = Tmp1(42, 2) + Xcd*Tmp1(27, 2) 
     Tmp2(28, 5) = Tmp1(43, 2) + Xcd*Tmp1(28, 2) 
     Tmp2(29, 5) = Tmp1(44, 2) + Xcd*Tmp1(29, 2) 
     Tmp2(30, 5) = Tmp1(45, 2) + Xcd*Tmp1(30, 2) 
     Tmp2(31, 5) = Tmp1(46, 2) + Xcd*Tmp1(31, 2) 
     Tmp2(32, 5) = Tmp1(47, 2) + Xcd*Tmp1(32, 2) 
     Tmp2(33, 5) = Tmp1(48, 2) + Xcd*Tmp1(33, 2) 
     Tmp2(34, 5) = Tmp1(49, 2) + Xcd*Tmp1(34, 2) 
     Tmp2(35, 5) = Tmp1(50, 2) + Xcd*Tmp1(35, 2) 
     Tmp2(11, 6) = Tmp1(21, 3) + Xcd*Tmp1(11, 3) 
     Tmp2(12, 6) = Tmp1(22, 3) + Xcd*Tmp1(12, 3) 
     Tmp2(13, 6) = Tmp1(23, 3) + Xcd*Tmp1(13, 3) 
     Tmp2(14, 6) = Tmp1(24, 3) + Xcd*Tmp1(14, 3) 
     Tmp2(15, 6) = Tmp1(25, 3) + Xcd*Tmp1(15, 3) 
     Tmp2(16, 6) = Tmp1(26, 3) + Xcd*Tmp1(16, 3) 
     Tmp2(17, 6) = Tmp1(27, 3) + Xcd*Tmp1(17, 3) 
     Tmp2(18, 6) = Tmp1(28, 3) + Xcd*Tmp1(18, 3) 
     Tmp2(19, 6) = Tmp1(29, 3) + Xcd*Tmp1(19, 3) 
     Tmp2(20, 6) = Tmp1(30, 3) + Xcd*Tmp1(20, 3) 
     Tmp2(21, 6) = Tmp1(36, 3) + Xcd*Tmp1(21, 3) 
     Tmp2(22, 6) = Tmp1(37, 3) + Xcd*Tmp1(22, 3) 
     Tmp2(23, 6) = Tmp1(38, 3) + Xcd*Tmp1(23, 3) 
     Tmp2(24, 6) = Tmp1(39, 3) + Xcd*Tmp1(24, 3) 
     Tmp2(25, 6) = Tmp1(40, 3) + Xcd*Tmp1(25, 3) 
     Tmp2(26, 6) = Tmp1(41, 3) + Xcd*Tmp1(26, 3) 
     Tmp2(27, 6) = Tmp1(42, 3) + Xcd*Tmp1(27, 3) 
     Tmp2(28, 6) = Tmp1(43, 3) + Xcd*Tmp1(28, 3) 
     Tmp2(29, 6) = Tmp1(44, 3) + Xcd*Tmp1(29, 3) 
     Tmp2(30, 6) = Tmp1(45, 3) + Xcd*Tmp1(30, 3) 
     Tmp2(31, 6) = Tmp1(46, 3) + Xcd*Tmp1(31, 3) 
     Tmp2(32, 6) = Tmp1(47, 3) + Xcd*Tmp1(32, 3) 
     Tmp2(33, 6) = Tmp1(48, 3) + Xcd*Tmp1(33, 3) 
     Tmp2(34, 6) = Tmp1(49, 3) + Xcd*Tmp1(34, 3) 
     Tmp2(35, 6) = Tmp1(50, 3) + Xcd*Tmp1(35, 3) 
     Tmp2(11, 7) = Tmp1(21, 4) + Xcd*Tmp1(11, 4) 
     Tmp2(12, 7) = Tmp1(22, 4) + Xcd*Tmp1(12, 4) 
     Tmp2(13, 7) = Tmp1(23, 4) + Xcd*Tmp1(13, 4) 
     Tmp2(14, 7) = Tmp1(24, 4) + Xcd*Tmp1(14, 4) 
     Tmp2(15, 7) = Tmp1(25, 4) + Xcd*Tmp1(15, 4) 
     Tmp2(16, 7) = Tmp1(26, 4) + Xcd*Tmp1(16, 4) 
     Tmp2(17, 7) = Tmp1(27, 4) + Xcd*Tmp1(17, 4) 
     Tmp2(18, 7) = Tmp1(28, 4) + Xcd*Tmp1(18, 4) 
     Tmp2(19, 7) = Tmp1(29, 4) + Xcd*Tmp1(19, 4) 
     Tmp2(20, 7) = Tmp1(30, 4) + Xcd*Tmp1(20, 4) 
     Tmp2(21, 7) = Tmp1(36, 4) + Xcd*Tmp1(21, 4) 
     Tmp2(22, 7) = Tmp1(37, 4) + Xcd*Tmp1(22, 4) 
     Tmp2(23, 7) = Tmp1(38, 4) + Xcd*Tmp1(23, 4) 
     Tmp2(24, 7) = Tmp1(39, 4) + Xcd*Tmp1(24, 4) 
     Tmp2(25, 7) = Tmp1(40, 4) + Xcd*Tmp1(25, 4) 
     Tmp2(26, 7) = Tmp1(41, 4) + Xcd*Tmp1(26, 4) 
     Tmp2(27, 7) = Tmp1(42, 4) + Xcd*Tmp1(27, 4) 
     Tmp2(28, 7) = Tmp1(43, 4) + Xcd*Tmp1(28, 4) 
     Tmp2(29, 7) = Tmp1(44, 4) + Xcd*Tmp1(29, 4) 
     Tmp2(30, 7) = Tmp1(45, 4) + Xcd*Tmp1(30, 4) 
     Tmp2(31, 7) = Tmp1(46, 4) + Xcd*Tmp1(31, 4) 
     Tmp2(32, 7) = Tmp1(47, 4) + Xcd*Tmp1(32, 4) 
     Tmp2(33, 7) = Tmp1(48, 4) + Xcd*Tmp1(33, 4) 
     Tmp2(34, 7) = Tmp1(49, 4) + Xcd*Tmp1(34, 4) 
     Tmp2(35, 7) = Tmp1(50, 4) + Xcd*Tmp1(35, 4) 
     Tmp2(11, 8) = Tmp1(22, 3) + Ycd*Tmp1(11, 3) 
     Tmp2(12, 8) = Tmp1(24, 3) + Ycd*Tmp1(12, 3) 
     Tmp2(13, 8) = Tmp1(25, 3) + Ycd*Tmp1(13, 3) 
     Tmp2(14, 8) = Tmp1(27, 3) + Ycd*Tmp1(14, 3) 
     Tmp2(15, 8) = Tmp1(28, 3) + Ycd*Tmp1(15, 3) 
     Tmp2(16, 8) = Tmp1(29, 3) + Ycd*Tmp1(16, 3) 
     Tmp2(17, 8) = Tmp1(31, 3) + Ycd*Tmp1(17, 3) 
     Tmp2(18, 8) = Tmp1(32, 3) + Ycd*Tmp1(18, 3) 
     Tmp2(19, 8) = Tmp1(33, 3) + Ycd*Tmp1(19, 3) 
     Tmp2(20, 8) = Tmp1(34, 3) + Ycd*Tmp1(20, 3) 
     Tmp2(21, 8) = Tmp1(37, 3) + Ycd*Tmp1(21, 3) 
     Tmp2(22, 8) = Tmp1(39, 3) + Ycd*Tmp1(22, 3) 
     Tmp2(23, 8) = Tmp1(40, 3) + Ycd*Tmp1(23, 3) 
     Tmp2(24, 8) = Tmp1(42, 3) + Ycd*Tmp1(24, 3) 
     Tmp2(25, 8) = Tmp1(43, 3) + Ycd*Tmp1(25, 3) 
     Tmp2(26, 8) = Tmp1(44, 3) + Ycd*Tmp1(26, 3) 
     Tmp2(27, 8) = Tmp1(46, 3) + Ycd*Tmp1(27, 3) 
     Tmp2(28, 8) = Tmp1(47, 3) + Ycd*Tmp1(28, 3) 
     Tmp2(29, 8) = Tmp1(48, 3) + Ycd*Tmp1(29, 3) 
     Tmp2(30, 8) = Tmp1(49, 3) + Ycd*Tmp1(30, 3) 
     Tmp2(31, 8) = Tmp1(51, 3) + Ycd*Tmp1(31, 3) 
     Tmp2(32, 8) = Tmp1(52, 3) + Ycd*Tmp1(32, 3) 
     Tmp2(33, 8) = Tmp1(53, 3) + Ycd*Tmp1(33, 3) 
     Tmp2(34, 8) = Tmp1(54, 3) + Ycd*Tmp1(34, 3) 
     Tmp2(35, 8) = Tmp1(55, 3) + Ycd*Tmp1(35, 3) 
     Tmp2(11, 9) = Tmp1(22, 4) + Ycd*Tmp1(11, 4) 
     Tmp2(12, 9) = Tmp1(24, 4) + Ycd*Tmp1(12, 4) 
     Tmp2(13, 9) = Tmp1(25, 4) + Ycd*Tmp1(13, 4) 
     Tmp2(14, 9) = Tmp1(27, 4) + Ycd*Tmp1(14, 4) 
     Tmp2(15, 9) = Tmp1(28, 4) + Ycd*Tmp1(15, 4) 
     Tmp2(16, 9) = Tmp1(29, 4) + Ycd*Tmp1(16, 4) 
     Tmp2(17, 9) = Tmp1(31, 4) + Ycd*Tmp1(17, 4) 
     Tmp2(18, 9) = Tmp1(32, 4) + Ycd*Tmp1(18, 4) 
     Tmp2(19, 9) = Tmp1(33, 4) + Ycd*Tmp1(19, 4) 
     Tmp2(20, 9) = Tmp1(34, 4) + Ycd*Tmp1(20, 4) 
     Tmp2(21, 9) = Tmp1(37, 4) + Ycd*Tmp1(21, 4) 
     Tmp2(22, 9) = Tmp1(39, 4) + Ycd*Tmp1(22, 4) 
     Tmp2(23, 9) = Tmp1(40, 4) + Ycd*Tmp1(23, 4) 
     Tmp2(24, 9) = Tmp1(42, 4) + Ycd*Tmp1(24, 4) 
     Tmp2(25, 9) = Tmp1(43, 4) + Ycd*Tmp1(25, 4) 
     Tmp2(26, 9) = Tmp1(44, 4) + Ycd*Tmp1(26, 4) 
     Tmp2(27, 9) = Tmp1(46, 4) + Ycd*Tmp1(27, 4) 
     Tmp2(28, 9) = Tmp1(47, 4) + Ycd*Tmp1(28, 4) 
     Tmp2(29, 9) = Tmp1(48, 4) + Ycd*Tmp1(29, 4) 
     Tmp2(30, 9) = Tmp1(49, 4) + Ycd*Tmp1(30, 4) 
     Tmp2(31, 9) = Tmp1(51, 4) + Ycd*Tmp1(31, 4) 
     Tmp2(32, 9) = Tmp1(52, 4) + Ycd*Tmp1(32, 4) 
     Tmp2(33, 9) = Tmp1(53, 4) + Ycd*Tmp1(33, 4) 
     Tmp2(34, 9) = Tmp1(54, 4) + Ycd*Tmp1(34, 4) 
     Tmp2(35, 9) = Tmp1(55, 4) + Ycd*Tmp1(35, 4) 
     Tmp2(11,10) = Tmp1(23, 4) + Zcd*Tmp1(11, 4) 
     Tmp2(12,10) = Tmp1(25, 4) + Zcd*Tmp1(12, 4) 
     Tmp2(13,10) = Tmp1(26, 4) + Zcd*Tmp1(13, 4) 
     Tmp2(14,10) = Tmp1(28, 4) + Zcd*Tmp1(14, 4) 
     Tmp2(15,10) = Tmp1(29, 4) + Zcd*Tmp1(15, 4) 
     Tmp2(16,10) = Tmp1(30, 4) + Zcd*Tmp1(16, 4) 
     Tmp2(17,10) = Tmp1(32, 4) + Zcd*Tmp1(17, 4) 
     Tmp2(18,10) = Tmp1(33, 4) + Zcd*Tmp1(18, 4) 
     Tmp2(19,10) = Tmp1(34, 4) + Zcd*Tmp1(19, 4) 
     Tmp2(20,10) = Tmp1(35, 4) + Zcd*Tmp1(20, 4) 
     Tmp2(21,10) = Tmp1(38, 4) + Zcd*Tmp1(21, 4) 
     Tmp2(22,10) = Tmp1(40, 4) + Zcd*Tmp1(22, 4) 
     Tmp2(23,10) = Tmp1(41, 4) + Zcd*Tmp1(23, 4) 
     Tmp2(24,10) = Tmp1(43, 4) + Zcd*Tmp1(24, 4) 
     Tmp2(25,10) = Tmp1(44, 4) + Zcd*Tmp1(25, 4) 
     Tmp2(26,10) = Tmp1(45, 4) + Zcd*Tmp1(26, 4) 
     Tmp2(27,10) = Tmp1(47, 4) + Zcd*Tmp1(27, 4) 
     Tmp2(28,10) = Tmp1(48, 4) + Zcd*Tmp1(28, 4) 
     Tmp2(29,10) = Tmp1(49, 4) + Zcd*Tmp1(29, 4) 
     Tmp2(30,10) = Tmp1(50, 4) + Zcd*Tmp1(30, 4) 
     Tmp2(31,10) = Tmp1(52, 4) + Zcd*Tmp1(31, 4) 
     Tmp2(32,10) = Tmp1(53, 4) + Zcd*Tmp1(32, 4) 
     Tmp2(33,10) = Tmp1(54, 4) + Zcd*Tmp1(33, 4) 
     Tmp2(34,10) = Tmp1(55, 4) + Zcd*Tmp1(34, 4) 
     Tmp2(35,10) = Tmp1(56, 4) + Zcd*Tmp1(35, 4) 
     ThetaP(ilmP,11,11,IP) = Tmp2(21, 5) + Xcd*Tmp2(11, 5) 
     ThetaP(ilmP,12,11,IP) = Tmp2(22, 5) + Xcd*Tmp2(12, 5) 
     ThetaP(ilmP,13,11,IP) = Tmp2(23, 5) + Xcd*Tmp2(13, 5) 
     ThetaP(ilmP,14,11,IP) = Tmp2(24, 5) + Xcd*Tmp2(14, 5) 
     ThetaP(ilmP,15,11,IP) = Tmp2(25, 5) + Xcd*Tmp2(15, 5) 
     ThetaP(ilmP,16,11,IP) = Tmp2(26, 5) + Xcd*Tmp2(16, 5) 
     ThetaP(ilmP,17,11,IP) = Tmp2(27, 5) + Xcd*Tmp2(17, 5) 
     ThetaP(ilmP,18,11,IP) = Tmp2(28, 5) + Xcd*Tmp2(18, 5) 
     ThetaP(ilmP,19,11,IP) = Tmp2(29, 5) + Xcd*Tmp2(19, 5) 
     ThetaP(ilmP,20,11,IP) = Tmp2(30, 5) + Xcd*Tmp2(20, 5) 
     ThetaP(ilmP,11,12,IP) = Tmp2(21, 6) + Xcd*Tmp2(11, 6) 
     ThetaP(ilmP,12,12,IP) = Tmp2(22, 6) + Xcd*Tmp2(12, 6) 
     ThetaP(ilmP,13,12,IP) = Tmp2(23, 6) + Xcd*Tmp2(13, 6) 
     ThetaP(ilmP,14,12,IP) = Tmp2(24, 6) + Xcd*Tmp2(14, 6) 
     ThetaP(ilmP,15,12,IP) = Tmp2(25, 6) + Xcd*Tmp2(15, 6) 
     ThetaP(ilmP,16,12,IP) = Tmp2(26, 6) + Xcd*Tmp2(16, 6) 
     ThetaP(ilmP,17,12,IP) = Tmp2(27, 6) + Xcd*Tmp2(17, 6) 
     ThetaP(ilmP,18,12,IP) = Tmp2(28, 6) + Xcd*Tmp2(18, 6) 
     ThetaP(ilmP,19,12,IP) = Tmp2(29, 6) + Xcd*Tmp2(19, 6) 
     ThetaP(ilmP,20,12,IP) = Tmp2(30, 6) + Xcd*Tmp2(20, 6) 
     ThetaP(ilmP,11,13,IP) = Tmp2(21, 7) + Xcd*Tmp2(11, 7) 
     ThetaP(ilmP,12,13,IP) = Tmp2(22, 7) + Xcd*Tmp2(12, 7) 
     ThetaP(ilmP,13,13,IP) = Tmp2(23, 7) + Xcd*Tmp2(13, 7) 
     ThetaP(ilmP,14,13,IP) = Tmp2(24, 7) + Xcd*Tmp2(14, 7) 
     ThetaP(ilmP,15,13,IP) = Tmp2(25, 7) + Xcd*Tmp2(15, 7) 
     ThetaP(ilmP,16,13,IP) = Tmp2(26, 7) + Xcd*Tmp2(16, 7) 
     ThetaP(ilmP,17,13,IP) = Tmp2(27, 7) + Xcd*Tmp2(17, 7) 
     ThetaP(ilmP,18,13,IP) = Tmp2(28, 7) + Xcd*Tmp2(18, 7) 
     ThetaP(ilmP,19,13,IP) = Tmp2(29, 7) + Xcd*Tmp2(19, 7) 
     ThetaP(ilmP,20,13,IP) = Tmp2(30, 7) + Xcd*Tmp2(20, 7) 
     ThetaP(ilmP,11,14,IP) = Tmp2(21, 8) + Xcd*Tmp2(11, 8) 
     ThetaP(ilmP,12,14,IP) = Tmp2(22, 8) + Xcd*Tmp2(12, 8) 
     ThetaP(ilmP,13,14,IP) = Tmp2(23, 8) + Xcd*Tmp2(13, 8) 
     ThetaP(ilmP,14,14,IP) = Tmp2(24, 8) + Xcd*Tmp2(14, 8) 
     ThetaP(ilmP,15,14,IP) = Tmp2(25, 8) + Xcd*Tmp2(15, 8) 
     ThetaP(ilmP,16,14,IP) = Tmp2(26, 8) + Xcd*Tmp2(16, 8) 
     ThetaP(ilmP,17,14,IP) = Tmp2(27, 8) + Xcd*Tmp2(17, 8) 
     ThetaP(ilmP,18,14,IP) = Tmp2(28, 8) + Xcd*Tmp2(18, 8) 
     ThetaP(ilmP,19,14,IP) = Tmp2(29, 8) + Xcd*Tmp2(19, 8) 
     ThetaP(ilmP,20,14,IP) = Tmp2(30, 8) + Xcd*Tmp2(20, 8) 
     ThetaP(ilmP,11,15,IP) = Tmp2(21, 9) + Xcd*Tmp2(11, 9) 
     ThetaP(ilmP,12,15,IP) = Tmp2(22, 9) + Xcd*Tmp2(12, 9) 
     ThetaP(ilmP,13,15,IP) = Tmp2(23, 9) + Xcd*Tmp2(13, 9) 
     ThetaP(ilmP,14,15,IP) = Tmp2(24, 9) + Xcd*Tmp2(14, 9) 
     ThetaP(ilmP,15,15,IP) = Tmp2(25, 9) + Xcd*Tmp2(15, 9) 
     ThetaP(ilmP,16,15,IP) = Tmp2(26, 9) + Xcd*Tmp2(16, 9) 
     ThetaP(ilmP,17,15,IP) = Tmp2(27, 9) + Xcd*Tmp2(17, 9) 
     ThetaP(ilmP,18,15,IP) = Tmp2(28, 9) + Xcd*Tmp2(18, 9) 
     ThetaP(ilmP,19,15,IP) = Tmp2(29, 9) + Xcd*Tmp2(19, 9) 
     ThetaP(ilmP,20,15,IP) = Tmp2(30, 9) + Xcd*Tmp2(20, 9) 
     ThetaP(ilmP,11,16,IP) = Tmp2(21,10) + Xcd*Tmp2(11,10) 
     ThetaP(ilmP,12,16,IP) = Tmp2(22,10) + Xcd*Tmp2(12,10) 
     ThetaP(ilmP,13,16,IP) = Tmp2(23,10) + Xcd*Tmp2(13,10) 
     ThetaP(ilmP,14,16,IP) = Tmp2(24,10) + Xcd*Tmp2(14,10) 
     ThetaP(ilmP,15,16,IP) = Tmp2(25,10) + Xcd*Tmp2(15,10) 
     ThetaP(ilmP,16,16,IP) = Tmp2(26,10) + Xcd*Tmp2(16,10) 
     ThetaP(ilmP,17,16,IP) = Tmp2(27,10) + Xcd*Tmp2(17,10) 
     ThetaP(ilmP,18,16,IP) = Tmp2(28,10) + Xcd*Tmp2(18,10) 
     ThetaP(ilmP,19,16,IP) = Tmp2(29,10) + Xcd*Tmp2(19,10) 
     ThetaP(ilmP,20,16,IP) = Tmp2(30,10) + Xcd*Tmp2(20,10) 
     ThetaP(ilmP,11,17,IP) = Tmp2(22, 8) + Ycd*Tmp2(11, 8) 
     ThetaP(ilmP,12,17,IP) = Tmp2(24, 8) + Ycd*Tmp2(12, 8) 
     ThetaP(ilmP,13,17,IP) = Tmp2(25, 8) + Ycd*Tmp2(13, 8) 
     ThetaP(ilmP,14,17,IP) = Tmp2(27, 8) + Ycd*Tmp2(14, 8) 
     ThetaP(ilmP,15,17,IP) = Tmp2(28, 8) + Ycd*Tmp2(15, 8) 
     ThetaP(ilmP,16,17,IP) = Tmp2(29, 8) + Ycd*Tmp2(16, 8) 
     ThetaP(ilmP,17,17,IP) = Tmp2(31, 8) + Ycd*Tmp2(17, 8) 
     ThetaP(ilmP,18,17,IP) = Tmp2(32, 8) + Ycd*Tmp2(18, 8) 
     ThetaP(ilmP,19,17,IP) = Tmp2(33, 8) + Ycd*Tmp2(19, 8) 
     ThetaP(ilmP,20,17,IP) = Tmp2(34, 8) + Ycd*Tmp2(20, 8) 
     ThetaP(ilmP,11,18,IP) = Tmp2(22, 9) + Ycd*Tmp2(11, 9) 
     ThetaP(ilmP,12,18,IP) = Tmp2(24, 9) + Ycd*Tmp2(12, 9) 
     ThetaP(ilmP,13,18,IP) = Tmp2(25, 9) + Ycd*Tmp2(13, 9) 
     ThetaP(ilmP,14,18,IP) = Tmp2(27, 9) + Ycd*Tmp2(14, 9) 
     ThetaP(ilmP,15,18,IP) = Tmp2(28, 9) + Ycd*Tmp2(15, 9) 
     ThetaP(ilmP,16,18,IP) = Tmp2(29, 9) + Ycd*Tmp2(16, 9) 
     ThetaP(ilmP,17,18,IP) = Tmp2(31, 9) + Ycd*Tmp2(17, 9) 
     ThetaP(ilmP,18,18,IP) = Tmp2(32, 9) + Ycd*Tmp2(18, 9) 
     ThetaP(ilmP,19,18,IP) = Tmp2(33, 9) + Ycd*Tmp2(19, 9) 
     ThetaP(ilmP,20,18,IP) = Tmp2(34, 9) + Ycd*Tmp2(20, 9) 
     ThetaP(ilmP,11,19,IP) = Tmp2(22,10) + Ycd*Tmp2(11,10) 
     ThetaP(ilmP,12,19,IP) = Tmp2(24,10) + Ycd*Tmp2(12,10) 
     ThetaP(ilmP,13,19,IP) = Tmp2(25,10) + Ycd*Tmp2(13,10) 
     ThetaP(ilmP,14,19,IP) = Tmp2(27,10) + Ycd*Tmp2(14,10) 
     ThetaP(ilmP,15,19,IP) = Tmp2(28,10) + Ycd*Tmp2(15,10) 
     ThetaP(ilmP,16,19,IP) = Tmp2(29,10) + Ycd*Tmp2(16,10) 
     ThetaP(ilmP,17,19,IP) = Tmp2(31,10) + Ycd*Tmp2(17,10) 
     ThetaP(ilmP,18,19,IP) = Tmp2(32,10) + Ycd*Tmp2(18,10) 
     ThetaP(ilmP,19,19,IP) = Tmp2(33,10) + Ycd*Tmp2(19,10) 
     ThetaP(ilmP,20,19,IP) = Tmp2(34,10) + Ycd*Tmp2(20,10) 
     ThetaP(ilmP,11,20,IP) = Tmp2(23,10) + Zcd*Tmp2(11,10) 
     ThetaP(ilmP,12,20,IP) = Tmp2(25,10) + Zcd*Tmp2(12,10) 
     ThetaP(ilmP,13,20,IP) = Tmp2(26,10) + Zcd*Tmp2(13,10) 
     ThetaP(ilmP,14,20,IP) = Tmp2(28,10) + Zcd*Tmp2(14,10) 
     ThetaP(ilmP,15,20,IP) = Tmp2(29,10) + Zcd*Tmp2(15,10) 
     ThetaP(ilmP,16,20,IP) = Tmp2(30,10) + Zcd*Tmp2(16,10) 
     ThetaP(ilmP,17,20,IP) = Tmp2(32,10) + Zcd*Tmp2(17,10) 
     ThetaP(ilmP,18,20,IP) = Tmp2(33,10) + Zcd*Tmp2(18,10) 
     ThetaP(ilmP,19,20,IP) = Tmp2(34,10) + Zcd*Tmp2(19,10) 
     ThetaP(ilmP,20,20,IP) = Tmp2(35,10) + Zcd*Tmp2(20,10) 
    ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_RHS_Q6C3D3CtoD
end module
