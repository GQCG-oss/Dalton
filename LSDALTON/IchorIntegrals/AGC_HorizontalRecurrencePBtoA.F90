MODULE AGC_OBS_HorizontalRecurrenceLHSModBtoA
 use IchorPrecisionModule
  
 CONTAINS

subroutine HorizontalRR_LHS_P1A0B1BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(    4,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    1:    1,    2:    4,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         iTUVB) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
     DO iTUVB=  2,  4
        ThetaP(1,iTUVB,iP) = AuxCont(iTUVB,iP)
     ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P1A0B1BtoA

subroutine HorizontalRR_LHS_P2A0B2BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   10,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    1:    1,    5:   10,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         iTUVB) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
     DO iTUVB=  5, 10
        ThetaP(1,iTUVB,iP) = AuxCont(iTUVB,iP)
     ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P2A0B2BtoA

subroutine HorizontalRR_LHS_P2A1B1BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   10,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    2:    4,    2:    4,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
  real(realk) :: Xab,Yab,Zab
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         iPassP,iTUVB,iAtomA,iAtomB,Xab,Yab,Zab) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         iAtomApass,iAtomBpass,Pdistance12,AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
   iPassP = (iP-1)/(nTUVQ*nContQP)+1
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = -Pdistance12(1,iAtomA,iAtomB)
   Yab = -Pdistance12(2,iAtomA,iAtomB)
   Zab = -Pdistance12(3,iAtomA,iAtomB)
     ThetaP( 2, 2      ,iP) = AuxCont( 5      ,iP)+ Xab*AuxCont( 2,      ip) 
     ThetaP( 2, 3      ,iP) = AuxCont( 6      ,iP)+ Xab*AuxCont( 3,      ip) 
     ThetaP( 2, 4      ,iP) = AuxCont( 7      ,iP)+ Xab*AuxCont( 4,      ip) 
     ThetaP( 3, 2      ,iP) = AuxCont( 6      ,iP)+ Yab*AuxCont( 2,      ip) 
     ThetaP( 3, 3      ,iP) = AuxCont( 8      ,iP)+ Yab*AuxCont( 3,      ip) 
     ThetaP( 3, 4      ,iP) = AuxCont( 9      ,iP)+ Yab*AuxCont( 4,      ip) 
     ThetaP( 4, 2      ,iP) = AuxCont( 7      ,iP)+ Zab*AuxCont( 2,      ip) 
     ThetaP( 4, 3      ,iP) = AuxCont( 9      ,iP)+ Zab*AuxCont( 3,      ip) 
     ThetaP( 4, 4      ,iP) = AuxCont(10      ,iP)+ Zab*AuxCont( 4,      ip) 
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P2A1B1BtoA

subroutine HorizontalRR_LHS_P3A0B3BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   20,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    1:    1,   11:   20,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         iTUVB) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
     DO iTUVB= 11, 20
        ThetaP(1,iTUVB,iP) = AuxCont(iTUVB,iP)
     ENDDO
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P3A0B3BtoA

subroutine HorizontalRR_LHS_P3A1B2BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   20,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    2:    4,    5:   10,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
  real(realk) :: Xab,Yab,Zab
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         iPassP,iTUVB,iAtomA,iAtomB,Xab,Yab,Zab) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         iAtomApass,iAtomBpass,Pdistance12,AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
   iPassP = (iP-1)/(nTUVQ*nContQP)+1
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = -Pdistance12(1,iAtomA,iAtomB)
   Yab = -Pdistance12(2,iAtomA,iAtomB)
   Zab = -Pdistance12(3,iAtomA,iAtomB)
     ThetaP( 2, 5      ,iP) = AuxCont(11      ,iP)+ Xab*AuxCont( 5,      ip) 
     ThetaP( 2, 6      ,iP) = AuxCont(12      ,iP)+ Xab*AuxCont( 6,      ip) 
     ThetaP( 2, 7      ,iP) = AuxCont(13      ,iP)+ Xab*AuxCont( 7,      ip) 
     ThetaP( 2, 8      ,iP) = AuxCont(14      ,iP)+ Xab*AuxCont( 8,      ip) 
     ThetaP( 2, 9      ,iP) = AuxCont(15      ,iP)+ Xab*AuxCont( 9,      ip) 
     ThetaP( 2,10      ,iP) = AuxCont(16      ,iP)+ Xab*AuxCont(10,      ip) 
     ThetaP( 3, 5      ,iP) = AuxCont(12      ,iP)+ Yab*AuxCont( 5,      ip) 
     ThetaP( 3, 6      ,iP) = AuxCont(14      ,iP)+ Yab*AuxCont( 6,      ip) 
     ThetaP( 3, 7      ,iP) = AuxCont(15      ,iP)+ Yab*AuxCont( 7,      ip) 
     ThetaP( 3, 8      ,iP) = AuxCont(17      ,iP)+ Yab*AuxCont( 8,      ip) 
     ThetaP( 3, 9      ,iP) = AuxCont(18      ,iP)+ Yab*AuxCont( 9,      ip) 
     ThetaP( 3,10      ,iP) = AuxCont(19      ,iP)+ Yab*AuxCont(10,      ip) 
     ThetaP( 4, 5      ,iP) = AuxCont(13      ,iP)+ Zab*AuxCont( 5,      ip) 
     ThetaP( 4, 6      ,iP) = AuxCont(15      ,iP)+ Zab*AuxCont( 6,      ip) 
     ThetaP( 4, 7      ,iP) = AuxCont(16      ,iP)+ Zab*AuxCont( 7,      ip) 
     ThetaP( 4, 8      ,iP) = AuxCont(18      ,iP)+ Zab*AuxCont( 8,      ip) 
     ThetaP( 4, 9      ,iP) = AuxCont(19      ,iP)+ Zab*AuxCont( 9,      ip) 
     ThetaP( 4,10      ,iP) = AuxCont(20      ,iP)+ Zab*AuxCont(10,      ip) 
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P3A1B2BtoA

subroutine HorizontalRR_LHS_P4A1B3BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   35,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    2:    4,   11:   20,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
  real(realk) :: Xab,Yab,Zab
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         iPassP,iTUVB,iAtomA,iAtomB,Xab,Yab,Zab) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         iAtomApass,iAtomBpass,Pdistance12,AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
   iPassP = (iP-1)/(nTUVQ*nContQP)+1
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = -Pdistance12(1,iAtomA,iAtomB)
   Yab = -Pdistance12(2,iAtomA,iAtomB)
   Zab = -Pdistance12(3,iAtomA,iAtomB)
     ThetaP( 2,11      ,iP) = AuxCont(21      ,iP)+ Xab*AuxCont(11,      ip) 
     ThetaP( 2,12      ,iP) = AuxCont(22      ,iP)+ Xab*AuxCont(12,      ip) 
     ThetaP( 2,13      ,iP) = AuxCont(23      ,iP)+ Xab*AuxCont(13,      ip) 
     ThetaP( 2,14      ,iP) = AuxCont(24      ,iP)+ Xab*AuxCont(14,      ip) 
     ThetaP( 2,15      ,iP) = AuxCont(25      ,iP)+ Xab*AuxCont(15,      ip) 
     ThetaP( 2,16      ,iP) = AuxCont(26      ,iP)+ Xab*AuxCont(16,      ip) 
     ThetaP( 2,17      ,iP) = AuxCont(27      ,iP)+ Xab*AuxCont(17,      ip) 
     ThetaP( 2,18      ,iP) = AuxCont(28      ,iP)+ Xab*AuxCont(18,      ip) 
     ThetaP( 2,19      ,iP) = AuxCont(29      ,iP)+ Xab*AuxCont(19,      ip) 
     ThetaP( 2,20      ,iP) = AuxCont(30      ,iP)+ Xab*AuxCont(20,      ip) 
     ThetaP( 3,11      ,iP) = AuxCont(22      ,iP)+ Yab*AuxCont(11,      ip) 
     ThetaP( 3,12      ,iP) = AuxCont(24      ,iP)+ Yab*AuxCont(12,      ip) 
     ThetaP( 3,13      ,iP) = AuxCont(25      ,iP)+ Yab*AuxCont(13,      ip) 
     ThetaP( 3,14      ,iP) = AuxCont(27      ,iP)+ Yab*AuxCont(14,      ip) 
     ThetaP( 3,15      ,iP) = AuxCont(28      ,iP)+ Yab*AuxCont(15,      ip) 
     ThetaP( 3,16      ,iP) = AuxCont(29      ,iP)+ Yab*AuxCont(16,      ip) 
     ThetaP( 3,17      ,iP) = AuxCont(31      ,iP)+ Yab*AuxCont(17,      ip) 
     ThetaP( 3,18      ,iP) = AuxCont(32      ,iP)+ Yab*AuxCont(18,      ip) 
     ThetaP( 3,19      ,iP) = AuxCont(33      ,iP)+ Yab*AuxCont(19,      ip) 
     ThetaP( 3,20      ,iP) = AuxCont(34      ,iP)+ Yab*AuxCont(20,      ip) 
     ThetaP( 4,11      ,iP) = AuxCont(23      ,iP)+ Zab*AuxCont(11,      ip) 
     ThetaP( 4,12      ,iP) = AuxCont(25      ,iP)+ Zab*AuxCont(12,      ip) 
     ThetaP( 4,13      ,iP) = AuxCont(26      ,iP)+ Zab*AuxCont(13,      ip) 
     ThetaP( 4,14      ,iP) = AuxCont(28      ,iP)+ Zab*AuxCont(14,      ip) 
     ThetaP( 4,15      ,iP) = AuxCont(29      ,iP)+ Zab*AuxCont(15,      ip) 
     ThetaP( 4,16      ,iP) = AuxCont(30      ,iP)+ Zab*AuxCont(16,      ip) 
     ThetaP( 4,17      ,iP) = AuxCont(32      ,iP)+ Zab*AuxCont(17,      ip) 
     ThetaP( 4,18      ,iP) = AuxCont(33      ,iP)+ Zab*AuxCont(18,      ip) 
     ThetaP( 4,19      ,iP) = AuxCont(34      ,iP)+ Zab*AuxCont(19,      ip) 
     ThetaP( 4,20      ,iP) = AuxCont(35      ,iP)+ Zab*AuxCont(20,      ip) 
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P4A1B3BtoA

subroutine HorizontalRR_LHS_P4A2B2BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   35,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    5:   10,    5:   10,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
  real(realk) :: Xab,Yab,Zab
  real(realk) :: Tmp1(  2:  4,  5: 20)
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         Tmp1,&
!$OMP         iPassP,iTUVB,iAtomA,iAtomB,Xab,Yab,Zab) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         iAtomApass,iAtomBpass,Pdistance12,AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
   iPassP = (iP-1)/(nTUVQ*nContQP)+1
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = -Pdistance12(1,iAtomA,iAtomB)
   Yab = -Pdistance12(2,iAtomA,iAtomB)
   Zab = -Pdistance12(3,iAtomA,iAtomB)
     Tmp1( 2, 5) = AuxCont(11      ,iP)+ Xab*AuxCont( 5,      ip) 
     Tmp1( 2, 6) = AuxCont(12      ,iP)+ Xab*AuxCont( 6,      ip) 
     Tmp1( 2, 7) = AuxCont(13      ,iP)+ Xab*AuxCont( 7,      ip) 
     Tmp1( 2, 8) = AuxCont(14      ,iP)+ Xab*AuxCont( 8,      ip) 
     Tmp1( 2, 9) = AuxCont(15      ,iP)+ Xab*AuxCont( 9,      ip) 
     Tmp1( 2,10) = AuxCont(16      ,iP)+ Xab*AuxCont(10,      ip) 
     Tmp1( 2,11) = AuxCont(21      ,iP)+ Xab*AuxCont(11,      ip) 
     Tmp1( 2,12) = AuxCont(22      ,iP)+ Xab*AuxCont(12,      ip) 
     Tmp1( 2,13) = AuxCont(23      ,iP)+ Xab*AuxCont(13,      ip) 
     Tmp1( 2,14) = AuxCont(24      ,iP)+ Xab*AuxCont(14,      ip) 
     Tmp1( 2,15) = AuxCont(25      ,iP)+ Xab*AuxCont(15,      ip) 
     Tmp1( 2,16) = AuxCont(26      ,iP)+ Xab*AuxCont(16,      ip) 
     Tmp1( 2,17) = AuxCont(27      ,iP)+ Xab*AuxCont(17,      ip) 
     Tmp1( 2,18) = AuxCont(28      ,iP)+ Xab*AuxCont(18,      ip) 
     Tmp1( 2,19) = AuxCont(29      ,iP)+ Xab*AuxCont(19,      ip) 
     Tmp1( 2,20) = AuxCont(30      ,iP)+ Xab*AuxCont(20,      ip) 
     Tmp1( 3, 5) = AuxCont(12      ,iP)+ Yab*AuxCont( 5,      ip) 
     Tmp1( 3, 6) = AuxCont(14      ,iP)+ Yab*AuxCont( 6,      ip) 
     Tmp1( 3, 7) = AuxCont(15      ,iP)+ Yab*AuxCont( 7,      ip) 
     Tmp1( 3, 8) = AuxCont(17      ,iP)+ Yab*AuxCont( 8,      ip) 
     Tmp1( 3, 9) = AuxCont(18      ,iP)+ Yab*AuxCont( 9,      ip) 
     Tmp1( 3,10) = AuxCont(19      ,iP)+ Yab*AuxCont(10,      ip) 
     Tmp1( 3,11) = AuxCont(22      ,iP)+ Yab*AuxCont(11,      ip) 
     Tmp1( 3,12) = AuxCont(24      ,iP)+ Yab*AuxCont(12,      ip) 
     Tmp1( 3,13) = AuxCont(25      ,iP)+ Yab*AuxCont(13,      ip) 
     Tmp1( 3,14) = AuxCont(27      ,iP)+ Yab*AuxCont(14,      ip) 
     Tmp1( 3,15) = AuxCont(28      ,iP)+ Yab*AuxCont(15,      ip) 
     Tmp1( 3,16) = AuxCont(29      ,iP)+ Yab*AuxCont(16,      ip) 
     Tmp1( 3,17) = AuxCont(31      ,iP)+ Yab*AuxCont(17,      ip) 
     Tmp1( 3,18) = AuxCont(32      ,iP)+ Yab*AuxCont(18,      ip) 
     Tmp1( 3,19) = AuxCont(33      ,iP)+ Yab*AuxCont(19,      ip) 
     Tmp1( 3,20) = AuxCont(34      ,iP)+ Yab*AuxCont(20,      ip) 
     Tmp1( 4, 5) = AuxCont(13      ,iP)+ Zab*AuxCont( 5,      ip) 
     Tmp1( 4, 6) = AuxCont(15      ,iP)+ Zab*AuxCont( 6,      ip) 
     Tmp1( 4, 7) = AuxCont(16      ,iP)+ Zab*AuxCont( 7,      ip) 
     Tmp1( 4, 8) = AuxCont(18      ,iP)+ Zab*AuxCont( 8,      ip) 
     Tmp1( 4, 9) = AuxCont(19      ,iP)+ Zab*AuxCont( 9,      ip) 
     Tmp1( 4,10) = AuxCont(20      ,iP)+ Zab*AuxCont(10,      ip) 
     Tmp1( 4,11) = AuxCont(23      ,iP)+ Zab*AuxCont(11,      ip) 
     Tmp1( 4,12) = AuxCont(25      ,iP)+ Zab*AuxCont(12,      ip) 
     Tmp1( 4,13) = AuxCont(26      ,iP)+ Zab*AuxCont(13,      ip) 
     Tmp1( 4,14) = AuxCont(28      ,iP)+ Zab*AuxCont(14,      ip) 
     Tmp1( 4,15) = AuxCont(29      ,iP)+ Zab*AuxCont(15,      ip) 
     Tmp1( 4,16) = AuxCont(30      ,iP)+ Zab*AuxCont(16,      ip) 
     Tmp1( 4,17) = AuxCont(32      ,iP)+ Zab*AuxCont(17,      ip) 
     Tmp1( 4,18) = AuxCont(33      ,iP)+ Zab*AuxCont(18,      ip) 
     Tmp1( 4,19) = AuxCont(34      ,iP)+ Zab*AuxCont(19,      ip) 
     Tmp1( 4,20) = AuxCont(35      ,iP)+ Zab*AuxCont(20,      ip) 
     ThetaP( 5, 5      ,iP) = Tmp1( 2,11)+ Xab*Tmp1( 2, 5)
     ThetaP( 5, 6      ,iP) = Tmp1( 2,12)+ Xab*Tmp1( 2, 6)
     ThetaP( 5, 7      ,iP) = Tmp1( 2,13)+ Xab*Tmp1( 2, 7)
     ThetaP( 5, 8      ,iP) = Tmp1( 2,14)+ Xab*Tmp1( 2, 8)
     ThetaP( 5, 9      ,iP) = Tmp1( 2,15)+ Xab*Tmp1( 2, 9)
     ThetaP( 5,10      ,iP) = Tmp1( 2,16)+ Xab*Tmp1( 2,10)
     ThetaP( 6, 5      ,iP) = Tmp1( 3,11)+ Xab*Tmp1( 3, 5)
     ThetaP( 6, 6      ,iP) = Tmp1( 3,12)+ Xab*Tmp1( 3, 6)
     ThetaP( 6, 7      ,iP) = Tmp1( 3,13)+ Xab*Tmp1( 3, 7)
     ThetaP( 6, 8      ,iP) = Tmp1( 3,14)+ Xab*Tmp1( 3, 8)
     ThetaP( 6, 9      ,iP) = Tmp1( 3,15)+ Xab*Tmp1( 3, 9)
     ThetaP( 6,10      ,iP) = Tmp1( 3,16)+ Xab*Tmp1( 3,10)
     ThetaP( 7, 5      ,iP) = Tmp1( 4,11)+ Xab*Tmp1( 4, 5)
     ThetaP( 7, 6      ,iP) = Tmp1( 4,12)+ Xab*Tmp1( 4, 6)
     ThetaP( 7, 7      ,iP) = Tmp1( 4,13)+ Xab*Tmp1( 4, 7)
     ThetaP( 7, 8      ,iP) = Tmp1( 4,14)+ Xab*Tmp1( 4, 8)
     ThetaP( 7, 9      ,iP) = Tmp1( 4,15)+ Xab*Tmp1( 4, 9)
     ThetaP( 7,10      ,iP) = Tmp1( 4,16)+ Xab*Tmp1( 4,10)
     ThetaP( 8, 5      ,iP) = Tmp1( 3,12)+ Yab*Tmp1( 3, 5)
     ThetaP( 8, 6      ,iP) = Tmp1( 3,14)+ Yab*Tmp1( 3, 6)
     ThetaP( 8, 7      ,iP) = Tmp1( 3,15)+ Yab*Tmp1( 3, 7)
     ThetaP( 8, 8      ,iP) = Tmp1( 3,17)+ Yab*Tmp1( 3, 8)
     ThetaP( 8, 9      ,iP) = Tmp1( 3,18)+ Yab*Tmp1( 3, 9)
     ThetaP( 8,10      ,iP) = Tmp1( 3,19)+ Yab*Tmp1( 3,10)
     ThetaP( 9, 5      ,iP) = Tmp1( 4,12)+ Yab*Tmp1( 4, 5)
     ThetaP( 9, 6      ,iP) = Tmp1( 4,14)+ Yab*Tmp1( 4, 6)
     ThetaP( 9, 7      ,iP) = Tmp1( 4,15)+ Yab*Tmp1( 4, 7)
     ThetaP( 9, 8      ,iP) = Tmp1( 4,17)+ Yab*Tmp1( 4, 8)
     ThetaP( 9, 9      ,iP) = Tmp1( 4,18)+ Yab*Tmp1( 4, 9)
     ThetaP( 9,10      ,iP) = Tmp1( 4,19)+ Yab*Tmp1( 4,10)
     ThetaP(10, 5      ,iP) = Tmp1( 4,13)+ Zab*Tmp1( 4, 5)
     ThetaP(10, 6      ,iP) = Tmp1( 4,15)+ Zab*Tmp1( 4, 6)
     ThetaP(10, 7      ,iP) = Tmp1( 4,16)+ Zab*Tmp1( 4, 7)
     ThetaP(10, 8      ,iP) = Tmp1( 4,18)+ Zab*Tmp1( 4, 8)
     ThetaP(10, 9      ,iP) = Tmp1( 4,19)+ Zab*Tmp1( 4, 9)
     ThetaP(10,10      ,iP) = Tmp1( 4,20)+ Zab*Tmp1( 4,10)
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P4A2B2BtoA

subroutine HorizontalRR_LHS_P5A2B3BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   56,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(    5:   10,   11:   20,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
  real(realk) :: Xab,Yab,Zab
  real(realk) :: Tmp1(  2:  4, 11: 35)
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         Tmp1,&
!$OMP         iPassP,iTUVB,iAtomA,iAtomB,Xab,Yab,Zab) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         iAtomApass,iAtomBpass,Pdistance12,AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
   iPassP = (iP-1)/(nTUVQ*nContQP)+1
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = -Pdistance12(1,iAtomA,iAtomB)
   Yab = -Pdistance12(2,iAtomA,iAtomB)
   Zab = -Pdistance12(3,iAtomA,iAtomB)
     Tmp1( 2,11) = AuxCont(21      ,iP)+ Xab*AuxCont(11,      ip) 
     Tmp1( 2,12) = AuxCont(22      ,iP)+ Xab*AuxCont(12,      ip) 
     Tmp1( 2,13) = AuxCont(23      ,iP)+ Xab*AuxCont(13,      ip) 
     Tmp1( 2,14) = AuxCont(24      ,iP)+ Xab*AuxCont(14,      ip) 
     Tmp1( 2,15) = AuxCont(25      ,iP)+ Xab*AuxCont(15,      ip) 
     Tmp1( 2,16) = AuxCont(26      ,iP)+ Xab*AuxCont(16,      ip) 
     Tmp1( 2,17) = AuxCont(27      ,iP)+ Xab*AuxCont(17,      ip) 
     Tmp1( 2,18) = AuxCont(28      ,iP)+ Xab*AuxCont(18,      ip) 
     Tmp1( 2,19) = AuxCont(29      ,iP)+ Xab*AuxCont(19,      ip) 
     Tmp1( 2,20) = AuxCont(30      ,iP)+ Xab*AuxCont(20,      ip) 
     Tmp1( 2,21) = AuxCont(36      ,iP)+ Xab*AuxCont(21,      ip) 
     Tmp1( 2,22) = AuxCont(37      ,iP)+ Xab*AuxCont(22,      ip) 
     Tmp1( 2,23) = AuxCont(38      ,iP)+ Xab*AuxCont(23,      ip) 
     Tmp1( 2,24) = AuxCont(39      ,iP)+ Xab*AuxCont(24,      ip) 
     Tmp1( 2,25) = AuxCont(40      ,iP)+ Xab*AuxCont(25,      ip) 
     Tmp1( 2,26) = AuxCont(41      ,iP)+ Xab*AuxCont(26,      ip) 
     Tmp1( 2,27) = AuxCont(42      ,iP)+ Xab*AuxCont(27,      ip) 
     Tmp1( 2,28) = AuxCont(43      ,iP)+ Xab*AuxCont(28,      ip) 
     Tmp1( 2,29) = AuxCont(44      ,iP)+ Xab*AuxCont(29,      ip) 
     Tmp1( 2,30) = AuxCont(45      ,iP)+ Xab*AuxCont(30,      ip) 
     Tmp1( 2,31) = AuxCont(46      ,iP)+ Xab*AuxCont(31,      ip) 
     Tmp1( 2,32) = AuxCont(47      ,iP)+ Xab*AuxCont(32,      ip) 
     Tmp1( 2,33) = AuxCont(48      ,iP)+ Xab*AuxCont(33,      ip) 
     Tmp1( 2,34) = AuxCont(49      ,iP)+ Xab*AuxCont(34,      ip) 
     Tmp1( 2,35) = AuxCont(50      ,iP)+ Xab*AuxCont(35,      ip) 
     Tmp1( 3,11) = AuxCont(22      ,iP)+ Yab*AuxCont(11,      ip) 
     Tmp1( 3,12) = AuxCont(24      ,iP)+ Yab*AuxCont(12,      ip) 
     Tmp1( 3,13) = AuxCont(25      ,iP)+ Yab*AuxCont(13,      ip) 
     Tmp1( 3,14) = AuxCont(27      ,iP)+ Yab*AuxCont(14,      ip) 
     Tmp1( 3,15) = AuxCont(28      ,iP)+ Yab*AuxCont(15,      ip) 
     Tmp1( 3,16) = AuxCont(29      ,iP)+ Yab*AuxCont(16,      ip) 
     Tmp1( 3,17) = AuxCont(31      ,iP)+ Yab*AuxCont(17,      ip) 
     Tmp1( 3,18) = AuxCont(32      ,iP)+ Yab*AuxCont(18,      ip) 
     Tmp1( 3,19) = AuxCont(33      ,iP)+ Yab*AuxCont(19,      ip) 
     Tmp1( 3,20) = AuxCont(34      ,iP)+ Yab*AuxCont(20,      ip) 
     Tmp1( 3,21) = AuxCont(37      ,iP)+ Yab*AuxCont(21,      ip) 
     Tmp1( 3,22) = AuxCont(39      ,iP)+ Yab*AuxCont(22,      ip) 
     Tmp1( 3,23) = AuxCont(40      ,iP)+ Yab*AuxCont(23,      ip) 
     Tmp1( 3,24) = AuxCont(42      ,iP)+ Yab*AuxCont(24,      ip) 
     Tmp1( 3,25) = AuxCont(43      ,iP)+ Yab*AuxCont(25,      ip) 
     Tmp1( 3,26) = AuxCont(44      ,iP)+ Yab*AuxCont(26,      ip) 
     Tmp1( 3,27) = AuxCont(46      ,iP)+ Yab*AuxCont(27,      ip) 
     Tmp1( 3,28) = AuxCont(47      ,iP)+ Yab*AuxCont(28,      ip) 
     Tmp1( 3,29) = AuxCont(48      ,iP)+ Yab*AuxCont(29,      ip) 
     Tmp1( 3,30) = AuxCont(49      ,iP)+ Yab*AuxCont(30,      ip) 
     Tmp1( 3,31) = AuxCont(51      ,iP)+ Yab*AuxCont(31,      ip) 
     Tmp1( 3,32) = AuxCont(52      ,iP)+ Yab*AuxCont(32,      ip) 
     Tmp1( 3,33) = AuxCont(53      ,iP)+ Yab*AuxCont(33,      ip) 
     Tmp1( 3,34) = AuxCont(54      ,iP)+ Yab*AuxCont(34,      ip) 
     Tmp1( 3,35) = AuxCont(55      ,iP)+ Yab*AuxCont(35,      ip) 
     Tmp1( 4,11) = AuxCont(23      ,iP)+ Zab*AuxCont(11,      ip) 
     Tmp1( 4,12) = AuxCont(25      ,iP)+ Zab*AuxCont(12,      ip) 
     Tmp1( 4,13) = AuxCont(26      ,iP)+ Zab*AuxCont(13,      ip) 
     Tmp1( 4,14) = AuxCont(28      ,iP)+ Zab*AuxCont(14,      ip) 
     Tmp1( 4,15) = AuxCont(29      ,iP)+ Zab*AuxCont(15,      ip) 
     Tmp1( 4,16) = AuxCont(30      ,iP)+ Zab*AuxCont(16,      ip) 
     Tmp1( 4,17) = AuxCont(32      ,iP)+ Zab*AuxCont(17,      ip) 
     Tmp1( 4,18) = AuxCont(33      ,iP)+ Zab*AuxCont(18,      ip) 
     Tmp1( 4,19) = AuxCont(34      ,iP)+ Zab*AuxCont(19,      ip) 
     Tmp1( 4,20) = AuxCont(35      ,iP)+ Zab*AuxCont(20,      ip) 
     Tmp1( 4,21) = AuxCont(38      ,iP)+ Zab*AuxCont(21,      ip) 
     Tmp1( 4,22) = AuxCont(40      ,iP)+ Zab*AuxCont(22,      ip) 
     Tmp1( 4,23) = AuxCont(41      ,iP)+ Zab*AuxCont(23,      ip) 
     Tmp1( 4,24) = AuxCont(43      ,iP)+ Zab*AuxCont(24,      ip) 
     Tmp1( 4,25) = AuxCont(44      ,iP)+ Zab*AuxCont(25,      ip) 
     Tmp1( 4,26) = AuxCont(45      ,iP)+ Zab*AuxCont(26,      ip) 
     Tmp1( 4,27) = AuxCont(47      ,iP)+ Zab*AuxCont(27,      ip) 
     Tmp1( 4,28) = AuxCont(48      ,iP)+ Zab*AuxCont(28,      ip) 
     Tmp1( 4,29) = AuxCont(49      ,iP)+ Zab*AuxCont(29,      ip) 
     Tmp1( 4,30) = AuxCont(50      ,iP)+ Zab*AuxCont(30,      ip) 
     Tmp1( 4,31) = AuxCont(52      ,iP)+ Zab*AuxCont(31,      ip) 
     Tmp1( 4,32) = AuxCont(53      ,iP)+ Zab*AuxCont(32,      ip) 
     Tmp1( 4,33) = AuxCont(54      ,iP)+ Zab*AuxCont(33,      ip) 
     Tmp1( 4,34) = AuxCont(55      ,iP)+ Zab*AuxCont(34,      ip) 
     Tmp1( 4,35) = AuxCont(56      ,iP)+ Zab*AuxCont(35,      ip) 
     ThetaP( 5,11      ,iP) = Tmp1( 2,21)+ Xab*Tmp1( 2,11)
     ThetaP( 5,12      ,iP) = Tmp1( 2,22)+ Xab*Tmp1( 2,12)
     ThetaP( 5,13      ,iP) = Tmp1( 2,23)+ Xab*Tmp1( 2,13)
     ThetaP( 5,14      ,iP) = Tmp1( 2,24)+ Xab*Tmp1( 2,14)
     ThetaP( 5,15      ,iP) = Tmp1( 2,25)+ Xab*Tmp1( 2,15)
     ThetaP( 5,16      ,iP) = Tmp1( 2,26)+ Xab*Tmp1( 2,16)
     ThetaP( 5,17      ,iP) = Tmp1( 2,27)+ Xab*Tmp1( 2,17)
     ThetaP( 5,18      ,iP) = Tmp1( 2,28)+ Xab*Tmp1( 2,18)
     ThetaP( 5,19      ,iP) = Tmp1( 2,29)+ Xab*Tmp1( 2,19)
     ThetaP( 5,20      ,iP) = Tmp1( 2,30)+ Xab*Tmp1( 2,20)
     ThetaP( 6,11      ,iP) = Tmp1( 3,21)+ Xab*Tmp1( 3,11)
     ThetaP( 6,12      ,iP) = Tmp1( 3,22)+ Xab*Tmp1( 3,12)
     ThetaP( 6,13      ,iP) = Tmp1( 3,23)+ Xab*Tmp1( 3,13)
     ThetaP( 6,14      ,iP) = Tmp1( 3,24)+ Xab*Tmp1( 3,14)
     ThetaP( 6,15      ,iP) = Tmp1( 3,25)+ Xab*Tmp1( 3,15)
     ThetaP( 6,16      ,iP) = Tmp1( 3,26)+ Xab*Tmp1( 3,16)
     ThetaP( 6,17      ,iP) = Tmp1( 3,27)+ Xab*Tmp1( 3,17)
     ThetaP( 6,18      ,iP) = Tmp1( 3,28)+ Xab*Tmp1( 3,18)
     ThetaP( 6,19      ,iP) = Tmp1( 3,29)+ Xab*Tmp1( 3,19)
     ThetaP( 6,20      ,iP) = Tmp1( 3,30)+ Xab*Tmp1( 3,20)
     ThetaP( 7,11      ,iP) = Tmp1( 4,21)+ Xab*Tmp1( 4,11)
     ThetaP( 7,12      ,iP) = Tmp1( 4,22)+ Xab*Tmp1( 4,12)
     ThetaP( 7,13      ,iP) = Tmp1( 4,23)+ Xab*Tmp1( 4,13)
     ThetaP( 7,14      ,iP) = Tmp1( 4,24)+ Xab*Tmp1( 4,14)
     ThetaP( 7,15      ,iP) = Tmp1( 4,25)+ Xab*Tmp1( 4,15)
     ThetaP( 7,16      ,iP) = Tmp1( 4,26)+ Xab*Tmp1( 4,16)
     ThetaP( 7,17      ,iP) = Tmp1( 4,27)+ Xab*Tmp1( 4,17)
     ThetaP( 7,18      ,iP) = Tmp1( 4,28)+ Xab*Tmp1( 4,18)
     ThetaP( 7,19      ,iP) = Tmp1( 4,29)+ Xab*Tmp1( 4,19)
     ThetaP( 7,20      ,iP) = Tmp1( 4,30)+ Xab*Tmp1( 4,20)
     ThetaP( 8,11      ,iP) = Tmp1( 3,22)+ Yab*Tmp1( 3,11)
     ThetaP( 8,12      ,iP) = Tmp1( 3,24)+ Yab*Tmp1( 3,12)
     ThetaP( 8,13      ,iP) = Tmp1( 3,25)+ Yab*Tmp1( 3,13)
     ThetaP( 8,14      ,iP) = Tmp1( 3,27)+ Yab*Tmp1( 3,14)
     ThetaP( 8,15      ,iP) = Tmp1( 3,28)+ Yab*Tmp1( 3,15)
     ThetaP( 8,16      ,iP) = Tmp1( 3,29)+ Yab*Tmp1( 3,16)
     ThetaP( 8,17      ,iP) = Tmp1( 3,31)+ Yab*Tmp1( 3,17)
     ThetaP( 8,18      ,iP) = Tmp1( 3,32)+ Yab*Tmp1( 3,18)
     ThetaP( 8,19      ,iP) = Tmp1( 3,33)+ Yab*Tmp1( 3,19)
     ThetaP( 8,20      ,iP) = Tmp1( 3,34)+ Yab*Tmp1( 3,20)
     ThetaP( 9,11      ,iP) = Tmp1( 4,22)+ Yab*Tmp1( 4,11)
     ThetaP( 9,12      ,iP) = Tmp1( 4,24)+ Yab*Tmp1( 4,12)
     ThetaP( 9,13      ,iP) = Tmp1( 4,25)+ Yab*Tmp1( 4,13)
     ThetaP( 9,14      ,iP) = Tmp1( 4,27)+ Yab*Tmp1( 4,14)
     ThetaP( 9,15      ,iP) = Tmp1( 4,28)+ Yab*Tmp1( 4,15)
     ThetaP( 9,16      ,iP) = Tmp1( 4,29)+ Yab*Tmp1( 4,16)
     ThetaP( 9,17      ,iP) = Tmp1( 4,31)+ Yab*Tmp1( 4,17)
     ThetaP( 9,18      ,iP) = Tmp1( 4,32)+ Yab*Tmp1( 4,18)
     ThetaP( 9,19      ,iP) = Tmp1( 4,33)+ Yab*Tmp1( 4,19)
     ThetaP( 9,20      ,iP) = Tmp1( 4,34)+ Yab*Tmp1( 4,20)
     ThetaP(10,11      ,iP) = Tmp1( 4,23)+ Zab*Tmp1( 4,11)
     ThetaP(10,12      ,iP) = Tmp1( 4,25)+ Zab*Tmp1( 4,12)
     ThetaP(10,13      ,iP) = Tmp1( 4,26)+ Zab*Tmp1( 4,13)
     ThetaP(10,14      ,iP) = Tmp1( 4,28)+ Zab*Tmp1( 4,14)
     ThetaP(10,15      ,iP) = Tmp1( 4,29)+ Zab*Tmp1( 4,15)
     ThetaP(10,16      ,iP) = Tmp1( 4,30)+ Zab*Tmp1( 4,16)
     ThetaP(10,17      ,iP) = Tmp1( 4,32)+ Zab*Tmp1( 4,17)
     ThetaP(10,18      ,iP) = Tmp1( 4,33)+ Zab*Tmp1( 4,18)
     ThetaP(10,19      ,iP) = Tmp1( 4,34)+ Zab*Tmp1( 4,19)
     ThetaP(10,20      ,iP) = Tmp1( 4,35)+ Zab*Tmp1( 4,20)
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P5A2B3BtoA

subroutine HorizontalRR_LHS_P6A3B3BtoA(nContQP,nPasses,nTUVQ,&
         & Pdistance12,MaxPasses,nAtomsA,nAtomsB,IatomApass,IatomBpass,AuxCont,ThetaP,lupri)
  implicit none
  integer,intent(in) :: nContQP,nPasses,nTUVQ,lupri,MaxPasses,nAtomsA,nAtomsB
  real(realk),intent(in) :: Pdistance12(3,nAtomsA,nAtomsB)
  real(realk),intent(in) :: AuxCont(   84,nTUVQ*nContQP*nPasses)
  integer,intent(in) :: IatomApass(MaxPasses),IatomBpass(MaxPasses)
  real(realk),intent(inout) :: ThetaP(   11:   20,   11:   20,nTUVQ*nContQP*nPasses)
  !Local variables
  integer :: iPassP,iP,iTUVQ,iTUVB,iAtomA,iAtomB
  real(realk) :: Xab,Yab,Zab
  real(realk) :: Tmp1(  2:  4, 11: 56)
  real(realk) :: Tmp2(  5: 10, 11: 35)
!  real(realk) :: Tmp(nTUVA,nTUVB) ordering
!$OMP PARALLEL DO DEFAULT(none)&
!$OMP PRIVATE(iP,&
!$OMP         Tmp1,&
!$OMP         Tmp2,&
!$OMP         iPassP,iTUVB,iAtomA,iAtomB,Xab,Yab,Zab) &
!$OMP SHARED(nTUVQ,nContQP,nPasses,&
!$OMP         iAtomApass,iAtomBpass,Pdistance12,AuxCont,ThetaP)
  DO iP = 1,nTUVQ*nContQP*nPasses
   iPassP = (iP-1)/(nTUVQ*nContQP)+1
   iAtomA = iAtomApass(iPassP)
   iAtomB = iAtomBpass(iPassP)
   Xab = -Pdistance12(1,iAtomA,iAtomB)
   Yab = -Pdistance12(2,iAtomA,iAtomB)
   Zab = -Pdistance12(3,iAtomA,iAtomB)
     Tmp1( 2,11) = AuxCont(21      ,iP)+ Xab*AuxCont(11,      ip) 
     Tmp1( 2,12) = AuxCont(22      ,iP)+ Xab*AuxCont(12,      ip) 
     Tmp1( 2,13) = AuxCont(23      ,iP)+ Xab*AuxCont(13,      ip) 
     Tmp1( 2,14) = AuxCont(24      ,iP)+ Xab*AuxCont(14,      ip) 
     Tmp1( 2,15) = AuxCont(25      ,iP)+ Xab*AuxCont(15,      ip) 
     Tmp1( 2,16) = AuxCont(26      ,iP)+ Xab*AuxCont(16,      ip) 
     Tmp1( 2,17) = AuxCont(27      ,iP)+ Xab*AuxCont(17,      ip) 
     Tmp1( 2,18) = AuxCont(28      ,iP)+ Xab*AuxCont(18,      ip) 
     Tmp1( 2,19) = AuxCont(29      ,iP)+ Xab*AuxCont(19,      ip) 
     Tmp1( 2,20) = AuxCont(30      ,iP)+ Xab*AuxCont(20,      ip) 
     Tmp1( 2,21) = AuxCont(36      ,iP)+ Xab*AuxCont(21,      ip) 
     Tmp1( 2,22) = AuxCont(37      ,iP)+ Xab*AuxCont(22,      ip) 
     Tmp1( 2,23) = AuxCont(38      ,iP)+ Xab*AuxCont(23,      ip) 
     Tmp1( 2,24) = AuxCont(39      ,iP)+ Xab*AuxCont(24,      ip) 
     Tmp1( 2,25) = AuxCont(40      ,iP)+ Xab*AuxCont(25,      ip) 
     Tmp1( 2,26) = AuxCont(41      ,iP)+ Xab*AuxCont(26,      ip) 
     Tmp1( 2,27) = AuxCont(42      ,iP)+ Xab*AuxCont(27,      ip) 
     Tmp1( 2,28) = AuxCont(43      ,iP)+ Xab*AuxCont(28,      ip) 
     Tmp1( 2,29) = AuxCont(44      ,iP)+ Xab*AuxCont(29,      ip) 
     Tmp1( 2,30) = AuxCont(45      ,iP)+ Xab*AuxCont(30,      ip) 
     Tmp1( 2,31) = AuxCont(46      ,iP)+ Xab*AuxCont(31,      ip) 
     Tmp1( 2,32) = AuxCont(47      ,iP)+ Xab*AuxCont(32,      ip) 
     Tmp1( 2,33) = AuxCont(48      ,iP)+ Xab*AuxCont(33,      ip) 
     Tmp1( 2,34) = AuxCont(49      ,iP)+ Xab*AuxCont(34,      ip) 
     Tmp1( 2,35) = AuxCont(50      ,iP)+ Xab*AuxCont(35,      ip) 
     Tmp1( 2,36) = AuxCont(57      ,iP)+ Xab*AuxCont(36,      ip) 
     Tmp1( 2,37) = AuxCont(58      ,iP)+ Xab*AuxCont(37,      ip) 
     Tmp1( 2,38) = AuxCont(59      ,iP)+ Xab*AuxCont(38,      ip) 
     Tmp1( 2,39) = AuxCont(60      ,iP)+ Xab*AuxCont(39,      ip) 
     Tmp1( 2,40) = AuxCont(61      ,iP)+ Xab*AuxCont(40,      ip) 
     Tmp1( 2,41) = AuxCont(62      ,iP)+ Xab*AuxCont(41,      ip) 
     Tmp1( 2,42) = AuxCont(63      ,iP)+ Xab*AuxCont(42,      ip) 
     Tmp1( 2,43) = AuxCont(64      ,iP)+ Xab*AuxCont(43,      ip) 
     Tmp1( 2,44) = AuxCont(65      ,iP)+ Xab*AuxCont(44,      ip) 
     Tmp1( 2,45) = AuxCont(66      ,iP)+ Xab*AuxCont(45,      ip) 
     Tmp1( 2,46) = AuxCont(67      ,iP)+ Xab*AuxCont(46,      ip) 
     Tmp1( 2,47) = AuxCont(68      ,iP)+ Xab*AuxCont(47,      ip) 
     Tmp1( 2,48) = AuxCont(69      ,iP)+ Xab*AuxCont(48,      ip) 
     Tmp1( 2,49) = AuxCont(70      ,iP)+ Xab*AuxCont(49,      ip) 
     Tmp1( 2,50) = AuxCont(71      ,iP)+ Xab*AuxCont(50,      ip) 
     Tmp1( 2,51) = AuxCont(72      ,iP)+ Xab*AuxCont(51,      ip) 
     Tmp1( 2,52) = AuxCont(73      ,iP)+ Xab*AuxCont(52,      ip) 
     Tmp1( 2,53) = AuxCont(74      ,iP)+ Xab*AuxCont(53,      ip) 
     Tmp1( 2,54) = AuxCont(75      ,iP)+ Xab*AuxCont(54,      ip) 
     Tmp1( 2,55) = AuxCont(76      ,iP)+ Xab*AuxCont(55,      ip) 
     Tmp1( 2,56) = AuxCont(77      ,iP)+ Xab*AuxCont(56,      ip) 
     Tmp1( 3,11) = AuxCont(22      ,iP)+ Yab*AuxCont(11,      ip) 
     Tmp1( 3,12) = AuxCont(24      ,iP)+ Yab*AuxCont(12,      ip) 
     Tmp1( 3,13) = AuxCont(25      ,iP)+ Yab*AuxCont(13,      ip) 
     Tmp1( 3,14) = AuxCont(27      ,iP)+ Yab*AuxCont(14,      ip) 
     Tmp1( 3,15) = AuxCont(28      ,iP)+ Yab*AuxCont(15,      ip) 
     Tmp1( 3,16) = AuxCont(29      ,iP)+ Yab*AuxCont(16,      ip) 
     Tmp1( 3,17) = AuxCont(31      ,iP)+ Yab*AuxCont(17,      ip) 
     Tmp1( 3,18) = AuxCont(32      ,iP)+ Yab*AuxCont(18,      ip) 
     Tmp1( 3,19) = AuxCont(33      ,iP)+ Yab*AuxCont(19,      ip) 
     Tmp1( 3,20) = AuxCont(34      ,iP)+ Yab*AuxCont(20,      ip) 
     Tmp1( 3,21) = AuxCont(37      ,iP)+ Yab*AuxCont(21,      ip) 
     Tmp1( 3,22) = AuxCont(39      ,iP)+ Yab*AuxCont(22,      ip) 
     Tmp1( 3,23) = AuxCont(40      ,iP)+ Yab*AuxCont(23,      ip) 
     Tmp1( 3,24) = AuxCont(42      ,iP)+ Yab*AuxCont(24,      ip) 
     Tmp1( 3,25) = AuxCont(43      ,iP)+ Yab*AuxCont(25,      ip) 
     Tmp1( 3,26) = AuxCont(44      ,iP)+ Yab*AuxCont(26,      ip) 
     Tmp1( 3,27) = AuxCont(46      ,iP)+ Yab*AuxCont(27,      ip) 
     Tmp1( 3,28) = AuxCont(47      ,iP)+ Yab*AuxCont(28,      ip) 
     Tmp1( 3,29) = AuxCont(48      ,iP)+ Yab*AuxCont(29,      ip) 
     Tmp1( 3,30) = AuxCont(49      ,iP)+ Yab*AuxCont(30,      ip) 
     Tmp1( 3,31) = AuxCont(51      ,iP)+ Yab*AuxCont(31,      ip) 
     Tmp1( 3,32) = AuxCont(52      ,iP)+ Yab*AuxCont(32,      ip) 
     Tmp1( 3,33) = AuxCont(53      ,iP)+ Yab*AuxCont(33,      ip) 
     Tmp1( 3,34) = AuxCont(54      ,iP)+ Yab*AuxCont(34,      ip) 
     Tmp1( 3,35) = AuxCont(55      ,iP)+ Yab*AuxCont(35,      ip) 
     Tmp1( 3,36) = AuxCont(58      ,iP)+ Yab*AuxCont(36,      ip) 
     Tmp1( 3,37) = AuxCont(60      ,iP)+ Yab*AuxCont(37,      ip) 
     Tmp1( 3,38) = AuxCont(61      ,iP)+ Yab*AuxCont(38,      ip) 
     Tmp1( 3,39) = AuxCont(63      ,iP)+ Yab*AuxCont(39,      ip) 
     Tmp1( 3,40) = AuxCont(64      ,iP)+ Yab*AuxCont(40,      ip) 
     Tmp1( 3,41) = AuxCont(65      ,iP)+ Yab*AuxCont(41,      ip) 
     Tmp1( 3,42) = AuxCont(67      ,iP)+ Yab*AuxCont(42,      ip) 
     Tmp1( 3,43) = AuxCont(68      ,iP)+ Yab*AuxCont(43,      ip) 
     Tmp1( 3,44) = AuxCont(69      ,iP)+ Yab*AuxCont(44,      ip) 
     Tmp1( 3,45) = AuxCont(70      ,iP)+ Yab*AuxCont(45,      ip) 
     Tmp1( 3,46) = AuxCont(72      ,iP)+ Yab*AuxCont(46,      ip) 
     Tmp1( 3,47) = AuxCont(73      ,iP)+ Yab*AuxCont(47,      ip) 
     Tmp1( 3,48) = AuxCont(74      ,iP)+ Yab*AuxCont(48,      ip) 
     Tmp1( 3,49) = AuxCont(75      ,iP)+ Yab*AuxCont(49,      ip) 
     Tmp1( 3,50) = AuxCont(76      ,iP)+ Yab*AuxCont(50,      ip) 
     Tmp1( 3,51) = AuxCont(78      ,iP)+ Yab*AuxCont(51,      ip) 
     Tmp1( 3,52) = AuxCont(79      ,iP)+ Yab*AuxCont(52,      ip) 
     Tmp1( 3,53) = AuxCont(80      ,iP)+ Yab*AuxCont(53,      ip) 
     Tmp1( 3,54) = AuxCont(81      ,iP)+ Yab*AuxCont(54,      ip) 
     Tmp1( 3,55) = AuxCont(82      ,iP)+ Yab*AuxCont(55,      ip) 
     Tmp1( 3,56) = AuxCont(83      ,iP)+ Yab*AuxCont(56,      ip) 
     Tmp1( 4,11) = AuxCont(23      ,iP)+ Zab*AuxCont(11,      ip) 
     Tmp1( 4,12) = AuxCont(25      ,iP)+ Zab*AuxCont(12,      ip) 
     Tmp1( 4,13) = AuxCont(26      ,iP)+ Zab*AuxCont(13,      ip) 
     Tmp1( 4,14) = AuxCont(28      ,iP)+ Zab*AuxCont(14,      ip) 
     Tmp1( 4,15) = AuxCont(29      ,iP)+ Zab*AuxCont(15,      ip) 
     Tmp1( 4,16) = AuxCont(30      ,iP)+ Zab*AuxCont(16,      ip) 
     Tmp1( 4,17) = AuxCont(32      ,iP)+ Zab*AuxCont(17,      ip) 
     Tmp1( 4,18) = AuxCont(33      ,iP)+ Zab*AuxCont(18,      ip) 
     Tmp1( 4,19) = AuxCont(34      ,iP)+ Zab*AuxCont(19,      ip) 
     Tmp1( 4,20) = AuxCont(35      ,iP)+ Zab*AuxCont(20,      ip) 
     Tmp1( 4,21) = AuxCont(38      ,iP)+ Zab*AuxCont(21,      ip) 
     Tmp1( 4,22) = AuxCont(40      ,iP)+ Zab*AuxCont(22,      ip) 
     Tmp1( 4,23) = AuxCont(41      ,iP)+ Zab*AuxCont(23,      ip) 
     Tmp1( 4,24) = AuxCont(43      ,iP)+ Zab*AuxCont(24,      ip) 
     Tmp1( 4,25) = AuxCont(44      ,iP)+ Zab*AuxCont(25,      ip) 
     Tmp1( 4,26) = AuxCont(45      ,iP)+ Zab*AuxCont(26,      ip) 
     Tmp1( 4,27) = AuxCont(47      ,iP)+ Zab*AuxCont(27,      ip) 
     Tmp1( 4,28) = AuxCont(48      ,iP)+ Zab*AuxCont(28,      ip) 
     Tmp1( 4,29) = AuxCont(49      ,iP)+ Zab*AuxCont(29,      ip) 
     Tmp1( 4,30) = AuxCont(50      ,iP)+ Zab*AuxCont(30,      ip) 
     Tmp1( 4,31) = AuxCont(52      ,iP)+ Zab*AuxCont(31,      ip) 
     Tmp1( 4,32) = AuxCont(53      ,iP)+ Zab*AuxCont(32,      ip) 
     Tmp1( 4,33) = AuxCont(54      ,iP)+ Zab*AuxCont(33,      ip) 
     Tmp1( 4,34) = AuxCont(55      ,iP)+ Zab*AuxCont(34,      ip) 
     Tmp1( 4,35) = AuxCont(56      ,iP)+ Zab*AuxCont(35,      ip) 
     Tmp1( 4,36) = AuxCont(59      ,iP)+ Zab*AuxCont(36,      ip) 
     Tmp1( 4,37) = AuxCont(61      ,iP)+ Zab*AuxCont(37,      ip) 
     Tmp1( 4,38) = AuxCont(62      ,iP)+ Zab*AuxCont(38,      ip) 
     Tmp1( 4,39) = AuxCont(64      ,iP)+ Zab*AuxCont(39,      ip) 
     Tmp1( 4,40) = AuxCont(65      ,iP)+ Zab*AuxCont(40,      ip) 
     Tmp1( 4,41) = AuxCont(66      ,iP)+ Zab*AuxCont(41,      ip) 
     Tmp1( 4,42) = AuxCont(68      ,iP)+ Zab*AuxCont(42,      ip) 
     Tmp1( 4,43) = AuxCont(69      ,iP)+ Zab*AuxCont(43,      ip) 
     Tmp1( 4,44) = AuxCont(70      ,iP)+ Zab*AuxCont(44,      ip) 
     Tmp1( 4,45) = AuxCont(71      ,iP)+ Zab*AuxCont(45,      ip) 
     Tmp1( 4,46) = AuxCont(73      ,iP)+ Zab*AuxCont(46,      ip) 
     Tmp1( 4,47) = AuxCont(74      ,iP)+ Zab*AuxCont(47,      ip) 
     Tmp1( 4,48) = AuxCont(75      ,iP)+ Zab*AuxCont(48,      ip) 
     Tmp1( 4,49) = AuxCont(76      ,iP)+ Zab*AuxCont(49,      ip) 
     Tmp1( 4,50) = AuxCont(77      ,iP)+ Zab*AuxCont(50,      ip) 
     Tmp1( 4,51) = AuxCont(79      ,iP)+ Zab*AuxCont(51,      ip) 
     Tmp1( 4,52) = AuxCont(80      ,iP)+ Zab*AuxCont(52,      ip) 
     Tmp1( 4,53) = AuxCont(81      ,iP)+ Zab*AuxCont(53,      ip) 
     Tmp1( 4,54) = AuxCont(82      ,iP)+ Zab*AuxCont(54,      ip) 
     Tmp1( 4,55) = AuxCont(83      ,iP)+ Zab*AuxCont(55,      ip) 
     Tmp1( 4,56) = AuxCont(84      ,iP)+ Zab*AuxCont(56,      ip) 
     Tmp2( 5,11) = Tmp1( 2,21)+ Xab*Tmp1( 2,11)
     Tmp2( 5,12) = Tmp1( 2,22)+ Xab*Tmp1( 2,12)
     Tmp2( 5,13) = Tmp1( 2,23)+ Xab*Tmp1( 2,13)
     Tmp2( 5,14) = Tmp1( 2,24)+ Xab*Tmp1( 2,14)
     Tmp2( 5,15) = Tmp1( 2,25)+ Xab*Tmp1( 2,15)
     Tmp2( 5,16) = Tmp1( 2,26)+ Xab*Tmp1( 2,16)
     Tmp2( 5,17) = Tmp1( 2,27)+ Xab*Tmp1( 2,17)
     Tmp2( 5,18) = Tmp1( 2,28)+ Xab*Tmp1( 2,18)
     Tmp2( 5,19) = Tmp1( 2,29)+ Xab*Tmp1( 2,19)
     Tmp2( 5,20) = Tmp1( 2,30)+ Xab*Tmp1( 2,20)
     Tmp2( 5,21) = Tmp1( 2,36)+ Xab*Tmp1( 2,21)
     Tmp2( 5,22) = Tmp1( 2,37)+ Xab*Tmp1( 2,22)
     Tmp2( 5,23) = Tmp1( 2,38)+ Xab*Tmp1( 2,23)
     Tmp2( 5,24) = Tmp1( 2,39)+ Xab*Tmp1( 2,24)
     Tmp2( 5,25) = Tmp1( 2,40)+ Xab*Tmp1( 2,25)
     Tmp2( 5,26) = Tmp1( 2,41)+ Xab*Tmp1( 2,26)
     Tmp2( 5,27) = Tmp1( 2,42)+ Xab*Tmp1( 2,27)
     Tmp2( 5,28) = Tmp1( 2,43)+ Xab*Tmp1( 2,28)
     Tmp2( 5,29) = Tmp1( 2,44)+ Xab*Tmp1( 2,29)
     Tmp2( 5,30) = Tmp1( 2,45)+ Xab*Tmp1( 2,30)
     Tmp2( 5,31) = Tmp1( 2,46)+ Xab*Tmp1( 2,31)
     Tmp2( 5,32) = Tmp1( 2,47)+ Xab*Tmp1( 2,32)
     Tmp2( 5,33) = Tmp1( 2,48)+ Xab*Tmp1( 2,33)
     Tmp2( 5,34) = Tmp1( 2,49)+ Xab*Tmp1( 2,34)
     Tmp2( 5,35) = Tmp1( 2,50)+ Xab*Tmp1( 2,35)
     Tmp2( 6,11) = Tmp1( 3,21)+ Xab*Tmp1( 3,11)
     Tmp2( 6,12) = Tmp1( 3,22)+ Xab*Tmp1( 3,12)
     Tmp2( 6,13) = Tmp1( 3,23)+ Xab*Tmp1( 3,13)
     Tmp2( 6,14) = Tmp1( 3,24)+ Xab*Tmp1( 3,14)
     Tmp2( 6,15) = Tmp1( 3,25)+ Xab*Tmp1( 3,15)
     Tmp2( 6,16) = Tmp1( 3,26)+ Xab*Tmp1( 3,16)
     Tmp2( 6,17) = Tmp1( 3,27)+ Xab*Tmp1( 3,17)
     Tmp2( 6,18) = Tmp1( 3,28)+ Xab*Tmp1( 3,18)
     Tmp2( 6,19) = Tmp1( 3,29)+ Xab*Tmp1( 3,19)
     Tmp2( 6,20) = Tmp1( 3,30)+ Xab*Tmp1( 3,20)
     Tmp2( 6,21) = Tmp1( 3,36)+ Xab*Tmp1( 3,21)
     Tmp2( 6,22) = Tmp1( 3,37)+ Xab*Tmp1( 3,22)
     Tmp2( 6,23) = Tmp1( 3,38)+ Xab*Tmp1( 3,23)
     Tmp2( 6,24) = Tmp1( 3,39)+ Xab*Tmp1( 3,24)
     Tmp2( 6,25) = Tmp1( 3,40)+ Xab*Tmp1( 3,25)
     Tmp2( 6,26) = Tmp1( 3,41)+ Xab*Tmp1( 3,26)
     Tmp2( 6,27) = Tmp1( 3,42)+ Xab*Tmp1( 3,27)
     Tmp2( 6,28) = Tmp1( 3,43)+ Xab*Tmp1( 3,28)
     Tmp2( 6,29) = Tmp1( 3,44)+ Xab*Tmp1( 3,29)
     Tmp2( 6,30) = Tmp1( 3,45)+ Xab*Tmp1( 3,30)
     Tmp2( 6,31) = Tmp1( 3,46)+ Xab*Tmp1( 3,31)
     Tmp2( 6,32) = Tmp1( 3,47)+ Xab*Tmp1( 3,32)
     Tmp2( 6,33) = Tmp1( 3,48)+ Xab*Tmp1( 3,33)
     Tmp2( 6,34) = Tmp1( 3,49)+ Xab*Tmp1( 3,34)
     Tmp2( 6,35) = Tmp1( 3,50)+ Xab*Tmp1( 3,35)
     Tmp2( 7,11) = Tmp1( 4,21)+ Xab*Tmp1( 4,11)
     Tmp2( 7,12) = Tmp1( 4,22)+ Xab*Tmp1( 4,12)
     Tmp2( 7,13) = Tmp1( 4,23)+ Xab*Tmp1( 4,13)
     Tmp2( 7,14) = Tmp1( 4,24)+ Xab*Tmp1( 4,14)
     Tmp2( 7,15) = Tmp1( 4,25)+ Xab*Tmp1( 4,15)
     Tmp2( 7,16) = Tmp1( 4,26)+ Xab*Tmp1( 4,16)
     Tmp2( 7,17) = Tmp1( 4,27)+ Xab*Tmp1( 4,17)
     Tmp2( 7,18) = Tmp1( 4,28)+ Xab*Tmp1( 4,18)
     Tmp2( 7,19) = Tmp1( 4,29)+ Xab*Tmp1( 4,19)
     Tmp2( 7,20) = Tmp1( 4,30)+ Xab*Tmp1( 4,20)
     Tmp2( 7,21) = Tmp1( 4,36)+ Xab*Tmp1( 4,21)
     Tmp2( 7,22) = Tmp1( 4,37)+ Xab*Tmp1( 4,22)
     Tmp2( 7,23) = Tmp1( 4,38)+ Xab*Tmp1( 4,23)
     Tmp2( 7,24) = Tmp1( 4,39)+ Xab*Tmp1( 4,24)
     Tmp2( 7,25) = Tmp1( 4,40)+ Xab*Tmp1( 4,25)
     Tmp2( 7,26) = Tmp1( 4,41)+ Xab*Tmp1( 4,26)
     Tmp2( 7,27) = Tmp1( 4,42)+ Xab*Tmp1( 4,27)
     Tmp2( 7,28) = Tmp1( 4,43)+ Xab*Tmp1( 4,28)
     Tmp2( 7,29) = Tmp1( 4,44)+ Xab*Tmp1( 4,29)
     Tmp2( 7,30) = Tmp1( 4,45)+ Xab*Tmp1( 4,30)
     Tmp2( 7,31) = Tmp1( 4,46)+ Xab*Tmp1( 4,31)
     Tmp2( 7,32) = Tmp1( 4,47)+ Xab*Tmp1( 4,32)
     Tmp2( 7,33) = Tmp1( 4,48)+ Xab*Tmp1( 4,33)
     Tmp2( 7,34) = Tmp1( 4,49)+ Xab*Tmp1( 4,34)
     Tmp2( 7,35) = Tmp1( 4,50)+ Xab*Tmp1( 4,35)
     Tmp2( 8,11) = Tmp1( 3,22)+ Yab*Tmp1( 3,11)
     Tmp2( 8,12) = Tmp1( 3,24)+ Yab*Tmp1( 3,12)
     Tmp2( 8,13) = Tmp1( 3,25)+ Yab*Tmp1( 3,13)
     Tmp2( 8,14) = Tmp1( 3,27)+ Yab*Tmp1( 3,14)
     Tmp2( 8,15) = Tmp1( 3,28)+ Yab*Tmp1( 3,15)
     Tmp2( 8,16) = Tmp1( 3,29)+ Yab*Tmp1( 3,16)
     Tmp2( 8,17) = Tmp1( 3,31)+ Yab*Tmp1( 3,17)
     Tmp2( 8,18) = Tmp1( 3,32)+ Yab*Tmp1( 3,18)
     Tmp2( 8,19) = Tmp1( 3,33)+ Yab*Tmp1( 3,19)
     Tmp2( 8,20) = Tmp1( 3,34)+ Yab*Tmp1( 3,20)
     Tmp2( 8,21) = Tmp1( 3,37)+ Yab*Tmp1( 3,21)
     Tmp2( 8,22) = Tmp1( 3,39)+ Yab*Tmp1( 3,22)
     Tmp2( 8,23) = Tmp1( 3,40)+ Yab*Tmp1( 3,23)
     Tmp2( 8,24) = Tmp1( 3,42)+ Yab*Tmp1( 3,24)
     Tmp2( 8,25) = Tmp1( 3,43)+ Yab*Tmp1( 3,25)
     Tmp2( 8,26) = Tmp1( 3,44)+ Yab*Tmp1( 3,26)
     Tmp2( 8,27) = Tmp1( 3,46)+ Yab*Tmp1( 3,27)
     Tmp2( 8,28) = Tmp1( 3,47)+ Yab*Tmp1( 3,28)
     Tmp2( 8,29) = Tmp1( 3,48)+ Yab*Tmp1( 3,29)
     Tmp2( 8,30) = Tmp1( 3,49)+ Yab*Tmp1( 3,30)
     Tmp2( 8,31) = Tmp1( 3,51)+ Yab*Tmp1( 3,31)
     Tmp2( 8,32) = Tmp1( 3,52)+ Yab*Tmp1( 3,32)
     Tmp2( 8,33) = Tmp1( 3,53)+ Yab*Tmp1( 3,33)
     Tmp2( 8,34) = Tmp1( 3,54)+ Yab*Tmp1( 3,34)
     Tmp2( 8,35) = Tmp1( 3,55)+ Yab*Tmp1( 3,35)
     Tmp2( 9,11) = Tmp1( 4,22)+ Yab*Tmp1( 4,11)
     Tmp2( 9,12) = Tmp1( 4,24)+ Yab*Tmp1( 4,12)
     Tmp2( 9,13) = Tmp1( 4,25)+ Yab*Tmp1( 4,13)
     Tmp2( 9,14) = Tmp1( 4,27)+ Yab*Tmp1( 4,14)
     Tmp2( 9,15) = Tmp1( 4,28)+ Yab*Tmp1( 4,15)
     Tmp2( 9,16) = Tmp1( 4,29)+ Yab*Tmp1( 4,16)
     Tmp2( 9,17) = Tmp1( 4,31)+ Yab*Tmp1( 4,17)
     Tmp2( 9,18) = Tmp1( 4,32)+ Yab*Tmp1( 4,18)
     Tmp2( 9,19) = Tmp1( 4,33)+ Yab*Tmp1( 4,19)
     Tmp2( 9,20) = Tmp1( 4,34)+ Yab*Tmp1( 4,20)
     Tmp2( 9,21) = Tmp1( 4,37)+ Yab*Tmp1( 4,21)
     Tmp2( 9,22) = Tmp1( 4,39)+ Yab*Tmp1( 4,22)
     Tmp2( 9,23) = Tmp1( 4,40)+ Yab*Tmp1( 4,23)
     Tmp2( 9,24) = Tmp1( 4,42)+ Yab*Tmp1( 4,24)
     Tmp2( 9,25) = Tmp1( 4,43)+ Yab*Tmp1( 4,25)
     Tmp2( 9,26) = Tmp1( 4,44)+ Yab*Tmp1( 4,26)
     Tmp2( 9,27) = Tmp1( 4,46)+ Yab*Tmp1( 4,27)
     Tmp2( 9,28) = Tmp1( 4,47)+ Yab*Tmp1( 4,28)
     Tmp2( 9,29) = Tmp1( 4,48)+ Yab*Tmp1( 4,29)
     Tmp2( 9,30) = Tmp1( 4,49)+ Yab*Tmp1( 4,30)
     Tmp2( 9,31) = Tmp1( 4,51)+ Yab*Tmp1( 4,31)
     Tmp2( 9,32) = Tmp1( 4,52)+ Yab*Tmp1( 4,32)
     Tmp2( 9,33) = Tmp1( 4,53)+ Yab*Tmp1( 4,33)
     Tmp2( 9,34) = Tmp1( 4,54)+ Yab*Tmp1( 4,34)
     Tmp2( 9,35) = Tmp1( 4,55)+ Yab*Tmp1( 4,35)
     Tmp2(10,11) = Tmp1( 4,23)+ Zab*Tmp1( 4,11)
     Tmp2(10,12) = Tmp1( 4,25)+ Zab*Tmp1( 4,12)
     Tmp2(10,13) = Tmp1( 4,26)+ Zab*Tmp1( 4,13)
     Tmp2(10,14) = Tmp1( 4,28)+ Zab*Tmp1( 4,14)
     Tmp2(10,15) = Tmp1( 4,29)+ Zab*Tmp1( 4,15)
     Tmp2(10,16) = Tmp1( 4,30)+ Zab*Tmp1( 4,16)
     Tmp2(10,17) = Tmp1( 4,32)+ Zab*Tmp1( 4,17)
     Tmp2(10,18) = Tmp1( 4,33)+ Zab*Tmp1( 4,18)
     Tmp2(10,19) = Tmp1( 4,34)+ Zab*Tmp1( 4,19)
     Tmp2(10,20) = Tmp1( 4,35)+ Zab*Tmp1( 4,20)
     Tmp2(10,21) = Tmp1( 4,38)+ Zab*Tmp1( 4,21)
     Tmp2(10,22) = Tmp1( 4,40)+ Zab*Tmp1( 4,22)
     Tmp2(10,23) = Tmp1( 4,41)+ Zab*Tmp1( 4,23)
     Tmp2(10,24) = Tmp1( 4,43)+ Zab*Tmp1( 4,24)
     Tmp2(10,25) = Tmp1( 4,44)+ Zab*Tmp1( 4,25)
     Tmp2(10,26) = Tmp1( 4,45)+ Zab*Tmp1( 4,26)
     Tmp2(10,27) = Tmp1( 4,47)+ Zab*Tmp1( 4,27)
     Tmp2(10,28) = Tmp1( 4,48)+ Zab*Tmp1( 4,28)
     Tmp2(10,29) = Tmp1( 4,49)+ Zab*Tmp1( 4,29)
     Tmp2(10,30) = Tmp1( 4,50)+ Zab*Tmp1( 4,30)
     Tmp2(10,31) = Tmp1( 4,52)+ Zab*Tmp1( 4,31)
     Tmp2(10,32) = Tmp1( 4,53)+ Zab*Tmp1( 4,32)
     Tmp2(10,33) = Tmp1( 4,54)+ Zab*Tmp1( 4,33)
     Tmp2(10,34) = Tmp1( 4,55)+ Zab*Tmp1( 4,34)
     Tmp2(10,35) = Tmp1( 4,56)+ Zab*Tmp1( 4,35)
     ThetaP(11,11      ,iP) = Tmp2( 5,21)+ Xab*Tmp2( 5,11)
     ThetaP(11,12      ,iP) = Tmp2( 5,22)+ Xab*Tmp2( 5,12)
     ThetaP(11,13      ,iP) = Tmp2( 5,23)+ Xab*Tmp2( 5,13)
     ThetaP(11,14      ,iP) = Tmp2( 5,24)+ Xab*Tmp2( 5,14)
     ThetaP(11,15      ,iP) = Tmp2( 5,25)+ Xab*Tmp2( 5,15)
     ThetaP(11,16      ,iP) = Tmp2( 5,26)+ Xab*Tmp2( 5,16)
     ThetaP(11,17      ,iP) = Tmp2( 5,27)+ Xab*Tmp2( 5,17)
     ThetaP(11,18      ,iP) = Tmp2( 5,28)+ Xab*Tmp2( 5,18)
     ThetaP(11,19      ,iP) = Tmp2( 5,29)+ Xab*Tmp2( 5,19)
     ThetaP(11,20      ,iP) = Tmp2( 5,30)+ Xab*Tmp2( 5,20)
     ThetaP(12,11      ,iP) = Tmp2( 6,21)+ Xab*Tmp2( 6,11)
     ThetaP(12,12      ,iP) = Tmp2( 6,22)+ Xab*Tmp2( 6,12)
     ThetaP(12,13      ,iP) = Tmp2( 6,23)+ Xab*Tmp2( 6,13)
     ThetaP(12,14      ,iP) = Tmp2( 6,24)+ Xab*Tmp2( 6,14)
     ThetaP(12,15      ,iP) = Tmp2( 6,25)+ Xab*Tmp2( 6,15)
     ThetaP(12,16      ,iP) = Tmp2( 6,26)+ Xab*Tmp2( 6,16)
     ThetaP(12,17      ,iP) = Tmp2( 6,27)+ Xab*Tmp2( 6,17)
     ThetaP(12,18      ,iP) = Tmp2( 6,28)+ Xab*Tmp2( 6,18)
     ThetaP(12,19      ,iP) = Tmp2( 6,29)+ Xab*Tmp2( 6,19)
     ThetaP(12,20      ,iP) = Tmp2( 6,30)+ Xab*Tmp2( 6,20)
     ThetaP(13,11      ,iP) = Tmp2( 7,21)+ Xab*Tmp2( 7,11)
     ThetaP(13,12      ,iP) = Tmp2( 7,22)+ Xab*Tmp2( 7,12)
     ThetaP(13,13      ,iP) = Tmp2( 7,23)+ Xab*Tmp2( 7,13)
     ThetaP(13,14      ,iP) = Tmp2( 7,24)+ Xab*Tmp2( 7,14)
     ThetaP(13,15      ,iP) = Tmp2( 7,25)+ Xab*Tmp2( 7,15)
     ThetaP(13,16      ,iP) = Tmp2( 7,26)+ Xab*Tmp2( 7,16)
     ThetaP(13,17      ,iP) = Tmp2( 7,27)+ Xab*Tmp2( 7,17)
     ThetaP(13,18      ,iP) = Tmp2( 7,28)+ Xab*Tmp2( 7,18)
     ThetaP(13,19      ,iP) = Tmp2( 7,29)+ Xab*Tmp2( 7,19)
     ThetaP(13,20      ,iP) = Tmp2( 7,30)+ Xab*Tmp2( 7,20)
     ThetaP(14,11      ,iP) = Tmp2( 8,21)+ Xab*Tmp2( 8,11)
     ThetaP(14,12      ,iP) = Tmp2( 8,22)+ Xab*Tmp2( 8,12)
     ThetaP(14,13      ,iP) = Tmp2( 8,23)+ Xab*Tmp2( 8,13)
     ThetaP(14,14      ,iP) = Tmp2( 8,24)+ Xab*Tmp2( 8,14)
     ThetaP(14,15      ,iP) = Tmp2( 8,25)+ Xab*Tmp2( 8,15)
     ThetaP(14,16      ,iP) = Tmp2( 8,26)+ Xab*Tmp2( 8,16)
     ThetaP(14,17      ,iP) = Tmp2( 8,27)+ Xab*Tmp2( 8,17)
     ThetaP(14,18      ,iP) = Tmp2( 8,28)+ Xab*Tmp2( 8,18)
     ThetaP(14,19      ,iP) = Tmp2( 8,29)+ Xab*Tmp2( 8,19)
     ThetaP(14,20      ,iP) = Tmp2( 8,30)+ Xab*Tmp2( 8,20)
     ThetaP(15,11      ,iP) = Tmp2( 9,21)+ Xab*Tmp2( 9,11)
     ThetaP(15,12      ,iP) = Tmp2( 9,22)+ Xab*Tmp2( 9,12)
     ThetaP(15,13      ,iP) = Tmp2( 9,23)+ Xab*Tmp2( 9,13)
     ThetaP(15,14      ,iP) = Tmp2( 9,24)+ Xab*Tmp2( 9,14)
     ThetaP(15,15      ,iP) = Tmp2( 9,25)+ Xab*Tmp2( 9,15)
     ThetaP(15,16      ,iP) = Tmp2( 9,26)+ Xab*Tmp2( 9,16)
     ThetaP(15,17      ,iP) = Tmp2( 9,27)+ Xab*Tmp2( 9,17)
     ThetaP(15,18      ,iP) = Tmp2( 9,28)+ Xab*Tmp2( 9,18)
     ThetaP(15,19      ,iP) = Tmp2( 9,29)+ Xab*Tmp2( 9,19)
     ThetaP(15,20      ,iP) = Tmp2( 9,30)+ Xab*Tmp2( 9,20)
     ThetaP(16,11      ,iP) = Tmp2(10,21)+ Xab*Tmp2(10,11)
     ThetaP(16,12      ,iP) = Tmp2(10,22)+ Xab*Tmp2(10,12)
     ThetaP(16,13      ,iP) = Tmp2(10,23)+ Xab*Tmp2(10,13)
     ThetaP(16,14      ,iP) = Tmp2(10,24)+ Xab*Tmp2(10,14)
     ThetaP(16,15      ,iP) = Tmp2(10,25)+ Xab*Tmp2(10,15)
     ThetaP(16,16      ,iP) = Tmp2(10,26)+ Xab*Tmp2(10,16)
     ThetaP(16,17      ,iP) = Tmp2(10,27)+ Xab*Tmp2(10,17)
     ThetaP(16,18      ,iP) = Tmp2(10,28)+ Xab*Tmp2(10,18)
     ThetaP(16,19      ,iP) = Tmp2(10,29)+ Xab*Tmp2(10,19)
     ThetaP(16,20      ,iP) = Tmp2(10,30)+ Xab*Tmp2(10,20)
     ThetaP(17,11      ,iP) = Tmp2( 8,22)+ Yab*Tmp2( 8,11)
     ThetaP(17,12      ,iP) = Tmp2( 8,24)+ Yab*Tmp2( 8,12)
     ThetaP(17,13      ,iP) = Tmp2( 8,25)+ Yab*Tmp2( 8,13)
     ThetaP(17,14      ,iP) = Tmp2( 8,27)+ Yab*Tmp2( 8,14)
     ThetaP(17,15      ,iP) = Tmp2( 8,28)+ Yab*Tmp2( 8,15)
     ThetaP(17,16      ,iP) = Tmp2( 8,29)+ Yab*Tmp2( 8,16)
     ThetaP(17,17      ,iP) = Tmp2( 8,31)+ Yab*Tmp2( 8,17)
     ThetaP(17,18      ,iP) = Tmp2( 8,32)+ Yab*Tmp2( 8,18)
     ThetaP(17,19      ,iP) = Tmp2( 8,33)+ Yab*Tmp2( 8,19)
     ThetaP(17,20      ,iP) = Tmp2( 8,34)+ Yab*Tmp2( 8,20)
     ThetaP(18,11      ,iP) = Tmp2( 9,22)+ Yab*Tmp2( 9,11)
     ThetaP(18,12      ,iP) = Tmp2( 9,24)+ Yab*Tmp2( 9,12)
     ThetaP(18,13      ,iP) = Tmp2( 9,25)+ Yab*Tmp2( 9,13)
     ThetaP(18,14      ,iP) = Tmp2( 9,27)+ Yab*Tmp2( 9,14)
     ThetaP(18,15      ,iP) = Tmp2( 9,28)+ Yab*Tmp2( 9,15)
     ThetaP(18,16      ,iP) = Tmp2( 9,29)+ Yab*Tmp2( 9,16)
     ThetaP(18,17      ,iP) = Tmp2( 9,31)+ Yab*Tmp2( 9,17)
     ThetaP(18,18      ,iP) = Tmp2( 9,32)+ Yab*Tmp2( 9,18)
     ThetaP(18,19      ,iP) = Tmp2( 9,33)+ Yab*Tmp2( 9,19)
     ThetaP(18,20      ,iP) = Tmp2( 9,34)+ Yab*Tmp2( 9,20)
     ThetaP(19,11      ,iP) = Tmp2(10,22)+ Yab*Tmp2(10,11)
     ThetaP(19,12      ,iP) = Tmp2(10,24)+ Yab*Tmp2(10,12)
     ThetaP(19,13      ,iP) = Tmp2(10,25)+ Yab*Tmp2(10,13)
     ThetaP(19,14      ,iP) = Tmp2(10,27)+ Yab*Tmp2(10,14)
     ThetaP(19,15      ,iP) = Tmp2(10,28)+ Yab*Tmp2(10,15)
     ThetaP(19,16      ,iP) = Tmp2(10,29)+ Yab*Tmp2(10,16)
     ThetaP(19,17      ,iP) = Tmp2(10,31)+ Yab*Tmp2(10,17)
     ThetaP(19,18      ,iP) = Tmp2(10,32)+ Yab*Tmp2(10,18)
     ThetaP(19,19      ,iP) = Tmp2(10,33)+ Yab*Tmp2(10,19)
     ThetaP(19,20      ,iP) = Tmp2(10,34)+ Yab*Tmp2(10,20)
     ThetaP(20,11      ,iP) = Tmp2(10,23)+ Zab*Tmp2(10,11)
     ThetaP(20,12      ,iP) = Tmp2(10,25)+ Zab*Tmp2(10,12)
     ThetaP(20,13      ,iP) = Tmp2(10,26)+ Zab*Tmp2(10,13)
     ThetaP(20,14      ,iP) = Tmp2(10,28)+ Zab*Tmp2(10,14)
     ThetaP(20,15      ,iP) = Tmp2(10,29)+ Zab*Tmp2(10,15)
     ThetaP(20,16      ,iP) = Tmp2(10,30)+ Zab*Tmp2(10,16)
     ThetaP(20,17      ,iP) = Tmp2(10,32)+ Zab*Tmp2(10,17)
     ThetaP(20,18      ,iP) = Tmp2(10,33)+ Zab*Tmp2(10,18)
     ThetaP(20,19      ,iP) = Tmp2(10,34)+ Zab*Tmp2(10,19)
     ThetaP(20,20      ,iP) = Tmp2(10,35)+ Zab*Tmp2(10,20)
  ENDDO
!$OMP END PARALLEL DO
end subroutine HorizontalRR_LHS_P6A3B3BtoA
end module
