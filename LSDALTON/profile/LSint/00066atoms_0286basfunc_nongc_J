#!/bin/sh
#
# This is the script for generating files for a specific Dalton test job.
#
# For the .check file ksh or bash is preferred, otherwise use sh
# (and hope it is not the old Bourne shell, which will not work)
#
if [ -x /bin/ksh ]; then
   CHECK_SHELL='#!/bin/ksh'
elif [ -x /bin/bash ]; then
   CHECK_SHELL='#!/bin/bash'
else
   CHECK_SHELL='#!/bin/sh'
fi


#######################################################################
#  TEST DESCRIPTION
#######################################################################
cat > 00066atoms_0286basfunc_nongc_J.info <<'%EOF%'
   00066atoms_0286basfunc_nongc_J
   -------------
   Molecule:         22 water molecules in 3D cluster/3-21G
   Wave Function:    HF
   Profile:          Coulomb Matrix
   CPU time:         ~8 seconds
%EOF%

#######################################################################
#  MOLECULE INPUT
#######################################################################
cat > 00066atoms_0286basfunc_nongc_J.mol <<'%EOF%'
BASIS
3-21G Aux=Ahlrichs-Coulomb-Fit
File created by create_mol_file program, 66 atoms
unit flag pos ->   X
Atomtypes=2 Charge=0 Nosymmetry Angstrom
Charge=1. Atoms=44
H       30.559000000    31.098000000    30.763000000
H       31.823000000    31.514000000    31.485000000
H       26.326000000    30.040000000    29.611000000
H       25.426000000    28.836000000    29.782000000
H       30.421000000    36.350000000    31.028000000
H       29.530000000    35.277000000    30.440000000
H       31.056000000    35.497000000    34.020000000
H       32.412000000    35.977000000    34.492000000
H       31.764000000    28.295000000    28.890000000
H       30.595000000    29.171000000    29.286000000
H       29.145000000    33.003000000    31.132000000
H       30.064000000    32.735000000    32.305000000
H       33.707000000    33.211000000    31.017000000
H       33.306000000    32.172000000    29.993000000
H       35.935000000    27.873000000    31.608000000
H       34.955000000    28.999000000    31.858000000
H       32.455000000    29.569000000    31.141000000
H       33.685000000    29.770000000    30.282000000
H       29.168000000    28.616000000    33.124000000
H       29.705000000    29.927000000    32.593000000
H       32.552000000    33.440000000    33.951000000
H       33.143000000    32.739000000    32.746000000
H       30.862000000    29.519000000    27.092000000
H       29.805000000    29.284000000    26.034000000
H       27.475000000    30.831000000    26.721000000
H       27.457000000    29.387000000    27.175000000
H       32.356000000    32.394000000    27.786000000
H       33.594000000    33.067000000    27.234000000
H       34.983000000    35.290000000    31.709000000
H       36.044000000    34.324000000    31.227000000
H       33.924000000    30.336000000    28.186000000
H       35.428000000    30.500000000    28.208000000
H       32.157000000    31.116000000    34.460000000
H       32.801000000    29.792000000    34.812000000
H       28.795000000    30.750000000    28.761000000
H       28.139000000    31.173000000    30.058000000
H       25.920000000    31.352000000    30.869000000
H       26.203000000    32.797000000    31.220000000
H       27.389000000    26.655000000    31.258000000
H       27.526000000    28.101000000    30.834000000
H       29.743000000    27.032000000    30.371000000
H       30.483000000    25.977000000    31.166000000
H       29.938000000    29.732000000    35.297000000
H       30.045000000    29.184000000    36.704000000
Charge=8. Atoms=22
O       30.980000000    31.081000000    31.622000000
O       26.052000000    29.385000000    30.253000000
O       30.193000000    35.925000000    30.202000000
O       31.902000000    35.181000000    34.337000000
O       31.405000000    29.175000000    28.776000000
O       29.478000000    33.398000000    31.938000000
O       33.225000000    32.390000000    30.921000000
O       35.858000000    28.730000000    32.027000000
O       33.385000000    29.350000000    31.088000000
O       28.890000000    29.480000000    32.821000000
O       32.855000000    32.584000000    33.646000000
O       30.641000000    29.726000000    26.184000000
O       27.596000000    30.278000000    27.494000000
O       33.311000000    32.392000000    27.851000000
O       35.108000000    34.386000000    31.419000000
O       34.711000000    30.036000000    28.639000000
O       32.100000000    30.387000000    35.078000000
O       28.993000000    30.982000000    29.668000000
O       26.417000000    32.117000000    30.581000000
O       28.014000000    27.280000000    30.890000000
O       30.595000000    26.602000000    30.449000000
O       29.431000000    29.289000000    35.977000000
%EOF%

#######################################################################
#  DALTON INPUT
#######################################################################
cat > 00066atoms_0286basfunc_nongc_J.dal <<'%EOF%'
**PROFILE
.COULOMB
**WAVE FUNCTIONS
.HF
*DENSOPT
.START
H1DIAG
*END OF INPUT
%EOF%

#######################################################################
#  CHECK SCRIPT
#######################################################################
echo $CHECK_SHELL >00066atoms_0286basfunc_nongc_J.check
cat >> 00066atoms_0286basfunc_nongc_J.check <<'%EOF%'
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi
CRIT1=`$GREP "Coulomb energy, mat_dotproduct\(D,J\)\= * 4372\.9746268" $log | wc -l`
TEST[1]=`expr  $CRIT1`
CTRL[1]=1
ERROR[1]="ENERGY NOT CORRECT -"

PASSED=1
for i in 1
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
      echo ${ERROR[i]}
      PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
   echo PROF ENDED PROPERLY
   exit 0
else
   echo THERE IS A PROBLEM
   exit 1
fi

%EOF%
#######################################################################
