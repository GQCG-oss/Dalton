#!/bin/bash
# 32 bit MPI lib
source /com/OpenMPI/1.4.1/intel/bin/openmpi.sh
source /com/intel/Compiler/11.1/064/mkl/tools/environment/mklvarsem64t.sh
TMP_DIR=/home/tkjaer/NightlyTestingCdash/tmp/DaltonReleaseompMPI64
SCRATCH_DIR=/scratch/tkjaer/DaltonReleaseompMPI64
git clone git@repo.ctcc.no:dalton.git $TMP_DIR
cd $TMP_DIR
git checkout linsca-develop
export OMP_NUM_THREADS=3
export MATH_ROOT=/com/intel/mkl/10.1.1.019
MATH_ROOT=/com/intel/mkl/10.1.1.019
source /com/OpenMPI/1.4.1/intel/bin/openmpi.sh
source /com/intel/Compiler/11.1/064/mkl/tools/environment/mklvarsem64t.sh
source /com/intel/Compiler/11.1/064/bin/intel64/ifortvars_intel64.sh
export LD_LIBRARY_PATH=/com/intel/Compiler/11.1/064/lib/intel64:/com/OpenMPI/1.4.1/intel/lib:/com/intel/mkl/9.1.023/lib/em64t
./setup --fc=mpif90 --cc=mpicc --mpi --internal-math --scratch=$SCRATCH_DIR --int64 --mpi32 --omp --timings -D BUILDNAME="Grendel-linux-MPI-32bit-64bitlsdalton"
cd $TMP_DIR/build
make depend
make Nightly
rm -rf $TMP_DIR 
rm -rf $SCRATCH_DIR

exit 0

