#!/bin/bash
TMP_DIR=/home/tkjaer/NightlyTestingCdash/tmp/DaltonGfortranDebug
SCRATCH_DIR=/tmp/tkjaer/DaltonGfortranDebug
rm -rf $TMP_DIR 
rm -rf $SCRATCH_DIR
export PATH=/com/gcc/4.7.2/bin:/usr/local/torque/bin:/com/bin:/usr/local/bin:/bin:/usr/bin:/com/intel/Compiler/11.1/064/mkl/lib/em64t
export LD_LIBRARY_PATH=/com/gcc/4.7.2/lib64:/com/gcc/4.7.2/lib:/com/intel/Compiler/11.1/064/mkl/lib/em64t:/com/intel/Compiler/11.1/064/lib/intel64
git clone git@repo.ctcc.no:dalton.git $TMP_DIR
cd $TMP_DIR
#git checkout linsca-develop
#git checkout Dalton2013_release
git log --pretty=format:"%an" --since=1.day > /home/tkjaer/NightlyTestingCdash/SINNERS
source /com/gcc/4.7.2/load.sh
cd $TMP_DIR
mkdir $TMP_DIR/build
cd $TMP_DIR/build
export OMP_NUM_THREADS=1
export MATH_ROOT=/com/intel/Compiler/11.1/064/mkl
export DALTON_TMPDIR=$SCRATCH_DIR
export DALTON_NUM_MPI_PROCS=1
export CTEST_PROJECT_NAME=LSDALTON
FC=gfortran CC=gcc CXX=gcc cmake -DENABLE_BOUNDS_CHECK=1 -DCMAKE_BUILD_TYPE=Debug -DENABLE_CODE_COVERAGE=1 -DENABLE_RELEASE=0 -DENABLE_TIMINGS=1 -DENABLE_BLAS=ON -DENABLE_LAPACK=ON -DBUILDNAME=MB-Grendel-linux-gfortran472-debug /home/tkjaer/NightlyTestingCdash/tmp/DaltonGfortranDebug
#make depend
#make Experimental
#make Nightly
ctest -D Nightly -L linsca -j4
exit 0

