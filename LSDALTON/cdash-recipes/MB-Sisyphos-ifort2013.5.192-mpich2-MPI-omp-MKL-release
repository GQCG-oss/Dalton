TMP_DIR=/home/sisyphos/NightlyTesting/tmp/DaltonIfortRelease32MPI
SCRATCH_DIR=/tmp/sisyphos/DaltonIfortRelease32MPI
rm -rf $TMP_DIR
rm -rf $SCRATCH_DIR

git clone --recursive git@gitlab.com:dalton/dalton.git $TMP_DIR
cd $TMP_DIR
export OMP_NUM_THREADS=2
export DALTON_TMPDIR=$SCRATCH_DIR
export DALTON_NUM_MPI_PROCS=3
export CTEST_PROJECT_NAME=LSDALTON

source /opt/intel/bin/compilervars.sh intel64
source /opt/intel/mkl/bin/mklvars.sh intel64
export MATH_ROOT=/opt/intel/mkl
#mpich2 32 bit integer MPI compiled using ifort 
export PATH=/home/sisyphos/mpich2-ifortbuild-exec/bin:$PATH
export LD_LIBRARY_PATH=/home/sisyphos/mpich2-ifortbuild-exec/lib:$LD_LIBRARY_PATH
./setup --fc=mpif90 --cc=mpicc --cxx=mpic++ --csr --scalapack --static --timings --mpi --omp --lapack=none --blas=none --explicit-libs="-Wl,--start-group /opt/intel/mkl/lib/intel64/libmkl_scalapack_lp64.a /opt/intel/mkl/lib/intel64/libmkl_blacs_intelmpi_lp64.a /opt/intel/mkl/lib/intel64/libmkl_intel_lp64.a /opt/intel/mkl/lib/intel64/libmkl_intel_thread.a /opt/intel/mkl/lib/intel64/libmkl_core.a -Wl,--end-group /opt/intel/composer_xe_2013.5.192/compiler/lib/intel64/libiomp5.a -openmp -lpthread -lm" -DENABLE_DEC=ON -DENABLE_TENSORS=ON -D BUILDNAME="MB-Sisyphos-ifort2013.5.192-mpich2-MPI-omp-MKL-release" build

cd build
ctest -D Nightly -L linsca
exit 0

