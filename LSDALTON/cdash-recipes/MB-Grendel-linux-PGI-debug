#!/bin/bash
TMP_DIR=/home/tkjaer/NightlyTestingCdash/tmp/DaltonPGIDebug
SCRATCH_DIR=/tmp/tkjaer/DaltonPGIDebug
rm -rf $TMP_DIR 
rm -rf $SCRATCH_DIR
export PATH=/usr/local/torque/bin:/com/pgi/linux86-64/2015/bin:/com/bin:/usr/local/bin:/bin:/usr/bin:$PATH
export LD_LIBRARY_PATH=/com/pgi/linux86-64/2015/bin:$LD_LIBRARY_PATH
git clone --recursive git@gitlab.com:dalton/dalton.git $TMP_DIR
cd $TMP_DIR
#git checkout linsca-develop
#git checkout Dalton2013_release
git log --pretty=format:"%an" --since=1.day > /home/tkjaer/NightlyTestingCdash/SINNERS
#export MATH_ROOT=/com/acml-4.1.0-pgi

export OMP_NUM_THREADS=1
export DALTON_TMPDIR=$SCRATCH_DIR
export DALTON_NUM_MPI_PROCS=1
export CTEST_PROJECT_NAME=LSDALTON
#./setup --fc=pgf90 --cc=pgcc --blas=builtin --lapack=builtin -DENABLE_DEC=ON -D BUILDNAME="RB-Grendel-linux-PGI-debug" --type=debug --check
./setup --fc=pgf90 --cc=pgcc --cxx=pgc++ -DENABLE_DEC=ON -D BUILDNAME="MB-Grendel-linux-PGI-debug" --type=debug --check -D ENABLE_EFS=OFF -D ENABLE_GEN1INT=OFF -D ENABLE_PELIB=OFF
cd $TMP_DIR/build
#make clean
#find . -exec touch {} \;
#make depend
#make Experimental
#make Nightly
ctest -D Nightly -L linsca -j4
exit 0

