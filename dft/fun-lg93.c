/*
C...   Copyright (c) 2005 by the authors of Dalton (see below).
C...   All Rights Reserved.
C...
C...   The source code in this file is part of
C...   "Dalton, a molecular electronic structure program, Release 2.0
C...   (2005), written by C. Angeli, K. L. Bak,  V. Bakken,
C...   O. Christiansen, R. Cimiraglia, S. Coriani, P. Dahle,
C...   E. K. Dalskov, T. Enevoldsen, B. Fernandez, C. Haettig,
C...   K. Hald, A. Halkier, H. Heiberg, T. Helgaker, H. Hettema,
C...   H. J. Aa. Jensen, D. Jonsson, P. Joergensen, S. Kirpekar,
C...   W. Klopper, R.Kobayashi, H. Koch, O. B. Lutnaes, K. V. Mikkelsen,
C...   P. Norman, J.Olsen, M. J. Packer, T. B. Pedersen, Z. Rinkevicius,
C...   E. Rudberg, T. A. Ruden, K. Ruud, P. Salek, A. Sanchez de Meras,
C...   T. Saue, S. P. A. Sauer, B. Schimmelpfennig, K. O. Sylvester-Hvid,
C...   P. R. Taylor, O. Vahtras, D. J. Wilson, H. Agren.
C...   This source code is provided under a written licence and may be
C...   used, copied, transmitted, or stored only in accord with that
C...   written licence.
C...
C...   In particular, no part of the source code or compiled modules may
C...   be distributed outside the research group of the licence holder.
C...   This means also that persons (e.g. post-docs) leaving the research
C...   group of the licence holder may not take any part of Dalton,
C...   including modified files, with him/her, unless that person has
C...   obtained his/her own licence.
C...
C...   For questions concerning this copyright write to:
C...      dalton-admin@kjemi.uio.no
C...
C...   For information on how to get a licence see:
C...      http://www.kjemi.uio.no/software/dalton/dalton.html
C
*/
/*-*-mode: C; c-indentation-style: "bsd"; c-basic-offset: 4; -*-*/
/* fun-lg93.c:

   Automatically generated code implementing LG93 functional and
   its derivatives. It is generated by func-codegen.pl being a part of
   a "Automatic code generation framework for analytical functional
   derivative evaluation", Pawel Salek, 2005

    This functional is connected by making following changes:
    1. add "extern Functional lg93Functional;" to 'functionals.h'
    2. add "&lg93Functional," to 'functionals.c'
    3. add "fun-lg93.c" to 'Makefile.am', 'Makefile.in' or 'Makefile'.

    This functional has been generated from following input:
    ------ cut here -------
rho:  rhoa + rhob;
grad: sqrt(grada*grada + gradb*gradb + 2*gradab);
zeta: (rhoa-rhob)/(rhoa+rhob);

ad:  1.0*10^(-8);
a4:  29.790;
a6:  22.417;
a8:  12.119;
a10: 1570.1;
a12: 55.944;
b:   0.024974;
Ax:  -3/4*(6/%PI)^(1/3);
kfa: (6*%PI*%PI*rhoa)^(1/3);
kfb: (6*%PI*%PI*rhob)^(1/3);
exa: -3*kfa/(4*%PI);
exb: -3*kfb/(4*%PI);

sa:  grada/(2*kfa*rhoa);
sb:  gradb/(2*kfb*rhob);
F1a: (1+((ad+0.1234)/b)*sa^2+a4*sa^4+a6*sa^6+a8*sa^8+a10*sa^10+a12*sa^12)^b;
F1b: (1+((ad+0.1234)/b)*sb^2+a4*sb^4+a6*sb^6+a8*sb^8+a10*sb^10+a12*sb^12)^b;
F2a: 1+ad*sa^2;
F2b: 1+ad*sb^2;
Fa: F1a/F2a;
Fb: F1b/F2b;

Exa: Ax*rhoa^(4/3)*Fa;
Exb: Ax*rhob^(4/3)*Fb;

K(rhoa,rhob,grada,gradb,gradab):=(Exa+Exb);


    ------ cut here -------
*/

 
/* strictly conform to XOPEN ANSI C standard */
#if !defined(SYS_DEC)
/* XOPEN compliance is missing on old Tru64 4.0E Alphas and pow() prototype
 * is not specified. */
#define _XOPEN_SOURCE          500
#define _XOPEN_SOURCE_EXTENDED 1
#endif
#include <math.h>
#include <stddef.h>
 
#define __CVERSION__
 
#include "functionals.h"
 
/* INTERFACE PART */
static int lg93_isgga(void) { return 1; } /* FIXME: detect! */
static int lg93_read(const char *conf_line);
static real lg93_energy(const FunDensProp* dp);
static void lg93_first(FunFirstFuncDrv *ds,   real factor,
                         const FunDensProp* dp);
static void lg93_second(FunSecondFuncDrv *ds, real factor,
                          const FunDensProp* dp);
static void lg93_third(FunThirdFuncDrv *ds,   real factor,
                         const FunDensProp* dp);
static void lg93_fourth(FunFourthFuncDrv *ds,   real factor,
                          const FunDensProp* dp);
 
Functional LG93Functional = {
  "LG93",       /* name */
  lg93_isgga,   /* gga-corrected */
  lg93_read,
  NULL,
  lg93_energy,
  lg93_first,
  lg93_second,
  lg93_third,
  lg93_fourth
};
 
/* IMPLEMENTATION PART */
static int
lg93_read(const char *conf_line)
{
    fun_set_hf_weight(0);
    return 1;
}

static real
lg93_energy(const FunDensProp *dp)
{
    real res;
    real rhoa = dp->rhoa, rhob = dp->rhob;
    real grada = dp->grada, gradb = dp->gradb, gradab = dp->gradab;

    real t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
    real t11, t12, t13, t14;

    t1 = pow(6.0,0.333333333333333);
    t2 = 1/pow(3.141592653589793,0.333333333333333);
    t3 = 1/pow(6.0,0.666666666666667);
    t4 = 1/pow(3.141592653589793,1.333333333333333);
    t5 = pow(grada,2.0);
    t6 = 1/pow(rhoa,2.666666666666667);
    t7 = 1/pow(3.141592653589793,8.0);
    t8 = 1/t1;
    t9 = 1/pow(3.141592653589793,6.666666666666667);
    t10 = 1/pow(3.141592653589793,5.333333333333333);
    t11 = 1/pow(3.141592653589793,4.0);
    t12 = 1/pow(3.141592653589793,2.666666666666667);
    t13 = pow(gradb,2.0);
    t14 = 1/pow(rhob,2.666666666666667);

   /* code */
    res = -0.75*t1*t2*pow(rhob,1.333333333333333)*pow(1.0538736979166666E-5*
        t7*pow(gradb,12.0)/pow(rhob,16.0)+0.007098614728009*t8*t9*
        pow(gradb,10.0)/pow(rhob,13.33333333333333)+0.001314995659722*
        t10*t3*pow(gradb,8.0)/pow(rhob,10.66666666666667)+0.009729600694444*
        t11*pow(gradb,6.0)/pow(rhob,8.0)+0.3103125*t12*t8*pow(gradb,
        4.0)/pow(rhob,5.333333333333333)+1.235284796188036*t3*t4*t13*
        t14+1.0,0.024974)/(2.5E-9*t3*t4*t13*t14+1.0)-0.75*t1*t2*pow(rhoa,
        1.333333333333333)*pow(1.0538736979166666E-5*t7*pow(grada,
        12.0)/pow(rhoa,16.0)+0.007098614728009*t8*t9*pow(grada,10.0)/
        pow(rhoa,13.33333333333333)+0.001314995659722*t10*t3*pow(grada,
        8.0)/pow(rhoa,10.66666666666667)+0.009729600694444*t11*pow(grada,
        6.0)/pow(rhoa,8.0)+0.3103125*t12*t8*pow(grada,4.0)/pow(rhoa,
        5.333333333333333)+1.235284796188036*t3*t4*t5*t6+1.0,0.024974)/
        (2.5E-9*t3*t4*t5*t6+1.0);

    return res;
}

static void
lg93_first_helper(real rhoa, real grada, real *res)
{    real t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
    real t11, t12, t13, t14, t15, t16, t17, t18;
    real t19, t20, t21, t22, t23, t24, t25, t26;
    real t27, t28, t29, t30;

    t1 = pow(6.0,0.333333333333333);
    t2 = 1/t1;
    t3 = 1/pow(3.141592653589793,1.666666666666667);
    t4 = pow(grada,2.0);
    t5 = 1/pow(6.0,0.666666666666667);
    t6 = 1/pow(3.141592653589793,1.333333333333333);
    t7 = 1/pow(rhoa,2.666666666666667);
    t8 = 2.5E-9*t5*t6*t4*t7+1.0;
    t9 = 1/pow(t8,2.0);
    t10 = 1/pow(3.141592653589793,8.0);
    t11 = pow(grada,12.0);
    t12 = 1/pow(rhoa,16.0);
    t13 = 1/pow(3.141592653589793,6.666666666666667);
    t14 = pow(grada,10.0);
    t15 = 1/pow(rhoa,13.33333333333333);
    t16 = 1/pow(3.141592653589793,5.333333333333333);
    t17 = pow(grada,8.0);
    t18 = 1/pow(rhoa,10.66666666666667);
    t19 = 1/pow(3.141592653589793,4.0);
    t20 = pow(grada,6.0);
    t21 = 1/pow(rhoa,8.0);
    t22 = 1/pow(3.141592653589793,2.666666666666667);
    t23 = pow(grada,4.0);
    t24 = 1/pow(rhoa,5.333333333333333);
    t25 = 1.235284796188036*t5*t6*t4*t7+0.3103125*t2*t22*
        t23*t24+0.009729600694444*t19*t20*t21+0.001314995659722*t5*
        t16*t17*t18+0.007098614728009*t2*t13*t14*t15+1.0538736979166666E-5*
        t10*t11*t12+1.0;
    t26 = pow(t25,0.024974);
    t27 = 1/pow(3.141592653589793,0.333333333333333);
    t28 = 1/t8;
    t29 = 1/pow(t25,0.975026);
    t30 = pow(rhoa,1.333333333333333);

   /* code */
    res[0] = -0.0187305*t1*t27*t28*t29*t30*(-1.6861979166666666E-4*
        t10*t11/pow(rhoa,17.0)-0.094648196373457*t13*t14*t2/pow(rhoa,
        14.33333333333333)-0.01402662037037*t16*t17*t5/pow(rhoa,11.66666666666667)-
        0.077836805555556*t19*t20/pow(rhoa,9.0)-1.655*t2*t22*t23/pow(rhoa,
        6.333333333333333)-3.294092789834761*t4*t5*t6/pow(rhoa,3.666666666666667))-
        5.0E-9*t2*t26*t3*t4*t9/pow(rhoa,2.333333333333333)-1.0*t1*
        t26*t27*t28*pow(rhoa,0.333333333333333);
    res[1] = 3.75E-9*t2*t26*t3*t9*grada/t30-0.0187305*t1*
        t27*t28*t29*t30*(1.2646484375E-4*t10*t12*pow(grada,11.0)+0.070986147280093*
        t13*t15*t2*pow(grada,9.0)+0.010519965277778*t16*t18*t5*pow(grada,
        7.0)+0.058377604166667*t19*t21*pow(grada,5.0)+1.24125*t2*t22*
        t24*pow(grada,3.0)+2.470569592376071*t5*t6*grada*t7);
}

static void
lg93_first(FunFirstFuncDrv *ds, real factor, const FunDensProp *dp)
{
    real res[2];

    lg93_first_helper(dp->rhoa, dp->grada, res);
   /* Final assignment */
    ds->df1000 += factor*res[0];
    ds->df0010 += factor*res[1];


    if(fabs(dp->rhoa-dp->rhob)>1e-13 ||
       fabs(dp->grada-dp->gradb)>1e-13)
        lg93_first_helper(dp->rhob, dp->gradb, res);
    ds->df0100 += factor*res[0];
    ds->df0001 += factor*res[1];

}

static void
lg93_second_helper(real rhoa, real grada, real *res)
{
    real t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
    real t11, t12, t13, t14, t15, t16, t17, t18;
    real t19, t20, t21, t22, t23, t24, t25, t26;
    real t27, t28, t29, t30, t31, t32, t33, t34;
    real t35, t36, t37, t38, t39, t40, t41, t42;
    real t43, t44, t45, t46, t47, t48, t49;

    t1 = pow(6.0,0.333333333333333);
    t2 = 1/t1;
    t3 = 1/pow(3.141592653589793,1.666666666666667);
    t4 = pow(grada,2.0);
    t5 = 1/pow(6.0,0.666666666666667);
    t6 = 1/pow(3.141592653589793,1.333333333333333);
    t7 = 1/pow(rhoa,2.666666666666667);
    t8 = 2.5E-9*t5*t6*t4*t7+1.0;
    t9 = 1/pow(t8,2.0);
    t10 = 1/pow(3.141592653589793,8.0);
    t11 = pow(grada,12.0);
    t12 = 1/pow(rhoa,16.0);
    t13 = 1/pow(3.141592653589793,6.666666666666667);
    t14 = pow(grada,10.0);
    t15 = 1/pow(rhoa,13.33333333333333);
    t16 = 1/pow(3.141592653589793,5.333333333333333);
    t17 = pow(grada,8.0);
    t18 = 1/pow(rhoa,10.66666666666667);
    t19 = 1/pow(3.141592653589793,4.0);
    t20 = pow(grada,6.0);
    t21 = 1/pow(rhoa,8.0);
    t22 = 1/pow(3.141592653589793,2.666666666666667);
    t23 = pow(grada,4.0);
    t24 = 1/pow(rhoa,5.333333333333333);
    t25 = 1.235284796188036*t5*t6*t4*t7+0.3103125*t2*t22*
        t23*t24+0.009729600694444*t19*t20*t21+0.001314995659722*t5*
        t16*t17*t18+0.007098614728009*t2*t13*t14*t15+1.0538736979166666E-5*
        t10*t11*t12+1.0;
    t26 = pow(t25,0.024974);
    t27 = 1/pow(rhoa,2.333333333333333);
    t28 = 1/pow(3.141592653589793,0.333333333333333);
    t29 = 1/t8;
    t30 = pow(rhoa,0.333333333333333);
    t31 = 1/pow(rhoa,17.0);
    t32 = 1/pow(rhoa,14.33333333333333);
    t33 = 1/pow(rhoa,11.66666666666667);
    t34 = 1/pow(rhoa,9.0);
    t35 = 1/pow(rhoa,6.333333333333333);
    t36 = 1/pow(rhoa,3.666666666666667);
    t37 = -3.294092789834761*t5*t6*t4*t36-1.655*t2*t22*t23*
        t35-0.077836805555556*t19*t20*t34-0.01402662037037*t5*t16*
        t17*t33-0.094648196373457*t2*t13*t14*t32-1.6861979166666666E-4*
        t10*t11*t31;
    t38 = 1/pow(t25,0.975026);
    t39 = pow(rhoa,1.333333333333333);
    t40 = 1/t39;
    t41 = pow(grada,11.0);
    t42 = pow(grada,9.0);
    t43 = pow(grada,7.0);
    t44 = pow(grada,5.0);
    t45 = pow(grada,3.0);
    t46 = 2.470569592376071*t5*t6*grada*t7+1.24125*t2*t22*
        t45*t24+0.058377604166667*t19*t44*t21+0.010519965277778*t5*
        t16*t43*t18+0.070986147280093*t2*t13*t42*t15+1.2646484375E-4*
        t10*t41*t12;
    t47 = 1/pow(3.141592653589793,3.0);
    t48 = 1/pow(t8,3.0);
    t49 = 1/pow(t25,1.975026);

   /* code */
    res[0] = -0.0187305*t1*t28*t37*t29*t38*t39-1.0*t1*t26*
        t28*t29*t30-5.0E-9*t2*t3*t4*t9*t26*t27;
    res[1] = 3.75E-9*t2*t3*grada*t9*t26*t40-0.0187305*t1*
        t28*t46*t29*t38*t39;
    res[2] = -0.0187305*t1*t28*t29*t38*t39*(0.002866536458333*
        t10*t11/pow(rhoa,18.0)+1.356624148019547*t13*t14*t2/pow(rhoa,
        15.33333333333333)+0.163643904320988*t16*t17*t5/pow(rhoa,12.66666666666667)+
        0.70053125*t19*t20/pow(rhoa,10.0)+10.48166666666667*t2*t22*
        t23/pow(rhoa,7.333333333333333)+12.07834022939412*t4*t5*t6/
        pow(rhoa,4.666666666666667))-1.111111111111111E-17*t23*t26*
        t47*t48/pow(rhoa,6.0)+5.0E-9*t2*t26*t3*t4*t9/pow(rhoa,3.333333333333333)-
        0.333333333333333*t1*t26*t28*t29/pow(rhoa,0.666666666666667)+
        0.018262724493*t1*t28*t29*pow(t37,2.0)*t39*t49-0.049948*t1*
        t28*t37*t29*t38*t30-2.4974E-10*t2*t3*t4*t37*t9*t38*t27;
    res[3] = 8.33333333333333E-18*t26*t45*t47*t48/pow(rhoa,
        5.0)+9.36525E-11*t2*t3*grada*t37*t9*t38*t40+0.018262724493*
        t1*t28*t37*t46*t29*t49*t39-0.0187305*t1*t28*(-6.588185579669522*
        t5*t6*grada*t36-6.62*t2*t22*t45*t35-0.467020833333333*t19*
        t44*t34-0.112212962962963*t5*t16*t43*t33-0.946481963734568*
        t2*t13*t42*t32-0.0020234375*t10*t41*t31)*t29*t38*t39-0.024974*
        t1*t28*t46*t29*t38*t30-1.2487E-10*t2*t3*t4*t46*t9*t38*t27-
        5.0E-9*t2*t3*grada*t9*t26*t27;
    res[4] = -6.25E-18*t26*t4*t47*t48/pow(rhoa,4.0)+0.018262724493*
        t1*t28*t29*t39*pow(t46,2.0)*t49+1.87305E-10*t2*t3*grada*t46*
        t9*t38*t40+3.75E-9*t2*t3*t9*t26*t40-0.0187305*t1*t28*(2.470569592376071*
        t5*t6*t7+3.72375*t2*t22*t4*t24+0.291888020833333*t19*t23*t21+
        0.073639756944444*t5*t16*t20*t18+0.638875325520833*t2*t13*
        t17*t15+0.00139111328125*t10*t14*t12)*t29*t38*t39;

}

static void
lg93_second(FunSecondFuncDrv *ds, real factor, const FunDensProp* dp)
{
    real res[5];
 
    lg93_second_helper(dp->rhoa, dp->grada, res);

    ds->df1000 += factor*res[0];
    ds->df0010 += factor*res[1];

    ds->df2000 += factor*res[2];
    ds->df1010 += factor*res[3];
    ds->df0020 += factor*res[4];


    if(fabs(dp->rhoa-dp->rhob)>1e-13 ||
       fabs(dp->grada-dp->gradb)>1e-13)
        lg93_second_helper(dp->rhob, dp->gradb, res);
    ds->df0100 += factor*res[0];
    ds->df0001 += factor*res[1];

    ds->df0200 += factor*res[2];
    ds->df0101 += factor*res[3];
    ds->df0002 += factor*res[4];

}

static void
lg93_third_helper(real rhoa, real grada, real *res)
{
    real t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
    real t11, t12, t13, t14, t15, t16, t17, t18;
    real t19, t20, t21, t22, t23, t24, t25, t26;
    real t27, t28, t29, t30, t31, t32, t33, t34;
    real t35, t36, t37, t38, t39, t40, t41, t42;
    real t43, t44, t45, t46, t47, t48, t49, t50;
    real t51, t52, t53, t54, t55, t56, t57, t58;
    real t59, t60, t61, t62, t63, t64, t65, t66;
    real t67, t68;

    t1 = pow(6.0,0.333333333333333);
    t2 = 1/t1;
    t3 = 1/pow(3.141592653589793,1.666666666666667);
    t4 = pow(grada,2.0);
    t5 = 1/pow(6.0,0.666666666666667);
    t6 = 1/pow(3.141592653589793,1.333333333333333);
    t7 = 1/pow(rhoa,2.666666666666667);
    t8 = 2.5E-9*t5*t6*t4*t7+1.0;
    t9 = 1/pow(t8,2.0);
    t10 = 1/pow(3.141592653589793,8.0);
    t11 = pow(grada,12.0);
    t12 = 1/pow(rhoa,16.0);
    t13 = 1/pow(3.141592653589793,6.666666666666667);
    t14 = pow(grada,10.0);
    t15 = 1/pow(rhoa,13.33333333333333);
    t16 = 1/pow(3.141592653589793,5.333333333333333);
    t17 = pow(grada,8.0);
    t18 = 1/pow(rhoa,10.66666666666667);
    t19 = 1/pow(3.141592653589793,4.0);
    t20 = pow(grada,6.0);
    t21 = 1/pow(rhoa,8.0);
    t22 = 1/pow(3.141592653589793,2.666666666666667);
    t23 = pow(grada,4.0);
    t24 = 1/pow(rhoa,5.333333333333333);
    t25 = 1.235284796188036*t5*t6*t4*t7+0.3103125*t2*t22*
        t23*t24+0.009729600694444*t19*t20*t21+0.001314995659722*t5*
        t16*t17*t18+0.007098614728009*t2*t13*t14*t15+1.0538736979166666E-5*
        t10*t11*t12+1.0;
    t26 = pow(t25,0.024974);
    t27 = 1/pow(rhoa,2.333333333333333);
    t28 = 1/pow(3.141592653589793,0.333333333333333);
    t29 = 1/t8;
    t30 = pow(rhoa,0.333333333333333);
    t31 = 1/pow(rhoa,17.0);
    t32 = 1/pow(rhoa,14.33333333333333);
    t33 = 1/pow(rhoa,11.66666666666667);
    t34 = 1/pow(rhoa,9.0);
    t35 = 1/pow(rhoa,6.333333333333333);
    t36 = 1/pow(rhoa,3.666666666666667);
    t37 = -3.294092789834761*t5*t6*t4*t36-1.655*t2*t22*t23*
        t35-0.077836805555556*t19*t20*t34-0.01402662037037*t5*t16*
        t17*t33-0.094648196373457*t2*t13*t14*t32-1.6861979166666666E-4*
        t10*t11*t31;
    t38 = 1/pow(t25,0.975026);
    t39 = pow(rhoa,1.333333333333333);
    t40 = 1/t39;
    t41 = pow(grada,11.0);
    t42 = pow(grada,9.0);
    t43 = pow(grada,7.0);
    t44 = pow(grada,5.0);
    t45 = pow(grada,3.0);
    t46 = 2.470569592376071*t5*t6*grada*t7+1.24125*t2*t22*
        t45*t24+0.058377604166667*t19*t44*t21+0.010519965277778*t5*
        t16*t43*t18+0.070986147280093*t2*t13*t42*t15+1.2646484375E-4*
        t10*t41*t12;
    t47 = 1/pow(3.141592653589793,3.0);
    t48 = 1/pow(t8,3.0);
    t49 = 1/pow(rhoa,6.0);
    t50 = 1/pow(rhoa,3.333333333333333);
    t51 = 1/pow(rhoa,0.666666666666667);
    t52 = pow(t37,2.0);
    t53 = 1/pow(t25,1.975026);
    t54 = 1/pow(rhoa,18.0);
    t55 = 1/pow(rhoa,15.33333333333333);
    t56 = 1/pow(rhoa,12.66666666666667);
    t57 = 1/pow(rhoa,10.0);
    t58 = 1/pow(rhoa,7.333333333333333);
    t59 = 1/pow(rhoa,4.666666666666667);
    t60 = 12.07834022939412*t5*t6*t4*t59+10.48166666666667*
        t2*t22*t23*t58+0.70053125*t19*t20*t57+0.163643904320988*t5*
        t16*t17*t56+1.356624148019547*t2*t13*t14*t55+0.002866536458333*
        t10*t11*t54;
    t61 = 1/pow(rhoa,5.0);
    t62 = -6.588185579669522*t5*t6*grada*t36-6.62*t2*t22*
        t45*t35-0.467020833333333*t19*t44*t34-0.112212962962963*t5*
        t16*t43*t33-0.946481963734568*t2*t13*t42*t32-0.0020234375*
        t10*t41*t31;
    t63 = 1/pow(rhoa,4.0);
    t64 = pow(t46,2.0);
    t65 = 2.470569592376071*t5*t6*t7+3.72375*t2*t22*t4*t24+
        0.291888020833333*t19*t23*t21+0.073639756944444*t5*t16*t20*
        t18+0.638875325520833*t2*t13*t17*t15+0.00139111328125*t10*
        t14*t12;
    t66 = 1/pow(3.141592653589793,4.333333333333333);
    t67 = 1/pow(t8,4.0);
    t68 = 1/pow(t25,2.975026);

   /* code */
    res[0] = -0.0187305*t1*t28*t37*t29*t38*t39-1.0*t1*t26*
        t28*t29*t30-5.0E-9*t2*t3*t4*t9*t26*t27;
    res[1] = 3.75E-9*t2*t3*grada*t9*t26*t40-0.0187305*t1*
        t28*t46*t29*t38*t39;
    res[2] = -0.333333333333333*t1*t26*t28*t29*t51+5.0E-9*
        t2*t3*t4*t9*t26*t50-1.111111111111111E-17*t47*t23*t48*t26*
        t49+0.018262724493*t1*t28*t52*t29*t53*t39-0.0187305*t1*t28*
        t60*t29*t38*t39-0.049948*t1*t28*t37*t29*t38*t30-2.4974E-10*
        t2*t3*t4*t37*t9*t38*t27;
    res[3] = -0.0187305*t1*t28*t62*t29*t38*t39+0.018262724493*
        t1*t28*t37*t46*t29*t53*t39-0.024974*t1*t28*t46*t29*t38*t30+
        9.36525E-11*t2*t3*grada*t37*t9*t38*t40-5.0E-9*t2*t3*grada*
        t9*t26*t27-1.2487E-10*t2*t3*t4*t46*t9*t38*t27+8.33333333333333E-18*
        t47*t45*t48*t26*t61;
    res[4] = -0.0187305*t1*t28*t65*t29*t38*t39+0.018262724493*
        t1*t28*t64*t29*t53*t39+3.75E-9*t2*t3*t9*t26*t40+1.87305E-10*
        t2*t3*grada*t46*t9*t38*t40-6.25E-18*t47*t4*t48*t26*t63;
    res[5] = -0.0187305*t1*t28*t29*t38*t39*(-0.05159765625*
        t10*t11/pow(rhoa,19.0)-20.80157026963306*t13*t14*t2/pow(rhoa,
        16.33333333333333)-2.072822788065843*t16*t17*t5/pow(rhoa,13.66666666666667)-
        7.0053125*t19*t20/pow(rhoa,11.0)-76.86555555555555*t2*t22*
        t23/pow(rhoa,8.333333333333334)-56.36558773717258*t4*t5*t6/
        pow(rhoa,5.666666666666667))-2.22222222222222E-25*t20*t26*
        t5*t66*t67/pow(rhoa,9.666666666666666)+7.77777777777778E-17*
        t23*t26*t47*t48/pow(rhoa,7.0)-1.888888888888889E-8*t2*t26*
        t3*t4*t9/pow(rhoa,4.333333333333333)+0.222222222222222*t1*
        t26*t28*t29/pow(rhoa,1.666666666666667)-0.036069355704512*
        t1*t28*t29*pow(t37,3.0)*t39*t68-0.024974*t1*t28*t37*t29*t38*
        t51+3.7461E-10*t2*t3*t4*t37*t9*t38*t50-8.32466666666667E-19*
        t47*t23*t37*t48*t38*t49+0.054788173479*t1*t28*t60*t37*t29*
        t53*t39+0.073050897972*t1*t28*t52*t29*t53*t30-0.074922*t1*
        t28*t60*t29*t38*t30+3.6525448986E-10*t2*t3*t4*t52*t9*t53*t27-
        3.7461E-10*t2*t3*t4*t60*t9*t38*t27;
    res[6] = 1.666666666666667E-25*t26*t44*t5*t66*t67/pow(rhoa,
        8.666666666666666)+4.16233333333333E-19*t47*t45*t37*t48*t38*
        t61-0.008324666666667*t1*t28*t46*t29*t38*t51+1.2487E-10*t2*
        t3*t4*t46*t9*t38*t50+1.1666666666666667E-8*t2*t3*grada*t9*
        t26*t50-2.77488888888889E-19*t47*t23*t46*t48*t38*t49-5.27777777777778E-17*
        t47*t45*t48*t26*t49-9.1313622465E-11*t2*t3*grada*t52*t9*t53*
        t40+9.36525E-11*t2*t3*grada*t60*t9*t38*t40-0.036069355704512*
        t1*t28*t52*t46*t29*t68*t39+0.018262724493*t1*t28*t60*t46*t29*
        t53*t39+0.036525448986*t1*t28*t62*t37*t29*t53*t39-0.0187305*
        t1*t28*(24.15668045878825*t5*t6*grada*t59+41.92666666666666*
        t2*t22*t45*t58+4.2031875*t19*t44*t57+1.309151234567901*t5*
        t16*t43*t56+13.56624148019547*t2*t13*t42*t55+0.0343984375*
        t10*t41*t54)*t29*t38*t39+0.048700598648*t1*t28*t37*t46*t29*
        t53*t30-0.049948*t1*t28*t62*t29*t38*t30+2.4350299324E-10*t2*
        t3*t4*t37*t46*t9*t53*t27-2.4974E-10*t2*t3*t4*t62*t9*t38*t27-
        2.4974E-10*t2*t3*grada*t37*t9*t38*t27;
    res[7] = -1.25E-25*t23*t26*t5*t66*t67/pow(rhoa,7.666666666666667)-
        1.560875E-19*t47*t4*t37*t48*t38*t63+4.16233333333333E-19*t47*
        t45*t46*t48*t38*t61+3.33333333333333E-17*t47*t4*t48*t26*t61-
        1.8262724493E-10*t2*t3*grada*t37*t46*t9*t53*t40+1.87305E-10*
        t2*t3*grada*t62*t9*t38*t40+9.36525E-11*t2*t3*t37*t9*t38*t40-
        0.036069355704512*t1*t28*t37*t64*t29*t68*t39+0.018262724493*
        t1*t28*t37*t65*t29*t53*t39+0.036525448986*t1*t28*t62*t46*t29*
        t53*t39-0.0187305*t1*t28*(-6.588185579669522*t5*t6*t36-19.86*
        t2*t22*t4*t35-2.335104166666667*t19*t23*t34-0.785490740740741*
        t5*t16*t20*t33-8.51833767361111*t2*t13*t17*t32-0.0222578125*
        t10*t14*t31)*t29*t38*t39+0.024350299324*t1*t28*t64*t29*t53*
        t30-0.024974*t1*t28*t65*t29*t38*t30+1.2175149662E-10*t2*t3*
        t4*t64*t9*t53*t27-1.2487E-10*t2*t3*t4*t65*t9*t38*t27-2.4974E-10*
        t2*t3*grada*t46*t9*t38*t27-5.0E-9*t2*t3*t9*t26*t27;
    res[8] = 9.375E-26*t26*t45*t5*t66*t67/pow(rhoa,6.666666666666667)-
        0.036069355704512*t1*t28*t29*t39*pow(t46,3.0)*t68-4.682625E-19*
        t47*t4*t46*t48*t38*t63-1.875E-17*t47*grada*t48*t26*t63-2.73940867395E-10*
        t2*t3*grada*t64*t9*t53*t40+2.809575E-10*t2*t3*grada*t65*t9*
        t38*t40+2.809575E-10*t2*t3*t46*t9*t38*t40+0.054788173479*t1*
        t28*t65*t46*t29*t53*t39-0.0187305*t1*t28*(7.4475*t2*t22*grada*
        t24+1.167552083333333*t19*t45*t21+0.441838541666667*t5*t16*
        t44*t18+5.111002604166666*t2*t13*t43*t15+0.0139111328125*t10*
        t42*t12)*t29*t38*t39;

}

static void
lg93_third(FunThirdFuncDrv *ds, real factor, const FunDensProp* dp)
{
    real res[9];
 
    lg93_third_helper(dp->rhoa, dp->grada, res);

    ds->df1000 += factor*res[0];
    ds->df0010 += factor*res[1];

    ds->df2000 += factor*res[2];
    ds->df1010 += factor*res[3];
    ds->df0020 += factor*res[4];

    ds->df3000 += factor*res[5];
    ds->df2010 += factor*res[6];
    ds->df1020 += factor*res[7];
    ds->df0030 += factor*res[8];


    if(fabs(dp->rhoa-dp->rhob)>1e-13 ||
       fabs(dp->grada-dp->gradb)>1e-13)
        lg93_third_helper(dp->rhob, dp->gradb, res);

    ds->df0100 += factor*res[0];
    ds->df0001 += factor*res[1];

    ds->df0200 += factor*res[2];
    ds->df0101 += factor*res[3];
    ds->df0002 += factor*res[4];

    ds->df0300 += factor*res[5];
    ds->df0201 += factor*res[6];
    ds->df0102 += factor*res[7];
    ds->df0003 += factor*res[8];

}

static void
lg93_fourth_helper(real rhoa, real grada, real *res)
{
    real t1, t2, t3, t4, t5, t6, t7, t8, t9, t10;
    real t11, t12, t13, t14, t15, t16, t17, t18;
    real t19, t20, t21, t22, t23, t24, t25, t26;
    real t27, t28, t29, t30, t31, t32, t33, t34;
    real t35, t36, t37, t38, t39, t40, t41, t42;
    real t43, t44, t45, t46, t47, t48, t49, t50;
    real t51, t52, t53, t54, t55, t56, t57, t58;
    real t59, t60, t61, t62, t63, t64, t65, t66;
    real t67, t68, t69, t70, t71, t72, t73, t74;
    real t75, t76, t77, t78, t79, t80, t81, t82;
    real t83, t84, t85, t86, t87, t88, t89, t90;
    real t91;

    t1 = pow(6.0,0.333333333333333);
    t2 = 1/t1;
    t3 = 1/pow(3.141592653589793,1.666666666666667);
    t4 = pow(grada,2.0);
    t5 = 1/pow(6.0,0.666666666666667);
    t6 = 1/pow(3.141592653589793,1.333333333333333);
    t7 = 1/pow(rhoa,2.666666666666667);
    t8 = 2.5E-9*t5*t6*t4*t7+1.0;
    t9 = 1/pow(t8,2.0);
    t10 = 1/pow(3.141592653589793,8.0);
    t11 = pow(grada,12.0);
    t12 = 1/pow(rhoa,16.0);
    t13 = 1/pow(3.141592653589793,6.666666666666667);
    t14 = pow(grada,10.0);
    t15 = 1/pow(rhoa,13.33333333333333);
    t16 = 1/pow(3.141592653589793,5.333333333333333);
    t17 = pow(grada,8.0);
    t18 = 1/pow(rhoa,10.66666666666667);
    t19 = 1/pow(3.141592653589793,4.0);
    t20 = pow(grada,6.0);
    t21 = 1/pow(rhoa,8.0);
    t22 = 1/pow(3.141592653589793,2.666666666666667);
    t23 = pow(grada,4.0);
    t24 = 1/pow(rhoa,5.333333333333333);
    t25 = 1.235284796188036*t5*t6*t4*t7+0.3103125*t2*t22*
        t23*t24+0.009729600694444*t19*t20*t21+0.001314995659722*t5*
        t16*t17*t18+0.007098614728009*t2*t13*t14*t15+1.0538736979166666E-5*
        t10*t11*t12+1.0;
    t26 = pow(t25,0.024974);
    t27 = 1/pow(rhoa,2.333333333333333);
    t28 = 1/pow(3.141592653589793,0.333333333333333);
    t29 = 1/t8;
    t30 = pow(rhoa,0.333333333333333);
    t31 = 1/pow(rhoa,17.0);
    t32 = 1/pow(rhoa,14.33333333333333);
    t33 = 1/pow(rhoa,11.66666666666667);
    t34 = 1/pow(rhoa,9.0);
    t35 = 1/pow(rhoa,6.333333333333333);
    t36 = 1/pow(rhoa,3.666666666666667);
    t37 = -3.294092789834761*t5*t6*t4*t36-1.655*t2*t22*t23*
        t35-0.077836805555556*t19*t20*t34-0.01402662037037*t5*t16*
        t17*t33-0.094648196373457*t2*t13*t14*t32-1.6861979166666666E-4*
        t10*t11*t31;
    t38 = 1/pow(t25,0.975026);
    t39 = pow(rhoa,1.333333333333333);
    t40 = 1/t39;
    t41 = pow(grada,11.0);
    t42 = pow(grada,9.0);
    t43 = pow(grada,7.0);
    t44 = pow(grada,5.0);
    t45 = pow(grada,3.0);
    t46 = 2.470569592376071*t5*t6*grada*t7+1.24125*t2*t22*
        t45*t24+0.058377604166667*t19*t44*t21+0.010519965277778*t5*
        t16*t43*t18+0.070986147280093*t2*t13*t42*t15+1.2646484375E-4*
        t10*t41*t12;
    t47 = 1/pow(3.141592653589793,3.0);
    t48 = 1/pow(t8,3.0);
    t49 = 1/pow(rhoa,6.0);
    t50 = 1/pow(rhoa,3.333333333333333);
    t51 = 1/pow(rhoa,0.666666666666667);
    t52 = pow(t37,2.0);
    t53 = 1/pow(t25,1.975026);
    t54 = 1/pow(rhoa,18.0);
    t55 = 1/pow(rhoa,15.33333333333333);
    t56 = 1/pow(rhoa,12.66666666666667);
    t57 = 1/pow(rhoa,10.0);
    t58 = 1/pow(rhoa,7.333333333333333);
    t59 = 1/pow(rhoa,4.666666666666667);
    t60 = 12.07834022939412*t5*t6*t4*t59+10.48166666666667*
        t2*t22*t23*t58+0.70053125*t19*t20*t57+0.163643904320988*t5*
        t16*t17*t56+1.356624148019547*t2*t13*t14*t55+0.002866536458333*
        t10*t11*t54;
    t61 = 1/pow(rhoa,5.0);
    t62 = -6.588185579669522*t5*t6*grada*t36-6.62*t2*t22*
        t45*t35-0.467020833333333*t19*t44*t34-0.112212962962963*t5*
        t16*t43*t33-0.946481963734568*t2*t13*t42*t32-0.0020234375*
        t10*t41*t31;
    t63 = 1/pow(rhoa,4.0);
    t64 = pow(t46,2.0);
    t65 = 2.470569592376071*t5*t6*t7+3.72375*t2*t22*t4*t24+
        0.291888020833333*t19*t23*t21+0.073639756944444*t5*t16*t20*
        t18+0.638875325520833*t2*t13*t17*t15+0.00139111328125*t10*
        t14*t12;
    t66 = 1/pow(3.141592653589793,4.333333333333333);
    t67 = 1/pow(t8,4.0);
    t68 = 1/pow(rhoa,9.666666666666666);
    t69 = 1/pow(rhoa,7.0);
    t70 = 1/pow(rhoa,4.333333333333333);
    t71 = 1/pow(rhoa,1.666666666666667);
    t72 = pow(t37,3.0);
    t73 = 1/pow(t25,2.975026);
    t74 = 1/pow(rhoa,19.0);
    t75 = 1/pow(rhoa,16.33333333333333);
    t76 = 1/pow(rhoa,13.66666666666667);
    t77 = 1/pow(rhoa,11.0);
    t78 = 1/pow(rhoa,8.333333333333334);
    t79 = 1/pow(rhoa,5.666666666666667);
    t80 = -56.36558773717258*t5*t6*t4*t79-76.86555555555555*
        t2*t22*t23*t78-7.0053125*t19*t20*t77-2.072822788065843*t5*
        t16*t17*t76-20.80157026963306*t2*t13*t14*t75-0.05159765625*
        t10*t11*t74;
    t81 = 1/pow(rhoa,8.666666666666666);
    t82 = 24.15668045878825*t5*t6*grada*t59+41.92666666666666*
        t2*t22*t45*t58+4.2031875*t19*t44*t57+1.309151234567901*t5*
        t16*t43*t56+13.56624148019547*t2*t13*t42*t55+0.0343984375*
        t10*t41*t54;
    t83 = 1/pow(rhoa,7.666666666666667);
    t84 = -6.588185579669522*t5*t6*t36-19.86*t2*t22*t4*t35-
        2.335104166666667*t19*t23*t34-0.785490740740741*t5*t16*t20*
        t33-8.51833767361111*t2*t13*t17*t32-0.0222578125*t10*t14*t31;
    t85 = 1/
        pow(rhoa,6.666666666666667);
    t86 = pow(t46,3.0);
    t87 = 7.4475*t2*t22*grada*t24+1.167552083333333*t19*t45*
        t21+0.441838541666667*t5*t16*t44*t18+5.111002604166666*t2*
        t13*t43*t15+0.0139111328125*t10*t42*t12;
    t88 = 1/pow(3.141592653589793,5.666666666666667);
    t89 = 1/pow(t8,5.0);
    t90 = 1/pow(t25,3.975026);
    t91 = 1/pow(rhoa,9.333333333333334);

   /* code */
    res[0] = -0.0187305*t1*t28*t37*t29*t38*t39-1.0*t1*t26*
        t28*t29*t30-5.0E-9*t2*t3*t4*t9*t26*t27;
    res[1] = 3.75E-9*t2*t3*grada*t9*t26*t40-0.0187305*t1*
        t28*t46*t29*t38*t39;
    res[2] = -0.333333333333333*t1*t26*t28*t29*t51+5.0E-9*
        t2*t3*t4*t9*t26*t50-1.111111111111111E-17*t47*t23*t48*t26*
        t49+0.018262724493*t1*t28*t52*t29*t53*t39-0.0187305*t1*t28*
        t60*t29*t38*t39-0.049948*t1*t28*t37*t29*t38*t30-2.4974E-10*
        t2*t3*t4*t37*t9*t38*t27;
    res[3] = -0.0187305*t1*t28*t62*t29*t38*t39+0.018262724493*
        t1*t28*t37*t46*t29*t53*t39-0.024974*t1*t28*t46*t29*t38*t30+
        9.36525E-11*t2*t3*grada*t37*t9*t38*t40-5.0E-9*t2*t3*grada*
        t9*t26*t27-1.2487E-10*t2*t3*t4*t46*t9*t38*t27+8.33333333333333E-18*
        t47*t45*t48*t26*t61;
    res[4] = -0.0187305*t1*t28*t65*t29*t38*t39+0.018262724493*
        t1*t28*t64*t29*t53*t39+3.75E-9*t2*t3*t9*t26*t40+1.87305E-10*
        t2*t3*grada*t46*t9*t38*t40-6.25E-18*t47*t4*t48*t26*t63;
    res[5] = 0.222222222222222*t1*t26*t28*t29*t71-1.888888888888889E-8*
        t2*t3*t4*t9*t26*t70+7.77777777777778E-17*t47*t23*t48*t26*t69-
        2.22222222222222E-25*t5*t66*t20*t67*t26*t68-0.024974*t1*t28*
        t37*t29*t38*t51+3.7461E-10*t2*t3*t4*t37*t9*t38*t50-8.32466666666667E-19*
        t47*t23*t37*t48*t38*t49-0.036069355704512*t1*t28*t72*t29*t73*
        t39+0.054788173479*t1*t28*t60*t37*t29*t53*t39-0.0187305*t1*
        t28*t80*t29*t38*t39+0.073050897972*t1*t28*t52*t29*t53*t30-
        0.074922*t1*t28*t60*t29*t38*t30+3.6525448986E-10*t2*t3*t4*
        t52*t9*t53*t27-3.7461E-10*t2*t3*t4*t60*t9*t38*t27;
    res[6] = -0.0187305*t1*t28*t82*t29*t38*t39+0.018262724493*
        t1*t28*t60*t46*t29*t53*t39+0.036525448986*t1*t28*t62*t37*t29*
        t53*t39-0.036069355704512*t1*t28*t52*t46*t29*t73*t39-0.049948*
        t1*t28*t62*t29*t38*t30+0.048700598648*t1*t28*t37*t46*t29*t53*
        t30-0.008324666666667*t1*t28*t46*t29*t38*t51+9.36525E-11*t2*
        t3*grada*t60*t9*t38*t40-9.1313622465E-11*t2*t3*grada*t52*t9*
        t53*t40-2.4974E-10*t2*t3*grada*t37*t9*t38*t27-2.4974E-10*t2*
        t3*t4*t62*t9*t38*t27+2.4350299324E-10*t2*t3*t4*t37*t46*t9*
        t53*t27+1.1666666666666667E-8*t2*t3*grada*t9*t26*t50+1.2487E-10*
        t2*t3*t4*t46*t9*t38*t50+4.16233333333333E-19*t47*t45*t37*t48*
        t38*t61-5.27777777777778E-17*t47*t45*t48*t26*t49-2.77488888888889E-19*
        t47*t23*t46*t48*t38*t49+1.666666666666667E-25*t5*t66*t44*t67*
        t26*t81;
    res[7] = -0.0187305*t1*t28*t84*t29*t38*t39+0.036525448986*
        t1*t28*t62*t46*t29*t53*t39+0.018262724493*t1*t28*t37*t65*t29*
        t53*t39-0.036069355704512*t1*t28*t37*t64*t29*t73*t39-0.024974*
        t1*t28*t65*t29*t38*t30+0.024350299324*t1*t28*t64*t29*t53*t30+
        9.36525E-11*t2*t3*t37*t9*t38*t40+1.87305E-10*t2*t3*grada*t62*
        t9*t38*t40-1.8262724493E-10*t2*t3*grada*t37*t46*t9*t53*t40-
        5.0E-9*t2*t3*t9*t26*t27-2.4974E-10*t2*t3*grada*t46*t9*t38*
        t27-1.2487E-10*t2*t3*t4*t65*t9*t38*t27+1.2175149662E-10*t2*
        t3*t4*t64*t9*t53*t27-1.560875E-19*t47*t4*t37*t48*t38*t63+3.33333333333333E-17*
        t47*t4*t48*t26*t61+4.16233333333333E-19*t47*t45*t46*t48*t38*
        t61-1.25E-25*t5*t66*t23*t67*t26*t83;
    res[8] = -0.0187305*t1*t28*t87*t29*t38*t39+0.054788173479*
        t1*t28*t65*t46*t29*t53*t39-0.036069355704512*t1*t28*t86*t29*
        t73*t39+2.809575E-10*t2*t3*t46*t9*t38*t40+2.809575E-10*t2*
        t3*grada*t65*t9*t38*t40-2.73940867395E-10*t2*t3*grada*t64*
        t9*t53*t40-1.875E-17*t47*grada*t48*t26*t63-4.682625E-19*t47*
        t4*t46*t48*t38*t63+9.375E-26*t5*t66*t45*t67*t26*t85;
    res[9] = -0.0187305*t1*t28*t29*t38*t39*(0.98035546875*
        t10*t11/pow(rhoa,20.0)+339.7589810706733*t13*t14*t2/pow(rhoa,
        17.33333333333333)+28.32857810356652*t16*t17*t5/pow(rhoa,14.66666666666667)+
        77.05843750000001*t19*t20/pow(rhoa,12.0)+640.5462962962963*
        t2*t22*t23*t91+319.4049971773113*t5*t6*t4*t85)+0.107307271024171*
        t1*t28*t29*pow(t37,4.0)*t39*t90+0.022199111111111*t1*t28*t37*
        t29*t38*t71-1.886924444444445E-9*t2*t3*t4*t37*t9*t38*t70-0.37037037037037*
        t1*t26*t28*t29*t7+7.76968888888889E-18*t47*t23*t37*t48*t38*
        t69-2.219911111111111E-26*t5*t66*t20*t37*t67*t38*t68+0.054788173479*
        t1*t28*t29*t39*t53*pow(t60,2.0)+0.048700598648*t1*t28*t52*
        t29*t53*t51-0.049948*t1*t28*t60*t29*t38*t51-7.3050897972E-10*
        t2*t3*t4*t52*t9*t53*t50+7.4922E-10*t2*t3*t4*t60*t9*t38*t50+
        1.623353288266667E-18*t47*t23*t52*t48*t53*t49-1.664933333333333E-18*
        t47*t23*t60*t48*t38*t49-0.216416134227071*t1*t28*t60*t52*t29*
        t73*t39+0.073050897972*t1*t28*t80*t37*t29*t53*t39-0.19236989709073*
        t1*t28*t72*t29*t73*t30+0.292203591888*t1*t28*t60*t37*t29*t53*
        t30-0.099896*t1*t28*t80*t29*t38*t30-9.61849485453648E-10*t2*
        t3*t4*t72*t9*t73*t27+1.46101795944E-9*t2*t3*t4*t60*t37*t9*
        t53*t27-4.9948E-10*t2*t3*t4*t80*t9*t38*t27+8.333333333333333E-8*
        t2*t3*t4*t9*t26*t24-5.8641975308642E-16*t47*t23*t48*t26*t21+
        3.7037037037037E-24*t5*t66*t20*t67*t26*t18-9.87654320987654E-34*
        t2*t88*t17*t89*t26*t15;
    res[10] = 7.40740740740741E-34*t2*t26*t43*t88*t89/pow(rhoa,
        12.33333333333333)+1.2487E-26*t5*t66*t44*t37*t67*t38*t81+0.005549777777778*
        t1*t28*t46*t29*t38*t71-4.71731111111111E-10*t2*t3*t4*t46*t9*
        t38*t70-3.888888888888889E-8*t2*t3*grada*t9*t26*t70+1.94242222222222E-18*
        t47*t23*t46*t48*t38*t69+3.42592592592593E-16*t47*t45*t48*t26*
        t69-5.54977777777778E-27*t5*t66*t20*t46*t67*t38*t68-2.5E-24*
        t5*t66*t44*t67*t26*t68-6.087574831E-19*t47*t45*t52*t48*t53*
        t61+6.2435E-19*t47*t45*t60*t48*t38*t61+0.024350299324*t1*t28*
        t37*t46*t29*t53*t51-0.024974*t1*t28*t62*t29*t38*t51-3.6525448986E-10*
        t2*t3*t4*t37*t46*t9*t53*t50+3.7461E-10*t2*t3*t4*t62*t9*t38*
        t50+8.7409E-10*t2*t3*grada*t37*t9*t38*t50+8.11676644133333E-19*
        t47*t23*t37*t46*t48*t53*t49-8.32466666666667E-19*t47*t23*t62*
        t48*t38*t49-3.95421666666667E-18*t47*t45*t37*t48*t38*t49+1.803467785225591E-10*
        t2*t3*grada*t72*t9*t73*t40-2.73940867395E-10*t2*t3*grada*t60*
        t37*t9*t53*t40+9.36525E-11*t2*t3*grada*t80*t9*t38*t40+0.107307271024171*
        t1*t28*t72*t46*t29*t90*t39-0.108208067113535*t1*t28*t62*t52*
        t29*t73*t39-0.108208067113535*t1*t28*t60*t37*t46*t29*t73*t39+
        0.054788173479*t1*t28*t60*t62*t29*t53*t39+0.018262724493*t1*
        t28*t80*t46*t29*t53*t39+0.054788173479*t1*t28*t82*t37*t29*
        t53*t39-0.0187305*t1*t28*(-112.7311754743452*t5*t6*grada*t79-
        307.4622222222222*t2*t22*t45*t78-42.031875*t19*t44*t77-16.58258230452675*
        t5*t16*t43*t76-208.0157026963306*t2*t13*t42*t75-0.619171875*
        t10*t41*t74)*t29*t38*t39-0.144277422818047*t1*t28*t52*t46*
        t29*t73*t30+0.073050897972*t1*t28*t60*t46*t29*t53*t30+0.146101795944*
        t1*t28*t62*t37*t29*t53*t30-0.074922*t1*t28*t82*t29*t38*t30-
        7.21387114090236E-10*t2*t3*t4*t52*t46*t9*t73*t27+3.6525448986E-10*
        t2*t3*grada*t52*t9*t53*t27+3.6525448986E-10*t2*t3*t4*t60*t46*
        t9*t53*t27+7.3050897972E-10*t2*t3*t4*t62*t37*t9*t53*t27-3.7461E-10*
        t2*t3*t4*t82*t9*t38*t27-3.7461E-10*t2*t3*grada*t60*t9*t38*
        t27;
    res[11] = -5.55555555555556E-34*t2*t20*t26*t88*t89/pow(rhoa,
        11.33333333333333)-6.2435E-27*t5*t66*t23*t37*t67*t38*t83+8.32466666666667E-27*
        t5*t66*t44*t46*t67*t38*t81+1.625E-24*t5*t66*t23*t67*t26*t81+
        1.52189370775E-19*t47*t4*t52*t48*t53*t63-1.560875E-19*t47*
        t4*t60*t48*t38*t63+0.036525448986*t1*t28*t29*t39*t53*pow(t62,
        2.0)-8.11676644133333E-19*t47*t45*t37*t46*t48*t53*t61+8.32466666666667E-19*
        t47*t45*t62*t48*t38*t61+1.664933333333333E-18*t47*t4*t37*t48*
        t38*t61+0.008116766441333*t1*t28*t64*t29*t53*t51-0.008324666666667*
        t1*t28*t65*t29*t38*t51-1.2175149662E-10*t2*t3*t4*t64*t9*t53*
        t50+1.2487E-10*t2*t3*t4*t65*t9*t38*t50+5.82726666666667E-10*
        t2*t3*grada*t46*t9*t38*t50+1.1666666666666667E-8*t2*t3*t9*
        t26*t50+2.70558881377778E-19*t47*t23*t64*t48*t53*t49-2.77488888888889E-19*
        t47*t23*t65*t48*t38*t49-2.63614444444444E-18*t47*t45*t46*t48*
        t38*t49-1.777777777777778E-16*t47*t4*t48*t26*t49+3.60693557045118E-10*
        t2*t3*grada*t52*t46*t9*t73*t40-9.1313622465E-11*t2*t3*t52*
        t9*t53*t40-1.8262724493E-10*t2*t3*grada*t60*t46*t9*t53*t40-
        3.6525448986E-10*t2*t3*grada*t62*t37*t9*t53*t40+1.87305E-10*
        t2*t3*grada*t82*t9*t38*t40+9.36525E-11*t2*t3*t60*t9*t38*t40+
        0.107307271024171*t1*t28*t52*t64*t29*t90*t39-0.036069355704512*
        t1*t28*t52*t65*t29*t73*t39-0.036069355704512*t1*t28*t60*t64*
        t29*t73*t39-0.144277422818047*t1*t28*t62*t37*t46*t29*t73*t39+
        0.018262724493*t1*t28*t60*t65*t29*t53*t39+0.036525448986*t1*
        t28*t82*t46*t29*t53*t39+0.036525448986*t1*t28*t84*t37*t29*
        t53*t39-0.0187305*t1*t28*(24.15668045878825*t5*t6*t59+125.78*
        t2*t22*t4*t58+21.0159375*t19*t23*t57+9.164058641975307*t5*
        t16*t20*t56+122.0961733217593*t2*t13*t17*t55+0.3783828125*
        t10*t14*t54)*t29*t38*t39-0.096184948545365*t1*t28*t37*t64*
        t29*t73*t30+0.048700598648*t1*t28*t37*t65*t29*t53*t30+0.097401197296*
        t1*t28*t62*t46*t29*t53*t30-0.049948*t1*t28*t84*t29*t38*t30-
        4.80924742726824E-10*t2*t3*t4*t37*t64*t9*t73*t27+2.4350299324E-10*
        t2*t3*t4*t37*t65*t9*t53*t27+4.8700598648E-10*t2*t3*t4*t62*
        t46*t9*t53*t27+4.8700598648E-10*t2*t3*grada*t37*t46*t9*t53*
        t27-2.4974E-10*t2*t3*t4*t84*t9*t38*t27-4.9948E-10*t2*t3*grada*
        t62*t9*t38*t27-2.4974E-10*t2*t3*t37*t9*t38*t27;
    res[12] = 4.16666666666667E-34*t2*t26*t44*t88*t89/pow(rhoa,
        10.33333333333333)+2.3413125E-27*t5*t66*t45*t37*t67*t38*t85-
        9.36525E-27*t5*t66*t23*t46*t67*t38*t83-1.0E-24*t5*t66*t45*
        t67*t26*t83+4.56568112325E-19*t47*t4*t37*t46*t48*t53*t63-4.682625E-19*
        t47*t4*t62*t48*t38*t63-4.682625E-19*t47*grada*t37*t48*t38*
        t63-6.087574831E-19*t47*t45*t64*t48*t53*t61+6.2435E-19*t47*
        t45*t65*t48*t38*t61+2.4974E-18*t47*t4*t46*t48*t38*t61+7.5E-17*
        t47*grada*t48*t26*t61+5.41040335567677E-10*t2*t3*grada*t37*
        t64*t9*t73*t40-2.73940867395E-10*t2*t3*grada*t37*t65*t9*t53*
        t40-5.4788173479E-10*t2*t3*grada*t62*t46*t9*t53*t40-2.73940867395E-10*
        t2*t3*t37*t46*t9*t53*t40+2.809575E-10*t2*t3*grada*t84*t9*t38*
        t40+2.809575E-10*t2*t3*t62*t9*t38*t40+0.107307271024171*t1*
        t28*t37*t86*t29*t90*t39-0.108208067113535*t1*t28*t62*t64*t29*
        t73*t39-0.108208067113535*t1*t28*t37*t65*t46*t29*t73*t39+0.054788173479*
        t1*t28*t62*t65*t29*t53*t39+0.054788173479*t1*t28*t84*t46*t29*
        t53*t39+0.018262724493*t1*t28*t87*t37*t29*t53*t39-0.0187305*
        t1*t28*(-39.72*t2*t22*grada*t35-9.340416666666666*t19*t45*
        t34-4.712944444444444*t5*t16*t44*t33-68.14670138888889*t2*
        t13*t43*t32-0.222578125*t10*t42*t31)*t29*t38*t39-0.048092474272682*
        t1*t28*t86*t29*t73*t30+0.073050897972*t1*t28*t65*t46*t29*t53*
        t30-0.024974*t1*t28*t87*t29*t38*t30-2.40462371363412E-10*t2*
        t3*t4*t86*t9*t73*t27+3.6525448986E-10*t2*t3*grada*t64*t9*t53*
        t27+3.6525448986E-10*t2*t3*t4*t65*t46*t9*t53*t27-1.2487E-10*
        t2*t3*t4*t87*t9*t38*t27-3.7461E-10*t2*t3*grada*t65*t9*t38*
        t27-3.7461E-10*t2*t3*t46*t9*t38*t27;
    res[13] = -3.125E-34*t2*t88*t23*t89*t26*t91+0.107307271024171*
        t1*t28*t29*t39*pow(t46,4.0)*t90+9.36525E-27*t5*t66*t45*t46*
        t67*t38*t85+5.625E-25*t5*t66*t4*t67*t26*t85+0.054788173479*
        t1*t28*t29*t39*t53*pow(t65,2.0)+9.1313622465E-19*t47*t4*t64*
        t48*t53*t63-9.36525E-19*t47*t4*t65*t48*t38*t63-1.87305E-18*
        t47*grada*t46*t48*t38*t63-1.875E-17*t47*t48*t26*t63+7.21387114090236E-10*
        t2*t3*grada*t86*t9*t73*t40-5.4788173479E-10*t2*t3*t64*t9*t53*
        t40-1.09576346958E-9*t2*t3*grada*t65*t46*t9*t53*t40+3.7461E-10*
        t2*t3*grada*t87*t9*t38*t40+5.61915E-10*t2*t3*t65*t9*t38*t40-
        0.216416134227071*t1*t28*t65*t64*t29*t73*t39+0.073050897972*
        t1*t28*t87*t46*t29*t53*t39-0.0187305*t1*t28*(7.4475*t2*t22*
        t24+3.50265625*t19*t4*t21+2.209192708333333*t5*t16*t23*t18+
        35.77701822916666*t2*t13*t20*t15+0.1252001953125*t10*t17*t12)*
        t29*t38*t39;

}

static void
lg93_fourth(FunFourthFuncDrv *ds, real factor, const FunDensProp* dp)
{
    real res[14];
 
    lg93_fourth_helper(dp->rhoa, dp->grada, res);

    ds->df1000 += factor*res[0];
    ds->df0010 += factor*res[1];

    ds->df2000 += factor*res[2];
    ds->df1010 += factor*res[3];
    ds->df0020 += factor*res[4];

    ds->df3000 += factor*res[5];
    ds->df2010 += factor*res[6];
    ds->df1020 += factor*res[7];
    ds->df0030 += factor*res[8];

    ds->df4000 += factor*res[9];
    ds->df3010 += factor*res[10];
    ds->df2020 += factor*res[11];
    ds->df1030 += factor*res[12];
    ds->df0040 += factor*res[13];


    if(fabs(dp->rhoa-dp->rhob)>1e-13 ||
       fabs(dp->grada-dp->gradb)>1e-13)
        lg93_fourth_helper(dp->rhob, dp->gradb, res);

    ds->df0100 += factor*res[0];
    ds->df0001 += factor*res[1];

    ds->df0200 += factor*res[2];
    ds->df0101 += factor*res[3];
    ds->df0002 += factor*res[4];

    ds->df0300 += factor*res[5];
    ds->df0201 += factor*res[6];
    ds->df0102 += factor*res[7];
    ds->df0003 += factor*res[8];

    ds->df0400 += factor*res[9];
    ds->df0301 += factor*res[10];
    ds->df0202 += factor*res[11];
    ds->df0103 += factor*res[12];
    ds->df0004 += factor*res[13];

}
