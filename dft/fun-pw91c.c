/* Automatically generated functional code: pw91c
   Maxima input:
    >> pi:3.14159265358979312;
    >> 
    >> // parameter fuer PW92C 
    >> c:1.709921;
    >> T:[0.031091,0.015545,0.016887];
    >> U:[0.21370,0.20548,0.11125];
    >> V:[7.5957,14.1189,10.357];
    >> W:[3.5876,6.1977,3.6231];
    >> X:[1.6382,3.3662,0.88026];
    >> Y:[0.49294,0.62517,0.49671];
    >> P:[1,1,1];
    >> 
    >> // funktionen fuer PW92C 
    >> r(a,b):=(3/(4*pi*(a+b)))^(1/3);
    >> zet(a,b):=(a-b)/(a+b);
    >> omega(z):=((1+z)^(4/3)+(1-z)^(4/3)-2)/(2^(4/3)-2);
    >> en(r,t,u,v,w,x,y,p):=-2*t*(1+u*r)*log(1+1/(2*t*(v*sqrt(r)+w*r+x*r^(3/2)+y*r^(p+1))));
    >> 
    >> eps(a,b):=en(r(a,b),T[1],U[1],V[1],W[1],X[1],Y[1],P[1]);
    >> 
    >> // parameter fuer pw91c 
    >> iota:0.09;
    >> nu:16/pi*(3*pi^2)^(1/3);
    >> kappa:0.004235;
    >> lamda:nu*kappa;
    >> Z:-0.001667;
    >> Xi:23.266;
    >> Phi:0.007389;
    >> Lamda:8.723;
    >> Upsilon:0.472;
    >> 
    >> // funktionen fuer pw91c (closed shell!) 
    >> theta(r):=10^(-3)*(2.568+Xi*r+Phi*r^2)/(1+Lamda*r+Upsilon*r^2+10*Phi*r^3);
    >> phi(r):=theta(r)-Z;
    >> sigma(ga,gb,gab):=ga*ga+gb*gb+2*gab;
    >> d(a,b,ga,gb,gab):=sqrt(sigma(ga,gb,gab))/4/(3/pi)^(1/6)/(a+b)^(7/6);
    >> A(a,b):=2*iota/lamda*(1/(exp(-2*iota*eps(a,b)/lamda^2)-1));
    >> L(d,a,b):=lamda^2/(2*iota)*log((1+2*(iota*(d^2+A(a,b)*d^4))/(lamda*(1+A(a,b)*d^2+(A(a,b))^2*d^4))));
    >> J(d,a,b):=nu*(phi(r(a,b))-kappa-3*Z/7)*d^2*exp(-100*4/(3*pi^5*(a+b))^(1/3)*d^2);
    >> H(d,a,b):=L(d,a,b)+J(d,a,b);
    >> 
    >> 
    >> // kernel 
    >> K(rhoa,grada,rhob,gradb,gradab):=(rhoa+rhob)*(eps(rhoa,rhob)+H(d(rhoa,rhob,grada,gradb,gradab),rhoa,rhob));
    >> 
    >> 
    >> 
    >> 
    >> 
*/

// add "extern Functional pw91cFunctional;" to 'functionals.h'
// add "&pw91cFunctional," to 'functionals.c'
// add "fun-pw91c.c" to 'Makefile.in'

#include <math.h>
#include <stddef.h>
#include <stdio.h>

#define __CVERSION__

#include "functionals.h"
#define LOG log
#define ABS fabs
#define ASINH asinh
#define SQRT sqrt

/* INTERFACE PART */
static int pw91c_read(const char* conf_line);
static real pw91c_energy(const DftDensProp* dp);
static void pw91c_first(FirstFuncDrv *ds, real factor, 
                       const DftDensProp* dp);
static void pw91c_second(SecondFuncDrv *ds, real factor,
                        const DftDensProp* dp);
static void pw91c_third(ThirdFuncDrv *ds, real factor,
                       const DftDensProp* dp);

Functional PW91cFunctional = {
  "pw91c",
  fun_true,
  pw91c_read,
  NULL,
  pw91c_energy,
  pw91c_first,
  pw91c_second,
  pw91c_third
};

/* IMPLEMENTATION PART */
static int
pw91c_read(const char* conf_line)
{
    fun_set_hf_weight(0);
    return 1;
}


static real
pw91c_energy(const DftDensProp* dp)
{
    real t[12],zk;
    real rhoa = dp->rhoa;
    real rhob = dp->rhob;
    real grada = dp->grada;
    real gradb = dp->gradb;
    real gradab = dp->gradab;

    if(fabs(rhoa - rhob)>1e-30) {
        fputs("PW91 only closed shell\n",stderr);exit(1);
    }
    t[1] = rhob+rhoa;
    t[2] = pow(gradb,2.0)+2.0*gradab+pow(grada,2.0);
    t[3] = 1/pow(t[1],2.333333333333334);
    t[4] = 1/pow(t[1],0.66666666666667);
    t[5] = 1/pow(t[1],0.33333333333333);
    t[6] = 0.1325688999052*t[5]+1.0;
    t[7] = LOG(16.0818243221511/(2.225569421150687*t[5]+0.18970043257476*t[4]+5.98255043577108/pow(t[1],0.16666666666667)+0.80042863499936/SQRT(t[1]))+1.0);
    t[8] = pow(t[2],2.0);
    t[9] = 1/pow(t[1],4.666666666666667);
    t[10] = pow(2.718281828459045,2.513869963240347*t[6]*t[7])-1.0;
    t[11] = 1/t[10];
    zk = t[1]*(0.02473556743558*LOG(2.697586091519874*(0.01086645186224*t[8]*t[9]*t[11]+0.0634682060977*t[2]*t[3])/(0.02931318940774*t[8]*t[9]/pow(t[10],2.0)+0.17121095002288*t[2]*t[3]*t[11]+1.0)+1.0)-0.062182*t[6]*t[7]+1.0*t[2]*t[3]*(0.001*(14.43307452126544*t[5]+0.00284354383149*t[4]+2.568)/(5.411317332115466*t[5]+0.18164199329591*t[4]+0.01763993811759/t[1]+1.0)-0.00185357142857)/pow(2.718281828459045,2.612117298523359*t[2]/pow(t[1],2.666666666666667)));
    return zk;
}

static void
pw91c_first(FirstFuncDrv *ds, real factor, const DftDensProp* dp)
{
    real t[38];
    real dfdra, dfdrb, dfdga, dfdgb, dfdab;
    real rhoa = dp->rhoa;
    real rhob = dp->rhob;
    real grada = dp->grada;
    real gradb = dp->gradb;
    real gradab = dp->gradab;

    if(fabs(rhoa - rhob)>1e-30) {
        fputs("PW91 only closed shell\n",stderr);exit(1);
    }
    t[1] = pow(gradb,2.0)+2.0*gradab+pow(grada,2.0);
    t[2] = rhob+rhoa;
    t[3] = 1/pow(t[2],2.333333333333334);
    t[4] = 1/pow(t[2],0.66666666666667);
    t[5] = 1/pow(t[2],0.33333333333333);
    t[6] = 5.411317332115466*t[5]+0.18164199329591*t[4]+0.01763993811759/t[2]+1.0;
    t[7] = 1/t[6];
    t[8] = 14.43307452126544*t[5]+0.00284354383149*t[4]+2.568;
    t[9] = 0.001*t[7]*t[8]-0.00185357142857;
    t[10] = 1/pow(2.718281828459045,2.612117298523359*t[1]/pow(t[2],2.666666666666667));
    t[11] = 0.1325688999052*t[5]+1.0;
    t[12] = SQRT(t[2]);
    t[13] = 2.225569421150687*t[5]+0.18970043257476*t[4]+5.98255043577108/pow(t[2],0.16666666666667)+0.80042863499936/t[12];
    t[14] = 16.0818243221511/t[13]+1.0;
    t[15] = LOG(t[14]);
    t[16] = 1/pow(t[2],1.666666666666667);
    t[17] = 1/pow(t[2],1.333333333333333);
    t[18] = -0.99709173929518/pow(t[2],1.166666666666667)-0.7418564737169*t[17]-0.12646695504984*t[16]-0.40021431749968/pow(t[12],3.0);
    t[19] = 1/pow(t[13],2.0);
    t[20] = 1/t[14];
    t[21] = pow(t[1],2.0);
    t[22] = 1/pow(t[2],3.333333333333334);
    t[23] = 1/pow(t[2],4.666666666666667);
    t[24] = pow(2.718281828459045,2.513869963240347*t[11]*t[15]);
    t[25] = t[24]-1.0;
    t[26] = 1/t[25];
    t[27] = 0.01086645186224*t[21]*t[23]*t[26]+0.0634682060977*t[1]*t[3];
    t[28] = 1/pow(t[25],2.0);
    t[29] = 0.02931318940774*t[21]*t[23]*t[28]+0.17121095002288*t[1]*t[3]*t[26]+1.0;
    t[30] = 1/t[29];
    t[31] = 2.697586091519874*t[27]*t[30]+1.0;
    t[32] = 1/t[31];
    t[33] = 1/pow(t[2],5.666666666666667);
    t[34] = -0.11108699184383*t[17]*t[15]-40.42761511756372*t[18]*t[11]*t[19]*t[20];
    t[35] = 1/pow(t[29],2.0);
    t[36] = t[2]*(6.965646129395623*t[10]*t[21]*t[9]/pow(t[2],6.0)+1.0*t[1]*t[10]*t[3]*(0.001*(-4.811024840421813*t[17]-0.00189569588766*t[16])*t[7]-0.001*(-0.01763993811759/pow(t[2],2.0)-1.803772444038489*t[17]-0.12109466219727*t[16])*t[8]/pow(t[6],2.0))+0.02473556743558*t[32]*(2.697586091519874*t[30]*(-0.01086645186224*t[21]*t[23]*t[34]*t[28]*t[24]-0.05071010869043*t[21]*t[33]*t[26]-0.14809248089464*t[1]*t[22])-2.697586091519874*t[27]*(-0.05862637881548*t[21]*t[23]*t[24]*t[34]/pow(t[25],3.0)-0.13679488390278*t[21]*t[33]*t[28]-0.39949221672006*t[1]*t[22]*t[26]-0.17121095002288*t[1]*t[3]*t[34]*t[28]*t[24])*t[35])+1.0*t[18]*t[11]*t[19]*t[20]+0.00274779977797*t[17]*t[15]-2.333333333333333*t[1]*t[22]*t[9]*t[10])+0.02473556743558*LOG(t[31])-0.062182*t[11]*t[15]+1.0*t[1]*t[3]*t[9]*t[10];
    t[37] = 1/pow(t[2],5.0);
    dfdra = t[36];
    dfdrb = t[36];
    dfdga= t[2]*(0.02473556743558*(2.697586091519874*(0.04346580744894*grada*t[1]*t[23]*t[26]+0.12693641219541*grada*t[3])*t[30]-2.697586091519874*t[27]*(0.34242190004576*grada*t[3]*t[26]+0.11725275763095*grada*t[1]*t[23]*t[28])*t[35])*t[32]+2.0*grada*t[3]*t[9]*t[10]-5.224234597046718*grada*t[1]*t[37]*t[9]*t[10]);
    dfdgb = t[2]*(0.02473556743558*(2.697586091519874*(0.04346580744894*gradb*t[1]*t[23]*t[26]+0.12693641219541*gradb*t[3])*t[30]-2.697586091519874*t[27]*(0.34242190004576*gradb*t[3]*t[26]+0.11725275763095*gradb*t[1]*t[23]*t[28])*t[35])*t[32]+2.0*gradb*t[3]*t[9]*t[10]-5.224234597046718*gradb*t[1]*t[37]*t[9]*t[10]);
    dfdab = t[2]*(0.02473556743558*(2.697586091519874*(0.04346580744894*t[1]*t[23]*t[26]+0.12693641219541*t[3])*t[30]-2.697586091519874*t[27]*(0.34242190004576*t[3]*t[26]+0.11725275763095*t[1]*t[23]*t[28])*t[35])*t[32]+2.0*t[3]*t[9]*t[10]-5.224234597046718*t[1]*t[37]*t[9]*t[10]);
    ds->df1000 += factor*dfdra;
    ds->df0100 += factor*dfdrb;
    ds->df0010 += factor*dfdga;
    ds->df0001 += factor*dfdgb;
    ds->df00001 += factor*dfdab;
}

static void
pw91c_second(SecondFuncDrv *ds, real factor, const DftDensProp* dp)
{
    real t[90];
    real dfdra, dfdrb, dfdga, dfdgb, dfdab;
    real d2fdraga, d2fdrara, d2fdrarb, d2fdragb, d2fdrbrb;
    real d2fdrbgb, d2fdgaga, d2fdgbgb, d2fdrbga;
    real d2fdraab, d2fdrbab;
    real rhoa = dp->rhoa;
    real rhob = dp->rhob;
    real grada = dp->grada;
    real gradb = dp->gradb;
    real gradab = dp->gradab;

    if(fabs(rhoa - rhob)>1e-30) {
        fputs("PW91 only closed shell\n",stderr);exit(1);
    }
    t[1] = pow(grada,2.0);
    t[2] = pow(gradb,2.0);
    t[3] = 2.0*gradab+t[2]+t[1];
    t[4] = rhob+rhoa;
    t[5] = 1/pow(t[4],2.333333333333334);
    t[6] = 1/pow(t[4],0.66666666666667);
    t[7] = 1/pow(t[4],0.33333333333333);
    t[8] = 5.411317332115466*t[7]+0.18164199329591*t[6]+0.01763993811759/t[4]+1.0;
    t[9] = 1/t[8];
    t[10] = 14.43307452126544*t[7]+0.00284354383149*t[6]+2.568;
    t[11] = 0.001*t[10]*t[9]-0.00185357142857;
    t[12] = 1/pow(t[4],2.666666666666667);
    t[13] = 1/pow(2.718281828459045,2.612117298523359*t[3]*t[12]);
    t[14] = 0.1325688999052*t[7]+1.0;
    t[15] = SQRT(t[4]);
    t[16] = 2.225569421150687*t[7]+0.18970043257476*t[6]+5.98255043577108/pow(t[4],0.16666666666667)+0.80042863499936/t[15];
    t[17] = 16.0818243221511/t[16]+1.0;
    t[18] = LOG(t[17]);
    t[19] = 1/pow(t[4],1.666666666666667);
    t[20] = 1/pow(t[4],1.333333333333333);
    t[21] = -0.99709173929518/pow(t[4],1.166666666666667)-0.7418564737169*t[20]-0.12646695504984*t[19]-0.40021431749968/pow(t[15],3.0);
    t[22] = 1/pow(t[16],2.0);
    t[23] = 1/t[17];
    t[24] = -4.811024840421813*t[20]-0.00189569588766*t[19];
    t[25] = -0.01763993811759/pow(t[4],2.0)-1.803772444038489*t[20]-0.12109466219727*t[19];
    t[26] = 1/pow(t[8],2.0);
    t[27] = 0.001*t[24]*t[9]-0.001*t[10]*t[25]*t[26];
    t[28] = pow(t[3],2.0);
    t[29] = 1/pow(t[4],6.0);
    t[30] = 1/pow(t[4],3.333333333333334);
    t[31] = 1/pow(t[4],4.666666666666667);
    t[32] = pow(2.718281828459045,2.513869963240347*t[14]*t[18]);
    t[33] = t[32]-1.0;
    t[34] = 1/t[33];
    t[35] = 0.01086645186224*t[28]*t[31]*t[34]+0.0634682060977*t[3]*t[5];
    t[36] = 1/pow(t[33],2.0);
    t[37] = 0.02931318940774*t[28]*t[31]*t[36]+0.17121095002288*t[3]*t[5]*t[34]+1.0;
    t[38] = 1/t[37];
    t[39] = 2.697586091519874*t[35]*t[38]+1.0;
    t[40] = 1/t[39];
    t[41] = 1/pow(t[4],5.666666666666667);
    t[42] = -0.11108699184383*t[20]*t[18]-40.42761511756372*t[21]*t[14]*t[22]*t[23];
    t[43] = -0.01086645186224*t[28]*t[31]*t[42]*t[36]*t[32]-0.05071010869043*t[28]*t[41]*t[34]-0.14809248089464*t[3]*t[30];
    t[44] = 1/pow(t[37],2.0);
    t[45] = 1/pow(t[33],3.0);
    t[46] = -0.17121095002288*t[3]*t[5]*t[42]*t[36]*t[32]-0.05862637881548*t[28]*t[31]*t[42]*t[45]*t[32]-0.39949221672006*t[3]*t[30]*t[34]-0.13679488390278*t[28]*t[41]*t[36];
    t[47] = 2.697586091519874*t[38]*t[43]-2.697586091519874*t[35]*t[44]*t[46];
    t[48] = 0.02473556743558*LOG(t[39])+t[4]*(0.02473556743558*t[40]*t[47]+0.00274779977797*t[20]*t[18]-2.333333333333333*t[3]*t[30]*t[11]*t[13]+6.965646129395623*t[28]*t[29]*t[11]*t[13]+1.0*t[3]*t[5]*t[27]*t[13]+1.0*t[21]*t[14]*t[22]*t[23])-0.062182*t[14]*t[18]+1.0*t[3]*t[5]*t[11]*t[13];
    t[49] = 1/pow(t[4],5.0);
    t[50] = -5.224234597046718*grada*t[3]*t[49]*t[11]*t[13];
    t[51] = 2.0*grada*t[5]*t[11]*t[13];
    t[52] = 0.34242190004576*grada*t[5]*t[34]+0.11725275763095*grada*t[3]*t[31]*t[36];
    t[53] = 0.04346580744894*grada*t[3]*t[31]*t[34]+0.12693641219541*grada*t[5];
    t[54] = 2.697586091519874*t[53]*t[38]-2.697586091519874*t[35]*t[52]*t[44];
    t[55] = 0.02473556743558*t[54]*t[40];
    t[56] = -5.224234597046718*gradb*t[3]*t[49]*t[11]*t[13];
    t[57] = 2.0*gradb*t[5]*t[11]*t[13];
    t[58] = 0.34242190004576*gradb*t[5]*t[34]+0.11725275763095*gradb*t[3]*t[31]*t[36];
    t[59] = 0.04346580744894*gradb*t[3]*t[31]*t[34]+0.12693641219541*gradb*t[5];
    t[60] = 2.697586091519874*t[59]*t[38]-2.697586091519874*t[35]*t[58]*t[44];
    t[61] = 0.02473556743558*t[60]*t[40];
    t[62] = -5.224234597046718*t[3]*t[49]*t[11]*t[13];
    t[63] = 2.0*t[5]*t[11]*t[13];
    t[64] = 0.11725275763095*t[3]*t[31]*t[36];
    t[65] = 0.34242190004576*t[5]*t[34];
    t[66] = t[65]+t[64];
    t[67] = 0.12693641219541*t[5];
    t[68] = 0.04346580744894*t[3]*t[31]*t[34];
    t[69] = t[68]+t[67];
    t[70] = 2.697586091519874*t[69]*t[38]-2.697586091519874*t[35]*t[66]*t[44];
    t[71] = 0.02473556743558*t[70]*t[40];
    t[72] = pow(t[21],2.0);
    t[73] = 1/pow(t[16],4.0);
    t[74] = 1/pow(t[17],2.0);
    t[75] = 1/pow(t[16],3.0);
    t[76] = 0.98914196495586*t[5]+1.163273695844377/pow(t[4],2.166666666666667)+0.60032147624952/pow(t[15],5.0)+0.2107782584164*t[12];
    t[77] = 1/pow(t[4],4.333333333333333);
    t[78] = 1/pow(t[39],2.0);
    t[79] = 1/pow(t[37],3.0);
    t[80] = 1/pow(t[4],6.666666666666667);
    t[81] = 0.14811598912511*t[5]*t[18]-40.42761511756372*t[76]*t[14]*t[22]*t[23]+3.572962974617551*t[20]*t[21]*t[22]*t[23]+80.85523023512744*t[72]*t[14]*t[75]*t[23]-650.1498040841998*t[72]*t[14]*t[73]*t[74];
    t[82] = pow(t[42],2.0);
    t[83] = pow(2.718281828459045,5.027739926480694*t[14]*t[18]);
    t[84] = t[4]*(1.0*t[13]*t[3]*t[5]*(0.001*(6.414699787229083*t[5]+0.0031594931461*t[12])*t[9]+0.002*t[10]*pow(t[25],2.0)/pow(t[8],3.0)-0.001*t[10]*t[26]*(2.405029925384651*t[5]+0.03527987623518/pow(t[4],3.0)+0.20182443699545*t[12])-0.002*t[24]*t[25]*t[26])+0.02473556743558*t[40]*(-2.697586091519874*t[35]*t[44]*(0.17587913644643*t[28]*t[31]*t[82]*t[83]/pow(t[33],4.0)+0.34242190004576*t[3]*t[5]*t[82]*t[45]*t[83]+0.7751710087824*t[28]*t[80]*t[36]+1.331640722400196*t[3]*t[77]*t[34]-0.05862637881548*t[28]*t[31]*t[82]*t[45]*t[32]-0.05862637881548*t[28]*t[31]*t[81]*t[45]*t[32]+0.54717953561111*t[28]*t[41]*t[42]*t[45]*t[32]-0.17121095002288*t[3]*t[5]*t[82]*t[36]*t[32]-0.17121095002288*t[3]*t[5]*t[81]*t[36]*t[32]+0.79898443344012*t[3]*t[30]*t[42]*t[36]*t[32])+2.697586091519874*t[38]*(0.02173290372447*t[28]*t[31]*t[82]*t[45]*t[83]-0.01086645186224*t[28]*t[31]*t[82]*t[36]*t[32]+0.10142021738087*t[28]*t[41]*t[42]*t[36]*t[32]-0.01086645186224*t[28]*t[31]*t[81]*t[36]*t[32]+0.28735728257913*t[28]*t[80]*t[34]+0.49364160298214*t[3]*t[77])+5.395172183039747*t[35]*pow(t[46],2.0)*t[79]-5.395172183039747*t[44]*t[43]*t[46])-0.02473556743558*pow(t[47],2.0)*t[78]+16.0818243221511*t[72]*t[14]*t[73]*t[74]+48.52022599996423*t[11]*t[13]*pow(t[3],3.0)/pow(t[4],9.666666666666666)-58.04705107829686*t[11]*t[13]*t[28]/pow(t[4],7.0)-2.0*t[72]*t[14]*t[75]*t[23]-0.08837926660347*t[20]*t[21]*t[22]*t[23]+1.0*t[76]*t[14]*t[22]*t[23]-0.00366373303729*t[5]*t[18]-4.666666666666666*t[3]*t[30]*t[27]*t[13]+13.93129225879125*t[28]*t[29]*t[27]*t[13]+7.777777777777777*t[3]*t[77]*t[11]*t[13])+0.04947113487115*t[40]*t[47]+2.0*t[21]*t[14]*t[22]*t[23]+0.00549559955594*t[20]*t[18]+2.0*t[3]*t[5]*t[27]*t[13]-4.666666666666666*t[3]*t[30]*t[11]*t[13]+13.93129225879125*t[28]*t[29]*t[11]*t[13];
    t[85] = 1/pow(t[4],8.666666666666666);
    t[86] = t[4]*(-0.02473556743558*t[54]*t[78]*t[47]+0.02473556743558*t[40]*(-2.697586091519874*t[53]*t[44]*t[46]+5.395172183039747*t[35]*t[52]*t[79]*t[46]-2.697586091519874*t[35]*t[44]*(-0.34242190004576*grada*t[5]*t[42]*t[36]*t[32]-0.2345055152619*grada*t[3]*t[31]*t[42]*t[45]*t[32]-0.79898443344012*grada*t[30]*t[34]-0.54717953561111*grada*t[3]*t[41]*t[36])-2.697586091519874*t[52]*t[44]*t[43]+2.697586091519874*t[38]*(-0.04346580744894*grada*t[3]*t[31]*t[42]*t[36]*t[32]-0.20284043476174*grada*t[3]*t[41]*t[34]-0.29618496178928*grada*t[30]))-4.666666666666666*grada*t[30]*t[11]*t[13]+40.05246524402483*grada*t[3]*t[29]*t[11]*t[13]-36.39016949997318*grada*t[28]*t[85]*t[11]*t[13]+2.0*grada*t[5]*t[27]*t[13]-5.224234597046718*grada*t[3]*t[49]*t[27]*t[13])+t[55]+t[51]+t[50];
    t[87] = t[4]*(-0.02473556743558*t[60]*t[78]*t[47]+0.02473556743558*t[40]*(-2.697586091519874*t[59]*t[44]*t[46]+5.395172183039747*t[35]*t[58]*t[79]*t[46]-2.697586091519874*t[35]*t[44]*(-0.34242190004576*gradb*t[5]*t[42]*t[36]*t[32]-0.2345055152619*gradb*t[3]*t[31]*t[42]*t[45]*t[32]-0.79898443344012*gradb*t[30]*t[34]-0.54717953561111*gradb*t[3]*t[41]*t[36])-2.697586091519874*t[58]*t[44]*t[43]+2.697586091519874*t[38]*(-0.04346580744894*gradb*t[3]*t[31]*t[42]*t[36]*t[32]-0.20284043476174*gradb*t[3]*t[41]*t[34]-0.29618496178928*gradb*t[30]))-4.666666666666666*gradb*t[30]*t[11]*t[13]+40.05246524402483*gradb*t[3]*t[29]*t[11]*t[13]-36.39016949997318*gradb*t[28]*t[85]*t[11]*t[13]+2.0*gradb*t[5]*t[27]*t[13]-5.224234597046718*gradb*t[3]*t[49]*t[27]*t[13])+t[61]+t[57]+t[56];
    t[88] = t[4]*(-0.02473556743558*t[70]*t[78]*t[47]+0.02473556743558*t[40]*(-2.697586091519874*t[69]*t[44]*t[46]+5.395172183039747*t[35]*t[66]*t[79]*t[46]-2.697586091519874*t[35]*t[44]*(-0.34242190004576*t[5]*t[42]*t[36]*t[32]-0.2345055152619*t[3]*t[31]*t[42]*t[45]*t[32]-0.79898443344012*t[30]*t[34]-0.54717953561111*t[3]*t[41]*t[36])-2.697586091519874*t[66]*t[44]*t[43]+2.697586091519874*t[38]*(-0.04346580744894*t[3]*t[31]*t[42]*t[36]*t[32]-0.20284043476174*t[3]*t[41]*t[34]-0.29618496178928*t[30]))-4.666666666666666*t[30]*t[11]*t[13]+40.05246524402483*t[3]*t[29]*t[11]*t[13]-36.39016949997318*t[28]*t[85]*t[11]*t[13]+2.0*t[5]*t[27]*t[13]-5.224234597046718*t[3]*t[49]*t[27]*t[13])+t[71]+t[63]+t[62];
    t[89] = 1/pow(t[4],7.666666666666667);
    dfdra = t[48];
    dfdrb = t[48];
    dfdga = t[4]*(t[55]+t[51]+t[50]);
    dfdgb = t[4]*(t[61]+t[57]+t[56]);
    dfdab = t[4]*(t[71]+t[63]+t[62]);
    d2fdrara = t[84];
    d2fdrarb = t[84];
    d2fdraga = t[86];
    d2fdragb = t[87];
    d2fdrbrb = t[84];
    d2fdraab = t[88];
    d2fdrbab = t[88];
    d2fdgaga = t[4]*(0.02473556743558*t[40]*(5.395172183039747*t[35]*pow(t[52],2.0)*t[79]-2.697586091519874*t[35]*(t[65]+t[64]+0.2345055152619*t[1]*t[31]*t[36])*t[44]-5.395172183039747*t[53]*t[52]*t[44]+2.697586091519874*(t[68]+0.08693161489789*t[1]*t[31]*t[34]+t[67])*t[38])-0.02473556743558*pow(t[54],2.0)*t[78]+t[63]+t[62]+27.29262712497989*t[1]*t[3]*t[89]*t[11]*t[13]-20.89693838818687*t[1]*t[49]*t[11]*t[13]);
    d2fdgbgb = t[4]*(0.02473556743558*t[40]*(5.395172183039747*t[35]*pow(t[58],2.0)*t[79]-2.697586091519874*t[35]*(t[65]+t[64]+0.2345055152619*t[2]*t[31]*t[36])*t[44]-5.395172183039747*t[59]*t[58]*t[44]+2.697586091519874*(t[68]+0.08693161489789*t[2]*t[31]*t[34]+t[67])*t[38])-0.02473556743558*pow(t[60],2.0)*t[78]+t[63]+t[62]+27.29262712497989*t[2]*t[3]*t[89]*t[11]*t[13]-20.89693838818687*t[2]*t[49]*t[11]*t[13]);
    d2fdrbga = t[86];
    d2fdrbgb = t[87];
    ds->df1000 += factor*dfdra;
    ds->df0100 += factor*dfdrb;
    ds->df0010 += factor*dfdga;
    ds->df0001 += factor*dfdgb;
    ds->df00001 += factor*dfdab;
    ds->df2000 += factor*d2fdrara;
    ds->df1100 += factor*d2fdrarb;
    ds->df1010 += factor*d2fdraga;
    ds->df1001 += factor*d2fdragb;
    ds->df10001 += factor*d2fdraab;
    ds->df0200 += factor*d2fdrbrb;
    ds->df0110 += factor*d2fdrbga;
    ds->df0101 += factor*d2fdrbgb;
    ds->df01001 += factor*d2fdrbab;
    ds->df0020 += factor*d2fdgaga;
    ds->df0002 += factor*d2fdgbgb;
}

static void
pw91c_third(ThirdFuncDrv *ds, real factor, const DftDensProp* dp)
{
    real t[165];
    real dfdra, dfdrb, dfdga, dfdgb, dfdab;
    real d2fdraga, d2fdrara, d2fdrarb, d2fdragb, d2fdrbrb;
    real d2fdrbgb, d2fdgaga, d2fdgbgb, d2fdrbga;
    real d2fdraab, d2fdrbab;
    real d3fdraraga, d3fdraragb, d3fdraraab, d3fdrbrbab;
    real d3fdrarara, d3fdrararb, d3fdragaga, d3fdrarbrb;
    real d3fdragbgb, d3fdrarbgb, d3fdrarbab, d3fdgagaga;
    real d3fdrbrbrb, d3fdrbrbga, d3fdrbrbgb, d3fdrbgbgb;
    real d3fdrbgbga, d3fdrarbga, d3fdrbgaga;
    real rhoa = dp->rhoa;
    real rhob = dp->rhob;
    real grada = dp->grada;
    real gradb = dp->gradb;
    real gradab = dp->gradab;

    if(fabs(rhoa - rhob)>1e-30) {
        fputs("PW91 only closed shell\n",stderr);exit(1);
    }
    t[1] = pow(grada,2.0);
    t[2] = pow(gradb,2.0);
    t[3] = 2.0*gradab+t[2]+t[1];
    t[4] = rhob+rhoa;
    t[5] = 1/pow(t[4],2.333333333333334);
    t[6] = 1/pow(t[4],0.66666666666667);
    t[7] = 1/pow(t[4],0.33333333333333);
    t[8] = 5.411317332115466*t[7]+0.18164199329591*t[6]+0.01763993811759/t[4]+1.0;
    t[9] = 1/t[8];
    t[10] = 14.43307452126544*t[7]+0.00284354383149*t[6]+2.568;
    t[11] = 0.001*t[10]*t[9]-0.00185357142857;
    t[12] = 1/pow(t[4],2.666666666666667);
    t[13] = 1/pow(2.718281828459045,2.612117298523359*t[3]*t[12]);
    t[14] = 0.1325688999052*t[7]+1.0;
    t[15] = SQRT(t[4]);
    t[16] = 2.225569421150687*t[7]+0.18970043257476*t[6]+5.98255043577108/pow(t[4],0.16666666666667)+0.80042863499936/t[15];
    t[17] = 16.0818243221511/t[16]+1.0;
    t[18] = LOG(t[17]);
    t[19] = 1/pow(t[4],1.666666666666667);
    t[20] = 1/pow(t[4],1.333333333333333);
    t[21] = -0.99709173929518/pow(t[4],1.166666666666667)-0.7418564737169*t[20]-0.12646695504984*t[19]-0.40021431749968/pow(t[15],3.0);
    t[22] = 1/pow(t[16],2.0);
    t[23] = 1/t[17];
    t[24] = -4.811024840421813*t[20]-0.00189569588766*t[19];
    t[25] = -0.01763993811759/pow(t[4],2.0)-1.803772444038489*t[20]-0.12109466219727*t[19];
    t[26] = 1/pow(t[8],2.0);
    t[27] = 0.001*t[24]*t[9]-0.001*t[10]*t[25]*t[26];
    t[28] = pow(t[3],2.0);
    t[29] = 1/pow(t[4],6.0);
    t[30] = 1/pow(t[4],3.333333333333334);
    t[31] = 1/pow(t[4],4.666666666666667);
    t[32] = pow(2.718281828459045,2.513869963240347*t[14]*t[18]);
    t[33] = t[32]-1.0;
    t[34] = 1/t[33];
    t[35] = 0.01086645186224*t[28]*t[31]*t[34]+0.0634682060977*t[3]*t[5];
    t[36] = 1/pow(t[33],2.0);
    t[37] = 0.02931318940774*t[28]*t[31]*t[36]+0.17121095002288*t[3]*t[5]*t[34]+1.0;
    t[38] = 1/t[37];
    t[39] = 2.697586091519874*t[35]*t[38]+1.0;
    t[40] = 1/t[39];
    t[41] = 1/pow(t[4],5.666666666666667);
    t[42] = -0.11108699184383*t[20]*t[18]-40.42761511756372*t[21]*t[14]*t[22]*t[23];
    t[43] = -0.01086645186224*t[28]*t[31]*t[42]*t[36]*t[32]-0.05071010869043*t[28]*t[41]*t[34]-0.14809248089464*t[3]*t[30];
    t[44] = 1/pow(t[37],2.0);
    t[45] = 1/pow(t[33],3.0);
    t[46] = -0.17121095002288*t[3]*t[5]*t[42]*t[36]*t[32]-0.05862637881548*t[28]*t[31]*t[42]*t[45]*t[32]-0.39949221672006*t[3]*t[30]*t[34]-0.13679488390278*t[28]*t[41]*t[36];
    t[47] = 2.697586091519874*t[38]*t[43]-2.697586091519874*t[35]*t[44]*t[46];
    t[48] = 0.02473556743558*LOG(t[39])+t[4]*(0.02473556743558*t[40]*t[47]+0.00274779977797*t[20]*t[18]-2.333333333333333*t[3]*t[30]*t[11]*t[13]+6.965646129395623*t[28]*t[29]*t[11]*t[13]+1.0*t[3]*t[5]*t[27]*t[13]+1.0*t[21]*t[14]*t[22]*t[23])-0.062182*t[14]*t[18]+1.0*t[3]*t[5]*t[11]*t[13];
    t[49] = 1/pow(t[4],5.0);
    t[50] = -5.224234597046718*grada*t[3]*t[49]*t[11]*t[13];
    t[51] = 2.0*grada*t[5]*t[11]*t[13];
    t[52] = 0.34242190004576*grada*t[5]*t[34]+0.11725275763095*grada*t[3]*t[31]*t[36];
    t[53] = 0.04346580744894*grada*t[3]*t[31]*t[34]+0.12693641219541*grada*t[5];
    t[54] = 2.697586091519874*t[53]*t[38]-2.697586091519874*t[35]*t[52]*t[44];
    t[55] = 0.02473556743558*t[54]*t[40];
    t[56] = -5.224234597046718*gradb*t[3]*t[49]*t[11]*t[13];
    t[57] = 2.0*gradb*t[5]*t[11]*t[13];
    t[58] = 0.34242190004576*gradb*t[5]*t[34]+0.11725275763095*gradb*t[3]*t[31]*t[36];
    t[59] = 0.04346580744894*gradb*t[3]*t[31]*t[34]+0.12693641219541*gradb*t[5];
    t[60] = 2.697586091519874*t[59]*t[38]-2.697586091519874*t[35]*t[58]*t[44];
    t[61] = 0.02473556743558*t[60]*t[40];
    t[62] = -5.224234597046718*t[3]*t[49]*t[11]*t[13];
    t[63] = 2.0*t[5]*t[11]*t[13];
    t[64] = 0.11725275763095*t[3]*t[31]*t[36];
    t[65] = 0.34242190004576*t[5]*t[34];
    t[66] = t[65]+t[64];
    t[67] = 0.12693641219541*t[5];
    t[68] = 0.04346580744894*t[3]*t[31]*t[34];
    t[69] = t[68]+t[67];
    t[70] = 2.697586091519874*t[69]*t[38]-2.697586091519874*t[35]*t[66]*t[44];
    t[71] = 0.02473556743558*t[70]*t[40];
    t[72] = pow(t[21],2.0);
    t[73] = 1/pow(t[16],4.0);
    t[74] = 1/pow(t[17],2.0);
    t[75] = 1/pow(t[16],3.0);
    t[76] = 0.98914196495586*t[5]+1.163273695844377/pow(t[4],2.166666666666667)+0.60032147624952/pow(t[15],5.0)+0.2107782584164*t[12];
    t[77] = 6.414699787229083*t[5]+0.0031594931461*t[12];
    t[78] = pow(t[25],2.0);
    t[79] = 1/pow(t[8],3.0);
    t[80] = 2.405029925384651*t[5]+0.03527987623518/pow(t[4],3.0)+0.20182443699545*t[12];
    t[81] = 0.001*t[77]*t[9]-0.001*t[10]*t[26]*t[80]+0.002*t[10]*t[78]*t[79]-0.002*t[24]*t[25]*t[26];
    t[82] = pow(t[3],3.0);
    t[83] = 1/pow(t[4],9.666666666666666);
    t[84] = 1/pow(t[4],7.0);
    t[85] = 1/pow(t[4],4.333333333333333);
    t[86] = 1/pow(t[39],2.0);
    t[87] = pow(t[47],2.0);
    t[88] = 1/pow(t[37],3.0);
    t[89] = pow(t[46],2.0);
    t[90] = 1/pow(t[4],6.666666666666667);
    t[91] = 0.14811598912511*t[5]*t[18]-40.42761511756372*t[76]*t[14]*t[22]*t[23]+3.572962974617551*t[20]*t[21]*t[22]*t[23]+80.85523023512744*t[72]*t[14]*t[75]*t[23]-650.1498040841998*t[72]*t[14]*t[73]*t[74];
    t[92] = pow(t[42],2.0);
    t[93] = pow(2.718281828459045,5.027739926480694*t[14]*t[18]);
    t[94] = 0.02173290372447*t[28]*t[31]*t[92]*t[45]*t[93]-0.01086645186224*t[28]*t[31]*t[92]*t[36]*t[32]+0.10142021738087*t[28]*t[41]*t[42]*t[36]*t[32]-0.01086645186224*t[28]*t[31]*t[91]*t[36]*t[32]+0.28735728257913*t[28]*t[90]*t[34]+0.49364160298214*t[3]*t[85];
    t[95] = 1/pow(t[33],4.0);
    t[96] = 0.34242190004576*t[3]*t[5]*t[92]*t[45]*t[93]+0.17587913644643*t[28]*t[31]*t[92]*t[95]*t[93]-0.17121095002288*t[3]*t[5]*t[92]*t[36]*t[32]+0.79898443344012*t[3]*t[30]*t[42]*t[36]*t[32]-0.17121095002288*t[3]*t[5]*t[91]*t[36]*t[32]-0.05862637881548*t[28]*t[31]*t[92]*t[45]*t[32]+0.54717953561111*t[28]*t[41]*t[42]*t[45]*t[32]-0.05862637881548*t[28]*t[31]*t[91]*t[45]*t[32]+1.331640722400196*t[3]*t[85]*t[34]+0.7751710087824*t[28]*t[90]*t[36];
    t[97] = -2.697586091519874*t[35]*t[44]*t[96]+2.697586091519874*t[38]*t[94]+5.395172183039747*t[35]*t[88]*t[89]-5.395172183039747*t[44]*t[43]*t[46];
    t[98] = t[4]*(0.02473556743558*t[40]*t[97]-0.02473556743558*t[86]*t[87]-0.00366373303729*t[5]*t[18]+7.777777777777777*t[3]*t[85]*t[11]*t[13]-58.04705107829686*t[28]*t[84]*t[11]*t[13]+48.52022599996423*t[82]*t[83]*t[11]*t[13]-4.666666666666666*t[3]*t[30]*t[27]*t[13]+13.93129225879125*t[28]*t[29]*t[27]*t[13]+1.0*t[3]*t[5]*t[81]*t[13]+1.0*t[76]*t[14]*t[22]*t[23]-0.08837926660347*t[20]*t[21]*t[22]*t[23]-2.0*t[72]*t[14]*t[75]*t[23]+16.0818243221511*t[72]*t[14]*t[73]*t[74])+0.04947113487115*t[40]*t[47]+0.00549559955594*t[20]*t[18]-4.666666666666666*t[3]*t[30]*t[11]*t[13]+13.93129225879125*t[28]*t[29]*t[11]*t[13]+2.0*t[3]*t[5]*t[27]*t[13]+2.0*t[21]*t[14]*t[22]*t[23];
    t[99] = 1/pow(t[4],8.666666666666666);
    t[100] = -0.04346580744894*grada*t[3]*t[31]*t[42]*t[36]*t[32]-0.20284043476174*grada*t[3]*t[41]*t[34]-0.29618496178928*grada*t[30];
    t[101] = -0.34242190004576*grada*t[5]*t[42]*t[36]*t[32]-0.2345055152619*grada*t[3]*t[31]*t[42]*t[45]*t[32]-0.79898443344012*grada*t[30]*t[34]-0.54717953561111*grada*t[3]*t[41]*t[36];
    t[102] = -2.697586091519874*t[53]*t[44]*t[46]+5.395172183039747*t[35]*t[52]*t[88]*t[46]-2.697586091519874*t[35]*t[44]*t[101]-2.697586091519874*t[52]*t[44]*t[43]+2.697586091519874*t[38]*t[100];
    t[103] = t[4]*(-0.02473556743558*t[54]*t[86]*t[47]+0.02473556743558*t[40]*t[102]-4.666666666666666*grada*t[30]*t[11]*t[13]+40.05246524402483*grada*t[3]*t[29]*t[11]*t[13]-36.39016949997318*grada*t[28]*t[99]*t[11]*t[13]+2.0*grada*t[5]*t[27]*t[13]-5.224234597046718*grada*t[3]*t[49]*t[27]*t[13])+t[55]+t[51]+t[50];
    t[104] = -0.04346580744894*gradb*t[3]*t[31]*t[42]*t[36]*t[32]-0.20284043476174*gradb*t[3]*t[41]*t[34]-0.29618496178928*gradb*t[30];
    t[105] = -0.34242190004576*gradb*t[5]*t[42]*t[36]*t[32]-0.2345055152619*gradb*t[3]*t[31]*t[42]*t[45]*t[32]-0.79898443344012*gradb*t[30]*t[34]-0.54717953561111*gradb*t[3]*t[41]*t[36];
    t[106] = -2.697586091519874*t[59]*t[44]*t[46]+5.395172183039747*t[35]*t[58]*t[88]*t[46]-2.697586091519874*t[35]*t[44]*t[105]-2.697586091519874*t[58]*t[44]*t[43]+2.697586091519874*t[38]*t[104];
    t[107] = t[4]*(-0.02473556743558*t[60]*t[86]*t[47]+0.02473556743558*t[40]*t[106]-4.666666666666666*gradb*t[30]*t[11]*t[13]+40.05246524402483*gradb*t[3]*t[29]*t[11]*t[13]-36.39016949997318*gradb*t[28]*t[99]*t[11]*t[13]+2.0*gradb*t[5]*t[27]*t[13]-5.224234597046718*gradb*t[3]*t[49]*t[27]*t[13])+t[61]+t[57]+t[56];
    t[108] = -5.224234597046718*t[3]*t[49]*t[27]*t[13];
    t[109] = 2.0*t[5]*t[27]*t[13];
    t[110] = -36.39016949997318*t[28]*t[99]*t[11]*t[13];
    t[111] = 40.05246524402483*t[3]*t[29]*t[11]*t[13];
    t[112] = -4.666666666666666*t[30]*t[11]*t[13];
    t[113] = -0.29618496178928*t[30];
    t[114] = -0.20284043476174*t[3]*t[41]*t[34];
    t[115] = -0.04346580744894*t[3]*t[31]*t[42]*t[36]*t[32];
    t[116] = t[115]+t[114]+t[113];
    t[117] = -0.54717953561111*t[3]*t[41]*t[36];
    t[118] = -0.79898443344012*t[30]*t[34];
    t[119] = -0.2345055152619*t[3]*t[31]*t[42]*t[45]*t[32];
    t[120] = -0.34242190004576*t[5]*t[42]*t[36]*t[32];
    t[121] = t[120]+t[119]+t[118]+t[117];
    t[122] = -2.697586091519874*t[69]*t[44]*t[46]+5.395172183039747*t[35]*t[66]*t[88]*t[46]-2.697586091519874*t[35]*t[44]*t[121]-2.697586091519874*t[66]*t[44]*t[43]+2.697586091519874*t[38]*t[116];
    t[123] = t[4]*(-0.02473556743558*t[70]*t[86]*t[47]+0.02473556743558*t[40]*t[122]+t[112]+t[111]+t[110]+t[109]+t[108])+t[71]+t[63]+t[62];
    t[124] = 1/pow(t[4],7.666666666666667);
    t[125] = 27.29262712497989*t[1]*t[3]*t[124]*t[11]*t[13];
    t[126] = -20.89693838818687*t[1]*t[49]*t[11]*t[13];
    t[127] = pow(t[54],2.0);
    t[128] = -0.02473556743558*t[127]*t[86];
    t[129] = pow(t[52],2.0);
    t[130] = t[65]+t[64]+0.2345055152619*t[1]*t[31]*t[36];
    t[131] = t[68]+0.08693161489789*t[1]*t[31]*t[34]+t[67];
    t[132] = 2.697586091519874*t[131]*t[38]-5.395172183039747*t[53]*t[52]*t[44]-2.697586091519874*t[35]*t[130]*t[44]+5.395172183039747*t[35]*t[129]*t[88];
    t[133] = 0.02473556743558*t[132]*t[40];
    t[134] = 27.29262712497989*t[2]*t[3]*t[124]*t[11]*t[13];
    t[135] = -20.89693838818687*t[2]*t[49]*t[11]*t[13];
    t[136] = pow(t[60],2.0);
    t[137] = -0.02473556743558*t[136]*t[86];
    t[138] = pow(t[58],2.0);
    t[139] = t[65]+t[64]+0.2345055152619*t[2]*t[31]*t[36];
    t[140] = t[68]+0.08693161489789*t[2]*t[31]*t[34]+t[67];
    t[141] = 2.697586091519874*t[140]*t[38]-5.395172183039747*t[59]*t[58]*t[44]-2.697586091519874*t[35]*t[139]*t[44]+5.395172183039747*t[35]*t[138]*t[88];
    t[142] = 0.02473556743558*t[141]*t[40];
    t[143] = pow(t[21],3.0);
    t[144] = 1/pow(t[16],6.0);
    t[145] = 1/pow(t[17],3.0);
    t[146] = 1/pow(t[16],5.0);
    t[147] = 1/pow(t[4],3.666666666666667);
    t[148] = -2.520426340996149/pow(t[4],3.166666666666667)-2.307997918230343*t[30]-1.500803690623807/pow(t[15],7.0)-0.56207535577705*t[147];
    t[149] = 1/pow(t[4],5.333333333333333);
    t[150] = 1/pow(t[39],3.0);
    t[151] = 1/pow(t[37],4.0);
    t[152] = -0.34560397462526*t[30]*t[18]-40.42761511756372*t[148]*t[14]*t[22]*t[23]-7.145925949235101*t[5]*t[21]*t[22]*t[23]+5.359444461926326*t[20]*t[76]*t[22]*t[23]+242.5656907053823*t[76]*t[21]*t[14]*t[75]*t[23]-10.71888892385265*t[20]*t[72]*t[75]*t[23]-242.5656907053823*t[143]*t[14]*t[73]*t[23]-1950.449412252599*t[76]*t[21]*t[14]*t[73]*t[74]+86.18964430102483*t[20]*t[72]*t[73]*t[74]+3900.898824505199*t[143]*t[14]*t[146]*t[74]-20911.18986472612*t[143]*t[14]*t[144]*t[145];
    t[153] = pow(t[42],3.0);
    t[154] = -0.22217398368767*t[20]*t[18]-80.85523023512744*t[21]*t[14]*t[22]*t[23];
    t[155] = pow(2.718281828459045,7.541609889721041*t[14]*t[18]);
    t[156] = t[4]*(-0.07420670230673*t[86]*t[47]*t[97]+0.02473556743558*t[40]*(16.18551654911924*t[35]*t[88]*t[46]*t[96]-8.092758274559621*t[44]*t[43]*t[96]-8.092758274559621*t[44]*t[46]*t[94]-2.697586091519874*t[35]*t[44]*(-2.462307910249984*t[28]*t[41]*t[92]*t[95]*t[93]+0.17587913644643*t[28]*t[31]*t[154]*t[92]*t[95]*t[93]+0.52763740933928*t[28]*t[31]*t[91]*t[42]*t[95]*t[93]+0.17587913644643*t[28]*t[31]*t[153]*t[95]*t[93]-2.396953300320353*t[3]*t[30]*t[92]*t[45]*t[93]+0.34242190004576*t[3]*t[5]*t[154]*t[92]*t[45]*t[93]+1.027265700137294*t[3]*t[5]*t[91]*t[42]*t[45]*t[93]+0.34242190004576*t[3]*t[5]*t[153]*t[45]*t[93]-5.167806725216017*t[28]*t[124]*t[36]-5.770443130400849*t[3]*t[149]*t[34]-0.70351654578571*t[153]*t[155]*t[28]*t[31]/pow(t[33],5.0)+0.82076930341666*t[28]*t[41]*t[92]*t[45]*t[32]+0.82076930341666*t[28]*t[41]*t[91]*t[45]*t[32]-0.17587913644643*t[28]*t[31]*t[91]*t[42]*t[45]*t[32]-4.651026052694415*t[28]*t[90]*t[42]*t[45]*t[32]-0.05862637881548*t[28]*t[31]*t[153]*t[45]*t[32]-0.05862637881548*t[28]*t[31]*t[152]*t[45]*t[32]+1.198476650160176*t[3]*t[30]*t[92]*t[36]*t[32]+1.198476650160176*t[3]*t[30]*t[91]*t[36]*t[32]-0.51363285006865*t[3]*t[5]*t[91]*t[42]*t[36]*t[32]-3.994922167200588*t[3]*t[85]*t[42]*t[36]*t[32]-0.17121095002288*t[3]*t[5]*t[153]*t[36]*t[32]-0.17121095002288*t[3]*t[5]*t[152]*t[36]*t[32]-1.027265700137294*t[3]*t[5]*t[153]*t[95]*t[155])+16.18551654911924*t[88]*t[43]*t[89]-16.18551654911924*t[151]*t[35]*pow(t[46],3.0)+2.697586091519874*t[38]*(-0.06519871117342*t[28]*t[31]*t[153]*t[95]*t[155]+0.02173290372447*t[28]*t[31]*t[153]*t[45]*t[93]+0.02173290372447*t[28]*t[31]*t[154]*t[92]*t[45]*t[93]-0.30426065214261*t[28]*t[41]*t[92]*t[45]*t[93]+0.06519871117342*t[28]*t[31]*t[91]*t[42]*t[45]*t[93]-0.01086645186224*t[28]*t[31]*t[153]*t[36]*t[32]+0.1521303260713*t[28]*t[41]*t[92]*t[36]*t[32]-0.03259935558671*t[28]*t[31]*t[91]*t[42]*t[36]*t[32]-0.86207184773738*t[28]*t[90]*t[42]*t[36]*t[32]+0.1521303260713*t[28]*t[41]*t[91]*t[36]*t[32]-0.01086645186224*t[28]*t[31]*t[152]*t[36]*t[32]-1.915715217194188*t[28]*t[124]*t[34]-2.139113612922606*t[3]*t[149]))+1.0*t[13]*t[3]*t[5]*(0.001*(-14.96763283686786*t[30]-0.00842531505627*t[147])*t[9]+0.006*t[10]*t[25]*t[79]*t[80]-0.003*t[24]*t[26]*t[80]-0.006*t[10]*pow(t[25],3.0)/pow(t[8],4.0)+0.006*t[24]*t[78]*t[79]-0.003*t[25]*t[26]*t[77]-0.001*t[10]*t[26]*(-0.10583962870554/pow(t[4],4.0)-5.611736492564187*t[30]-0.53819849865454*t[147]))-873.3640679993562*t[11]*t[13]*t[82]/pow(t[4],10.66666666666667)-2.131949758856289*t[20]*t[72]*t[73]*t[74]+48.2454729664533*t[76]*t[21]*t[14]*t[73]*t[74]-96.4909459329066*t[143]*t[14]*t[146]*t[74]+0.04947113487115*t[150]*pow(t[47],3.0)+337.9747244340518*t[11]*t[13]*pow(t[3],4.0)/pow(t[4],13.33333333333333)+460.5066052211551*t[11]*t[13]*t[28]/pow(t[4],8.0)+0.2651377998104*t[20]*t[72]*t[75]*t[23]-5.999999999999999*t[76]*t[21]*t[14]*t[75]*t[23]+5.999999999999999*t[143]*t[14]*t[73]*t[23]-0.1325688999052*t[20]*t[76]*t[22]*t[23]+0.17675853320694*t[5]*t[21]*t[22]*t[23]+1.0*t[148]*t[14]*t[22]*t[23]+0.00854871042035*t[30]*t[18]+517.2501470570614*t[143]*t[14]*t[144]*t[145]-6.999999999999999*t[3]*t[30]*t[81]*t[13]+20.89693838818687*t[28]*t[29]*t[81]*t[13]+23.33333333333333*t[3]*t[85]*t[27]*t[13]-174.1411532348906*t[28]*t[84]*t[27]*t[13]+145.5606779998927*t[82]*t[83]*t[27]*t[13]-33.7037037037037*t[3]*t[149]*t[11]*t[13])+0.07420670230673*t[40]*t[97]-0.07420670230673*t[86]*t[87]+48.2454729664533*t[72]*t[14]*t[73]*t[74]-5.999999999999999*t[72]*t[14]*t[75]*t[23]-0.2651377998104*t[20]*t[21]*t[22]*t[23]+3.0*t[76]*t[14]*t[22]*t[23]-0.01099119911187*t[5]*t[18]+2.999999999999999*t[3]*t[5]*t[81]*t[13]-14.0*t[3]*t[30]*t[27]*t[13]+41.79387677637374*t[28]*t[29]*t[27]*t[13]+23.33333333333333*t[3]*t[85]*t[11]*t[13]-174.1411532348906*t[28]*t[84]*t[11]*t[13]+145.5606779998927*t[82]*t[83]*t[11]*t[13];
    t[157] = 1/pow(t[4],12.33333333333333);
    t[158] = t[4]*(-0.02473556743558*t[54]*t[86]*t[97]+0.02473556743558*t[40]*(-2.697586091519874*t[53]*t[44]*t[96]+5.395172183039747*t[35]*t[52]*t[88]*t[96]-2.697586091519874*t[35]*t[44]*(0.68484380009153*grada*t[5]*t[92]*t[45]*t[93]+0.70351654578571*grada*t[3]*t[31]*t[92]*t[95]*t[93]-0.34242190004576*grada*t[5]*t[92]*t[36]*t[32]+1.597968866880235*grada*t[30]*t[42]*t[36]*t[32]-0.34242190004576*grada*t[5]*t[91]*t[36]*t[32]-0.2345055152619*grada*t[3]*t[31]*t[92]*t[45]*t[32]+2.188718142444431*grada*t[3]*t[41]*t[42]*t[45]*t[32]-0.2345055152619*grada*t[3]*t[31]*t[91]*t[45]*t[32]+2.663281444800392*grada*t[85]*t[34]+3.10068403512961*grada*t[3]*t[90]*t[36])-2.697586091519874*t[52]*t[44]*t[94]+2.697586091519874*t[38]*(0.08693161489789*grada*t[3]*t[31]*t[92]*t[45]*t[93]-0.04346580744894*grada*t[3]*t[31]*t[92]*t[36]*t[32]+0.40568086952348*grada*t[3]*t[41]*t[42]*t[36]*t[32]-0.04346580744894*grada*t[3]*t[31]*t[91]*t[36]*t[32]+1.149429130316513*grada*t[3]*t[90]*t[34]+0.98728320596428*grada*t[85])+5.395172183039747*t[53]*t[88]*t[89]-16.18551654911924*t[35]*t[52]*t[151]*t[89]+10.7903443660795*t[35]*t[88]*t[101]*t[46]+10.7903443660795*t[52]*t[88]*t[43]*t[46]-5.395172183039747*t[44]*t[100]*t[46]-5.395172183039747*t[44]*t[43]*t[101])+0.04947113487115*t[54]*t[150]*t[87]-0.04947113487115*t[86]*t[102]*t[47]+15.55555555555555*grada*t[85]*t[11]*t[13]-272.8211400679953*grada*t[3]*t[84]*t[11]*t[13]+594.372768499562*grada*t[28]*t[83]*t[11]*t[13]-253.4810433255389*grada*t[82]*t[157]*t[11]*t[13]-9.333333333333332*grada*t[30]*t[27]*t[13]+80.10493048804966*grada*t[3]*t[29]*t[27]*t[13]-72.78033899994635*grada*t[28]*t[99]*t[27]*t[13]+2.0*grada*t[5]*t[81]*t[13]-5.224234597046718*grada*t[3]*t[49]*t[81]*t[13])-0.04947113487115*t[54]*t[86]*t[47]+0.04947113487115*t[40]*t[102]-9.333333333333332*grada*t[30]*t[11]*t[13]+80.10493048804966*grada*t[3]*t[29]*t[11]*t[13]-72.78033899994635*grada*t[28]*t[99]*t[11]*t[13]+3.999999999999999*grada*t[5]*t[27]*t[13]-10.44846919409344*grada*t[3]*t[49]*t[27]*t[13];
    t[159] = t[4]*(-0.02473556743558*t[60]*t[86]*t[97]+0.02473556743558*t[40]*(-2.697586091519874*t[59]*t[44]*t[96]+5.395172183039747*t[35]*t[58]*t[88]*t[96]-2.697586091519874*t[35]*t[44]*(0.68484380009153*gradb*t[5]*t[92]*t[45]*t[93]+0.70351654578571*gradb*t[3]*t[31]*t[92]*t[95]*t[93]-0.34242190004576*gradb*t[5]*t[92]*t[36]*t[32]+1.597968866880235*gradb*t[30]*t[42]*t[36]*t[32]-0.34242190004576*gradb*t[5]*t[91]*t[36]*t[32]-0.2345055152619*gradb*t[3]*t[31]*t[92]*t[45]*t[32]+2.188718142444431*gradb*t[3]*t[41]*t[42]*t[45]*t[32]-0.2345055152619*gradb*t[3]*t[31]*t[91]*t[45]*t[32]+2.663281444800392*gradb*t[85]*t[34]+3.10068403512961*gradb*t[3]*t[90]*t[36])-2.697586091519874*t[58]*t[44]*t[94]+2.697586091519874*t[38]*(0.08693161489789*gradb*t[3]*t[31]*t[92]*t[45]*t[93]-0.04346580744894*gradb*t[3]*t[31]*t[92]*t[36]*t[32]+0.40568086952348*gradb*t[3]*t[41]*t[42]*t[36]*t[32]-0.04346580744894*gradb*t[3]*t[31]*t[91]*t[36]*t[32]+1.149429130316513*gradb*t[3]*t[90]*t[34]+0.98728320596428*gradb*t[85])+5.395172183039747*t[59]*t[88]*t[89]-16.18551654911924*t[35]*t[58]*t[151]*t[89]+10.7903443660795*t[35]*t[88]*t[105]*t[46]+10.7903443660795*t[58]*t[88]*t[43]*t[46]-5.395172183039747*t[44]*t[104]*t[46]-5.395172183039747*t[44]*t[43]*t[105])+0.04947113487115*t[60]*t[150]*t[87]-0.04947113487115*t[86]*t[106]*t[47]+15.55555555555555*gradb*t[85]*t[11]*t[13]-272.8211400679953*gradb*t[3]*t[84]*t[11]*t[13]+594.372768499562*gradb*t[28]*t[83]*t[11]*t[13]-253.4810433255389*gradb*t[82]*t[157]*t[11]*t[13]-9.333333333333332*gradb*t[30]*t[27]*t[13]+80.10493048804966*gradb*t[3]*t[29]*t[27]*t[13]-72.78033899994635*gradb*t[28]*t[99]*t[27]*t[13]+2.0*gradb*t[5]*t[81]*t[13]-5.224234597046718*gradb*t[3]*t[49]*t[81]*t[13])-0.04947113487115*t[60]*t[86]*t[47]+0.04947113487115*t[40]*t[106]-9.333333333333332*gradb*t[30]*t[11]*t[13]+80.10493048804966*gradb*t[3]*t[29]*t[11]*t[13]-72.78033899994635*gradb*t[28]*t[99]*t[11]*t[13]+3.999999999999999*gradb*t[5]*t[27]*t[13]-10.44846919409344*gradb*t[3]*t[49]*t[27]*t[13];
    t[160] = t[4]*(-0.02473556743558*t[70]*t[86]*t[97]+0.02473556743558*t[40]*(-2.697586091519874*t[69]*t[44]*t[96]+5.395172183039747*t[35]*t[66]*t[88]*t[96]-2.697586091519874*t[35]*t[44]*(0.68484380009153*t[5]*t[92]*t[45]*t[93]+0.70351654578571*t[3]*t[31]*t[92]*t[95]*t[93]-0.34242190004576*t[5]*t[92]*t[36]*t[32]+1.597968866880235*t[30]*t[42]*t[36]*t[32]-0.34242190004576*t[5]*t[91]*t[36]*t[32]-0.2345055152619*t[3]*t[31]*t[92]*t[45]*t[32]+2.188718142444431*t[3]*t[41]*t[42]*t[45]*t[32]-0.2345055152619*t[3]*t[31]*t[91]*t[45]*t[32]+2.663281444800392*t[85]*t[34]+3.10068403512961*t[3]*t[90]*t[36])-2.697586091519874*t[66]*t[44]*t[94]+2.697586091519874*t[38]*(0.08693161489789*t[3]*t[31]*t[92]*t[45]*t[93]-0.04346580744894*t[3]*t[31]*t[92]*t[36]*t[32]+0.40568086952348*t[3]*t[41]*t[42]*t[36]*t[32]-0.04346580744894*t[3]*t[31]*t[91]*t[36]*t[32]+1.149429130316513*t[3]*t[90]*t[34]+0.98728320596428*t[85])+5.395172183039747*t[69]*t[88]*t[89]-16.18551654911924*t[35]*t[66]*t[151]*t[89]+10.7903443660795*t[35]*t[88]*t[121]*t[46]+10.7903443660795*t[66]*t[88]*t[43]*t[46]-5.395172183039747*t[44]*t[116]*t[46]-5.395172183039747*t[44]*t[43]*t[121])+0.04947113487115*t[70]*t[150]*t[87]-0.04947113487115*t[86]*t[122]*t[47]+15.55555555555555*t[85]*t[11]*t[13]-272.8211400679953*t[3]*t[84]*t[11]*t[13]+594.372768499562*t[28]*t[83]*t[11]*t[13]-253.4810433255389*t[82]*t[157]*t[11]*t[13]-9.333333333333332*t[30]*t[27]*t[13]+80.10493048804966*t[3]*t[29]*t[27]*t[13]-72.78033899994635*t[28]*t[99]*t[27]*t[13]+2.0*t[5]*t[81]*t[13]-5.224234597046718*t[3]*t[49]*t[81]*t[13])-0.04947113487115*t[70]*t[86]*t[47]+0.04947113487115*t[40]*t[122]-9.333333333333332*t[30]*t[11]*t[13]+80.10493048804966*t[3]*t[29]*t[11]*t[13]-72.78033899994635*t[28]*t[99]*t[11]*t[13]+3.999999999999999*t[5]*t[27]*t[13]-10.44846919409344*t[3]*t[49]*t[27]*t[13];
    t[161] = 1/pow(t[4],11.33333333333333);
    t[162] = t[4]*(-0.02473556743558*t[132]*t[86]*t[47]+0.04947113487115*t[127]*t[150]*t[47]-0.04947113487115*t[54]*t[86]*t[102]+0.02473556743558*t[40]*(-2.697586091519874*t[131]*t[44]*t[46]+10.7903443660795*t[53]*t[52]*t[88]*t[46]+5.395172183039747*t[35]*t[130]*t[88]*t[46]-16.18551654911924*t[35]*t[129]*t[151]*t[46]-5.395172183039747*t[53]*t[44]*t[101]+10.7903443660795*t[35]*t[52]*t[88]*t[101]-2.697586091519874*t[35]*t[44]*(t[120]+t[119]-0.46901103052381*t[1]*t[31]*t[42]*t[45]*t[32]+t[118]+t[117]-1.094359071222215*t[1]*t[41]*t[36])-2.697586091519874*t[130]*t[44]*t[43]+5.395172183039747*t[129]*t[88]*t[43]-5.395172183039747*t[52]*t[44]*t[100]+2.697586091519874*t[38]*(t[115]-0.08693161489789*t[1]*t[31]*t[42]*t[36]*t[32]+t[114]-0.40568086952348*t[1]*t[41]*t[34]+t[113]))+t[112]+t[111]+104.4846919409343*t[1]*t[29]*t[11]*t[13]+t[110]-354.8041526247384*t[1]*t[3]*t[99]*t[11]*t[13]+190.1107824941542*t[1]*t[28]*t[161]*t[11]*t[13]+t[109]+t[108]-20.89693838818687*t[1]*t[49]*t[27]*t[13]+27.29262712497989*t[1]*t[3]*t[124]*t[27]*t[13])+t[133]+t[128]+t[63]+t[62]+t[126]+t[125];
    t[163] = t[4]*(-0.02473556743558*t[141]*t[86]*t[47]+0.04947113487115*t[136]*t[150]*t[47]-0.04947113487115*t[60]*t[86]*t[106]+0.02473556743558*t[40]*(-2.697586091519874*t[140]*t[44]*t[46]+10.7903443660795*t[59]*t[58]*t[88]*t[46]+5.395172183039747*t[35]*t[139]*t[88]*t[46]-16.18551654911924*t[35]*t[138]*t[151]*t[46]-5.395172183039747*t[59]*t[44]*t[105]+10.7903443660795*t[35]*t[58]*t[88]*t[105]-2.697586091519874*t[35]*t[44]*(t[120]+t[119]-0.46901103052381*t[2]*t[31]*t[42]*t[45]*t[32]+t[118]+t[117]-1.094359071222215*t[2]*t[41]*t[36])-2.697586091519874*t[139]*t[44]*t[43]+5.395172183039747*t[138]*t[88]*t[43]-5.395172183039747*t[58]*t[44]*t[104]+2.697586091519874*t[38]*(t[115]-0.08693161489789*t[2]*t[31]*t[42]*t[36]*t[32]+t[114]-0.40568086952348*t[2]*t[41]*t[34]+t[113]))+t[112]+t[111]+104.4846919409343*t[2]*t[29]*t[11]*t[13]+t[110]-354.8041526247384*t[2]*t[3]*t[99]*t[11]*t[13]+190.1107824941542*t[2]*t[28]*t[161]*t[11]*t[13]+t[109]+t[108]-20.89693838818687*t[2]*t[49]*t[27]*t[13]+27.29262712497989*t[2]*t[3]*t[124]*t[27]*t[13])+t[142]+t[137]+t[63]+t[62]+t[135]+t[134];
    t[164] = pow(grada,3.0);
    dfdra =t[48];
    dfdrb = t[48];
    dfdga = t[4]*(t[55]+t[51]+t[50]);
    dfdgb = t[4]*(t[61]+t[57]+t[56]);
    dfdab = t[4]*(t[71]+t[63]+t[62]);
    d2fdrara = t[98];
    d2fdrarb = t[98];
    d2fdraga = t[103];
    d2fdragb = t[107];
    d2fdrbrb = t[98];
    d2fdraab = t[123];
    d2fdrbab = t[123];
    d2fdgaga = t[4]*(t[133]+t[128]+t[63]+t[62]+t[126]+t[125]);
    d2fdgbgb = t[4]*(t[142]+t[137]+t[63]+t[62]+t[135]+t[134]);
    d2fdrbga = t[103];
    d2fdrbgb = t[107];
    d3fdrararb = t[156];
    d3fdraraga = t[158];
    d3fdraragb = t[159];
    d3fdrbrbab = t[160];
    d3fdraraab = t[160];
    d3fdrarbrb = t[156];
    d3fdrarbga = t[158];
    d3fdrarbgb = t[159];
    d3fdrarbab = t[160];
    d3fdragaga = t[162];
    d3fdragbgb = t[163];
    d3fdrarara = t[156];
    d3fdrbrbrb = t[156];
    d3fdrbrbga = t[158];
    d3fdrbrbgb = t[159];
    d3fdrbgaga = t[162];
    d3fdrbgbga = t[162];
    d3fdrbgbgb = t[163];
    d3fdgagaga = t[4]*(0.02473556743558*t[40]*(16.18551654911924*t[35]*t[130]*t[52]*t[88]+16.18551654911924*t[53]*t[129]*t[88]-16.18551654911924*t[151]*t[35]*pow(t[52],3.0)-8.092758274559621*t[131]*t[52]*t[44]-8.092758274559621*t[53]*t[130]*t[44]-1.897796449065635*grada*t[31]*t[35]*t[44]*t[36]+0.70351654578571*grada*t[31]*t[38]*t[34])-0.07420670230673*t[132]*t[54]*t[86]+0.04947113487115*t[150]*pow(t[54],3.0)-142.5830868706157*t[11]*t[13]*t[164]*t[3]/pow(t[4],10.33333333333333)-62.69081516456061*grada*t[49]*t[11]*t[13]+81.87788137493966*grada*t[3]*t[124]*t[11]*t[13]+163.7557627498793*t[164]*t[124]*t[11]*t[13]);
    ds->df1000 += factor*dfdra;
    ds->df0100 += factor*dfdrb;
    ds->df0010 += factor*dfdga;
    ds->df0001 += factor*dfdgb;
    ds->df00001 += factor*dfdab;
    ds->df2000 += factor*d2fdrara;
    ds->df1100 += factor*d2fdrarb;
    ds->df1010 += factor*d2fdraga;
    ds->df1001 += factor*d2fdragb;
    ds->df10001 += factor*d2fdraab;
    ds->df0200 += factor*d2fdrbrb;
    ds->df0110 += factor*d2fdrbga;
    ds->df0101 += factor*d2fdrbgb;
    ds->df01001 += factor*d2fdrbab;
    ds->df0020 += factor*d2fdgaga;
    ds->df0002 += factor*d2fdgbgb;
    ds->df2010 += factor*d3fdraraga;
    ds->df2001 += factor*d3fdraragb;
    ds->df1101 += factor*d3fdrarbgb;
    ds->df11001 += factor*d3fdrarbab;
    ds->df1020 += factor*d3fdragaga;
    ds->df1002 += factor*d3fdragbgb;
    ds->df3000 += factor*d3fdrarara;
    ds->df2100 += factor*d3fdrararb;
    ds->df20001 += factor*d3fdraraab;
    ds->df02001 += factor*d3fdrbrbab;
    ds->df1200 += factor*d3fdrarbrb;
    ds->df1110 += factor*d3fdrarbga;
    ds->df0300 += factor*d3fdrbrbrb;
    ds->df0210 += factor*d3fdrbrbga;
    ds->df0201 += factor*d3fdrbrbgb;
    ds->df0120 += factor*d3fdrbgaga;
    ds->df0102 += factor*d3fdrbgbgb;
    ds->df0030 += factor*d3fdgagaga;
}
