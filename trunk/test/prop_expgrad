#!/bin/sh
info='
   prop_expgrad
   ------------
   Molecule:         N2
   Wave Function:    BLYP
   Test Purpose:     Calculate exponent gradient
'

molecule='INTGRL
Geometry optimization, calculation of quadrupole moment, magnetizabilities
and nuclear shieldings at the optimized geometry
    1    0
        7.    2    6    1    1    1    1    1    1
 N1   0.00000 0.000000  1.034
 N2   0.00000 0.000000 -1.034
H   7    0
1792.96029032
 269.84707155
  61.33531163
  17.00072818
   5.18324751
   0.67431212
   0.18300181
H   4    0
13.75333842
 3.01377620
 0.81923924
 0.22417597
H   1    0
0.87680110
H   1    0
1.09547007
H   1    0
1.25075670
H   1    0
1.29425886
'

dalton='**DALTON INPUT
.RUN PROPERTIES
**WAVE FUNCTION
.DFT
 BLYP
**PROPERTIES
.EXPGRA
**END OF DALTON INPUT
'

test='
check_scf_energy DFT -109.508937550101 1e-6

check_exp_grad  1 1792.9602903200    -0.0000000001 1-e7
check_exp_grad  2  269.8470715500    -0.0000000033 1-e7
check_exp_grad  3   61.3353116300     0.0000000219 1-e7
check_exp_grad  4   17.0007281800    -0.0000000859 1-e7
check_exp_grad  5    5.1832475100    -0.0000001448 1-e7
check_exp_grad  6    0.6743121200    -0.0000000462 1-e7
check_exp_grad  7    0.1830018100    -0.0000001807 1-e7
check_exp_grad  8   13.7533384200     0.0000000136 1-e7
check_exp_grad  9    3.0137762000    -0.0000001343 1-e7
check_exp_grad 10    0.8192392400     0.0000000633 1-e7
check_exp_grad 11    0.2241759700    -0.0000002645 1-e7
check_exp_grad 12    0.8768011000     0.0000001015 1-e7
check_exp_grad 13    1.0954700700    -0.0000000826 1-e7
check_exp_grad 14    1.2507567000    -0.0000000292 1-e7
check_exp_grad 15    1.2942588600     0.0000000561 1-e7
'

. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"
