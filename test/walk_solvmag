#!/bin/sh
#
# This is the script for generating files for a specific Dalton test job.
#
# For the .check file ksh or bash is preferred, otherwise use sh
# (and hope it is not the old Bourne shell, which will not work)
#
if [ -x /bin/ksh ]; then
   CHECK_SHELL='#!/bin/ksh'
elif [ -x /bin/bash ]; then
   CHECK_SHELL='#!/bin/bash'
else
   CHECK_SHELL='#!/bin/sh'
fi


#######################################################################
#  TEST DESCRIPTION
#######################################################################
cat > walk_solvmag.info <<'%EOF%'
   walk_solvmag
   ------------
   Molecule:         CH3F
   Wave Function:    SCF
   Test Purpose:     Geometry walk and shielding and magnetizability for
                     a solvated molecule (equilibrium solvation)
%EOF%

#######################################################################
#  MOLECULE INPUT
#######################################################################
cat > walk_solvmag.mol <<'%EOF%'
ATOMBASIS
Geomatry walk and calculation of shielding and magnetizability for a
solvated molecule (equilibrium solvation)
Nosymmetry Atomtypes=3
Charge=6.0 Atoms=1 Basis=6-311++G(2d,2p)
C     0.0000001475010024 -0.0000000000003520 -1.3932067381011331
Charge=9.0 Atoms=1 Basis=6-311++G(2d,2p)
F    -0.0000001276140516  0.0000000000003430  1.2050427284018797
Charge=1.0 Atoms=3 Basis=6-311++G**
H     1.9358001772894534 -0.0000000000007497 -2.0424861818430919
H    -0.9678997639598199 -1.6764519428430403 -2.0424864897014450
H    -0.9678997639598013  1.6764519428415161 -2.0424864897035540
%EOF%

#######################################################################
#  DALTON INPUT
#######################################################################
cat > walk_solvmag.dal <<'%EOF%'
**DALTON INPUT
.WALK
**INTEGRALS
*ONEINT
.SOLVENT
 10
**WAVE FUNCTIONS
.HF
*SOLVENT
.DIELECTRIC
 32.63
.MAX L
 10
.CAVITY
 5.08
**PROPERTIES
.SHIELD
.MAGNET
**END OF DALTON INPUT
%EOF%
#######################################################################



#######################################################################

#######################################################################
#  CHECK SCRIPT
#######################################################################
echo $CHECK_SHELL >walk_solvmag.check
cat >>walk_solvmag.check <<'%EOF%'
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi

# Integral setup
CRIT1=`$GREP "One\-electron RLM integrals calculated\." $log | wc -l`
CRIT2=`$GREP "Maximum L quantum number\: 10" $log | wc -l`
CRIT3=`$GREP "All symmetries saved on file\." $log | wc -l`
TEST[1]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[1]=3
ERROR[1]="INTEGRAL SETUP NOT CORRECT"

# Geometry
CRIT1=`$GREP "Total number of coordinates\: * 15" $log | wc -l`
CRIT2=`$GREP "1 * x * (0| )\.0000001475" $log | wc -l`
CRIT3=`$GREP "2 * y * (\-0|\-|0| )\.0000000000" $log | wc -l`
CRIT4=`$GREP "3 * z * \-1\.3932067381" $log | wc -l`
CRIT5=`$GREP "4 * x * (\-0|\-)\.0000001276" $log | wc -l`
CRIT6=`$GREP "5 * y * (\-0|\-|0| )\.0000000000" $log | wc -l`
CRIT7=`$GREP "6 * z * 1\.2050427284" $log | wc -l`
CRIT8=`$GREP "7 * x * 1\.9358001773" $log | wc -l`
CRIT9=`$GREP "8 * y * (\-0|\-|0| )\.0000000000" $log | wc -l`
CRIT10=`$GREP "9 * z * \-2\.0424861818" $log | wc -l`
CRIT11=`$GREP "10 * x * (\-0|\-)\.9678997640" $log | wc -l`
CRIT12=`$GREP "11 * y * \-1\.6764519428" $log | wc -l`
CRIT13=`$GREP "12 * z * \-2\.0424864897" $log | wc -l`
CRIT14=`$GREP "13 * x * (\-0|\-)\.9678997640" $log | wc -l`
CRIT15=`$GREP "14 * y * 1\.6764519428" $log | wc -l`
CRIT16=`$GREP "15 * z * \-2\.0424864897" $log | wc -l`
TEST[2]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16`
CTRL[2]=16
ERROR[2]="GEOMETRY NOT READ CORRECTLY"

# Initial energy
CRIT1=`$GREP "Final * HF energy\: * \-139\.0893070200[0-9][0-9]" $log | wc -l`
TEST[3]=`expr	$CRIT1`
CTRL[3]=1
ERROR[3]="INITIAL ENERGY NOT CORRECT"

# Initial gradient
CRIT1=`$GREP "C * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000 * (\-0|\-)\.000408...[0-9]" $log | wc -l`
CRIT2=`$GREP "F * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000 * (0| )\.000559...[0-9]" $log | wc -l`
CRIT3=`$GREP "H * (0| )\.000007...[0-9] * (\-0|\-|0| )\.0000000000 * (\-0|\-)\.000005...[0-9]" $log | wc -l`
CRIT4=`$GREP "H * (\-0|\-)\.000003...[0-9] * (\-0|\-)\.000006...[0-9] * (\-0|\-)\.000005...[0-9]" $log | wc -l`
CRIT5=`$GREP "H * (\-0|\-)\.000003...[0-9] * (0| )\.000006...[0-9] * (\-0|\-)\.000005...[0-9]" $log | wc -l`
CRIT6=`$GREP "cav * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000 * (\-0|\-)\.000133...[0-9]" $log | wc -l`
TEST[4]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[4]=6
ERROR[4]="INITIAL GRADIENT NOT CORRECT"

# Initial Hessian
CRIT1=`$GREP "C * x * (0| )\.66660[0-9]" $log | wc -l`
CRIT2=`$GREP "C * y * (\-0|\-|0| )\.000000 * (0| )\.66660[0-9]" $log | wc -l`
CRIT3=`$GREP "C * z * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.50300[0-9]" $log | wc -l`
CRIT4=`$GREP "F * x * (\-0|\-)\.07390[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.05178[0-9]" $log | wc -l`
CRIT5=`$GREP "F * y * (\-0|\-|0| )\.000000 * (\-0|\-)\.07390[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.05178[0-9]" $log | wc -l`
CRIT6=`$GREP "F * z * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (\-0|\-)\.27439[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.38577[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * (\-0|\-)\.33001[0-9] * (\-0|\-|0| )\.000000 * (0| )\.07905[0-9] * (0| )\.01066[0-9] * (\-0|\-|0| )\.000000 * (0| )\.00298[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * (\-0|\-|0| )\.000000 * (\-0|\-)\.06583[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.00406[0-9] * (\-0|\-|0| )\.000000" $log | wc -l`
CRIT9=`$GREP "H * z * (0| )\.06730[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-)\.0762(2|3)[0-9] * (0| )\.04122[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-)\.03702[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * (\-0|\-)\.13188[0-9] * (\-0|\-)\.11439[0-9] * (\-0|\-)\.03952[0-9] * (0| )\.00571[0-9] * (0| )\.00285[0-9] * (\-0|\-)\.00149[0-9]" $log | wc -l`
CRIT11=`$GREP "H * y * (\-0|\-)\.11439[0-9] * (\-0|\-)\.26397[0-9] * (\-0|\-)\.06846[0-9] * (0| )\.00285[0-9] * (0| )\.00901[0-9] * (\-0|\-)\.00258[0-9]" $log | wc -l`
CRIT12=`$GREP "H * z * (\-0|\-)\.03365[0-9] * (\-0|\-)\.05828[0-9] * (\-0|\-)\.0762(2|3)[0-9] * (\-0|\-)\.02061[0-9] * (\-0|\-)\.03570[0-9] * (\-0|\-)\.03702[0-9]" $log | wc -l`
CRIT13=`$GREP "H * x * (\-0|\-)\.13188[0-9] * (0| )\.11439[0-9] * (\-0|\-)\.03952[0-9] * (0| )\.00571[0-9] * (\-0|\-)\.00285[0-9] * (\-0|\-)\.00149[0-9]" $log | wc -l`
CRIT14=`$GREP "H * y * (0| )\.11439[0-9] * (\-0|\-)\.26397[0-9] * (0| )\.06846[0-9] * (\-0|\-)\.00285[0-9] * (0| )\.00901[0-9] * (0| )\.00258[0-9]" $log | wc -l`
CRIT15=`$GREP "H * z * (\-0|\-)\.03365[0-9] * (0| )\.05828[0-9] * (\-0|\-)\.0762(2|3)[0-9] * (\-0|\-)\.02061[0-9] * (0| )\.03570[0-9] * (\-0|\-)\.03702[0-9]" $log | wc -l`
CRIT16=`$GREP "cav * x * (0| )\.00108[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.00004[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000" $log | wc -l`
CRIT17=`$GREP "cav * y * (\-0|\-|0| )\.000000 * (0| )\.00108[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.00004[0-9] * (\-0|\-|0| )\.000000" $log | wc -l`
CRIT18=`$GREP "cav * z * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (0| )\.00007[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (\-0|\-)\.00030[0-9]" $log | wc -l`
CRIT19=`$GREP "H * x * (0| )\.34499[0-9]" $log | wc -l`
CRIT20=`$GREP "H * z * (\-0|\-)\.08913[0-9] * (\-0|\-|0| )\.000000 * (0| )\.09839[0-9]" $log | wc -l`
CRIT21=`$GREP "H * x * (\-0|\-)\.01284[0-9] * (\-0|\-)\.02943[0-9] * (\-0|\-)\.00946[0-9] * (0| )\.12719[0-9]" $log | wc -l`
CRIT22=`$GREP "H * y * (0| )\.00094[0-9] * (0| )\.00360[0-9] * (0| )\.00128[0-9] * (0| )\.12574[0-9] * (0| )\.27239[0-9]" $log | wc -l`
CRIT23=`$GREP "H * z * (0| )\.00361[0-9] * (0| )\.00883[0-9] * (0| )\.00716[0-9] * (0| )\.04456[0-9] * (0| )\.07719[0-9] * (0| )\.09839[0-9]" $log | wc -l`
CRIT24=`$GREP "H * x * (\-0|\-)\.01284[0-9] * (0| )\.02943[0-9] * (\-0|\-)\.00946[0-9] * (0| )\.01183[0-9] * (\-0|\-)\.01518[0-9] * (0| )\.00584[0-9]" $log | wc -l`
CRIT25=`$GREP "H * y * (\-0|\-)\.00094[0-9] * (0| )\.00360[0-9] * (\-0|\-)\.00128[0-9] * (0| )\.01518[0-9] * (\-0|\-)\.02106[0-9] * (0| )\.00755[0-9]" $log | wc -l`
CRIT26=`$GREP "H * z * (0| )\.00361[0-9] * (\-0|\-)\.00883[0-9] * (0| )\.00716[0-9] * (0| )\.00584[0-9] * (\-0|\-)\.00755[0-9] * (0| )\.00716[0-9]" $log | wc -l`
CRIT27=`$GREP "cav * x * (0| )\.00004[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-)\.00046[0-9] * (\-0|\-)\.00001[0-9] * (0| )\.00003[0-9] * (0| )\.00023[0-9]" $log | wc -l`
CRIT28=`$GREP "cav * y * (\-0|\-|0| )\.000000 * (\-0|\-)\.00003[0-9] * (\-0|\-|0| )\.000000 * (0| )\.00003[0-9] * (0| )\.00002[0-9] * (0| )\.00040[0-9]" $log | wc -l`
CRIT29=`$GREP "cav * z * (\-0|\-)\.00014[0-9] * (\-0|\-|0| )\.000000 * (0| )\.00053[0-9] * (0| )\.00007[0-9] * (0| )\.00012[0-9] * (0| )\.00053[0-9]" $log | wc -l`
CRIT30=`$GREP "H * x * (0| )\.12719[0-9]" $log | wc -l`
CRIT31=`$GREP "H * y * (\-0|\-)\.12574[0-9] * (0| )\.27239[0-9]" $log | wc -l`
CRIT32=`$GREP "H * z * (0| )\.04456[0-9] * (\-0|\-)\.07719[0-9] * (0| )\.09839[0-9]" $log | wc -l`
CRIT33=`$GREP "cav * x * (\-0|\-)\.00001[0-9] * (\-0|\-)\.00003[0-9] * (0| )\.00023[0-9] * (\-0|\-)\.00114[0-9]" $log | wc -l`
CRIT34=`$GREP "cav * y * (\-0|\-)\.00003[0-9] * (0| )\.00002[0-9] * (\-0|\-)\.00040[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-)\.00114[0-9]" $log | wc -l`
CRIT35=`$GREP "cav * z * (0| )\.00007[0-9] * (\-0|\-)\.00012[0-9] * (0| )\.00053[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (\-0|\-)\.00139[0-9]" $log | wc -l`
TEST[5]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
		$CRIT25 \+ $CRIT26 \+ $CRIT27 \+ $CRIT28 \+ $CRIT29 \+ $CRIT30 \+ \
		$CRIT31 \+ $CRIT32 \+ $CRIT33 \+ $CRIT34 \+ $CRIT35`
CTRL[5]=41
ERROR[5]="INITIAL HESSIAN NOT CORRECT"

# First step
CRIT1=`$GREP "C * (0| )\.000000000[0-9] * (\-0|\-|0| )\.0000000000 * (0| )\.0005(89|90)...[0-9]" $log | wc -l`
CRIT2=`$GREP "F * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000 * (\-0|\-)\.000795...[0-9]" $log | wc -l`
CRIT3=`$GREP "H * (\-0|\-)\.000112...[0-9] * (\-0|\-|0| )\.0000000000 * (0| )\.00014(2|3)...[0-9]" $log | wc -l`
CRIT4=`$GREP "H * (0| )\.000056...[0-9] * (0| )\.000097...[0-9] * (0| )\.00014(2|3)...[0-9]" $log | wc -l`
CRIT5=`$GREP "H * (0| )\.000056...[0-9] * (\-0|\-)\.000097...[0-9] * (0| )\.00014(2|3)...[0-9]" $log | wc -l`
CRIT6=`$GREP "cav * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000 * (\-0|\-)\.000223...[0-9]" $log | wc -l`
TEST[6]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[6]=6
ERROR[6]="GEOMETRY STEP NOT CORRECT"

# Second energy
CRIT1=`$GREP "Final * HF energy\: * \-139\.089307350[2-3][0-9][0-9]" $log | wc -l`
TEST[7]=`expr	$CRIT1`
CTRL[7]=1
ERROR[7]="SECOND ENERGY NOT CORRECT"

# Final geometry
CRIT1=`$GREP "C * (0| )\.0000001..[0-9] * (\-0|\-|0| )\.0000000000 * \-1\.392393...[0-9]" $log | wc -l`
CRIT2=`$GREP "F * (\-0|\-)\.0000001..[0-9] * (\-0|\-|0| )\.0000000000 * 1\.204470...[0-9]" $log | wc -l`
CRIT3=`$GREP "H * 1\.935687...[0-9] * (\-0|\-|0| )\.0000000000 * \-2\.042119...[0-9]" $log | wc -l`
CRIT4=`$GREP "H * (\-0|\-)\.967843...[0-9] * \-1\.676354...[0-9] * \-2\.042119...[0-9]" $log | wc -l`
CRIT5=`$GREP "H * (\-0|\-)\.967843...[0-9] * 1\.676354...[0-9] * \-2\.042119...[0-9]" $log | wc -l`
CRIT6=`$GREP "cav * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000" $log | wc -l`
CRIT7=`$GREP "Geometry optimization has converged\." $log | wc -l`
TEST[8]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ $CRIT7`
CTRL[8]=26
ERROR[8]="FINAL GEOMETRY NOT CORRECT"

# Magnetizabilities
CRIT1=`$GREP "Isotropic magnetizability\: * \-3\.9977 * \-315\.457. * \-18\.9973" $log | wc -l`
CRIT2=`$GREP "Diamagnetic contribution\: * \-12\.4489 * \-982\.350. * \-59\.1585" $log | wc -l`
CRIT3=`$GREP "Paramagnetic contribution\: * 8\.4513 * 666\.892. * 40\.1612" $log | wc -l`
CRIT4=`$GREP "Parallel component\: * \-5\.1168 * \-403\.766. * \-24\.3154" $log | wc -l`
CRIT5=`$GREP "Perpendicular component\: * \-3\.4381 * \-271\.303. * \-16\.3383" $log | wc -l`
CRIT6=`$GREP "Anisotropy\: * \-1\.6786 * \-132\.4627 * \-7\.9771" $log | wc -l`
CRIT7=`$GREP "Magnetizability is cylindrical\." $log | wc -l`
TEST[9]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7`
CTRL[9]=7
ERROR[9]="MAGNETIZABILITIES NOT CORRECT"

# Total magnetizability tensor
CRIT1=`$GREP "Bx * \-3\.438124....[0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9] * (0| )\.0000001...[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "By * (\-0|\-|0| )\.0000000000[0-9][0-9] * \-3\.438124....[0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "Bz * (0| )\.0000001...[0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9] * \-5\.116772....[0-9][0-9]" $log | wc -l`
TEST[10]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[10]=3
ERROR[10]="TOTAL MAGNETIZABILITIES NOT CORRECT"

# Diamagnetic magnetizability tensor
CRIT1=`$GREP "Bx * \-15\.10134....[0-9][0-9][0-9] * (\-0|\-|0| )\.0000000000[0-1][0-9] * (\-0|\-)\.00000084..[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "By * (\-0|\-|0| )\.0000000000[0-1][0-9] * \-15\.10134....[0-9][0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "Bz * (\-0|\-)\.00000084..[0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9] * \-7\.1441(2|3)....[0-9][0-9][0-9]" $log | wc -l`
TEST[11]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[11]=3
ERROR[11]="DIAMAGNETIC MAGNETIZABILITY TENSOR NOT CORRECT"

# Paramagnetic magnetizability tensor
CRIT1=`$GREP "Bx * 11\.6632(1|2)....[0-9][0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9] * (0| )\.0000010..[0-9][0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "By * (\-0|\-|0| )\.0000000000[0-9][0-9] * 11\.6632(1|2)....[0-9][0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "Bz * (0| )\.0000010..[0-9][0-9][0-9] * (\-0|\-|0| )\.0000000000[0-9][0-9] * 2\.027356....[0-9][0-9]" $log | wc -l`
TEST[12]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[12]=3
ERROR[12]="PARAMAGNETIC MAGNETIZABILITY TENSOR NOT CORRECT"

# Molecular g-tensor
CRIT1=`$GREP "Isotropic g\-tensor * \: * (0| )\.055559.." $log | wc -l`
CRIT2=`$GREP "Nuclear contribution * \: * (0| )\.7492828." $log | wc -l`
CRIT3=`$GREP "Electronic contribution * \: * (\-0|\-)\.689989.." $log | wc -l`
CRIT4=`$GREP "Parallel component\: * (0| )\.278411.." $log | wc -l`
CRIT5=`$GREP "Perpendicular component\: * (\-0|\-)\.055866(5|6|7)." $log | wc -l`
CRIT6=`$GREP "Anisotropy\: * (0| )\.334277.." $log | wc -l`
CRIT7=`$GREP "Molecular rotational g\-tensor is cylindrical\." $log | wc -l`
TEST[13]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7`
CTRL[13]=7
ERROR[13]="MOLECULAR G-TENSOR NOT CORRECT"

# Shielding tensor
CRIT1=`$GREP "C * x * 95\.6849...[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-)\.00001..[0-9]" $log | wc -l`
CRIT2=`$GREP "C * y * (\-0|\-|0| )\.00000000 * 95\.6849...[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREP "C * z * (\-0|\-)\.00001..[0-9] * (\-0|\-|0| )\.00000000 * 191\.107(3|4)...[0-9]" $log | wc -l`
CRIT4=`$GREP "F * x * 515\.1749...[0-9] * (\-0|\-|0| )\.00000000 * (0| )\.000007.[0-9]" $log | wc -l`
CRIT5=`$GREP "F * y * (\-0|\-|0| )\.00000000 * 515\.1749...[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT6=`$GREP "F * z * (0| )\.000008.[0-9] * (\-0|\-|0| )\.00000000 * 439\.186(2|3)...[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * 28\.2958...[0-9] * (\-0|\-|0| )\.00000000 * \-4\.6769...[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * (\-0|\-|0| )\.00000000 * 25\.2026...[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT9=`$GREP "H * z * \-1\.2223...[0-9] * (\-0|\-|0| )\.00000000 * 31\.0365...[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * 25\.9759...[0-9] * 1\.339(3|4)...[0-9] * 2\.3384...[0-9]" $log | wc -l`
CRIT11=`$GREP "H * y * 1\.339(3|4)...[0-9] * 27\.5225...[0-9] * 4\.0503...[0-9]" $log | wc -l`
CRIT12=`$GREP "H * z * (0| )\.6111...[0-9] * 1\.058(5|6)...[0-9] * 31\.0365...[0-9]" $log | wc -l`
CRIT13=`$GREP "H * x * 25\.9759...[0-9] * \-1\.339(3|4)...[0-9] * 2\.3384...[0-9]" $log | wc -l`
CRIT14=`$GREP "H * y * \-1\.339(3|4)...[0-9] * 27\.5225...[0-9] * \-4\.0503...[0-9]" $log | wc -l`
CRIT15=`$GREP "H * z * (0| )\.6111...[0-9] * \-1\.0585...[0-9] * 31\.0365...[0-9]" $log | wc -l`
CRIT16=`$GREP "cav * x * 48\.7349...[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-)\.000003.[0-9]" $log | wc -l`
CRIT17=`$GREP "cav * y * (\-0|\-|0| )\.00000000 * 48\.7349...[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT18=`$GREP "cav * z * (\-0|\-)\.000003.[0-9] * (\-0|\-|0| )\.00000000 * 83\.375(1|2)...[0-9]" $log | wc -l`
TEST[14]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18`
CTRL[14]=33
ERROR[14]="SHIELDING TENSOR NOT CORRECT"

# Chemical shieldings
CRIT1=`$GREP "\@1 C * 127\.492. * 319\.387. \-191\.895. * 1\.0000 * 95\.422. * 95\.422. * (0| )\.0000" $log | wc -l`
CRIT2=`$GREP "\@1 F * 489\.845. * 510\.279. * \-20\.434. * \-1\.0000 * 75\.988. * 37\.994. * 3\.0000" $log | wc -l`
CRIT3=`$GREP "\@1 H * 28\.178. * 26\.230. * 1\.948. * (0| )\.686. * 7\.716. * 7\.110. * (0| )\.2555" $log | wc -l`
CRIT4=`$GREP "\@1 H * 28\.178. * 26\.230. * 1\.948. * (0| )\.686. * 7\.716. * 7\.110. * (0| )\.2555" $log | wc -l`
CRIT5=`$GREP "\@1 H * 28\.178. * 26\.230. * 1\.948. * (0| )\.686. * 7\.716. * 7\.110. * (0| )\.2555" $log | wc -l`
CRIT6=`$GREP "\@2 C * 127\.492. * 319\.387. \-191\.895. * 95\.422. * (0| )\.0000 * 95\.422. * (0| )\.0000" $log | wc -l`
CRIT7=`$GREP "\@2 F * 489\.845. * 510\.279. * \-20\.434. * \-75\.988. * (0| )\.0000 * 75\.988. * (0| )\.0000" $log | wc -l`
CRIT8=`$GREP "\@2 H * 28\.178. * 26\.230. * 1\.948. * 7\.110. * (0| )\.255. * 7\.187. * 1\.7273" $log | wc -l`
CRIT9=`$GREP "\@2 H * 28\.178. * 26\.230. * 1\.948. * 7\.110. * (0| )\.255. * 7\.187. * 1\.7273" $log | wc -l`
CRIT10=`$GREP "\@2 H * 28\.178. * 26\.230. * 1\.948. * 7\.110. * (0| )\.255. * 7\.187. * 1\.7273" $log | wc -l`
TEST[15]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10`
CTRL[15]=22
ERROR[15]="CHEMICAL SHIELDINGS NOT CORRECT"

PASSED=1
for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
do
   if [ ${TEST[i]} -lt ${CTRL[i]} ]; then
     echo "${ERROR[i]} ( test = ${TEST[i]}; control = ${CTRL[i]} ); "
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi

%EOF%
#######################################################################
