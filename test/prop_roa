#!/bin/sh
#
# This is the script for generating files for a specific Dalton test job.
#
# For the .check file ksh or bash is preferred, otherwise use sh
# (and hope it is not the old Bourne shell, which will not work)
#
if [ -x /bin/ksh ]; then
   CHECK_SHELL='#!/bin/ksh'
elif [ -x /bin/bash ]; then
   CHECK_SHELL='#!/bin/bash'
else
   CHECK_SHELL='#!/bin/sh'
fi


#######################################################################
#  TEST DESCRIPTION
#######################################################################
cat > prop_roa.info <<'%EOF%'
   prop_roa
   --------
   Molecule:         C3H4
   Wave Function:    SCF / DunningDZ
   Test Purpose:     Single-point calculation of Raman Optical Activity
                     parameters
%EOF%

#######################################################################
#  MOLECULE INPUT
#######################################################################
cat > prop_roa.mol <<'%EOF%'
BASIS
DunningDZ
ROA calculation for allene (H2C=C=CH2) at optimized geometry SCF-DZ
No symmetry
    2  0 0
        6.    3
C1    0.0            0.0           0.0
C2    0.0	     2.4743846667  0.0
C3    0.0           -2.4743846667  0.0
        1.    4
H4    1.7367853003   3.5259125935  0.0
H5   -1.7367853003   3.5259125935  0.0
H6    0.0           -3.5259125935  1.7367853003
H7    0.0           -3.5259125935 -1.7367853003
%EOF%

#######################################################################
#  DALTON INPUT
#######################################################################
cat > prop_roa.dal <<'%EOF%'
**DALTON INPUT
.WALK
.MAX IT
 50
*WALK
.NUMERI
.PRINT
 1
.DISPLA
 0.001
**WAVE FUNCTIONS
.HF
*SCF INPUT
.THRESH
1.0D-8
**START
.VROA
*ABALNR
.THRESH
5.0D-8
.FREQUE
     3
0.0932147101 0.088558504 0.08564539532
**EACH STEP
.VROA
*ABALNR
.THRESH
5.0D-8
.FREQUE
     3
0.0932147101 0.088558504 0.08564539532
**PROPERTIES
.VROA
.RAMAN
.VIBANA
*RESPON
.THRESH
1.0D-6
*ABALNR
.THRESH
5.0D-8
.FREQUE
     3
0.0932147101 0.088558504 0.08564539532
*VIBANA
.HESPUN
.ISOTOP
   4   7
1 1 1 2 1 1 2
1 1 1 1 2 2 1
1 1 1 2 1 2 1
1 1 1 1 2 1 2
**END OF DALTON INPUT
%EOF%
#######################################################################



#######################################################################

#######################################################################
#  CHECK SCRIPT
#######################################################################
echo $CHECK_SHELL >prop_roa.check
cat >>prop_roa.check <<'%EOF%'
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi

# Geometry
CRIT1=`$GREP "1 * C1 * x * (0| )\.0000000000" $log | wc -l`
CRIT2=`$GREP "4 * C2 * x * (0| )\.0000000000" $log | wc -l`
CRIT3=`$GREP "5 * y * 2\.4743846667" $log | wc -l`
CRIT4=`$GREP "7 * C3 * x * (0| )\.0000000000" $log | wc -l`
CRIT5=`$GREP "8 * y * \-2\.4743846667" $log | wc -l`
CRIT6=`$GREP "10 * H4 * x * 1\.7367853003" $log | wc -l`
CRIT7=`$GREP "11 * y * 3\.5259125935" $log | wc -l`
CRIT8=`$GREP "13 * H5 * x * \-1\.7367853003" $log | wc -l`
CRIT9=`$GREP "14 * y * 3\.5259125935" $log | wc -l`
CRIT10=`$GREP "16 * H6 * x * (0| )\.0000000000" $log | wc -l`
CRIT11=`$GREP "17 * y * \-3\.5259125935" $log | wc -l`
CRIT12=`$GREP "18 * z * 1\.7367853003" $log | wc -l`
CRIT13=`$GREP "19 * H7 * x * (0| )\.0000000000" $log | wc -l`
CRIT14=`$GREP "20 * y * \-3\.5259125935" $log | wc -l`
CRIT15=`$GREP "21 * z * \-1\.7367853003" $log | wc -l`
TEST[1]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[1]=15
ERROR[1]="INITIAL GEOMETRY NOT CORRECT"

# Initial energy
CRIT1=`$GREP "Final * HF energy\: * \-115\.8302823663[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "Electronic energy\: * \-175\.0835477694[0-9][0-9]" $log | wc -l`
TEST[2]=`expr	$CRIT1 \+ $CRIT2`
CTRL[2]=4
ERROR[2]="INITIAL ENERGY NOT CORRECT"

# Numerical walk
CRIT1=`$GREP "Walk type\: Numerical differentiation" $log | wc -l`
CRIT2=`$GREP "Vibrational Raman intensities and optical activity" $log | wc -l`
TEST[3]=`expr	$CRIT1 \+ $CRIT2`
CTRL[3]=46
ERROR[3]="WALK NOT SET UP CORRECTLY"

# Frequencies
CRIT1=`$GREP "Number of frequencies * \: * 3" $log | wc -l`
CRIT2=`$GREP "Frequencies * \: * (0| )\.093215 * (0| )\.088559 * (0| )\.085645" $log | wc -l`
TEST[4]=`expr	$CRIT1 \+ $CRIT2`
CTRL[4]=88
ERROR[4]="SPECIFIED FREQUENCIES NOT CORRECT"

# Optical rotation
CRIT1=`$GREP "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.430053[0-9]" $log | wc -l`
CRIT2=`$GREP "Ez * (0| )\.430053[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT3=`$GREP "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.407688[0-9]" $log | wc -l`
CRIT4=`$GREP "Ez * (0| )\.407688[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT5=`$GREP "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.393766[0-9]" $log | wc -l`
CRIT6=`$GREP "Ez * (0| )\.393766[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT7=`$GREP "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.496605[0-9]" $log | wc -l`
CRIT8=`$GREP "Ez * (0| )\.496605[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT9=`$GREP "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.470845[0-9]" $log | wc -l`
CRIT10=`$GREP "Ez * (0| )\.470845[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
CRIT11=`$GREP "Ex * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000 * (0| )\.454805[0-9]" $log | wc -l`
CRIT12=`$GREP "Ez * (0| )\.454805[0-9] * (\-0|\-|0| )\.0000000 * (\-0|\-|0| )\.0000000" $log | wc -l`
TEST[5]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[5]=12
ERROR[5]="OPTICAL ROTATION NOT CORRECT"

# Polarizability tensor
CRIT1=`$GREP "1 * 17\.5550150[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT2=`$GREP "2 * (\-0|\-|0| )\.00000000 * 65\.5489224[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREP "3 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 17\.5550150[0-9]" $log | wc -l`
CRIT4=`$GREP "1 * 17\.5181914[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT5=`$GREP "2 * (\-0|\-|0| )\.00000000 * 65\.0400881[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT6=`$GREP "3 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 17\.5181914[0-9]" $log | wc -l`
CRIT7=`$GREP "1 * 17\.4962021[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT8=`$GREP "2 * (\-0|\-|0| )\.00000000 * 64\.7395750[0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT9=`$GREP "3 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 17\.4962021[0-9]" $log | wc -l`
TEST[6]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[6]=9
ERROR[6]="POLARIZABILITY TENSOR NOT CORRECT"

# No-London G tensor
CRIT1=`$GREP "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4966056[0-9]" $log | wc -l`
CRIT2=`$GREP "3 * (0| )\.4966056[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREP "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4708455[0-9]" $log | wc -l`
CRIT4=`$GREP "3 * (0| )\.4708455[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT5=`$GREP "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4548056[0-9]" $log | wc -l`
CRIT6=`$GREP "3 * (0| )\.4548056[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
TEST[7]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[7]=6
ERROR[7]="NO-LONDON G TENSORS NOT CORRECT"

# London G tensor
CRIT1=`$GREP "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4300538[0-9]" $log | wc -l`
CRIT2=`$GREP "3 * (0| )\.4300538[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREP "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.4076881[0-9]" $log | wc -l`
CRIT4=`$GREP "3 * (0| )\.4076881[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT5=`$GREP "1 * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * (0| )\.3937663[0-9]" $log | wc -l`
CRIT6=`$GREP "3 * (0| )\.3937663[0-9] * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000" $log | wc -l`
TEST[8]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[8]=6
ERROR[8]="LONDON G TENSORS NOT CORRECT"

# A tensor
CRIT1=`$GREP "1 * \-*0*\.000000.*    22\.751177.* \-*0*\.000000.* 22\.751177" $log | wc -l`
CRIT2=`$GREP "2 *    11\.690695.* \-*0*\.000000.* \-*0*\.000000.* \-*0*\.000000" $log | wc -l`
CRIT3=`$GREP "3 * \-*0*\.000000.*  \-22\.751177.* \-*0*\.000000.* \-22\.751177" $log | wc -l`
CRIT4=`$GREP "2 *  \-11\.690695" $log | wc -l`
CRIT5=`$GREP "1 * \-*0*\.000000.*    22\.693019.* \-*0*\.000000.* 22\.693019" $log | wc -l`
CRIT6=`$GREP "2 *    11\.655869.* \-*0*\.000000.* \-*0*\.000000.* \-*0*\.000000" $log | wc -l`
CRIT7=`$GREP "3 * \-*0*\.000000.*  \-22\.693019.* \-*0*\.000000.* \-22\.693019" $log | wc -l`
CRIT8=`$GREP "2 *  \-11\.655869" $log | wc -l`
CRIT9=`$GREP "1 * \-*0*\.000000.*    22\.658293.* \-*0*\.000000.* 22\.658293" $log | wc -l`
CRIT10=`$GREP "2 *   11\.635106.* \-*0*\.000000.* \-*0*\.000000.* \-*0*\.000000" $log | wc -l`
CRIT11=`$GREP "3 * \-*0*\.00000.*  \-22\.658293.* \-*0*\.000000.* \-22\.658293" $log | wc -l`
CRIT12=`$GREP "2 *  \-11\.63510" $log | wc -l`
TEST[9]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[9]=12
ERROR[9]="A TENSOR NOT CORRECT"

# Rayleigh properties
CRIT1=`$GREP "24\.7212 * 50\.5800 * 1466\.513[0-9] * 303\.4801 * (0| )\.2069" $log | wc -l`
CRIT2=`$GREP "24\.4359 * 49\.5900 * 1446\.745[0-9] * 297\.5401 * (0| )\.2057" $log | wc -l`
CRIT3=`$GREP "24\.2680 * 49\.0104 * 1435\.131[0-9] * 294\.0626 * (0| )\.2049" $log | wc -l`
TEST[10]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[10]=3
ERROR[10]="RAYLEIGH PROPERTIES NOT CORRECT"

# Displaced geometries
CRIT1=`$GREP "Final * HF energy\: * \-115\.8302816229[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "Final * HF energy\: * \-115\.8302818721[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "Final * HF energy\: * \-115\.8302818685[0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "Final * HF energy\: * \-115\.8302820258[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "Final * HF energy\: * \-115\.8302822115[0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "Final * HF energy\: * \-115\.8302822118[0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "Final * HF energy\: * \-115\.8302822897[0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "Final * HF energy\: * \-115\.8302822958[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "Final * HF energy\: * \-115\.8302823011[0-9][0-9]" $log | wc -l`
CRIT10=`$GREP "Final * HF energy\: * \-115\.8302823540[0-9][0-9]" $log | wc -l`
CRIT11=`$GREP "Final * HF energy\: * \-115\.8302823663[0-9][0-9]" $log | wc -l`
TEST[11]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11`
CTRL[11]=44
ERROR[11]="DISPLACED GEOMETRIES NOT CORRECT"

# Vibrational frequencies
CRIT1=`$GREP "1 * A * 3428\.47 * (0| )\.01562[0-9] * 10\.27[0-9] * (0| )\.243[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * A * 3428\.47 * (0| )\.01562[0-9] * 10\.27[0-9] * (0| )\.243[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * A * 3328\.58 * (0| )\.01516[0-9] * 5\.71[0-9] * (0| )\.135[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * A * 3328\.27 * (0| )\.01516[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT5=`$GREP "5 * A * 2178\.98 * (0| )\.00992[0-9] * 116\.49[0-9] * 2\.756[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * A * 1620\.52 * (0| )\.00738[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT7=`$GREP "7 * A * 1572\.44 * (0| )\.00716[0-9] * 6\.50[0-9] * (0| )\.154[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * A * 1168\.67 * (0| )\.00532[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT9=`$GREP "9 * A * 1140\.15 * (0| )\.00519[0-9] * (0| )\.29[0-9] * (0| )\.007[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * A * 1140\.15 * (0| )\.00519[0-9] * (0| )\.29[0-9] * (0| )\.007[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * A * 1050\.77 * (0| )\.00478[0-9] * 93\.33[0-9] * 2\.208[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * A * 1050\.77 * (0| )\.00478[0-9] * 93\.33[0-9] * 2\.208[0-9]" $log | wc -l`
CRIT13=`$GREP "13 * A * 952\.17 * (0| )\.00433[0-9] * (0| )\.000 * (0| )\.0000" $log | wc -l`
CRIT14=`$GREP "14 * A * 414\.32 * (0| )\.00188[0-9] * 16\.30[0-9] * (0| )\.385[0-9]" $log | wc -l`
CRIT15=`$GREP "15 * A * 414\.32 * (0| )\.00188[0-9] * 16\.30[0-9] * (0| )\.385[0-9]" $log | wc -l`
TEST[12]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[12]=15
ERROR[12]="VIBRATIONAL FREQUENCIES NOT CORRECT"

# Raman properties freq1
CRIT1=`$GREP "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.600[6-8][0-9][0-9] * 66\.40(23|24|25|26|27|28|29|30|31|32)[0-9][0-9] * 49\.80(18|19|20|21|22|23|24)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT2=`$GREP "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.600[6-8][0-9][0-9] * 66\.40(23|24|25|26|27|28|29|30|31|32)[0-9][0-9] * 49\.80(18|19|20|21|22|23|24)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT3=`$GREP "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.4055[0-9][0-9] * 37\.6220[0-9][0-9] * 28\.2165[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT4=`$GREP "4 * 3328\.2[0-9] * 6\.5550[0-9][0-9] * 5\.7572[0-9][0-9] * 318\.0052[0-9][0-9] * 17\.2716[0-9][0-9] * (0| )\.0543[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0573[0-9][0-9] * (0| )\.2292[0-9][0-9] * (0| )\.1719[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT6=`$GREP "6 * 1620\.5[0-9] * (0| )\.0009[0-9][0-9] * 1\.7183[0-9][0-9] * 6\.9164[0-9][0-9] * 5\.1551[0-9][0-9] * (0| )\.7453[0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0779[0-9][0-9] * (0| )\.3116[0-9][0-9] * (0| )\.2337[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT8=`$GREP "8 * 1168\.6[0-9] * 1\.2120[0-9][0-9] * 10\.5349[0-9][0-9] * 96\.6835[0-9][0-9] * 31\.6048[0-9][0-9] * (0| )\.3268[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.260[6-7][0-9][0-9] * 1\.042[7-9][0-9][0-9] * (0| )\.782[0-1][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT10=`$GREP "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.260[6-7][0-9][0-9] * 1\.042[7-9][0-9][0-9] * (0| )\.782[0-1][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT11=`$GREP "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.1449[0-9][0-9] * 4\.579[7-9][0-9][0-9] * 3\.434[8-9][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT12=`$GREP "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.1449[0-9][0-9] * 4\.579[7-9][0-9][0-9] * 3\.434[8-9][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT13=`$GREP "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2642[0-9][0-9] * 5\.057[0-1][0-9][0-9] * 3\.7928[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT14=`$GREP "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.838[1-2][0-9][0-9] * 3\.352[7-9][0-9][0-9] * 2\.514[5-7][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT15=`$GREP "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.838[1-2][0-9][0-9] * 3\.352[7-9][0-9][0-9] * 2\.514[5-7][0-9][0-9] * (0| )\.750000" $log | wc -l`
TEST[13]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[13]=15
ERROR[13]="RAMAN PROPERTIES FREQ1 NOT CORRECT"

# Raman optical activity freq1
CRIT1=`$GREP "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.600[6-8][0-9][0-9] * 116\.20[4-5][0-9] * 99\.60[3-4][0-9] * 232\.4(08|09|10|11)[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.600[6-8][0-9][0-9] * 116\.20[4-5][0-9] * 99\.60[3-4][0-9] * 232\.4(08|09|10|11)[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.4055[0-9][0-9] * 65\.838[0-9] * 56\.433[0-9] * 131\.677[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * 3328\.2[0-9] * 6\.5550[0-9][0-9] * 5\.7572[0-9][0-9] * 335\.276[0-9] * 34\.543[0-9] * 670\.553[0-9] * (0| )\.103[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0573[0-9][0-9] * (0| )\.401[0-9] * (0| )\.343[0-9] * (0| )\.802[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 1620\.5[0-9] * (0| )\.0009[0-9][0-9] * 1\.7183[0-9][0-9] * 12\.071[0-9] * 10\.310[0-9] * 24\.143[0-9] * (0| )\.854[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0779[0-9][0-9] * (0| )\.545[0-9] * (0| )\.467[0-9] * 1\.090[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * 1168\.6[0-9] * 1\.2120[0-9][0-9] * 10\.5349[0-9][0-9] * 128\.288[0-9] * 63\.209[0-9] * 256\.576[0-9] * (0| )\.492[0-9]" $log | wc -l`
CRIT9=`$GREP "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.260[6-7][0-9][0-9] * 1\.82[4-5][0-9] * 1\.564[0-9] * 3\.6(49|50|51)[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.260[6-7][0-9][0-9] * 1\.82[4-5][0-9] * 1\.564[0-9] * 3\.6(49|50|51)[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.1449[0-9][0-9] * 8\.014[0-9] * 6\.869[0-9] * 16\.029[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.1449[0-9][0-9] * 8\.014[0-9] * 6\.869[0-9] * 16\.029[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT13=`$GREP "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2642[0-9][0-9] * 8\.8(49|50)[0-9] * 7\.585[0-9] * 17\.(699|700)[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT14=`$GREP "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.838[1-2][0-9][0-9] * 5\.867[0-9] * 5\.029[0-9] * 11\.73[4-5][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT15=`$GREP "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.838[1-2][0-9][0-9] * 5\.867[0-9] * 5\.029[0-9] * 11\.73[4-5][0-9] * (0| )\.857[0-9]" $log | wc -l`
TEST[14]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[14]=15
ERROR[14]="ROA FREQ1 NOT CORRECT"

# Circular intensity difference freq1
CRIT1=`$GREP "11 * 1050\.7[0-9] * (\-0|\-)\.80(15|16|17|18|19|20|21|22|23)[0-9][0-9] * (\-0|\-)\.50[6-7][0-9][0-9][0-9] * (\-0|\-)\.34(69|70|71|72|73)[0-9][0-9] * (\-0|\-)\.66(65|66|67|68|69|70|71|72)[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "12 * 1050\.7[0-9] * (0| )\.80(15|16|17|18|19|20|21|22|23)[0-9][0-9] * (0| )\.50[6-7][0-9][0-9][0-9] * (0| )\.34(69|70|71|72|73)[0-9][0-9] * (0| )\.66(65|66|67|68|69|70|71|72)[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "14 * 414\.3[0-9] * (0| )\.038[0-1][0-9][0-9] * (0| )\.05(08|09|10|11|12)[0-9][0-9] * (0| )\.005[6-7][0-9][0-9] * (0| )\.096[2-6][0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "15 * 414\.3[0-9] * (\-0|\-)\.038[0-1][0-9][0-9] * (\-0|\-)\.05(08|09|10|11|12)[0-9][0-9] * (\-0|\-)\.005[6-7][0-9][0-9] * (\-0|\-)\.096[2-6][0-9][0-9]" $log | wc -l`
TEST[15]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[15]=4
ERROR[15]="CIRCULAR INTENSITY DIFFERENCES FREQ1 NOT CORRECT"

# Raman properties freq2
CRIT1=`$GREP "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.31(58|59|60)[0-9][0-9] * 65\.26(34|35|36|37|38|39|40|41)[0-9][0-9] * 48\.94(75|76|77|78|79|80|81)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT2=`$GREP "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.31(58|59|60)[0-9][0-9] * 65\.26(34|35|36|37|38|39|40|41)[0-9][0-9] * 48\.94(75|76|77|78|79|80|81)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT3=`$GREP "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.3258[0-9][0-9] * 37\.3034[0-9][0-9] * 27\.9775[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT4=`$GREP "4 * 3328\.2[0-9] * 6\.4696[0-9][0-9] * 5\.6209[0-9][0-9] * 313\.6197[0-9][0-9] * 16\.8627[0-9][0-9] * (0| )\.0537[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0560[0-9][0-9] * (0| )\.2243[0-9][0-9] * (0| )\.1682[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT6=`$GREP "6 * 1620\.5[0-9] * (0| )\.0007[0-9][0-9] * 1\.7382[0-9][0-9] * 6\.9875[0-9][0-9] * 5\.2148[0-9][0-9] * (0| )\.7463[0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0778[0-9][0-9] * (0| )\.3112[0-9][0-9] * (0| )\.2334[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT8=`$GREP "8 * 1168\.6[0-9] * 1\.1682[0-9][0-9] * 10\.1487[0-9][0-9] * 93\.1642[0-9][0-9] * 30\.4463[0-9][0-9] * (0| )\.3268[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2500[0-9][0-9] * 1\.000[2-3][0-9][0-9] * (0| )\.750[1-2][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT10=`$GREP "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2500[0-9][0-9] * 1\.000[2-3][0-9][0-9] * (0| )\.750[1-2][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT11=`$GREP "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.1008[0-9][0-9] * 4\.403[3-4][0-9][0-9] * 3\.302[4-5][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT12=`$GREP "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.1008[0-9][0-9] * 4\.403[3-4][0-9][0-9] * 3\.302[4-5][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT13=`$GREP "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2600[0-9][0-9] * 5\.040[1-2][0-9][0-9] * 3\.7801[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT14=`$GREP "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.822[2-3][0-9][0-9] * 3\.289[0-3][0-9][0-9] * 2\.466[7-9][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT15=`$GREP "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.822[2-3][0-9][0-9] * 3\.289[0-3][0-9][0-9] * 2\.466[7-9][0-9][0-9] * (0| )\.750000" $log | wc -l`
TEST[16]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[16]=15
ERROR[16]="RAMAN PROPERTIES FREQ2 NOT CORRECT"

# Raman optical activity freq2
CRIT1=`$GREP "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.31(58|59|60)[0-9][0-9] * 114\.21[1-2][0-9] * 97\.89[5-6][0-9] * 228\.42[2-4][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.31(58|59|60)[0-9][0-9] * 114\.21[1-2][0-9] * 97\.89[5-6][0-9] * 228\.42[2-4][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.3258[0-9][0-9] * 65\.281[0-9] * 55\.955[0-9] * 130\.562[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * 3328\.2[0-9] * 6\.4696[0-9][0-9] * 5\.6209[0-9][0-9] * 330\.482[0-9] * 33\.725[0-9] * 660\.965[0-9] * (0| )\.102[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0560[0-9][0-9] * (0| )\.392[0-9] * (0| )\.336[0-9] * (0| )\.785[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 1620\.5[0-9] * (0| )\.0007[0-9][0-9] * 1\.7382[0-9][0-9] * 12\.202[0-9] * 10\.429[0-9] * 24\.404[0-9] * (0| )\.854[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0778[0-9][0-9] * (0| )\.544[0-9] * (0| )\.466[0-9] * 1\.089[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * 1168\.6[0-9] * 1\.1682[0-9][0-9] * 10\.1487[0-9][0-9] * 123\.610[0-9] * 60\.892[0-9] * 247\.221[0-9] * (0| )\.492[0-9]" $log | wc -l`
CRIT9=`$GREP "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2500[0-9][0-9] * 1\.750[0-9] * 1\.500[0-9] * 3\.50[0-1][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2500[0-9][0-9] * 1\.750[0-9] * 1\.500[0-9] * 3\.50[0-1][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.1008[0-9][0-9] * 7\.70[5-6][0-9] * 6\.605[0-9] * 15\.41[1-2][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.1008[0-9][0-9] * 7\.70[5-6][0-9] * 6\.605[0-9] * 15\.41[1-2][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT13=`$GREP "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2600[0-9][0-9] * 8\.820[0-9] * 7\.560[0-9] * 17\.640[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT14=`$GREP "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.822[2-3][0-9][0-9] * 5\.75[5-7][0-9] * 4\.93[3-4][0-9] * 11\.51[1-3][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT15=`$GREP "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.822[2-3][0-9][0-9] * 5\.75[5-7][0-9] * 4\.93[3-4][0-9] * 11\.51[1-3][0-9] * (0| )\.857[0-9]" $log | wc -l`
TEST[17]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[17]=15
ERROR[17]="ROA FREQ2 NOT CORRECT"

# Circular intensity difference freq2
CRIT1=`$GREP "11 * 1050\.7[0-9] * (\-0|\-)\.76(05|06|07|08|09|10|11|12|13)[0-9][0-9] * (\-0|\-)\.47(75|76|77|78|79|80|81|82)[0-9][0-9] * (\-0|\-)\.330[4-8][0-9][0-9] * (\-0|\-)\.62(4|5)[0-9][0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "12 * 1050\.7[0-9] * (0| )\.76(05|06|07|08|09|10|11|12|13)[0-9][0-9] * (0| )\.47(75|76|77|78|79|80|81|82)[0-9][0-9] * (0| )\.330[4-8][0-9][0-9] * (0| )\.62(4|5)[0-9][0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "14 * 414\.3[0-9] * (0| )\.03(58|59|60|61|62)[0-9][0-9] * (0| )\.048[3-6][0-9][0-9] * (0| )\.0053[0-9][0-9] * (0| )\.091[4-8][0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "15 * 414\.3[0-9] * (\-0|\-)\.03(58|59|60|61|62)[0-9][0-9] * (\-0|\-)\.048[3-6][0-9][0-9] * (\-0|\-)\.0053[0-9][0-9] * (\-0|\-)\.091[4-8][0-9][0-9]" $log | wc -l`
TEST[18]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[18]=4
ERROR[18]="CIRCULAR INTENSITY DIFFERENCES FREQ2 NOT CORRECT"

# Raman properties freq3
CRIT1=`$GREP "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 64\.59(44|45|46|47|48|49|50|51)[0-9][0-9] * 48\.44(58|59|60|61|62|63)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT2=`$GREP "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 64\.59(44|45|46|47|48|49|50|51)[0-9][0-9] * 48\.44(58|59|60|61|62|63)[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT3=`$GREP "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.2785[0-9][0-9] * 37\.1142[0-9][0-9] * 27\.8356[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT4=`$GREP "4 * 3328\.2[0-9] * 6\.4193[0-9][0-9] * 5\.5412[0-9][0-9] * 311\.0370[0-9][0-9] * 16\.6238[0-9][0-9] * (0| )\.0534[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0553[0-9][0-9] * (0| )\.2215[0-9][0-9] * (0| )\.1661[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT6=`$GREP "6 * 1620\.5[0-9] * (0| )\.0006[0-9][0-9] * 1\.7496[0-9][0-9] * 7\.0283[0-9][0-9] * 5\.2488[0-9][0-9] * (0| )\.7468[0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0777[0-9][0-9] * (0| )\.3109[0-9][0-9] * (0| )\.2332[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT8=`$GREP "8 * 1168\.6[0-9] * 1\.1429[0-9][0-9] * 9\.9262[0-9][0-9] * 91\.1364[0-9][0-9] * 29\.7788[0-9][0-9] * (0| )\.3267[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * (0| )\.975[5-7][0-9][0-9] * (0| )\.7317[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT10=`$GREP "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * (0| )\.975[5-7][0-9][0-9] * (0| )\.7317[0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT11=`$GREP "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 4\.30(09|10)[0-9][0-9] * 3\.225[7-8][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT12=`$GREP "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 4\.30(09|10)[0-9][0-9] * 3\.225[7-8][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT13=`$GREP "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2575[0-9][0-9] * 5\.0(299|300)[0-9][0-9] * 3\.772[4-5][0-9][0-9] * (0| )\.750000" $log | wc -l`
CRIT14=`$GREP "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 3\.25[1-2][0-9][0-9][0-9] * 2\.43[8-9]..[0-9] * (0| )\.750000" $log | wc -l`
CRIT15=`$GREP "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 3\.25[1-2][0-9][0-9][0-9] * 2\.43[8-9]..[0-9] * (0| )\.750000" $log | wc -l`
TEST[19]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[19]=15
ERROR[19]="RAMAN PROPERTIES FREQ3 NOT CORRECT"

# Raman optical activity freq3
CRIT1=`$GREP "1 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 113\.04[0-1][0-9] * 96\.89[1-2][0-9] * 226\.08[0-4][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 3428\.4[0-9] * (0| )\.000000 * 16\.148[6-7][0-9][0-9] * 113\.04[0-1][0-9] * 96\.89[1-2][0-9] * 226\.08[0-4][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 3328\.5[0-9] * (0| )\.000000 * 9\.2785[0-9][0-9] * 64\.949[0-9] * 55\.671[0-9] * 129\.899[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * 3328\.2[0-9] * 6\.4193[0-9][0-9] * 5\.5412[0-9][0-9] * 327\.660[0-9] * 33\.247[0-9] * 655\.321[0-9] * (0| )\.101[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 2178\.9[0-9] * (0| )\.000000 * (0| )\.0553[0-9][0-9] * (0| )\.387[0-9] * (0| )\.332[0-9] * (0| )\.775[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 1620\.5[0-9] * (0| )\.0006[0-9][0-9] * 1\.7496[0-9][0-9] * 12\.277[0-9] * 10\.497[0-9] * 24\.554[0-9] * (0| )\.855[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * 1572\.4[0-9] * (0| )\.000000 * (0| )\.0777[0-9][0-9] * (0| )\.544[0-9] * (0| )\.466[0-9] * 1\.088[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * 1168\.6[0-9] * 1\.1429[0-9][0-9] * 9\.9262[0-9][0-9] * 120\.915[0-9] * 59\.557[0-9] * 241\.830[0-9] * (0| )\.492[0-9]" $log | wc -l`
CRIT9=`$GREP "9 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * 1\.707[0-9] * 1\.463[0-9] * 3\.41[4-5][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * 1140\.1[0-9] * (0| )\.000000 * (0| )\.2439[0-9][0-9] * 1\.707[0-9] * 1\.463[0-9] * 3\.41[4-5][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 7\.526[0-9] * 6\.451[0-9] * 15\.053[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * 1050\.7[0-9] * (0| )\.000000 * 1\.0752[0-9][0-9] * 7\.526[0-9] * 6\.451[0-9] * 15\.053[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT13=`$GREP "13 * 952\.1[0-9] * (0| )\.000000 * 1\.2575[0-9][0-9] * 8\.802[0-9] * 7\.545[0-9] * 17\.605[0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT14=`$GREP "14 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 5\.69[0-1][0-9] * 4\.87[7-9][0-9] * 11\.38[0-3][0-9] * (0| )\.857[0-9]" $log | wc -l`
CRIT15=`$GREP "15 * 414\.3[0-9] * (0| )\.000000 * (0| )\.81(29|30)[0-9][0-9] * 5\.69[0-1][0-9] * 4\.87[7-9][0-9] * 11\.38[0-3][0-9] * (0| )\.857[0-9]" $log | wc -l`
TEST[20]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[20]=15
ERROR[20]="ROA FREQ3 NOT CORRECT"

# Circular intensity difference freq3
CRIT1=`$GREP "11 * 1050\.7[0-9] * (\-0|\-)\.73(4|5)[0-9][0-9][0-9] * (\-0|\-)\.4(598|599|600|601|602)[0-9][0-9] * (\-0|\-)\.3(199|200|201|202|203|204)[0-9][0-9] * (\-0|\-)\.(5995|5996|5997|5998|5999|6000|6001|6002)[0-9][0-9]" $log | wc -l`
CRIT2=`$GREP "12 * 1050\.7[0-9] * (0| )\.73(4|5)[0-9][0-9][0-9] * (0| )\.4(598|599|600|601|602)[0-9][0-9] * (0| )\.3(199|200|201|202|203|204)[0-9][0-9] * (0| )\.(5995|5996|5997|5998|5999|6000|6001|6002)[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "14 * 414\.3[0-9] * (0| )\.034[7-8][0-9][0-9] * (0| )\.046[8-9][0-9][0-9] * (0| )\.005[0-1][0-9][0-9] * (0| )\.088[4-8][0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "15 * 414\.3[0-9] * (\-0|\-)\.034[7-8][0-9][0-9] * (\-0|\-)\.046[8-9][0-9][0-9] * (\-0|\-)\.005[0-1][0-9][0-9] * (\-0|\-)\.088[4-8][0-9][0-9]" $log | wc -l`
TEST[21]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[21]=4
ERROR[21]="CIRCULAR INTENSITY DIFFERENCES FREQ3 NOT CORRECT"

# Isotopic frequencies
CRIT1=`$GREP "1 * A * 3381\.7[0-9] * (0| )\.01540[0-9] * 5\.64[0-9] * (0| )\.133[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * A * 3381\.6[0-9] * (0| )\.01540[0-9] * 8\.40[0-9] * (0| )\.198[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * A * 2509\.9[0-9] * (0| )\.01143[0-9] * 7\.25[0-9] * (0| )\.171[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * A * 2486\.3[0-9] * (0| )\.01132[0-9] * 3\.01[0-9] * (0| )\.071[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * A * 2141\.1[0-9] * (0| )\.00975[0-9] * 109\.70[0-9] * 2\.596[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * A * 1491\.7[0-9] * (0| )\.00679[0-9] * (0| )\.08[0-9] * (0| )\.002[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * A * 1421\.5[0-9] * (0| )\.00647[0-9] * 5\.28[0-9] * (0| )\.125[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * A * 1157\.2[0-9] * (0| )\.00527[0-9] * (0| )\.00[0-9] * (0| )\.0000" $log | wc -l`
CRIT9=`$GREP "9 * A * 1018\.5[0-9] * (0| )\.00464[0-9] * 57\.51[0-9] * 1\.361[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * A * 993\.8[0-9] * (0| )\.00452[0-9] * 6.10[0-9] * (0| )\.144[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * A * 946\.6[0-9] * (0| )\.00431[0-9] * 5\.42[0-9] * (0| )\.128[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * A * 940\.4[0-9] * (0| )\.00428[0-9] * 66\.24[0-9] * 1\.567[0-9]" $log | wc -l`
CRIT13=`$GREP "13 * A * 741\.0[0-9] * (0| )\.00337[0-9] * 9\.04[0-9] * (0| )\.214[0-9]" $log | wc -l`
CRIT14=`$GREP "14 * A * 385\.1[0-9] * (0| )\.00175[0-9] * 14\.65[0-9] * (0| )\.346[0-9]" $log | wc -l`
CRIT15=`$GREP "15 * A * 381\.0[0-9] * (0| )\.00173[0-9] * 14\.76[0-9] * (0| )\.349[0-9]" $log | wc -l`
TEST[22]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15`
CTRL[22]=60
ERROR[22]="ISOTOPIC FREQUENCIES NOT CORRECT"

PASSED=1
for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
     echo ${ERROR[i]}
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi

%EOF%
#######################################################################
