#!/bin/sh
info='
   dft_b3lyp_molhes_nosym 
   ----------------------
   Molecule:         LiOH
   Wave Function:    DFT (B3LYP) / 6-31G** 
   Test Purpose:     Test analytical molecular hessian and dipole
                     gradient with spherical basis functions  
                     
'

molecule='BASIS
6-31G**
LiOH
B3LYP/6-31G** 
    3   0
        3.    1
Li  .0000000000             .0000000000           -2.1946269792
        8.    1
O   .0000000000             .0000000000             .7986363667
        1.    1
H   .0000000000             .0000000000            2.6039702557
'

dalton='**DALTON INPUT
.RUN WAVE FUNCTION
.PROPERTIES
**WAVE FUNCTIONS
.DFT
 B3LYP
*DFT INPUT
! EHT guess goes through very bad densities, do not let it stop you.
.DFTELS
5e-3
**PROPERTIES
.MOLGRA
.MOLHES
.DIPGRA
.VIBANA
*END OF INPUT
'

test='
check_scf_energy DFT -83.328707056761 4e-10

check_mol_gradient 1 "Li    " 0 0 0.0000121851 7e-8
check_mol_gradient 1 "O     " 0 0 0.0000396686 7e-8
check_mol_gradient 1 "H     " 0 0 0.0000009353 9e-8

check_mol_hessian 9 1e-5 "
           Li   x      Li   y      Li   z      O    x      O    y      O    z

 Li   x    0.000800
 Li   y   -0.000000    0.000800
 Li   z    0.000000    0.000000    0.193450

 O    x   -0.002134    0.000000   -0.000000    0.005697
 O    y    0.000000   -0.002134   -0.000000   -0.000000    0.005697
 O    z   -0.000000   -0.000000   -0.193264    0.000000    0.000000    0.765394

 H    x    0.001334   -0.000000    0.000000   -0.003545    0.000000   -0.000000
 H    y   -0.000000    0.001334    0.000000    0.000000   -0.003545   -0.000000
 H    z   -0.000000   -0.000000   -0.000205    0.000000    0.000000   -0.572130


           H    x      H    y      H    z

 H    x    0.002212
 H    y   -0.000000    0.002212
 H    z   -0.000000   -0.000000    0.572335"


check_dip_gradient 3 1e-5 "
        Li   x     0.64481875    -0.00000001    -0.00000001
        Li   y    -0.00000021     0.64481894    -0.00000001
        Li   z     0.00000021     0.00000021     0.69499817

        O    x    -0.91590504     0.00000055     0.00000002
        O    y     0.00000055    -0.91590004     0.00000002
        O    z     0.00000304     0.00000304    -0.81742772

        H    x     0.27108610    -0.00000034    -0.00000001
        H    y    -0.00000034     0.27108610    -0.00000001
        H    z    -0.00000017    -0.00000017     0.12242481"

check_rotational_const 35507.25 1.184394
check_vibr_freqs 1e-5 "
   1      A      3996.42    0.018209     28.473   0.6738
   2      A      1013.90    0.004620     93.866   2.2214
   3      A       265.47    0.001210    140.176   3.3174
   4      A       265.47    0.001210    140.176   3.3174"
'

. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"
