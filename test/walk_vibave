
#######################################################################
#  TEST DESCRIPTION
#######################################################################
#
#*#
#*# walk_vibave
#*# -----------
#*# Molecule:         NH3
#*# Wave Function:    SCF
#*# Test Purpose:     Vibrational average of shieldings, magnetizabilities
#*#                   and polarizabilities
#*#
#
#######################################################################
#  MOLECULE INPUT
#######################################################################
cat > walk_vibave.mol <<%EOF%
BASIS
STO-3G
Vibrational averaging of shieldings, magnetizabilities and polarizabilities
(test62)
    2    0  X  Y  Z    
       7.    1
N          0.6023400            0.00000000              0.00000000
        1.    3
H         -0.1947831            0.899791                1.558484
H         -0.1947831            0.899791               -1.558484
H         -0.1947831           -1.7995826090           -0.000000
%EOF%

#######################################################################
#  DALTON INPUT
#######################################################################
cat > walk_vibave.dal <<%EOF%
**DALTON INPUT
.WALK
*WALK
.NOORTH
.VIBAVE
.DISPLAC
 0.05
.ECKART
N          0.6037353032            0.0000000000            0.0000000000
H         -0.2012451011            0.8886984766            1.5392709141
H         -0.2012451011            0.8886984766           -1.5392709141
H         -0.2012451011           -1.7773969533            0.0000000000
**WAVE FUNCTIONS
.HF
*HF INPUT
.THRESH
1.0D-8
**START
.SHIELD
.MAGNET
.POLARI
*LINRES
.THRESH
1.0D-6
**PROPERTIES
.PRINT
 0
.SHIELD
.MAGNET
.POLARI
*LINRES
.THRESH
1.0D-6
*END OF INPUT
%EOF%
#######################################################################



#######################################################################

#######################################################################
#  CHECK SCRIPT
#######################################################################
echo '#!/bin/ksh
log=$1

if [ `uname` = IRIX64 ]; then
   GREP="egrep"
else
   GREP="egrep -a"
fi

# Basis set
CRIT1=`$GREP "Basis set used is \"STO\-3G\" from the basis set library\." $log | wc -l`
CRIT2=`$GREP "N * 1 * 7 * 15 * 5 * \[6s3p\|2s1p\]" $log | wc -l`
CRIT3=`$GREP "H * 1 * 1 * 3 * 1 * \[3s\|1s\]" $log | wc -l`
CRIT4=`$GREP "total\: * 4 * 10 * 24 * 8" $log | wc -l`
TEST[1]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[1]=6
ERROR[1]="BASIS SET NOT READ CORRECTLY"

# Geometry
CRIT1=`$GREP "Total number of coordinates\: 12" $log | wc -l`
CRIT2=`$GREP "1 * N * x * 0\.6023400000" $log | wc -l`
CRIT3=`$GREP "2 * y * 0\.0000000000" $log | wc -l`
CRIT4=`$GREP "3 * z * 0\.0000000000" $log | wc -l`
CRIT5=`$GREP "4 * H * x * \-0\.1947831000" $log | wc -l`
CRIT6=`$GREP "5 * y * 0\.8997910000" $log | wc -l`
CRIT7=`$GREP "6 * z * 1\.5584840000" $log | wc -l`
CRIT8=`$GREP "7 * H * x * \-0\.1947831000" $log | wc -l`
CRIT9=`$GREP "8 * y * 0\.8997910000" $log | wc -l`
CRIT10=`$GREP "9 * z * \-1\.5584840000" $log | wc -l`
CRIT11=`$GREP "10 * H * x * \-0\.1947831000" $log | wc -l`
CRIT12=`$GREP "11 * y * \-1\.7995826090" $log | wc -l`
CRIT13=`$GREP "12 * z * 0\.0000000000" $log | wc -l`
TEST[2]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13`
CTRL[2]=13
ERROR[2]="GEOMETRY NOT READ CORRECTLY"

# Initial energy
CRIT1=`$GREP "Final * HF energy\: * \-55\.45511933245[0-9]" $log | wc -l`
TEST[3]=`expr	$CRIT1`
CTRL[3]=2
ERROR[3]="INITIAL ENERGY NOT CORRECT"

# Numerical differentiation
CRIT1=`$GREP "Walk type\: Numerical differentiation" $log | wc -l`
CRIT2=`$GREP "Vibrational averaging of * molecular properties at an effective geometry" $log | wc -l`
CRIT3=`$GREP "Molecular properties transformed to the following Eckart frame" $log | wc -l`
CRIT4=`$GREP "N * 0\.6037353032 * 0\.0000000000 * 0\.0000000000" $log | wc -l`
CRIT5=`$GREP "H * \-0\.2012451011 * 0\.8886984766 * 1\.5392709141" $log | wc -l`
CRIT6=`$GREP "H * \-0\.2012451011 * 0\.8886984766 * \-1\.5392709141" $log | wc -l`
CRIT7=`$GREP "H * \-0\.2012451011 * \-1\.7773969533 * 0\.0000000000" $log | wc -l`
TEST[4]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7`
CTRL[4]=14
ERROR[4]="NUMERICAL DIFFERENTIATION NOT SET UP CORRECTLY"

# Inital gradient
CRIT1=`$GREP "N * 0\.006665495[0-9] * 0\.000000190[0-9] * 0\.0000000000" $log | wc -l`
CRIT2=`$GREP "H * \-0\.002221804[0-9] * 0\.004882376[0-9] * 0\.008456546[0-9]" $log | wc -l`
CRIT3=`$GREP "H * \-0\.002221804[0-9] * 0\.004882376[0-9] * \-0\.008456546[0-9]" $log | wc -l`
CRIT4=`$GREP "H * \-0\.002221887[0-9] * \-0\.009764944[0-9] * 0\.0000000000" $log | wc -l`
TEST[5]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[5]=4
ERROR[5]="INITIAL GRADIENT NOT CORRECT"

# Initial Hessian
CRIT1=`$GREP "N * x * 0\.32280[0-9]" $log | wc -l`
CRIT2=`$GREP "N * y * 0\.000000 * 0\.81860[0-9]" $log | wc -l`
CRIT3=`$GREP "N * z * 0\.000000 * 0\.000000 * 0\.81860[0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * \-0\.10760[0-9] * 0\.11963[0-9] * 0\.20720[0-9] * 0\.11013[0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * 0\.06655[0-9] * \-0\.18631[0-9] * \-0\.14992[0-9] * \-0\.08762[0-9] * 0\.18830[0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * 0\.11527[0-9] * \-0\.14992[0-9] * \-0\.35942[0-9] * \-0\.15176[0-9] * 0\.16825[0-9] * 0\.38258[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * \-0\.10760[0-9] * 0\.11963[0-9] * \-0\.20720[0-9] * \-0\.00126[0-9] * \-0\.01094[0-9] * 0\.03064[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * 0\.06655[0-9] * \-0\.18631[0-9] * 0\.14992[0-9] * \-0\.01094[0-9] * 0\.01487[0-9] * \-0\.02869[0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * \-0\.11527[0-9] * 0\.14992[0-9] * \-0\.35942[0-9] * \-0\.03064[0-9] * 0\.02869[0-9] * \-0\.02745[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * \-0\.10760[0-9] * \-0\.23926[0-9] * 0\.000000 * \-0\.00126[0-9] * 0\.03200[0-9] * 0\.00584[0-9]" $log | wc -l`
CRIT11=`$GREP "H * y * \-0\.13311[0-9] * \-0\.44598[0-9] * 0\.000000 * \-0\.02106[0-9] * \-0\.01687[0-9] * 0\.01036[0-9]" $log | wc -l`
CRIT12=`$GREP "H * z * 0\.000000 * 0\.000000 * \-0\.09975[0-9] * \-0\.02479[0-9] * \-0\.04702[0-9] * 0\.00429[0-9]" $log | wc -l`
CRIT13=`$GREP "H * x * 0\.11013[0-9]" $log | wc -l`
CRIT14=`$GREP "H * y * \-0\.08762[0-9] * 0\.18830[0-9]" $log | wc -l`
CRIT15=`$GREP "H * z * 0\.15176[0-9] * \-0\.16825[0-9] * 0\.38258[0-9]" $log | wc -l`
CRIT16=`$GREP "H * x * \-0\.00126[0-9] * 0\.03200[0-9] * \-0\.00584[0-9] * 0\.11013[0-9]" $log | wc -l`
CRIT17=`$GREP "H * y * \-0\.02106[0-9] * \-0\.01687[0-9] * \-0\.01036[0-9] * 0\.17524[0-9] * 0\.47972[0-9]" $log | wc -l`
CRIT18=`$GREP "H * z * 0\.02479[0-9] * 0\.04702[0-9] * 0\.00429[0-9] * 0\.000000 * 0\.000000 * 0\.09116[0-9]" $log | wc -l`
TEST[6]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18`
CTRL[6]=18
ERROR[6]="INITIAL HESSIAN NOT CORRECT"

# Initial static polarizabilities
CRIT1=`$GREP "Ex * 1\.39498[0-9] * 0\.000000 * 0\.000000" $log | wc -l`
CRIT2=`$GREP "Ey * 0\.000000 * 5\.71948[0-9] * 0\.000000" $log | wc -l`
CRIT3=`$GREP "Ez * 0\.000000 * 0\.000000 * 5\.71948[0-9]" $log | wc -l`
TEST[7]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[7]=3
ERROR[7]="INITIAL STATIC POLARIZABILITIES NOT CORRECT"

# Initial magnetizabilities
CRIT1=`$GREP "Isotropic magnetizability\: * \-3\.241[0-9] * \-255\.779[0-9] * \-15\.403[0-9]" $log | wc -l`
CRIT2=`$GREP "Diamagnetic contribution\: * \-4\.261[0-9] * \-336\.281[0-9] * \-20\.251[0-9]" $log | wc -l`
CRIT3=`$GREP "Paramagnetic contribution\: * 1\.020[0-9] * 80\.502[0-9] * 4\.848[0-9]" $log | wc -l`
CRIT4=`$GREP "Parallel component\: * \-3\.223[0-9] * \-254\.386[0-9] * \-15\.319[0-9]" $log | wc -l`
CRIT5=`$GREP "Perpendicular component\: * \-3\.250[0-9] * \-256\.475[0-9] * \-15\.445[0-9]" $log | wc -l`
CRIT6=`$GREP "Anisotropy\: * 0\.026[0-9] * 2\.089[0-9] * 0\.125[0-9]" $log | wc -l`
TEST[8]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[8]=6
ERROR[8]="INITIAL MAGNETIZABILITIES NOT CORRECT"

# Initial g-factor
CRIT1=`$GREP "Isotropic g\-factor * \: * 0\.4503330[0-9]" $log | wc -l`
CRIT2=`$GREP "Nuclear contribution * \: * 0\.9851315[0-9]" $log | wc -l`
CRIT3=`$GREP "Electronic contribution * \: * \-0\.1077988[0-9]" $log | wc -l`
CRIT4=`$GREP "Parallel component\: * 0\.4139216[0-9]" $log | wc -l`
CRIT5=`$GREP "Perpendicular component\: * 0\.4685387[0-9]" $log | wc -l`
CRIT6=`$GREP "Anisotropy\: * \-0\.0546170[0-9]" $log | wc -l`
TEST[9]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[9]=6
ERROR[9]="INITIAL G-FACTOR NOT CORRECT"

# Initial shielding tensor
CRIT1=`$GREP "N * x * 290\.4388716[0-9] * \-0\.0000005[0-9] * 0\.00000000" $log | wc -l`
CRIT2=`$GREP "N * y * \-0\.0000016[0-9] * 304\.4396995[0-9] * 0\.00000000" $log | wc -l`
CRIT3=`$GREP "N * z * 0\.00000000 * 0\.00000000 * 304\.4396562[0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * 27\.6577549[0-9] * \-1\.7829960[0-9] * \-3\.0882401[0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * \-2\.4848602[0-9] * 31\.7263868[0-9] * 4\.9251800[0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * \-4\.3039051[0-9] * 4\.9251802[0-9] * 37\.4134947[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * 27\.6577549[0-9] * \-1\.7829960[0-9] * 3\.0882401[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * \-2\.4848602[0-9] * 31\.7263868[0-9] * \-4\.9251800[0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * 4\.3039051[0-9] * \-4\.9251802[0-9] * 37\.4134947[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * 27\.6577506[0-9] * 3\.5659907[0-9] * 0\.00000000" $log | wc -l`
CRIT11=`$GREP "H * z * 0\.00000000 * 0\.00000000 * 28\.8828308[0-9]" $log | wc -l`
TEST[10]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11`
CTRL[10]=33
ERROR[10]="INITIAL SHIELDING TENSOR NOT CORRECT"

# Initial chemical shielding for nitrogen
CRIT1=`$GREP "Shielding constant\: * 299\.772[0-9] ppm" $log | wc -l`
CRIT2=`$GREP "Anisotropy\: * \-14\.000[0-9] ppm" $log | wc -l`
CRIT3=`$GREP "S parameter\: * 14\.000[0-9] ppm" $log | wc -l`
TEST[11]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[11]=3
ERROR[11]="INITIAL CHEMICAL SHIELDING FOR NITROGEN NOT CORRECT"

# Initial chemical shielding for hydrogen
CRIT1=`$GREP "Shielding constant\: * 32\.265[0-9] ppm" $log | wc -l`
CRIT2=`$GREP "Anisotropy\: * 13\.951[0-9] ppm" $log | wc -l`
CRIT3=`$GREP "S parameter\: * 14\.122[0-9] ppm" $log | wc -l`
CRIT4=`$GREP "A parameter\: * 0\.701[0-9] ppm" $log | wc -l`
CRIT5=`$GREP "H * x * 27\.6577549[0-9] * \-1\.7829960[0-9] * \-3\.0882401[0-9]" $log | wc -l`
CRIT6=`$GREP "H * y * \-2\.4848602[0-9] * 31\.7263868[0-9] * 4\.9251800[0-9]" $log | wc -l`
CRIT7=`$GREP "H * z * \-4\.3039051[0-9] * 4\.9251802[0-9] * 37\.4134947[0-9]" $log | wc -l`
TEST[12]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7`
CTRL[12]=21
ERROR[12]="INITIAL CHEMICAL SHIELDING FOR HYDROGEN NOT CORRECT"

# Summary of initial shieldings
CRIT1=`$GREP "\@1N * 299\.772[0-9] * 415\.185[0-9] \-115\.412[0-9] * \-1\.000[0-9] * 14\.000[0-9] * 7\.000[0-9] * 3\.000[0-9]" $log | wc -l`
CRIT2=`$GREP "\@1H * 32\.265[0-9] * 31\.674[0-9] * 0\.591[0-9] * 0\.666[0-9] * 15\.218[0-9] * 13\.951[0-9] * 0\.272[0-9]" $log | wc -l`
CRIT3=`$GREP "\@2N * 299\.772[0-9] * 415\.185[0-9] \-115\.412[0-9] * \-14\.000[0-9] * 0\.000[0-9] * 14\.000[0-9] * 0\.000[0-9]" $log | wc -l`
CRIT4=`$GREP "\@2H * 32\.265[0-9] * 31\.674[0-9] * 0\.591[0-9] * 13\.951[0-9] * 0\.272[0-9] * 14\.122[0-9] * 0\.701[0-9]" $log | wc -l`
TEST[13]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[13]=8
ERROR[13]="SUMMARY OF INITIAL SHIELDINGS NOT CORRECT"

# Projected gradient
CRIT1=`$GREP "Norm of projected gradient * 0\.01858[0-9]" $log | wc -l`
TEST[14]=`expr	$CRIT1`
CTRL[14]=1
ERROR[14]="PROJECTED GRADIENT NOT CORRECT"

# Projected Hessian
CRIT1=`$GREP "1 * 0\.3228005[0-9] * \-0\.0000002[0-9] * 0\.0000000[0-9] * \-0\.1076002[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * \-0\.0000002[0-9] * 0\.8175087[0-9] * 0\.0000000[0-9] * 0\.1207049[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0\.0000000[0-9] * 0\.0000000[0-9] * 0\.8175093[0-9] * 0\.2090671[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * \-0\.1076002[0-9] * 0\.1207049[0-9] * 0\.2090671[0-9] * 0\.1071549[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 0\.0665559[0-9] * \-0\.1859448[0-9] * \-0\.1499231[0-9] * \-0\.0879808[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 0\.1152783[0-9] * \-0\.1499232[0-9] * \-0\.3590613[0-9] * \-0\.1523873[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * \-0\.1076002[0-9] * 0\.1207049[0-9] * \-0\.2090671[0-9] * 0\.0002226[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * 0\.0665559[0-9] * \-0\.1859448[0-9] * 0\.1499231[0-9] * \-0\.0112991[0-9]" $log | wc -l`
CRIT9=`$GREP "9 * \-0\.1152783[0-9] * 0\.1499232[0-9] * \-0\.3590613[0-9] * \-0\.0312629[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * \-0\.1076000[0-9] * \-0\.2414096[0-9] * 0\.0000000[0-9] * 0\.0002226[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * \-0\.1331116[0-9] * \-0\.4456190[0-9] * 0\.0000000[0-9] * \-0\.0214249[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * 0\.0000000[0-9] * 0\.0000000[0-9] * \-0\.0993866[0-9] * \-0\.0254168[0-9]" $log | wc -l`
CRIT13=`$GREP "1 * 0\.0665559[0-9] * 0\.1152783[0-9] * \-0\.1076002[0-9] * 0\.0665559[0-9]" $log | wc -l`
CRIT14=`$GREP "2 * \-0\.1859448[0-9] * \-0\.1499232[0-9] * 0\.1207049[0-9] * \-0\.1859448[0-9]" $log | wc -l`
CRIT15=`$GREP "3 * \-0\.1499231[0-9] * \-0\.3590613[0-9] * \-0\.2090671[0-9] * 0\.1499231[0-9]" $log | wc -l`
CRIT16=`$GREP "4 * \-0\.0879808[0-9] * \-0\.1523873[0-9] * 0\.0002226[0-9] * \-0\.0112991[0-9]" $log | wc -l`
CRIT17=`$GREP "5 * 0\.1868274[0-9] * 0\.1690357[0-9] * \-0\.0112991[0-9] * 0\.0161106[0-9]" $log | wc -l`
CRIT18=`$GREP "6 * 0\.1690357[0-9] * 0\.3820131[0-9] * 0\.0312629[0-9] * \-0\.0294765[0-9]" $log | wc -l`
CRIT19=`$GREP "7 * \-0\.0112991[0-9] * 0\.0312629[0-9] * 0\.1071549[0-9] * \-0\.0879808[0-9]" $log | wc -l`
CRIT20=`$GREP "8 * 0\.0161106[0-9] * \-0\.0294765[0-9] * \-0\.0879808[0-9] * 0\.1868274[0-9]" $log | wc -l`
CRIT21=`$GREP "9 * 0\.0294765[0-9] * \-0\.0280278[0-9] * 0\.1523873[0-9] * \-0\.1690357[0-9]" $log | wc -l`
CRIT22=`$GREP "10 * 0\.0327240[0-9] * 0\.0058461[0-9] * 0\.0002226[0-9] * 0\.0327240[0-9]" $log | wc -l`
CRIT23=`$GREP "11 * \-0\.0169932[0-9] * 0\.0103640[0-9] * \-0\.0214249[0-9] * \-0\.0169932[0-9]" $log | wc -l`
CRIT24=`$GREP "12 * \-0\.0485890[0-9] * 0\.0050760[0-9] * 0\.0254168[0-9] * 0\.0485890[0-9]" $log | wc -l`
CRIT25=`$GREP "1 * \-0\.1152783[0-9] * \-0\.1076000[0-9] * \-0\.1331116[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT26=`$GREP "2 * 0\.1499232[0-9] * \-0\.2414096[0-9] * \-0\.4456190[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT27=`$GREP "3 * \-0\.3590613[0-9] * 0\.0000000[0-9] * 0\.0000000[0-9] * \-0\.0993866[0-9]" $log | wc -l`
CRIT28=`$GREP "4 * \-0\.0312629[0-9] * 0\.0002226[0-9] * \-0\.0214249[0-9] * \-0\.0254168[0-9]" $log | wc -l`
CRIT29=`$GREP "5 * 0\.0294765[0-9] * 0\.0327240[0-9] * \-0\.0169932[0-9] * \-0\.0485890[0-9]" $log | wc -l`
CRIT30=`$GREP "6 * \-0\.0280278[0-9] * 0\.0058461[0-9] * 0\.0103640[0-9] * 0\.0050760[0-9]" $log | wc -l`
CRIT31=`$GREP "7 * 0\.1523873[0-9] * 0\.0002226[0-9] * \-0\.0214249[0-9] * 0\.0254168[0-9]" $log | wc -l`
CRIT32=`$GREP "8 * \-0\.1690357[0-9] * 0\.0327240[0-9] * \-0\.0169932[0-9] * 0\.0485890[0-9]" $log | wc -l`
CRIT33=`$GREP "9 * 0\.3820131[0-9] * \-0\.0058461[0-9] * \-0\.0103640[0-9] * 0\.0050760[0-9]" $log | wc -l`
CRIT34=`$GREP "10 * \-0\.0058461[0-9] * 0\.1071547[0-9] * 0\.1759615[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT35=`$GREP "11 * \-0\.0103640[0-9] * 0\.1759615[0-9] * 0\.4796055[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT36=`$GREP "12 * 0\.0050760[0-9] * 0\.0000000[0-9] * 0\.0000000[0-9] * 0\.0892346[0-9]" $log | wc -l`
TEST[15]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
		$CRIT25 \+ $CRIT26 \+ $CRIT27 \+ $CRIT28 \+ $CRIT29 \+ $CRIT30 \+ \
		$CRIT31 \+ $CRIT32 \+ $CRIT33 \+ $CRIT34 \+ $CRIT35 \+ $CRIT36`
CTRL[15]=36
ERROR[15]="PROJECTED HESSIAN NOT CORRECT"

# Energy at effective geometry
CRIT1=`$GREP "Energy at effective geometry\: * \-55\.455119332[0-9]" $log | wc -l`
TEST[16]=`expr	$CRIT1`
CTRL[16]=1
ERROR[16]="ENERGY AT EFFECTIVE GEOMETRY NOT CORRECT"

# Gradient at effective geometry
CRIT1=`$GREP "1 * 0\.0066655[0-9] * 0\.0000001[0-9] * 0\.00000000 * \-0\.0022218[0-9]" $log | wc -l`
CRIT2=`$GREP "1 * 0\.0048823[0-9] * 0\.0084565[0-9] * \-0\.0022218[0-9] * 0\.0048823[0-9]" $log | wc -l`
CRIT3=`$GREP "1 * \-0\.0084565[0-9] * \-0\.0022218[0-9] * \-0\.0097649[0-9] * 0\.00000000" $log | wc -l`
TEST[17]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[17]=3
ERROR[17]="GRADIENT AT EFFECTIVE GEOMETRY NOT CORRECT"

# Hessian at effective geometry
CRIT1=`$GREP "1 * 0\.3228005[0-9] * \-0\.0000002[0-9] * 0\.0000000[0-9] * \-0\.1076002[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * \-0\.0000002[0-9] * 0\.8175087[0-9] * 0\.0000000[0-9] * 0\.1207049[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0\.0000000[0-9] * 0\.0000000[0-9] * 0\.8175093[0-9] * 0\.2090671[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * \-0\.1076002[0-9] * 0\.1207049[0-9] * 0\.2090671[0-9] * 0\.1071549[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 0\.0665559[0-9] * \-0\.1859448[0-9] * \-0\.1499231[0-9] * \-0\.0879808[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 0\.1152783[0-9] * \-0\.1499232[0-9] * \-0\.3590613[0-9] * \-0\.1523873[0-9]" $log | wc -l`
CRIT7=`$GREP "7 * \-0\.1076002[0-9] * 0\.1207049[0-9] * \-0\.2090671[0-9] * 0\.0002226[0-9]" $log | wc -l`
CRIT8=`$GREP "8 * 0\.0665559[0-9] * \-0\.1859448[0-9] * 0\.1499231[0-9] * \-0\.0112991[0-9]" $log | wc -l`
CRIT9=`$GREP "9 * \-0\.1152783[0-9] * 0\.1499232[0-9] * \-0\.3590613[0-9] * \-0\.0312629[0-9]" $log | wc -l`
CRIT10=`$GREP "10 * \-0\.1076000[0-9] * \-0\.2414096[0-9] * 0\.0000000[0-9] * 0\.0002226[0-9]" $log | wc -l`
CRIT11=`$GREP "11 * \-0\.1331116[0-9] * \-0\.4456190[0-9] * 0\.0000000[0-9] * \-0\.0214249[0-9]" $log | wc -l`
CRIT12=`$GREP "12 * 0\.0000000[0-9] * 0\.0000000[0-9] * \-0\.0993866[0-9] * \-0\.0254168[0-9]" $log | wc -l`
CRIT13=`$GREP "1 * 0\.0665559[0-9] * 0\.1152783[0-9] * \-0\.1076002[0-9] * 0\.0665559[0-9]" $log | wc -l`
CRIT14=`$GREP "2 * \-0\.1859448[0-9] * \-0\.1499232[0-9] * 0\.1207049[0-9] * \-0\.1859448[0-9]" $log | wc -l`
CRIT15=`$GREP "3 * \-0\.1499231[0-9] * \-0\.3590613[0-9] * \-0\.2090671[0-9] * 0\.1499231[0-9]" $log | wc -l`
CRIT16=`$GREP "4 * \-0\.0879808[0-9] * \-0\.1523873[0-9] * 0\.0002226[0-9] * \-0\.0112991[0-9]" $log | wc -l`
CRIT17=`$GREP "5 * 0\.1868274[0-9] * 0\.1690357[0-9] * \-0\.0112991[0-9] * 0\.0161106[0-9]" $log | wc -l`
CRIT18=`$GREP "6 * 0\.1690357[0-9] * 0\.3820131[0-9] * 0\.0312629[0-9] * \-0\.0294765[0-9]" $log | wc -l`
CRIT19=`$GREP "7 * \-0\.0112991[0-9] * 0\.0312629[0-9] * 0\.1071549[0-9] * \-0\.0879808[0-9]" $log | wc -l`
CRIT20=`$GREP "8 * 0\.0161106[0-9] * \-0\.0294765[0-9] * \-0\.0879808[0-9] * 0\.1868274[0-9]" $log | wc -l`
CRIT21=`$GREP "9 * 0\.0294765[0-9] * \-0\.0280278[0-9] * 0\.1523873[0-9] * \-0\.1690357[0-9]" $log | wc -l`
CRIT22=`$GREP "10 * 0\.0327240[0-9] * 0\.0058461[0-9] * 0\.0002226[0-9] * 0\.0327240[0-9]" $log | wc -l`
CRIT23=`$GREP "11 * \-0\.0169932[0-9] * 0\.0103640[0-9] * \-0\.0214249[0-9] * \-0\.0169932[0-9]" $log | wc -l`
CRIT24=`$GREP "12 * \-0\.0485890[0-9] * 0\.0050760[0-9] * 0\.0254168[0-9] * 0\.0485890[0-9]" $log | wc -l`
CRIT25=`$GREP "1 * \-0\.1152783[0-9] * \-0\.1076000[0-9] * \-0\.1331116[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT26=`$GREP "2 * 0\.1499232[0-9] * \-0\.2414096[0-9] * \-0\.4456190[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT27=`$GREP "3 * \-0\.3590613[0-9] * 0\.0000000[0-9] * 0\.0000000[0-9] * \-0\.0993866[0-9]" $log | wc -l`
CRIT28=`$GREP "4 * \-0\.0312629[0-9] * 0\.0002226[0-9] * \-0\.0214249[0-9] * \-0\.0254168[0-9]" $log | wc -l`
CRIT29=`$GREP "5 * 0\.0294765[0-9] * 0\.0327240[0-9] * \-0\.0169932[0-9] * \-0\.0485890[0-9]" $log | wc -l`
CRIT30=`$GREP "6 * \-0\.0280278[0-9] * 0\.0058461[0-9] * 0\.0103640[0-9] * 0\.0050760[0-9]" $log | wc -l`
CRIT31=`$GREP "7 * 0\.1523873[0-9] * 0\.0002226[0-9] * \-0\.0214249[0-9] * 0\.0254168[0-9]" $log | wc -l`
CRIT32=`$GREP "8 * \-0\.1690357[0-9] * 0\.0327240[0-9] * \-0\.0169932[0-9] * 0\.0485890[0-9]" $log | wc -l`
CRIT33=`$GREP "9 * 0\.3820131[0-9] * \-0\.0058461[0-9] * \-0\.0103640[0-9] * 0\.0050760[0-9]" $log | wc -l`
CRIT34=`$GREP "10 * \-0\.0058461[0-9] * 0\.1071547[0-9] * 0\.1759615[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT35=`$GREP "11 * \-0\.0103640[0-9] * 0\.1759615[0-9] * 0\.4796055[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT36=`$GREP "12 * 0\.0050760[0-9] * 0\.0000000[0-9] * 0\.0000000[0-9] * 0\.0892346[0-9]" $log | wc -l`
TEST[18]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
		$CRIT25 \+ $CRIT26 \+ $CRIT27 \+ $CRIT28 \+ $CRIT29 \+ $CRIT30 \+ \
		$CRIT31 \+ $CRIT32 \+ $CRIT33 \+ $CRIT34 \+ $CRIT35 \+ $CRIT36`
CTRL[18]=36
ERROR[18]="HESSIAN AT EFFECTIVE GEOMETRY NOT CORRECT"

# Dipole moment at effective geometry
CRIT1=`$GREP "1 * \-0\.7279563[0-9] * \-0\.0000000[0-9] * 0\.00000000" $log | wc -l`
TEST[19]=`expr	$CRIT1`
CTRL[19]=1
ERROR[19]="DIPOLE MOMENT AT EFFECTIVE GEOMETRY NOT CORRECT"

# Magnetizabilities at effective geometry
CRIT1=`$GREP "Bx * \-3\.2237416750[0-9][0-9] * 0\.0000000545[0-9][0-9] * 0\.000000000000" $log | wc -l`
CRIT2=`$GREP "By * 0\.0000000545[0-9][0-9] * \-3\.2502155558[0-9][0-9] * 0\.000000000000" $log | wc -l`
TEST[20]=`expr	$CRIT1 \+ $CRIT2`
CTRL[20]=2
ERROR[20]="MAGNETIZABILITIES AT EFFECTIVE GEOMETRY NOT CORRECT"

# g-tensor at effective geometry
CRIT1=`$GREP "Bx * 0\.4139216708[0-9][0-9] * \-0\.0000000062[0-9][0-9] * 0\.000000000000" $log | wc -l`
CRIT2=`$GREP "By * \-0\.0000000128[0-9][0-9] * 0\.4685387625[0-9][0-9] * 0\.000000000000" $log | wc -l`
CRIT3=`$GREP "Bz * 0\.000000000000 * 0\.000000000000 * 0\.4685386890[0-9][0-9]" $log | wc -l`
TEST[21]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[21]=3
ERROR[21]="G-TENSOR AT EFFECTIVE GEOMETRY NOT CORRECT"

# Chemical shielding tensors at effective geometry
CRIT1=`$GREP "N * x * 290\.4388716[0-9] * \-0\.0000005[0-9] * 0\.00000000" $log | wc -l`
CRIT2=`$GREP "N * y * \-0\.0000016[0-9] * 304\.4396995[0-9] * 0\.00000000" $log | wc -l`
CRIT3=`$GREP "N * z * 0\.00000000 * 0\.00000000 * 304\.4396562[0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * 27\.6577549[0-9] * \-1\.7829960[0-9] * \-3\.0882401[0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * \-2\.4848602[0-9] * 31\.7263868[0-9] * 4\.9251800[0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * \-4\.3039051[0-9] * 4\.9251802[0-9] * 37\.4134947[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * 27\.6577549[0-9] * \-1\.7829960[0-9] * 3\.0882401[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * \-2\.4848602[0-9] * 31\.7263868[0-9] * \-4\.9251800[0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * 4\.3039051[0-9] * \-4\.9251802[0-9] * 37\.4134947[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * 27\.6577506[0-9] * 3\.5659907[0-9] * 0\.00000000" $log | wc -l`
CRIT11=`$GREP "H * z * 0\.00000000 * 0\.00000000 * 28\.8828308[0-9]" $log | wc -l`
TEST[22]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11`
CTRL[22]=33
ERROR[22]="CHEMICAL SHIELDING TENSORS AT EFFECTIVE GEOMETRY NOT CORRECT"

# Polarizability at effective geometry
CRIT1=`$GREP "Bx * 1\.3949847841[0-9][0-9] * 0\.0000004601[0-9][0-9] * 0\.000000000000" $log | wc -l`
CRIT2=`$GREP "By * 0\.0000004601[0-9][0-9] * 5\.7194861051[0-9][0-9] * 0\.000000000000" $log | wc -l`
CRIT3=`$GREP "Bz * 0\.000000000000 * 0\.000000000000 * 5\.7194848598[0-9][0-9]" $log | wc -l`
TEST[23]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[23]=3
ERROR[23]="POLARIZABILITY AT EFFECTIVE GEOMETRY NOT CORRECT"

# Energy at first displacement
CRIT1=`$GREP "Final * HF energy\: * \-55\.45435632873[0-9]" $log | wc -l`
TEST[24]=`expr	$CRIT1`
CTRL[24]=1
ERROR[24]="ENERGY AT FIRST DISPLACEMENT NOT CORRECT"

# Gradient at first displacement
CRIT1=`$GREP "N * 0\.005844773[0-9] * 0\.001022434[0-9] * \-0\.032619881[0-9]" $log | wc -l`
CRIT2=`$GREP "H * \-0\.010168151[0-9] * 0\.013984019[0-9] * 0\.024066458[0-9]" $log | wc -l`
CRIT3=`$GREP "H * 0\.006573799[0-9] * \-0\.005224949[0-9] * 0\.008768381[0-9]" $log | wc -l`
CRIT4=`$GREP "H * \-0\.002250421[0-9] * \-0\.009781504[0-9] * \-0\.000214958[0-9]" $log | wc -l`
TEST[25]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[25]=4
ERROR[25]="GRADIENT AT FIRST DISPLACEMENT NOT CORRECT"

# Differentiation complete
CRIT1=`$GREP "All displacements are now done \- numerical differentiation is complete\." $log | wc -l`
TEST[26]=`expr	$CRIT1`
CTRL[26]=1
ERROR[26]="NUMERICAL DIFFERENTIATION NOT COMPLETED"

# Dipole moment second derivatives
CRIT1=`$GREP "1 * \-0\.06908[0-9] * \-0\.07175[0-9] * \-0\.00000[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * \-0\.06908[0-9] * 0\.07190[0-9] * 0\.00000[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0\.03091[0-9] * 0\.00000[0-9] * 0\.000000" $log | wc -l`
CRIT4=`$GREP "4 * 0\.00271[0-9] * \-0\.00570[0-9] * 0\.00000[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 0\.00271[0-9] * 0\.00568[0-9] * \-0\.00000[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 0\.40822[0-9] * 0\.000000 * 0\.000000" $log | wc -l`
TEST[27]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[27]=6
ERROR[27]="DIPOLE MOMENT SECOND DERIVATIVES NOT CORRECT"

# Magnetizability tensor second derivatives
CRIT1=`$GREP "1 * 0\.26573[0-9] * 0\.08441[0-9] * 0\.63832[0-9] * 0\.00000[0-9] * 0\.00003[0-9] * 0\.15417[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 0\.26573[0-9] * \-0\.08455[0-9] * 0\.15415[0-9] * \-0\.00000[0-9] * \-0\.00002[0-9] * 0\.63834[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0\.27939[0-9] * 0\.00009[0-9] * 0\.51023[0-9] * 0\.000000 * 0\.00000[0-9] * 0\.51023[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * \-0\.37222[0-9] * 0\.16617[0-9] * 0\.02681[0-9] * \-0\.00011[0-9] * \-0\.00000[0-9] * 0\.04992[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * \-0\.37222[0-9] * \-0\.16640[0-9] * 0\.04985[0-9] * 0\.00011[0-9] * \-0\.00023[0-9] * 0\.02687[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * \-0\.14493[0-9] * 0\.00000[0-9] * \-0\.44127[0-9] * 0\.000000 * 0\.000000 * \-0\.44127[0-9]" $log | wc -l`
TEST[28]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[28]=6
ERROR[28]="MAGNETIZABILITY TENSOR SECOND DERIVATIVES NOT CORRECT"

# Rotational g tensor second derivatives
CRIT1=`$GREP "1 * \-0\.12149[0-9] * \-0\.09387[0-9] * \-0\.40308[0-9] * \-0\.00000[0-9] * \-0\.00001[0-9] * \-0\.00489[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * \-0\.12148[0-9] * 0\.09397[0-9] * \-0\.00487[0-9] * 0\.00000[0-9] * 0\.00001[0-9] * \-0\.40309[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0\.01324[0-9] * \-0\.00004[0-9] * \-0\.08276[0-9] * 0\.000000 * \-0\.00000[0-9] * \-0\.08276[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * 0\.08137[0-9] * \-0\.08885[0-9] * \-0\.13553[0-9] * 0\.00006[0-9] * 0\.00001[0-9] * \-0\.16419[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 0\.08137[0-9] * 0\.08894[0-9] * \-0\.16416[0-9] * \-0\.00006[0-9] * 0\.00014[0-9] * \-0\.13556[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 0\.03622[0-9] * 0\.000000 * 0\.20905[0-9] * 0\.000000 * 0\.000000 * 0\.20905[0-9]" $log | wc -l`
TEST[29]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[29]=6
ERROR[29]="G-TENSOR SECOND DERIVATIVES NOT CORRECT"

# Nuclear shielding tensor second derivatives for nitrogen
CRIT1=`$GREP "1 * \-35\.820 * \-3\.870 * 0\.000 \-11\.571\-167\.207 * \-0\.037 * \-0\.026 * \-0\.055 \-31\.918" $log | wc -l`
CRIT2=`$GREP "2 * \-35\.825 * 3\.805 * 0\.000 * 11\.533 \-31\.960 * 0\.026 * 0\.001 * 0\.049\-167\.204" $log | wc -l`
CRIT3=`$GREP "3 * \-47\.403 * \-0\.067 * 0\.000 * 0\.000 \-92\.415 * \-0\.002 * 0\.000 * 0\.002 \-92\.415" $log | wc -l`
CRIT4=`$GREP "4 * 56\.124 \-60\.813 * 0\.041 * \-4\.056 \-35\.214 * \-0\.009 * 0\.003 * \-0\.009 \-10\.149" $log | wc -l`
CRIT5=`$GREP "5 * 56\.083 * 61\.004 * \-0\.041 * 4\.795 \-10\.457 * 0\.205 * \-0\.003 * 0\.011 \-35\.210" $log | wc -l`
CRIT6=`$GREP "6 * \-1\.631 * \-0\.001 * 0\.000 * 0\.072 * 39\.824 * 0\.000 * 0\.000 * 0\.000 * 39\.739" $log | wc -l`
TEST[30]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[30]=6
ERROR[30]="NUCLEAR SHIELDING TENSOR SECOND DERIVATIVES FOR NITROGEN NOT CORRECT"

# Nuclear shielding tensor second derivatives for hydrogen1
CRIT1=`$GREP "1 * 6\.221 * 0\.015 * 1\.541 * 1\.853 * 2\.037 * \-4\.876 * 0\.840 * \-1\.603 * 5\.597" $log | wc -l`
CRIT2=`$GREP "2 * 1\.912 * 1\.605 * 1\.242 * \-0\.010 * 1\.749 * 0\.286 * 2\.325 * \-3\.019 * \-7\.094" $log | wc -l`
CRIT3=`$GREP "3 * 8\.900 * \-0\.820 * \-1\.423 * \-1\.920 * 7\.708 * 3\.210 * \-3\.326 * 3\.210 * 11\.416" $log | wc -l`
CRIT4=`$GREP "4 * \-2\.756 * \-0\.306 * \-2\.449 * 1\.389 * \-0\.656 * \-1\.826 * 0\.851 * 0\.995 * \-5\.457" $log | wc -l`
CRIT5=`$GREP "5 * \-9\.239 * 0\.491 * 2\.780 * 0\.949 * \-6\.419 * \-2\.289 * 3\.127 * \-5\.073 * \-6\.391" $log | wc -l`
CRIT6=`$GREP "6 * \-0\.741 * 0\.898 * 1\.556 * 0\.425 * \-4\.259 * 0\.456 * 0\.713 * 0\.442 * \-3\.736" $log | wc -l`
TEST[31]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[31]=6
ERROR[31]="NUCLEAR SHIELDING TENSOR SECOND DERIVATIVES FOR HYDROGEN1 NOT CORRECT"

# Nuclear shielding tensor second derivatives for hydrogen3
CRIT1=`$GREP "1 * \-0\.267 * \-2\.137 * 0\.000 * \-2\.200 \-10\.044 * 0\.011 * 0\.004 * \-0\.005 * \-1\.820" $log | wc -l`
CRIT2=`$GREP "2 * 8\.350 * \-1\.071 * 0\.000 * \-1\.471 * 5\.886 * \-0\.001 * 0\.003 * 0\.001 * 8\.210" $log | wc -l`
CRIT3=`$GREP "3 * 8\.886 * 1\.643 * \-0\.002 * 3\.840 * 13\.269 * 0\.000 * 0\.000 * 0\.000 * 5\.855" $log | wc -l`
CRIT4=`$GREP "4 * \-12\.496 * \-5\.112 * \-0\.001 * \-4\.033 \-12\.075 * 0\.003 * \-0\.001 * 0\.000 * \-4\.145" $log | wc -l`
CRIT5=`$GREP "5 * 0\.491 * 4\.750 * 0\.001 * \-0\.675 * \-2\.077 * \-0\.009 * 0\.001 * 0\.000 * \-0\.602" $log | wc -l`
CRIT6=`$GREP "6 * \-0\.741 * \-1\.796 * 0\.000 * \-0\.853 * \-3\.464 * 0\.000 * 0\.000 * 0\.000 * \-4\.550" $log | wc -l`
TEST[32]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[32]=6
ERROR[32]="NUCLEAR SHIELDING TENSOR SECOND DERIVATIVES FOR HYDROGEN3 NOT CORRECT"

# Polarizability second derivatives
CRIT1=`$GREP "1 * 0\.67353[0-9] * \-1\.13960[0-9] * 1\.38382[0-9] * \-0\.00005[0-9] * 0\.00003[0-9] * 3\.12727[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 0\.67353[0-9] * 1\.13964[0-9] * 3\.12706[0-9] * 0\.00005[0-9] * \-0\.00004[0-9] * 1\.38403[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0\.62869[0-9] * 0\.00000[0-9] * 4\.35289[0-9] * 0\.000000 * 0\.000000 * 4\.35285[0-9]" $log | wc -l`
CRIT4=`$GREP "4 * 0\.28555[0-9] * 0\.25708[0-9] * 1\.39738[0-9] * \-0\.00017[0-9] * \-0\.00000[0-9] * 1\.42150[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * 0\.28555[0-9] * \-0\.25708[0-9] * 1\.42137[0-9] * 0\.00017[0-9] * 0\.00000[0-9] * 1\.39752[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * 2\.83143[0-9] * \-0\.00000[0-9] * 0\.52963[0-9] * 0\.000000 * 0\.000000 * 0\.52962[0-9]" $log | wc -l`
TEST[33]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[33]=6
ERROR[33]="POLARIZABILITY SECOND DERIVATIVES NOT CORRECT"

# Vibrationally averaged dipole moment
CRIT1=`$GREP "X * \-0\.7279563[0-9] * 0\.0079296[0-9] * \-0\.7200266[0-9]" $log | wc -l`
CRIT2=`$GREP "Y * \-0\.0000000[0-9] * 0\.0000009[0-9] * 0\.0000009[0-9]" $log | wc -l`
TEST[34]=`expr	$CRIT1 \+ $CRIT2`
CTRL[34]=2
ERROR[34]="VIBRATIONALLY AVERAGED DIPOLE MOMENT NOT CORRECT"

# Vibrationally averaged magnetizabilities
CRIT1=`$GREP "XX * \-3\.2237416[0-9] * \-0\.0076052[0-9] * \-3\.2313469[0-9]" $log | wc -l`
CRIT2=`$GREP "XY * 0\.0000000[0-9] * \-0\.0000035[0-9] * \-0\.0000035[0-9]" $log | wc -l`
CRIT3=`$GREP "XZ * 0\.00000000 * 0\.00000000 * 0\.00000000" $log | wc -l`
CRIT4=`$GREP "YY * \-3\.2502155[0-9] * 0\.0018217[0-9] * \-3\.2483938[0-9]" $log | wc -l`
CRIT5=`$GREP "YZ * 0\.00000000 * \-0\.0000034[0-9] * \-0\.0000034[0-9]" $log | wc -l`
CRIT6=`$GREP "ZZ * \-3\.2502155[0-9] * 0\.0018238[0-9] * \-3\.2483916[0-9]" $log | wc -l`
TEST[35]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[35]=6
ERROR[35]="VIBRATIONALLY AVERAGED MAGNETIZABILITIES NOT CORRECT"

# Vibrationally averaged g-tensor
CRIT1=`$GREP "AX * 0\.4139216[0-9] * 0\.0014070[0-9] * 0\.4153287[0-9]" $log | wc -l`
CRIT2=`$GREP "BX * \-0\.0000000[0-9] * 0\.0000017[0-9] * 0\.0000017[0-9]" $log | wc -l`
CRIT3=`$GREP "CX * 0\.00000000 * \-0\.0000000[0-9] * \-0\.0000000[0-9]" $log | wc -l`
CRIT4=`$GREP "AY * \-0\.0000000[0-9] * 0\.0000030[0-9] * 0\.0000030[0-9]" $log | wc -l`
CRIT5=`$GREP "BY * 0\.4685387[0-9] * \-0\.0036373[0-9] * 0\.4649014[0-9]" $log | wc -l`
CRIT6=`$GREP "CY * 0\.00000000 * 0\.0000021[0-9] * 0\.0000021[0-9]" $log | wc -l`
CRIT7=`$GREP "AZ * 0\.00000000 * 0\.00000000 * 0\.00000000" $log | wc -l`
CRIT8=`$GREP "BZ * 0\.00000000 * 0\.0000021[0-9] * 0\.0000021[0-9]" $log | wc -l`
CRIT9=`$GREP "CZ * 0\.4685386[0-9] * \-0\.0036384[0-9] * 0\.4649002[0-9]" $log | wc -l`
TEST[36]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[36]=9
ERROR[36]="VIBRATIONALLY AVERAGED G-TENSOR NOT CORRECT"

# Vibrationally averaged nuclear magnetic shielding constants for nitrogen
CRIT1=`$GREP "Bxmx * 290\.4388716[0-9] * 0\.6703184[0-9] * 291\.109190[0-1][0-9]" $log | wc -l`
CRIT2=`$GREP "Bymx * \-0\.0000005[0-9] * 0\.0119407[0-9] * 0\.0119401[0-9]" $log | wc -l`
CRIT3=`$GREP "Bzmx * 0\.00000000 * \-0\.0001918[0-9] * \-0\.0001918[0-9]" $log | wc -l`
CRIT4=`$GREP "Bxmy * \-0\.0000016[0-9] * 0\.0017142[0-9] * 0\.0017126[0-9]" $log | wc -l`
CRIT5=`$GREP "Bymy * 304\.4396995[0-9] * \-2\.055278[7-8][0-9] * 302\.384420[7-8][0-9]" $log | wc -l`
CRIT6=`$GREP "Bzmy * 0\.00000000 * 0\.0000007[0-9] * 0\.0000007[0-9]" $log | wc -l`
CRIT7=`$GREP "Bxmz * 0\.00000000 * 0\.0000040[0-9] * 0\.0000040[0-9]" $log | wc -l`
CRIT8=`$GREP "Bymz * 0\.00000000 * 0\.002744[7-8][0-9] * 0\.002744[7-8][0-9]" $log | wc -l`
CRIT9=`$GREP "Bzmz * 304\.4396562[0-9] * \-2\.0522223[0-9] * 302\.387433[8-9][0-9]" $log | wc -l`
TEST[37]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[37]=9
ERROR[37]="VIBRATIONALLY AVERAGED NUCLEAR MAGNETIC SHIELDING CONSTANTS FOR NITROGEN NOT CORRECT"

# Vibrationally averaged nuclear magnetic shielding constants for hydrogen1
CRIT1=`$GREP "Bxmx * 27\.6577549[0-9] * \-0\.056623[5-6][0-9] * 27\.6011313[0-9]" $log | wc -l`
CRIT2=`$GREP "Bymx * \-1\.7829960[0-9] * 0\.0411656[0-9] * \-1\.7418304[0-9]" $log | wc -l`
CRIT3=`$GREP "Bzmx * \-3\.0882401[0-9] * 0\.0695891[0-9] * \-3\.0186510[0-9]" $log | wc -l`
CRIT4=`$GREP "Bxmy * \-2\.4848602[0-9] * 0\.027219[1-4][0-9] * \-2\.45764(07|08|09|10)[0-9]" $log | wc -l`
CRIT5=`$GREP "Bymy * 31\.7263868[0-9] * \-0\.1020374[0-9] * 31\.6243494[0-9]" $log | wc -l`
CRIT6=`$GREP "Bzmy * 4\.9251800[0-9] * \-0\.0584325[0-9] * 4\.8667475[0-9]" $log | wc -l`
CRIT7=`$GREP "Bxmz * \-4\.3039051[0-9] * 0\.047110[3-5][0-9] * \-4\.256794[5-7][0-9]" $log | wc -l`
CRIT8=`$GREP "Bymz * 4\.9251802[0-9] * \-0\.0584363[0-9] * 4\.8667439[0-9]" $log | wc -l`
CRIT9=`$GREP "Bzmz * 37\.4134947[0-9] * \-0\.1697565[0-9] * 37\.2437381[0-9]" $log | wc -l`
TEST[38]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[38]=9
ERROR[38]="VIBRATIONALLY AVERAGED NUCLEAR MAGNETIC SHIELDING CONSTANTS FOR HYDROGEN1 NOT CORRECT"

# Vibrationally averaged nuclear magnetic shielding constants for hydrogen3
CRIT1=`$GREP "Bxmx * 27\.6577506[0-9] * \-0\.0572283[0-9] * 27\.6005222[0-9]" $log | wc -l`
CRIT2=`$GREP "Bymx * 3\.5659907[0-9] * \-0\.0827596[0-9] * 3\.4832311[0-9]" $log | wc -l`
CRIT3=`$GREP "Bzmx * 0\.00000000 * 0\.0000575[0-9] * 0\.0000575[0-9]" $log | wc -l`
CRIT4=`$GREP "Bxmy * 4\.9697189[0-9] * \-0\.0540539[0-9] * 4\.9156650[0-9]" $log | wc -l`
CRIT5=`$GREP "Bymy * 40\.2570442[0-9] * \-0\.2023550[0-9] * 40\.0546891[0-9]" $log | wc -l`
CRIT6=`$GREP "Bzmy * 0\.00000000 * \-0\.0000282[0-9] * \-0\.0000282[0-9]" $log | wc -l`
CRIT7=`$GREP "Bxmz * 0\.00000000 * \-0\.000018[4-7][0-9] * \-0\.000018[4-7][0-9]" $log | wc -l`
CRIT8=`$GREP "Bymz * 0\.00000000 * \-0\.0000198[0-9] * \-0\.0000198[0-9]" $log | wc -l`
CRIT9=`$GREP "Bzmz * 28\.8828308[0-9] * \-0\.0699113[0-9] * 28\.8129195[0-9]" $log | wc -l`
TEST[39]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[39]=9
ERROR[39]="VIBRATIONALLY AVERAGED NUCLEAR MAGNETIC SHIELDING CONSTANTS FOR HYDROGEN3 NOT CORRECT"

# Vibrationally averaged static polarizabilities
CRIT1=`$GREP "XX * 1\.3949847[0-9] * 0\.0833337[0-9] * 1\.4783185[0-9]" $log | wc -l`
CRIT2=`$GREP "XY * 0\.0000004[0-9] * 0\.0000004[0-9] * 0\.0000008[0-9]" $log | wc -l`
CRIT3=`$GREP "XZ * 0\.00000000 * \-0\.0000000[0-9] * \-0\.0000000[0-9]" $log | wc -l`
CRIT4=`$GREP "YY * 5\.7194861[0-9] * 0\.1208622[0-9] * 5\.8403483[0-9]" $log | wc -l`
CRIT5=`$GREP "YZ * 0\.00000000 * 0\.00000000 * 0\.00000000" $log | wc -l`
CRIT6=`$GREP "ZZ * 5\.7194848[0-9] * 0\.1208689[0-9] * 5\.8403537[0-9]" $log | wc -l`
TEST[40]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[40]=6
ERROR[40]="VIBRATIONALLY AVERAGED STATIC POLARIZABILITIES NOT CORRECT"

# Final energy
CRIT1=`$GREP "Final * HF energy\: * \-55\.45511933245[0-9]" $log | wc -l`
TEST[41]=`expr	$CRIT1`
CTRL[41]=2
ERROR[41]="FINAL ENERGY NOT CORRECT"

PASSED=1
for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \
         30 31 32 33 34 35 36 37 38 39 40 41
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
     echo ${ERROR[i]}
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi

' > walk_vibave.check
#######################################################################
