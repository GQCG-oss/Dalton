#
# This is the script for generating files for a specific Dalton test job.
#
# For the .check file ksh or bash is preferred, otherwise use sh
# (and hope it is not the old Bourne shell, which will not work)
#
if [ -x /bin/ksh ]; then
   CHECK_SHELL='#!/bin/ksh'
elif [ -x /bin/bash ]; then
   CHECK_SHELL='#!/bin/bash'
else
   CHECK_SHELL='#!/bin/sh'
fi


#######################################################################
#  TEST DESCRIPTION
#######################################################################
cat > walk_vibave.info <<'%EOF%'
   walk_vibave
   -----------
   Molecule:         NH3
   Wave Function:    SCF / STO-3G
   Test Purpose:     Vibrational average of shieldings, magnetizabilities
                     and polarizabilities
%EOF%

#######################################################################
#  MOLECULE INPUT
#######################################################################
cat > walk_vibave.mol <<'%EOF%'
BASIS
STO-3G
Vibrational averaging of shieldings, magnetizabilities and polarizabilities

Atomtypes=2 Nosymmetry
Charge=7.0 Atoms=1
N          0.6023400            0.00000000              0.00000000
Charge=1.0 Atoms=3
H         -0.1947831            0.899791                1.558484
H         -0.1947831            0.899791               -1.558484
H         -0.1947831           -1.7995826090           -0.000000
%EOF%

#######################################################################
#  DALTON INPUT
#######################################################################
cat > walk_vibave.dal <<'%EOF%'
**DALTON INPUT
.WALK
*WALK
.NOORTH
.VIBAVE
.DISPLAC
 0.05
.ECKART
N          0.6037353032            0.0000000000            0.0000000000
H         -0.2012451011            0.8886984766            1.5392709141
H         -0.2012451011            0.8886984766           -1.5392709141
H         -0.2012451011           -1.7773969533            0.0000000000
**WAVE FUNCTIONS
.HF
*SCF INPUT
.THRESH
2.0D-9
**START
.SHIELD
.MAGNET
.POLARI
*LINRES
.THRESH
1.0D-7
**EACH STEP
.PRINT
 0
.SHIELD
.MAGNET
.POLARI
*LINRES
.THRESH
1.0D-7
**END OF DALTON INPUT
%EOF%
#######################################################################



#######################################################################

#######################################################################
#  CHECK SCRIPT
#######################################################################
echo $CHECK_SHELL >walk_vibave.check
cat >>walk_vibave.check <<'%EOF%'
log=$1

if [ `uname` = Linux ]; then
   GREP="egrep -a"
else
   GREP="egrep"
fi

# Basis set
CRIT1=`$GREP "Basis set used is \"STO\-3G\" from the basis set library\." $log | wc -l`
CRIT2=`$GREP "N * 1 * 7\.0000 * 15 * 5 * \[6s3p\|2s1p\]" $log | wc -l`
CRIT3=`$GREP "H * 3 * 1\.0000 * 3 * 1 * \[3s\|1s\]" $log | wc -l`
CRIT4=`$GREP "total\: * 4 * 10\.0000 * 24 * 8" $log | wc -l`
TEST[1]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[1]=4
ERROR[1]="BASIS SET NOT READ CORRECTLY"

# Geometry
CRIT1=`$GREP "Total number of coordinates\: * 12" $log | wc -l`
CRIT2=`$GREP "1 * x * 0*\.6023400000" $log | wc -l`
CRIT3=`$GREP "2 * y * (\-0|\-|0| )\.0000000000" $log | wc -l`
CRIT4=`$GREP "3 * z * (\-0|\-|0| )\.0000000000" $log | wc -l`
CRIT5=`$GREP "4 * x * (\-0| \-)\.1947831000" $log | wc -l`
CRIT6=`$GREP "5 * y * 0*\.8997910000" $log | wc -l`
CRIT7=`$GREP "6 * z * 1\.5584840000" $log | wc -l`
CRIT8=`$GREP "7 * x * (\-0| \-)\.1947831000" $log | wc -l`
CRIT9=`$GREP "8 * y * 0*\.8997910000" $log | wc -l`
CRIT10=`$GREP "9 * z * \-1\.5584840000" $log | wc -l`
CRIT11=`$GREP "10 * x * (\-0| \-)\.1947831000" $log | wc -l`
CRIT12=`$GREP "11 * y * \-1\.7995826090" $log | wc -l`
CRIT13=`$GREP "12 * z * (\-0|\-|0| )\.0000000000" $log | wc -l`
TEST[2]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13`
CTRL[2]=13
ERROR[2]="GEOMETRY NOT READ CORRECTLY"

# Initial energy
CRIT1=`$GREP "Final * HF energy\: * \-55\.4551193324[0-9][0-9]" $log | wc -l`
TEST[3]=`expr	$CRIT1`
CTRL[3]=2
ERROR[3]="INITIAL ENERGY NOT CORRECT"

# Numerical differentiation
CRIT1=`$GREP "Walk type\: Numerical differentiation" $log | wc -l`
CRIT2=`$GREP "Vibrational averaging of * molecular properties at an effective geometry" $log | wc -l`
CRIT3=`$GREP "Molecular properties transformed to the following Eckart frame" $log | wc -l`
CRIT4=`$GREP "N * 0*\.6037353032 * (\-0|\-|0| )\.0000000000 * (\-0|\-|0| )\.0000000000" $log | wc -l`
CRIT5=`$GREP "H * (\-0| \-)\.2012451011 * 0*\.8886984766 * 1\.5392709141" $log | wc -l`
CRIT6=`$GREP "H * (\-0| \-)\.2012451011 * 0*\.8886984766 * \-1\.5392709141" $log | wc -l`
CRIT7=`$GREP "H * (\-0| \-)\.2012451011 * \-1\.7773969533 * (\-0|\-|0| )\.0000000000" $log | wc -l`
TEST[4]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7`
CTRL[4]=14
ERROR[4]="NUMERICAL DIFFERENTIATION NOT SET UP CORRECTLY"

# Inital gradient
CRIT1=`$GREP "N * 0*\.00666549[0-9]* * 0*\.000000190[0-9] * (0| |\-0|\-)\.000000000[0-9]" $log | wc -l`
CRIT2=`$GREP "H * (\-0| \-)\.00222180(3|4)[0-9] * 0*\.00488237(6|7)[0-9] * 0*\.008456546[0-9]" $log | wc -l`
CRIT3=`$GREP "H * (\-0| \-)\.00222180(3|4)[0-9] * 0*\.00488237(6|7)[0-9] * (\-0| \-)\.008456546[0-9]" $log | wc -l`
CRIT4=`$GREP "H * (\-0| \-)\.002221887[0-9] * (\-0| \-)\.00976494(3|4)[0-9] * (\-0|\-|0| )\.000000000[0-9]" $log | wc -l`
TEST[5]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[5]=4
ERROR[5]="INITIAL GRADIENT NOT CORRECT"

# Initial Hessian
CRIT1=`$GREP "N * x * 0*\.32280[0-9]" $log | wc -l`
CRIT2=`$GREP "N * y * (\-0|\-|0| )\.000000 * 0*\.81860[0-9]" $log | wc -l`
CRIT3=`$GREP "N * z * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * 0*\.81860[0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * (\-0| \-)\.10760[0-9] * 0*\.11963[0-9] * 0*\.20720[0-9] * 0*\.11013[0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * 0*\.06655[0-9] * (\-0| \-)\.18631[0-9] * (\-0| \-)\.14992[0-9] * (\-0| \-)\.08762[0-9] * 0*\.18830[0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * 0*\.11527[0-9] * (\-0| \-)\.14992[0-9] * (\-0| \-)\.35942[0-9] * (\-0| \-)\.15176[0-9] * 0*\.16825[0-9] * 0*\.38258[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * (\-0| \-)\.10760[0-9] * 0*\.11963[0-9] * (\-0| \-)\.20720[0-9] * (\-0| \-)\.00126[0-9] * (\-0| \-)\.01094[0-9] * 0*\.03064[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * 0*\.06655[0-9] * (\-0| \-)\.18631[0-9] * 0*\.14992[0-9] * (\-0| \-)\.01094[0-9] * 0*\.01487[0-9] * (\-0| \-)\.02869[0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * (\-0| \-)\.11527[0-9] * 0*\.14992[0-9] * (\-0| \-)\.35942[0-9] * (\-0| \-)\.03064[0-9] * 0*\.02869[0-9] * (\-0| \-)\.02745[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * (\-0| \-)\.10760[0-9] * (\-0| \-)\.23926[0-9] * (\-0|\-|0| )\.000000 * (\-0| \-)\.00126[0-9] * 0*\.03200[0-9] * 0*\.00584[0-9]" $log | wc -l`
CRIT11=`$GREP "H * y * (\-0| \-)\.13311[0-9] * (\-0| \-)\.44598[0-9] * (\-0|\-|0| )\.000000 * (\-0| \-)\.02106[0-9] * (\-0| \-)\.01687[0-9] * 0*\.01036[0-9]" $log | wc -l`
CRIT12=`$GREP "H * z * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * (\-0| \-)\.09975[0-9] * (\-0| \-)\.02479[0-9] * (\-0| \-)\.04702[0-9] * 0*\.00429[0-9]" $log | wc -l`
CRIT13=`$GREP "H * x * 0*\.11013[0-9]" $log | wc -l`
CRIT14=`$GREP "H * y * (\-0| \-)\.08762[0-9] * 0*\.18830[0-9]" $log | wc -l`
CRIT15=`$GREP "H * z * 0*\.15176[0-9] * (\-0| \-)\.16825[0-9] * 0*\.38258[0-9]" $log | wc -l`
CRIT16=`$GREP "H * x * (\-0| \-)\.00126[0-9] * 0*\.03200[0-9] * (\-0| \-)\.00584[0-9] * 0*\.11013[0-9]" $log | wc -l`
CRIT17=`$GREP "H * y * (\-0| \-)\.02106[0-9] * (\-0| \-)\.01687[0-9] * (\-0| \-)\.01036[0-9] * 0*\.17524[0-9] * 0*\.47972[0-9]" $log | wc -l`
CRIT18=`$GREP "H * z * 0*\.02479[0-9] * 0*\.04702[0-9] * 0*\.00429[0-9] * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * 0*\.09116[0-9]" $log | wc -l`
TEST[6]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18`
CTRL[6]=18
ERROR[6]="INITIAL HESSIAN NOT CORRECT"

# Initial static polarizabilities
CRIT1=`$GREP "Ex * 1\.394985 * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000" $log | wc -l`
CRIT2=`$GREP "Ey * (\-0|\-|0| )\.000000 * 5\.719486 * (\-0|\-|0| )\.000000" $log | wc -l`
CRIT3=`$GREP "Ez * (\-0|\-|0| )\.000000 * (\-0|\-|0| )\.000000 * 5\.719485" $log | wc -l`
TEST[7]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[7]=3
ERROR[7]="INITIAL STATIC POLARIZABILITIES NOT CORRECT"

# Initial magnetizabilities
CRIT1=`$GREP "Isotropic magnetizability\: * \-3\.2414 * \-255\.7793 * \-15\.4034" $log | wc -l`
CRIT2=`$GREP "Diamagnetic contribution\: * \-4\.2616 * \-336\.2815 * \-20*\.2514" $log | wc -l`
CRIT3=`$GREP "Paramagnetic contribution\: * 1\.0202 * 80*\.5022 * 4\.8480" $log | wc -l`
CRIT4=`$GREP "Parallel component\: * \-3\.2237 * \-254\.3866 * \-15\.3195" $log | wc -l`
CRIT5=`$GREP "Perpendicular component\: * \-3\.2502 * \-256\.4757 * \-15\.4453" $log | wc -l`
CRIT6=`$GREP "Anisotropy\: * 0*\.0265 * 2\.0891 * 0*\.1258" $log | wc -l`
TEST[8]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[8]=6
ERROR[8]="INITIAL MAGNETIZABILITIES NOT CORRECT"

# Initial g-tensor
CRIT1=`$GREP "Isotropic g\-tensor  * \: * 0*\.4503330[0-9]" $log | wc -l`
CRIT2=`$GREP "Nuclear contribution * \: * 0*\.985131(49|50)" $log | wc -l`
CRIT3=`$GREP "Electronic contribution * \: * (\-0| \-)\.1077988[0-9]" $log | wc -l`
CRIT4=`$GREP "Parallel component\: * 0*\.4139216[0-9]" $log | wc -l`
CRIT5=`$GREP "Perpendicular component\: * 0*\.4685387[0-9]" $log | wc -l`
CRIT6=`$GREP "Anisotropy\: * (\-0| \-)\.0546170[0-9]" $log | wc -l`
TEST[9]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[9]=6
ERROR[9]="INITIAL ROTATIONAL G-TENSOR NOT CORRECT"

# Initial shielding tensor
CRIT1=`$GREP "N * x * 290\.4388[0-9]* * (\-0| \-)\.000000[0-9]* * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT2=`$GREP "N * y * (\-0| \-)\.00000[0-9][0-9][0-9] * 304\.4396[0-9][0-9][0-9][0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREP "N * z * (\-0|\-|0| )\.00000[0-9][0-9][0-9] * (\-0|\-|0| )\.00000000 * 304\.4396[0-9][0-9][0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * 27\.65775[0-9][0-9][0-9] * \-1\.782995[0-9][0-9] * \-3\.088239[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * \-2\.484859[0-9][0-9] * 31\.72638[0-9][0-9][0-9] * 4\.925179[0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * \-4\.303904[0-9][0-9] * 4\.925179[0-9][0-9] * 37\.41348[0-9][0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * 27\.65775[0-9][0-9][0-9] * \-1\.782995[0-9][0-9] * 3\.088239[0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * \-2\.484859[0-9][0-9] * 31\.72638[0-9][0-9][0-9] * \-4\.925179[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * 4\.303904[0-9][0-9] * \-4\.925179[0-9][0-9] * 37\.41348[0-9][0-9][0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * 27\.65774[0-9][0-9][0-9] * 3\.565990[0-9][0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT11=`$GREP "H * y * 4\.969718[0-9][0-9] * 40\.25703[0-9][0-9][0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT12=`$GREP "H * z * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 28\.88282[0-9][0-9][0-9]" $log | wc -l`
# expr 2 + 3 + 3 + 3 + 3 + 3 + 3 + 3 + 3 + 2 + 2 + 2
TEST[10]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[10]=33
ERROR[10]="INITIAL SHIELDING TENSOR NOT CORRECT"

# Initial chemical shielding for nitrogen
CRIT1=`$GREP "Shielding constant\: * 299\.7727 ppm" $log | wc -l`
CRIT2=`$GREP "Anisotropy\: * \-14\.0008 ppm" $log | wc -l`
CRIT3=`$GREP "S parameter\: * 14\.0008 ppm" $log | wc -l`
TEST[11]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[11]=3
ERROR[11]="INITIAL CHEMICAL SHIELDING FOR NITROGEN NOT CORRECT"

# Initial chemical shielding for hydrogen
CRIT1=`$GREP "Shielding constant\: * 32\.2659 ppm" $log | wc -l`
CRIT2=`$GREP "Anisotropy\: * 13\.9511 ppm" $log | wc -l`
CRIT3=`$GREP "S parameter\: * 14\.1227 ppm" $log | wc -l`
CRIT4=`$GREP "A parameter\: * 0*\.7019 ppm" $log | wc -l`
TEST[12]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[12]=12
ERROR[12]="INITIAL CHEMICAL SHIELDING FOR HYDROGEN NOT CORRECT"

# Summary of initial shieldings
CRIT1=`$GREP "\@1 N * 299\.7727 * 415\.1852 \-115\.4125 * \-1\.0000 * 14\.0008 * 7\.0004 * 3\.0000" $log | wc -l`
CRIT2=`$GREP "\@1 H * 32\.2659 * 31\.6749 * 0*\.5910 * 0*\.6669 * 15\.2184 * 13\.9511 * 0*\.2725" $log | wc -l`
TEST[13]=`expr	$CRIT1 \+ $CRIT2`
CTRL[13]=4
ERROR[13]="SUMMARY OF INITIAL SHIELDINGS NOT CORRECT"

# Projected gradient
CRIT1=`$GREP "Norm of projected gradient * 0*\.018582" $log | wc -l`
TEST[14]=`expr	$CRIT1`
CTRL[14]=1
ERROR[14]="PROJECTED GRADIENT NOT CORRECT"

# Energy at effective geometry
CRIT1=`$GREP "Energy at effective geometry\: * \-55\.4551193325" $log | wc -l`
TEST[15]=`expr	$CRIT1`
CTRL[15]=1
ERROR[15]="ENERGY AT EFFECTIVE GEOMETRY NOT CORRECT"

# Gradient at effective geometry
CRIT1=`$GREP "1 * 0*\.006665(49|50) * 0*\.00000019 * -*0*\.00000000 * -0*\.00222180 * 0*\.00488238" $log | wc -l`
CRIT2=`$GREP "1 * 0*\.00845655 * -0*\.00222180 * 0*\.00488238 * -0*\.00845655 * -0*\.00222189" $log | wc -l`
CRIT3=`$GREP "1 * -0*\.00976494 * -*0*\.00000000" $log | wc -l`
TEST[16]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[16]=3
ERROR[16]="GRADIENT AT EFFECTIVE GEOMETRY NOT CORRECT"

# Hessian at effective geometry
CRIT1=`$GREP "1 * 0*\.3228005[0-9] * (\-0| \-)\.0000002[0-9] * (\-0|\-|0| )\.0000000[0-9] * (\-0| \-)\.1076002[0-9]"  $log | wc -l`
CRIT2=`$GREP "2 * (\-0| \-)\.0000002[0-9] * 0*\.8175087[0-9] * (\-0|\-|0| )\.0000000[0-9] * 0*\.1207049[0-9]"  $log | wc -l`
CRIT3=`$GREP "3 * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000000[0-9] * 0*\.8175093[0-9] * 0*\.2090671[0-9]"  $log | wc -l`
CRIT4=`$GREP "4 * (\-0| \-)\.1076002[0-9] * 0*\.1207049[0-9] * 0*\.2090671[0-9] * 0*\.1071549[0-9]"  $log | wc -l`
CRIT5=`$GREP "5 * 0*\.0665559[0-9] * (\-0| \-)\.1859448[0-9] * (\-0| \-)\.1499231[0-9] * (\-0| \-)\.0879808[0-9]"  $log | wc -l`
CRIT6=`$GREP "6 * 0*\.1152783[0-9] * (\-0| \-)\.1499232[0-9] * (\-0| \-)\.3590613[0-9] * (\-0| \-)\.1523873[0-9]"  $log | wc -l`
CRIT7=`$GREP "7 * (\-0| \-)\.1076002[0-9] * 0*\.1207049[0-9] * (\-0| \-)\.2090671[0-9] * 0*\.0002226[0-9]"  $log | wc -l`
CRIT8=`$GREP "8 * 0*\.0665559[0-9] * (\-0| \-)\.1859448[0-9] * 0*\.1499231[0-9] * (\-0| \-)\.0112991[0-9]"  $log | wc -l`
CRIT9=`$GREP "9 * (\-0| \-)\.1152783[0-9] * 0*\.1499232[0-9] * (\-0| \-)\.3590613[0-9] * (\-0| \-)\.0312629[0-9]"  $log | wc -l`
CRIT10=`$GREP "10 * (\-0| \-)\.1076000[0-9] * (\-0| \-)\.2414096[0-9] * (\-0|\-|0| )\.0000000[0-9] * 0*\.0002226[0-9]"  $log | wc -l`
CRIT11=`$GREP "11 * (\-0| \-)\.1331116[0-9] * (\-0| \-)\.4456190[0-9] * (\-0|\-|0| )\.0000000[0-9] * (\-0| \-)\.0214249[0-9]"  $log | wc -l`
CRIT12=`$GREP "12 * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000000[0-9] * (\-0| \-)\.0993866[0-9] * (\-0| \-)\.0254168[0-9]"  $log | wc -l`
CRIT13=`$GREP "1 * 0*\.0665559[0-9] * 0*\.1152783[0-9] * (\-0| \-)\.1076002[0-9] * 0*\.0665559[0-9]"  $log | wc -l`
CRIT14=`$GREP "2 * (\-0| \-)\.1859448[0-9] * (\-0| \-)\.1499232[0-9] * 0*\.1207049[0-9] * (\-0| \-)\.1859448[0-9]"  $log | wc -l`
CRIT15=`$GREP "3 * (\-0| \-)\.1499231[0-9] * (\-0| \-)\.3590613[0-9] * (\-0| \-)\.2090671[0-9] * 0*\.1499231[0-9]"  $log | wc -l`
CRIT16=`$GREP "4 * (\-0| \-)\.0879808[0-9] * (\-0| \-)\.1523873[0-9] * 0*\.0002226[0-9] * (\-0| \-)\.0112991[0-9]"  $log | wc -l`
CRIT17=`$GREP "5 * 0*\.1868274[0-9] * 0*\.1690357[0-9] * (\-0| \-)\.0112991[0-9] * 0*\.0161106[0-9]"  $log | wc -l`
CRIT18=`$GREP "6 * 0*\.1690357[0-9] * 0*\.3820131[0-9] * 0*\.0312629[0-9] * (\-0| \-)\.0294765[0-9]"  $log | wc -l`
CRIT19=`$GREP "7 * (\-0| \-)\.0112991[0-9] * 0*\.0312629[0-9] * 0*\.1071549[0-9] * (\-0| \-)\.0879808[0-9]"  $log | wc -l`
CRIT20=`$GREP "8 * 0*\.0161106[0-9] * (\-0| \-)\.0294765[0-9] * (\-0| \-)\.0879808[0-9] * 0*\.1868274[0-9]"  $log | wc -l`
CRIT21=`$GREP "9 * 0*\.0294765[0-9] * (\-0| \-)\.0280278[0-9] * 0*\.1523873[0-9] * (\-0| \-)\.1690357[0-9]"  $log | wc -l`
CRIT22=`$GREP "10 * 0*\.0327240[0-9] * 0*\.0058461[0-9] * 0*\.0002226[0-9] * 0*\.0327240[0-9]"  $log | wc -l`
CRIT23=`$GREP "11 * (\-0| \-)\.0169932[0-9] * 0*\.0103640[0-9] * (\-0| \-)\.0214249[0-9] * (\-0| \-)\.0169932[0-9]"  $log | wc -l`
CRIT24=`$GREP "12 * (\-0| \-)\.0485890[0-9] * 0*\.0050760[0-9] * 0*\.0254168[0-9] * 0*\.0485890[0-9]"  $log | wc -l`
CRIT25=`$GREP "1 * (\-0| \-)\.1152783[0-9] * (\-0| \-)\.1076000[0-9] * (\-0| \-)\.1331116[0-9] * (\-0|\-|0| )\.0000000[0-9]"  $log | wc -l`
CRIT26=`$GREP "2 * 0*\.1499232[0-9] * (\-0| \-)\.2414096[0-9] * (\-0| \-)\.4456190[0-9] * (\-0|\-|0| )\.0000000[0-9]"  $log | wc -l`
CRIT27=`$GREP "3 * (\-0| \-)\.3590613[0-9] * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000000[0-9] * (\-0| \-)\.0993866[0-9]"  $log | wc -l`
CRIT28=`$GREP "4 * (\-0| \-)\.0312629[0-9] * 0*\.0002226[0-9] * (\-0| \-)\.0214249[0-9] * (\-0| \-)\.0254168[0-9]"  $log | wc -l`
CRIT29=`$GREP "5 * 0*\.0294765[0-9] * 0*\.0327240[0-9] * (\-0| \-)\.0169932[0-9] * (\-0| \-)\.0485890[0-9]"  $log | wc -l`
CRIT30=`$GREP "6 * (\-0| \-)\.0280278[0-9] * 0*\.0058461[0-9] * 0*\.0103640[0-9] * 0*\.0050760[0-9]"  $log | wc -l`
CRIT31=`$GREP "7 * 0*\.1523873[0-9] * 0*\.0002226[0-9] * (\-0| \-)\.0214249[0-9] * 0*\.0254168[0-9]"  $log | wc -l`
CRIT32=`$GREP "8 * (\-0| \-)\.1690357[0-9] * 0*\.0327240[0-9] * (\-0| \-)\.0169932[0-9] * 0*\.0485890[0-9]"  $log | wc -l`
CRIT33=`$GREP "9 * 0*\.3820131[0-9] * (\-0| \-)\.0058461[0-9] * (\-0| \-)\.0103640[0-9] * 0*\.0050760[0-9]"  $log | wc -l`
CRIT34=`$GREP "10 * (\-0| \-)\.0058461[0-9] * 0*\.1071547[0-9] * 0*\.1759615[0-9] * (\-0|\-|0| )\.0000000[0-9]"  $log | wc -l`
CRIT35=`$GREP "11 * (\-0| \-)\.0103640[0-9] * 0*\.1759615[0-9] * 0*\.4796055[0-9] * (\-0|\-|0| )\.0000000[0-9]"  $log | wc -l`
CRIT36=`$GREP "12 * 0*\.0050760[0-9] * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000000[0-9] * 0*\.0892346[0-9]"  $log | wc -l`
TEST[17]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
# 18-sep-2006 hjaaj: skip the rest because format changed and it
# is not worthwhile to check all numbers
#		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
#		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18 \+ \
#		$CRIT19 \+ $CRIT20 \+ $CRIT21 \+ $CRIT22 \+ $CRIT23 \+ $CRIT24 \+ \
#		$CRIT25 \+ $CRIT26 \+ $CRIT27 \+ $CRIT28 \+ $CRIT29 \+ $CRIT30 \+ \
#		$CRIT31 \+ $CRIT32 \+ $CRIT33 \+ $CRIT34 \+ $CRIT35 \+ $CRIT36`
CTRL[17]=12
#hj#CTRL[17]=36
ERROR[17]="HESSIAN AT EFFECTIVE GEOMETRY NOT CORRECT"

# Dipole moment at effective geometry
CRIT1=`$GREP "1 * (\-0| \-)\.72795634 * 0*\.00000002 * (\-0|\-|0| )\.00000000" $log | wc -l`
TEST[18]=`expr	$CRIT1`
CTRL[18]=1
ERROR[18]="DIPOLE MOMENT AT EFFECTIVE GEOMETRY NOT CORRECT"

# Magnetizabilities at effective geometry
CRIT1=`$GREP "Bx * \-3\.22374167(4|5)[0-9][0-9][0-9] * 0*\.00000005.[0-9][0-9][0-9] * (\-0|\-|0| )\.000000000000" $log | wc -l`
CRIT2=`$GREP "By * 0*\.00000005.[0-9][0-9][0-9] * \-3\.25021555(5|6)[0-9][0-9][0-9] * (\-0|\-|0| )\.000000000000" $log | wc -l`
TEST[19]=`expr	$CRIT1 \+ $CRIT2`
CTRL[19]=4
ERROR[19]="MAGNETIZABILITIES AT EFFECTIVE GEOMETRY NOT CORRECT"

# g-tensor at effective geometry
CRIT1=`$GREP "Bx * 0*\.4139216[67].* * -0*\.000000002[0-9]* * \-*0*\.000000000000" $log | wc -l`
CRIT2=`$GREP "By * \-0*\.000000009[0-9]* * 0*\.46853876[0-9]* * \-*0*\.000000000000" $log | wc -l`
CRIT3=`$GREP "Bz * \-*0*\.000000000000 * \-*0*\.000000000000 * 0*\.46853868" $log | wc -l`
TEST[20]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[20]=3
ERROR[20]="ROTATIONAL G-TENSOR AT EFFECTIVE GEOMETRY NOT CORRECT"

# Chemical shielding tensors at effective geometry
CRIT1=`$GREP "N * x * 290*\.4388[0-9][0-9][0-9][0-9] * 0*\.000000[0-9][0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT2=`$GREP "N * y * (\-0| \-)\.000000[0-9][0-9] * 304\.4396[0-9][0-9][0-9][0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT3=`$GREP "N * z * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 304\.4396[0-9][0-9][0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * 27\.65775[0-9][0-9][0-9] * \-1\.782995[0-9][0-9] * \-3\.088239[0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * \-2\.484859[0-9][0-9] * 31\.72638[0-9][0-9][0-9] * 4\.925179[0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * \-4\.303904[0-9][0-9] * 4\.925179[0-9][0-9] * 37\.41348[0-9][0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * 27\.65775[0-9][0-9][0-9] * \-1\.782995[0-9][0-9] * 3\.088239[0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * \-2\.484859[0-9][0-9] * 31\.72638[0-9][0-9][0-9] * \-4\.925179[0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * 4\.303904[0-9][0-9] * \-4\.925179[0-9][0-9] * 37\.41348[0-9][0-9][0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * 27\.65774[0-9][0-9][0-9] * 3\.565991[0-9][0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT11=`$GREP "H * y * 4\.969719[0-9][0-9] * 40*\.25703[0-9][0-9][0-9] * (\-0|\-|0| )\.00000000" $log | wc -l`
CRIT12=`$GREP "H * z * (\-0|\-|0| )\.00000000 * (\-0|\-|0| )\.00000000 * 28\.88282[0-9][0-9][0-9]" $log | wc -l`
# expr 1 + 1 + 3 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 3 + 3
TEST[21]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[21]=28
ERROR[21]="CHEMICAL SHIELDING TENSORS AT EFFECTIVE GEOMETRY NOT CORRECT"

# Polarizability at effective geometry
CRIT1=`$GREP "Ex *     1\.39498478.*    0*\.00000073.* \-*0*\.0000000" $log | wc -l`
CRIT2=`$GREP "Ey *    0*\.00000073.*     5\.71948610.* \-*0*\.0000000" $log | wc -l`
CRIT3=`$GREP "Ez * \-*0*\.00000000.* \-*0*\.00000000.*     5\.7194848" $log | wc -l`
TEST[22]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[22]=3
ERROR[22]="POLARIZABILITY AT EFFECTIVE GEOMETRY NOT CORRECT"

# Gradient at first displacement
CRIT1=`$GREP "N * 0*\.0058447(6|7).[0-9] * 0*\.00102....[0-9] * (\-0| \-)\.0326(19|20)...[0-9]" $log | wc -l`
CRIT2=`$GREP "H * (\-0| \-)\.01016(7|8)...[0-9] * 0*\.01398....[0-9] * 0*\.02406(5|6)...[0-9]" $log | wc -l`
CRIT3=`$GREP "H * 0*\.00657(3|4)...[0-9] * (\-0| \-)\.00522....[0-9] * 0*\.00876[7-9]...[0-9]" $log | wc -l`
CRIT4=`$GREP "H * (\-0|\-)\.0022(49|50|51)...[0-9] * (\-0|\-)\.00978[0-3]...[0-9] * (\-0|\-)\.0002149(5|6).[0-9]" $log | wc -l`
TEST[24]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[24]=4
ERROR[24]="GRADIENT AT FIRST DISPLACEMENT NOT CORRECT"

# Differentiation complete
CRIT1=`$GREP "All displacements are now done \- numerical differentiation is complete\." $log | wc -l`
TEST[25]=`expr	$CRIT1`
CTRL[25]=1
ERROR[25]="NUMERICAL DIFFERENTIATION NOT COMPLETED"

# Dipole moment second derivatives
CRIT1=`$GREP "1 * (\-0|\-)\.068[6-9].[0-9] * (\-0|\-)\.0[2-9]...[0-9] * (\-0|\-|0| )\.0[0-4]...[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * (\-0| \-)\.06864[0-9] * 0*\.07126[0-9] * (\-0|\-|0| )\.0000(1|0)[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0*\.03091[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9]" $log | wc -l`
CRIT4=`$GREP "5 * 0*\.00253[0-9] * 0*\.0063(3|4)[0-9] * (\-0|\-|0| )\.0000(0|1)[0-9]" $log | wc -l`
CRIT5=`$GREP "6 * 0*\.40822[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9]" $log | wc -l`
TEST[26]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[26]=5
ERROR[26]="DIPOLE MOMENT SECOND DERIVATIVES NOT CORRECT"

# Magnetizability tensor second derivatives
CRIT1=`$GREP "1 * 0*\.266[0-4].[0-9] * 0*\.08[2-5]..[0-9] * 0*\.6383[1-4][0-9] * (\-0|\-|0| )\.00[0-1]..[0-9] * (\-0|\-|0| )\.000[0-3].[0-9] * 0*\.153[4-9].[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 0*\.26647[0-9] * (\-0| \-)\.08435[0-9] * 0*\.15341[0-9] * (\-0|\-|0| )\.0000(0|1)[0-9] * (0| |\-0|\-)\.0000[0-3][0-9] * 0*\.63834[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0*\.27939[0-9] * (\-0|\-|0| )\.00000[0-9] * 0*\.51023[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9] * 0*\.51023[0-9]" $log | wc -l`
CRIT4=`$GREP "5 * (\-0| \-)\.36942[0-9] * (\-0| \-)\.16743[0-9] * 0*\.04705[0-9] * (0| |\-0|\-)\.000[0-3].[0-9] * (\-0|\-|0| )\.0000[0-3][0-9] * 0*\.02687[0-9]" $log | wc -l`
CRIT5=`$GREP "6 * (\-0| \-)\.14493[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0| \-)\.44127[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0| \-)\.44127[0-9]" $log | wc -l`
TEST[27]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[27]=5
ERROR[27]="MAGNETIZABILITY TENSOR SECOND DERIVATIVES NOT CORRECT"

# Rotational g tensor second derivatives
CRIT1=`$GREP "1 * (\-0|\-)\.121[1-3].[0-9] * (\-0|\-)\.09[0-6]..[0-9] * (\-0|\-)\.40(28|29|30|31|32|33).[0-9] * (\-0|\-|0| )\.00[0-3]..[0-9] * (\-0|\-|0| )\.0000.[0-9] * (\-0|\-)\.00(48|49|50|51|52|53|54).[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * (\-0| \-)\.12113[0-9] * 0*\.09444[0-9] * (\-0| \-)\.00523[0-9] * (\-0|\-|0| )\.0000(0|1)[0-9] * (\-0|\-|0| )\.0000[0-2][0-9] * (\-0| \-)\.40309[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0*\.01324[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0| \-)\.08276[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0| \-)\.08276[0-9]" $log | wc -l`
CRIT4=`$GREP "5 * 0*\.08029[0-9] * 0*\.08937[0-9] * \-0*\.16308[0-9] * \-*0*\.000[0-2][0-9][0-9] * \-*0*\.0000[0-9][0-9] * \-0*\.13556[0-9]" $log | wc -l`
CRIT5=`$GREP "6 * 0*\.03622[0-9] * (\-0|\-|0| )\.00000[0-9] * 0*\.20905[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9] * 0*\.20905[0-9]" $log | wc -l`
TEST[28]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[28]=5
ERROR[28]="G-TENSOR SECOND DERIVATIVES NOT CORRECT"

# Nuclear shielding tensor second derivatives for nitrogen
CRIT1=`$GREP "1 * \-35\.[5-6].[0-9] * \-[3-4]\...[0-9] * (\-0|\-|0| )\.[0-9].[0-9] \-1[0-2]\...[0-9]\-16[6-7]\...[0-9] * (\-0|\-|0| )\.0[0-7][0-9] * (\-0|\-|0| )\.[0-9].[0-9] * (\-0|\-|0| )\.0[0-5][0-9] \-3[1-2]\...[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * \-35\.56[0-9] * 4\.193 * (0| |\-0|\-)\.00(0|1) * 10\.72[0-9] \-32\.51[0-9] * (\-0|\-|0| )\.00[0-9] * (\-0|\-|0| )\.00[0-9] * (\-0|\-|0| )\.00[0-9]\-167\.1[0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "3 * \-47\.40[0-9] * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 \-92\.68[0-9] * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 \-92\.68[0-9]" $log | wc -l`
CRIT4=`$GREP "5 * 55\.66[0-9] * 61\.12[0-9] * (\-0|\-|0| )\.(0|1)[0-9][0-9] * 4\.87[0-9] \-10\.03[0-9] * (\-0|\-|0| )\.0[0-2][0-9] * (\-0|\-|0| )\.0[01][0-9] * (\-0|\-|0| )\.0[0-3][0-9] \-35\.56[0-9]" $log | wc -l`
CRIT5=`$GREP "6 * \-1\.63[0-3] * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * 39\.57[0-9] * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * 39\.57[0-9]" $log | wc -l`
TEST[29]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[29]=5
ERROR[29]="NUCLEAR SHIELDING TENSOR SECOND DERIVATIVES FOR NITROGEN NOT CORRECT"

# Nuclear shielding tensor second derivatives for hydrogen1
CRIT1=`$GREP "1 * [5-6]\...[0-9] * (\-0|\-|0| )\.[0-6].[0-9] * ( |0|1|2)\...[0-9] * [1-2]\...[0-9] * [1-2]\...[0-9] * \-[4-5]\...[0-9] * (1|0| )\...[0-9] * \-1\.[2-9].[0-9] * [5-6]\...[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 1\.89(7|8) * 1\.603 * 1\.25(2|3) * 0*\.072 * 1\.81(4|5|6) * 0*\.30(8|9) * 2\.325 * \-3\.01(8|9) * \-7\.(100|099)" $log | wc -l`
CRIT3=`$GREP "3 * 8\.895 * (\-0| \-)\.821 * \-1\.422 * \-1\.876 * 7\.750 * 3\.201 * \-3\.249 * 3\.201 * 11\.44[0-9]" $log | wc -l`
CRIT4=`$GREP "5 * \-9\.2[0-3][0-9] * 0*\.4[7-8][0-9] * 2\.7[8-9][0-9] * 0*\.9(3|4). * \-6\.4[4-5][0-9] * \-2\.2(7|8)[0-9] * 3\.20[0-9] * \-5\.0(2|3)[0-9] * \-6\.3[7-9][0-9]" $log | wc -l`
CRIT5=`$GREP "6 * (\-0| \-)\.741 * 0*\.898 * 1\.556 * 0*\.463 * \-4\.223 * 0*\.450 * 0*\.802 * 0*\.450 * \-3\.704" $log | wc -l`
TEST[30]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[30]=5
ERROR[30]="NUCLEAR SHIELDING TENSOR SECOND DERIVATIVES FOR HYDROGEN1 NOT CORRECT"

# Nuclear shielding tensor second derivatives for hydrogen3
CRIT1=`$GREP "1 * (\-0|\-|0| )\.[1-5].[0-9] * \-[1-2]\...[0-9] * (\-0|\-|0| )\.[0-1].[0-9] * \-[1-2]\...[0-9] ( \-9|\-10)\...[0-9] * (\-0|\-|0| )\.[0-4].[0-9] * (\-0|\-|0| )\.0[0-9][0-9] * (\-0|\-|0| )\.[0-5].[0-9] * \-1\.7[7-8][0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 8\.340 * \-1\.129 * (\-0|\-|0| )\.000 * \-1\.607 * 5\.914 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.00(0|1) * 8\.192" $log | wc -l`
CRIT3=`$GREP "3 * 8\.896 * 1\.642 * (\-0|\-|0| )\.000 * 3\.752 * 13\.29[0-9] * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * 5\.901" $log | wc -l`
CRIT4=`$GREP "5 * 0*\.508 * 4\.770 * (0| |\-0|\-)\.00[0-9] * (\-0| \-)\.652 * \-2\.095 * (\-0|\-|0| )\.00[0-9] * (\-0|\-|0| )\.00[0-9] * (\-0|\-|0| )\.00(0|1) * (\-0| \-)\.490" $log | wc -l`
CRIT5=`$GREP "6 * (\-0| \-)\.74[0-2] * \-1\.796 * (\-0|\-|0| )\.000 * (\-0| \-)\.926 * \-3\.444 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * (\-0|\-|0| )\.000 * \-4\.483" $log | wc -l`
TEST[31]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[31]=5
ERROR[31]="NUCLEAR SHIELDING TENSOR SECOND DERIVATIVES FOR HYDROGEN3 NOT CORRECT"

# Polarizability second derivatives
CRIT1=`$GREP "1 * 0*\.6[8-9]...[0-9] * (\-1|\-0|\-)\.[0-9]....[0-9] * 1\.3[8-9][0-9]..[0-9] * (\-0|\-|0| )\.[0-2]....[0-9] * (\-0|\-|0| )\.00[0-6]..[0-9] * 3\.1[0-2]...[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * 0*\.69766[0-9] * 1\.15528[0-9] * 3\.10294[0-9] * (0| |\-0|\-)\.000(0|1).[0-9] * (\-0|\-|0| )\.000(0|1).[0-9] * 1\.38403[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * 0*\.62869[0-9] * 0*\.00000[0-9] * 4\.35289[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9] * 4\.3528[4-9][0-9]" $log | wc -l`
CRIT4=`$GREP "5 * 0*\.30136[0-9] * (\-0| \-)\.26431[0-9] * 1\.4055[2-6][0-9] * (0| |\-0|\-)\.000[0-6].[0-9] * (0| |\-0|\-)\.0000[01][0-9] * 1\.3975(1|2)[0-9]" $log | wc -l`
CRIT5=`$GREP "6 * 2\.83143[0-9] * (\-0|\-|0| )\.00000[0-9] * 0*\.5296(2|3)[0-9] * (\-0|\-|0| )\.00000[0-9] * (\-0|\-|0| )\.00000[0-9] * 0*\.5296[2-3][0-9]" $log | wc -l`
TEST[32]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[32]=5
ERROR[32]="POLARIZABILITY SECOND DERIVATIVES NOT CORRECT"

# Vibrationally averaged dipole moment
CRIT1=`$GREP "X * (\-0| \-)\.7279563[0-9] * 0*\.0079[2-3]..[0-9] * (\-0| \-)\.72002..[0-9]" $log | wc -l`
TEST[33]=`expr	$CRIT1`
CTRL[33]=1
ERROR[33]="VIBRATIONALLY AVERAGED DIPOLE MOMENT NOT CORRECT"

# Vibrationally averaged magnetizabilities
CRIT1=`$GREP "XX * \-3\.2237416[0-9] * (\-0| \-)\.0075[0-5]..[0-9] * \-3\.2312[5-9]..[0-9]" $log | wc -l`
CRIT2=`$GREP "XY * 0*\.0000000[0-9] * (\-0|\-|0| )\.0000[0-4][0-9][0-9][0-9] * (\-0|\-|0| )\.0000[0-4][0-9][0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "YY * \-3\.2502155[0-9] * 0*\.0017[6-7]..[0-9] * \-3\.2484[3-6]..[0-9]" $log | wc -l`
CRIT4=`$GREP "ZZ * \-3\.2502155[0-9] * 0*\.001(77|78|79|80|81|82|83|84)..[0-9] * \-3\.248[3-4]...[0-9]" $log | wc -l`
TEST[34]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[34]=4
ERROR[34]="VIBRATIONALLY AVERAGED MAGNETIZABILITIES NOT CORRECT"

# Vibrationally averaged g-tensor
CRIT1=`$GREP "AX * 0*\.4139216[0-9] * 0*\.0013[7-9][0-9][0-9][0-9] * 0*\.4153[0-1]..[0-9]" $log | wc -l`
CRIT2=`$GREP "BX * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000[0-3][0-9][0-9][0-9] * (\-0|\-|0| )\.0000[0-3][0-9][0-9][0-9]" $log | wc -l`
CRIT3=`$GREP "CX * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000[0-7][0-9][0-9][0-9] * (\-0|\-|0| )\.0000[0-7][0-9][0-9][0-9]" $log | wc -l`
CRIT4=`$GREP "AY * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000[0-3][0-9][0-9][0-9] * (\-0|\-|0| )\.0000[0-3][0-9][0-9][0-9]" $log | wc -l`
CRIT5=`$GREP "BY * 0*\.4685387[0-9] * (\-0| \-)\.0036[1-2][0-9][0-9][0-9] * 0*\.4649[1-2][0-9][0-9][0-9]" $log | wc -l`
CRIT6=`$GREP "CY * (0| |\-0|\-)\.0000000[0-9] * (\-0|\-|0| )\.00000[0-9][0-9][0-9] * (\-0|\-|0| )\.00000[0-9][0-9][0-9]" $log | wc -l`
CRIT7=`$GREP "AZ * (\-0|\-|0| )\.0000000[0-9] * (\-0|\-|0| )\.0000[0-7][0-9][0-9][0-9] * (\-0|\-|0| )\.0000[0-7][0-9][0-9][0-9]" $log | wc -l`
CRIT8=`$GREP "BZ * (0| |\-0|\-)\.0000000[0-9] * (\-0|\-|0| )\.00000[0-9][0-9][0-9] * (\-0|\-|0| )\.00000[0-9][0-9][0-9]" $log | wc -l`
CRIT9=`$GREP "CZ * 0*\.4685386[0-9] * (\-0| \-)\.0036[2-5]..[0-9] * 0*\.464[8-9]...[0-9]" $log | wc -l`
TEST[35]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9`
CTRL[35]=9
ERROR[35]="VIBRATIONALLY AVERAGED G-TENSOR NOT CORRECT"

# Vibrationally averaged nuclear magnetic shielding constants for nitrogen
CRIT1=`$GREP "Bxmx * 290\.4388...[0-9] * 0*\.66[0-7]....[0-9] * 291\.(098|099|100|101|102|103|104|105|106|107)....[0-9]" $log | wc -l`
CRIT2=`$GREP "Bymx * 0*\.000000.[0-9] * (\-0|\-|0| )\.00[0-8]....[0-9] * (\-0|\-|0| )\.00[0-8]....[0-9]" $log | wc -l`
CRIT3=`$GREP "Bxmy * (\-0|\-)\.000000.[0-9] * (\-0|\-|0| )\.00[0-9]....[0-9] * (\-0|\-|0| )\.00[0-9]....[0-9]" $log | wc -l`
CRIT4=`$GREP "Bymy * 304\.4396...[0-9] * \-2\.05[7-9]....[0-9] * 302\.38[0-3]....[0-9]" $log | wc -l`
CRIT5=`$GREP "Bzmz * 304\.4396...[0-9] * \-2\.0[5-6].....[0-9] * 302\.3[7-8].....[0-9]" $log | wc -l`
TEST[36]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[36]=5
ERROR[36]="VIBRATIONALLY AVERAGED NUCLEAR MAGNETIC SHIELDING CONSTANTS FOR NITROGEN NOT CORRECT"

# Vibrationally averaged nuclear magnetic shielding constants for hydrogen1
CRIT1=`$GREP "Bxmx * 27\.65775..[0-9] * (\-0| \-)\.0[4-6].....[0-9] * 27\.[5-6]......[0-9]" $log | wc -l`
CRIT2=`$GREP "Bzmx * \-3\.088239.[0-9] * 0*\.0[6-8].....[0-9] * \-3\.0[0-2].....[0-9]" $log | wc -l`
CRIT3=`$GREP "Bzmy * 4\.925179.[0-9] * (\-0| \-)\.0[5-6].....[0-9] * 4\.8[6-7].....[0-9]" $log | wc -l`
CRIT4=`$GREP "Bxmz * \-4\.303904.[0-9] * 0*\.0[3-5].....[0-9] * \-4\.2[4-6].....[0-9]" $log | wc -l`
CRIT5=`$GREP "Bymz * 4\.925179.[0-9] * (\-0| \-)\.0[5-6].....[0-9] * 4\.8[6-7].....[0-9]" $log | wc -l`
# expr 3 + 1 + 1 + 1 + 1
TEST[37]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5`
CTRL[37]=6
ERROR[37]="VIBRATIONALLY AVERAGED NUCLEAR MAGNETIC SHIELDING CONSTANTS FOR HYDROGEN1 NOT CORRECT"

# Vibrationally averaged nuclear magnetic shielding constants for hydrogen3
CRIT1=`$GREP "Bymx * 3\.565991.[0-9] * (\-0|\-)\.0[7-9].....[0-9] * 3\.4[7-8].....[0-9]" $log | wc -l`
CRIT2=`$GREP "Bxmy * 4\.969719.[0-9] * (\-0|\-)\.0[4-6].....[0-9] * 4\.9[0-2].....[0-9]" $log | wc -l`
CRIT3=`$GREP "Bymy * 40\.25703..[0-9] * (\-0| \-)\.(19|20).....[0-9] * 40\.0[5-6].....[0-9]" $log | wc -l`
CRIT4=`$GREP "Bzmz * 28\.88282..[0-9] * (\-0|\-)\.06[6-7]....[0-9] * 28\.81[5-6]....[0-9]" $log | wc -l`
TEST[38]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[38]=4
ERROR[38]="VIBRATIONALLY AVERAGED NUCLEAR MAGNETIC SHIELDING CONSTANTS FOR HYDROGEN3 NOT CORRECT"

# Vibrationally averaged static polarizabilities
CRIT1=`$GREP "XX * 1\.394984.[0-9] * 0*\.08(37|38|39|40|41)...[0-9] * 1\.47(87|88|89|90|91)...[0-9]" $log | wc -l`
CRIT2=`$GREP "YY * 5\.719486.[0-9] * 0*\.120[2-5]...[0-9] * 5\.839[7-9]...[0-9]" $log | wc -l`
CRIT3=`$GREP "ZZ * 5\.719484.[0-9] * 0*\.120[4-9]...[0-9] * 5\.8(399|400|401|402|403|404|405)...[0-9]" $log | wc -l`
TEST[39]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[39]=3
ERROR[39]="VIBRATIONALLY AVERAGED STATIC POLARIZABILITIES NOT CORRECT"

# Final energy
CRIT1=`$GREP "Final * HF energy\: * \-55\.4551193324.[0-9]" $log | wc -l`
TEST[40]=`expr	$CRIT1`
CTRL[40]=2
ERROR[40]="FINAL ENERGY NOT CORRECT"

PASSED=1
for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 20 21 22 24 25 \
         26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
do
   if [ ${TEST[i]} -lt ${CTRL[i]} ]; then
     echo "${ERROR[i]} ( test = ${TEST[i]}; control = ${CTRL[i]} ); "
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi


%EOF%
#######################################################################
