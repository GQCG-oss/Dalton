#!/bin/sh

info='
   dft_b3lyp_magsus_nosym 
   ----------------------
   Molecule:         HOF
   Wave Function:    DFT (B3LYP) / 6-31G** 
   Test Purpose:     Test magnetizability and molecular
                     rotational g-factor calculation 
'

molecule='BASIS
6-31G**
HOF B3LYP/6-31g**

    3   0
        1.    1
H         -1.7477891561           -1.7077611826             .0000000000
        8.    1
O         -1.4230900102             .1042645372             .0000000000
        9.    1
F          1.2876238525            -.0038104469             .0000000000
'

dalton='**DALTON INPUT
.RUN WAVE FUNCTION
.PROPERTIES
**WAVE FUNCTIONS
.DFT
 B3LYP
**PROPERTIES
.MAGNET
**END OF INPUT
'

test='

check_scf_energy DFT -175.457032841072 5e-8

check_magnetizabilities -2.8715 -9.7870 6.9155 -1.8761 1.1057

check_mag_tensors 1e-6 "
       -4.122228940351      0.003446281640      0.000000000000
        0.003446281640     -2.134349705410      0.000000000000
        0.000000000000      0.000000000000     -2.357867371547
" "
       -4.383056381853      0.104164597233      0.000000000000
        0.104164597233    -12.310513819040      0.000000000000
        0.000000000000      0.000000000000    -12.667450435702
" "
        0.260827441502     -0.100718315594      0.000000000000
       -0.100718315594     10.176164113630      0.000000000000
        0.000000000000      0.000000000000     10.309583064155
"

check_g_tensors 1e-6 "
      0.62564831 -0.02129130  0.00000000
     -0.45875032 -0.09788415  0.00000000
      0.00000000  0.00000000 -0.05846854
" "
      0.96244318 -0.02229256  0.00000000
     -0.48032390  0.51435972  0.00000000
      0.00000000  0.00000000  0.53423357
" "
     -0.37306684  0.00865692  0.00000000
      0.18652522 -0.54293313  0.00000000
      0.00000000  0.00000000 -0.51654105
" "
      0.03627197 -0.00765565  0.00000000
     -0.16495164 -0.06931074  0.00000000
      0.00000000  0.00000000 -0.07616106
"
'
. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"


# check_basis "6-31G**" "
# H 1 1  4s1p 2s1p
# O 1 6  10s4p1d 3s2p1d
# F 1 9  10s4p1d 3s2p1d

