#!/bin/sh

info='
   dft_b3lyp_magsus_nosym 
   ----------------------
   Molecule:         HOF
   Wave Function:    DFT (B3LYP) / 6-31G** 
   Test Purpose:     Test magnetizability and molecular
                     rotational g-factor calculation 
'

molecule='BASIS
6-31G**
HOF B3LYP/6-31g**

    3   0
        1.    1
H         -1.7477891561           -1.7077611826             .0000000000
        8.    1
O         -1.4230900102             .1042645372             .0000000000
        9.    1
F          1.2876238525            -.0038104469             .0000000000
'

dalton='**DALTON INPUT
.RUN WAVE FUNCTION
.PROPERTIES
**WAVE FUNCTIONS
.DFT
 B3LYP
**PROPERTIES
.MAGNET
**END OF INPUT
'

test='

check_scf_energy DFT -175.457032841072 5e-8

check_magnetizabilities -2.8715 -9.7870 6.9155 -1.8761 1.1057

check_mag_tensors 1e-6 "
       -4.122228954409      0.003449331213      0.000000000000
        0.003449331213     -2.134350619245      0.000000000000
        0.000000000000      0.000000000000     -2.357871791822
" "
       -4.383056816324      0.104164935193      0.000000000000
        0.104164935193    -12.310515590636      0.000000000000
        0.000000000000      0.000000000000    -12.667452677000
" "
        0.260827861915     -0.100715603980      0.000000000000
       -0.100715603980     10.176164971391      0.000000000000
        0.000000000000      0.000000000000     10.309580885177
"

check_g_tensors 1e-6 "
      0.62564771     -0.02129146      0.00000000
     -0.45875383     -0.09788420      0.00000000
      0.00000000      0.00000000     -0.05846841
" "
      0.96244318 -0.02229256  0.00000000
     -0.48032390  0.51435972  0.00000000
      0.00000000  0.00000000  0.53423357
" "
     -0.37306738      0.00865676      0.00000000
      0.18652185     -0.54293319      0.00000000
      0.00000000      0.00000000     -0.51654090
" "
      0.03627191     -0.00765566      0.00000000
     -0.16495179     -0.06931073      0.00000000
      0.00000000      0.00000000     -0.07616108
"
'
. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"


# check_basis "6-31G**" "
# H 1 1  4s1p 2s1p
# O 1 6  10s4p1d 3s2p1d
# F 1 9  10s4p1d 3s2p1d

