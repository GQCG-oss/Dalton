#!/bin/sh

info='
   dft_camb3lyp_magsus 
   ----------------------
   Molecule:         HOF
   Wave Function:    DFT (CAM-B3LYP) / 6-31G** 
   Test Purpose:     Test magnetizability and molecular
                     rotational g-factor calculation with
                     Coulomb attenuated functional 
'

molecule='BASIS
6-31G**
HOF B3LYP/6-31G**

    3   0 
        1.    1
H         -1.7477891561           -1.7077611826             .0000000000
        8.    1
O         -1.4230900102             .1042645372             .0000000000
        9.    1
F          1.2876238525            -.0038104469             .0000000000
'

dalton='**DALTON INPUT
.RUN WAVE FUNCTION
.PROPERTIES
.DIRECT
**WAVE FUNCTIONS
.DFT
 CAMB3LYP
**PROPERTIES
.MAGNET
**END OF INPUT
'

test='
check_scf_energy DFT -175.475531229427 5e-8

check_mag_tensors 1e-6 "
       -4.132994288366     -0.000099117074      0.000000000000
       -0.000099117074     -2.170373714016     -0.000000000000
        0.000000000000     -0.000000000000     -2.400512150173

" "
       -4.383995451571      0.098463941843      0.000000000000
        0.098463941843    -12.316577919439      0.000000000000
        0.000000000000      0.000000000000    -12.669023183019
" "
        0.251001163205     -0.098563058917      0.000000000000
       -0.098563058917     10.146204205422     -0.000000000000
        0.000000000000     -0.000000000000     10.268511032846
"

check_g_tensors 1e-6 "
      0.63833964     -0.02141067     -0.00000000
     -0.46132231     -0.09607969      0.00000000
     -0.00000000      0.00000000     -0.05610729
" "
      0.96244318     -0.02229256      0.00000000
     -0.48032390      0.51435972      0.00000000
      0.00000000      0.00000000      0.53423357
" "
     -0.35993401      0.00853395      0.00000000
      0.18387571     -0.54174873     -0.00000000
      0.00000000     -0.00000000     -0.51455045
" "
      0.03583048     -0.00765206     -0.00000000
     -0.16487412     -0.06869068      0.00000000
     -0.00000000      0.00000000     -0.07579041
"
'
. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"


# check_basis "6-31G**" "
# H 1 1  4s1p 2s1p
# O 1 6  10s4p1d 3s2p1d
# F 1 9  10s4p1d 3s2p1d

