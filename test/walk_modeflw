
#######################################################################
#  TEST DESCRIPTION
#######################################################################
#
#*# walk_modeflw
#*# ------------
#*# Molecule:         NH3
#*# Wave Function:    SCF
#*# Test Purpose:     Locating a transition state using mode following
#
#######################################################################
#  MOLECULE INPUT
#######################################################################
cat > walk_modeflw.mol <<%EOF%
ATOMBASIS
Location of saddle point (transition state) by following
a specific eigenmode (test55)
c   2    0
        7.    1      6-31G**
N          -.2402098951            -.0000003109             .5147128871
        1.    3      6-31G**
H          1.4837091636             .0000000802            -.2633317998
H         -1.1558499044            1.5260201343            -.1256905028
H         -1.1558492311           -1.5260211423            -.1256905447
%EOF%

#######################################################################
#  DALTON INPUT
#######################################################################
cat > walk_modeflw.dal <<%EOF%
**GENERAL
.WALK
*WALK
.INDEX
  1
.MODFOL
.MODE
 -1
**WAVE FUNCTION
.HF
**FINAL
.VIBANA
.POPANA
*END OF INPUT
%EOF%
#######################################################################



#######################################################################

#######################################################################
#  CHECK SCRIPT
#######################################################################
echo '#!/bin/ksh
log=$1

if [ `uname` = IRIX64 ]; then
   GREP="egrep"
else
   GREP="egrep -a"
fi

# WALK module
CRIT1=`$GREP "Commencing geometry optimization using \.WALK" $log | wc -l`
TEST[1]=`expr	$CRIT1`
CTRL[1]=1
ERROR[1]="WALK MODULE NOT USED"

# Atombasis
CRIT1=`$GREP "N * 1 * 7 * 28 * 15 * \[10s4p1d\|3s2p1d\]" $log | wc -l`
CRIT2=`$GREP "H * 1 * 1 * 7 * 5 * \[4s1p\|2s1p\]" $log | wc -l`
CRIT3=`$GREP "total\: * 4 * 10 * 49 * 30" $log | wc -l`
TEST[2]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[2]=5
ERROR[2]="ATOMBASIS NOT READ CORRECTLY"

# Cartesian functions
CRIT1=`$GREP "Cartesian basis used\. " $log | wc -l`
TEST[3]=`expr	$CRIT1`
CTRL[3]=1
ERROR[3]="CARTESIAN BASIS FUNCTIONS NOT USED"

# Geometry
CRIT1=`$GREP "Total number of coordinates\: 12" $log | wc -l`
CRIT2=`$GREP "1 * N * x * \-0\.2402098951" $log | wc -l`
CRIT3=`$GREP "2 * y * \-0\.0000003109" $log | wc -l`
CRIT4=`$GREP "3 * z * 0\.5147128871" $log | wc -l`
CRIT5=`$GREP "4 * H * x * 1\.4837091636" $log | wc -l`
CRIT6=`$GREP "5 * y * 0\.0000000802" $log | wc -l`
CRIT7=`$GREP "6 * z * \-0\.2633317998" $log | wc -l`
CRIT8=`$GREP "7 * H * x * \-1\.1558499044" $log | wc -l`
CRIT9=`$GREP "8 * y * 1\.5260201343" $log | wc -l`
CRIT10=`$GREP "9 * z * \-0\.1256905028" $log | wc -l`
CRIT11=`$GREP "10 * H * x * \-1\.1558492311" $log | wc -l`
CRIT12=`$GREP "11 * y * \-1\.5260211423" $log | wc -l`
CRIT13=`$GREP "12 * z * \-0\.1256905447" $log | wc -l`
TEST[4]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13`
CTRL[4]=13
ERROR[4]="MOLECULAR GEOMETRY NOT READ CORRECTLY"

# Initial energy
CRIT1=`$GREP "Final * HF energy\: * \-56\.19554475264[0-9]" $log | wc -l`
TEST[5]=`expr	$CRIT1`
CTRL[5]=1
ERROR[5]="INITIAL ENERGY NOT CORRECT"

# Optimization setup
CRIT1=`$GREP "Walk type\: Level\-shifted Newton walk \(mode following\)" $log | wc -l`
CRIT2=`$GREP "Index of critical point searched\: 1" $log | wc -l`
CRIT3=`$GREP "Hessian mode selection \: * \-1" $log | wc -l`
TEST[6]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[6]=6
ERROR[6]="GEOMETRY OPTIMIZATION NOT SET UP CORRECTLY"

# Initial gradient
CRIT1=`$GREP "N * 0\.000000296[0-9] * \-0\.000000000[0-9] * 0\.000003196[0-9]" $log | wc -l`
CRIT2=`$GREP "H * 0\.000000205[0-9] * 0\.0000000000 * \-0\.000001047[0-9]" $log | wc -l`
CRIT3=`$GREP "H * \-0\.000000251[0-9] * 0\.000000346[0-9] * \-0\.000001074[0-9]" $log | wc -l`
CRIT4=`$GREP "H * \-0\.000000251[0-9] * \-0\.000000346[0-9] * \-0\.000001074[0-9]" $log | wc -l`
TEST[7]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[7]=4
ERROR[7]="INITIAL GRADIENT NOT CORRECT"

# Initial Hessian
CRIT1=`$GREP "N * x * 0\.74534[0-9]" $log | wc -l`
CRIT2=`$GREP "N * y * 0\.000000 * 0\.74669[0-9]" $log | wc -l`
CRIT3=`$GREP "N * z * \-0\.02598[0-9] * 0\.000000 * 0\.24846[0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * \-0\.40635[0-9] * \-0\.00000[0-9] * 0\.14932[0-9] * 0\.44364[0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * 0\.000000 * \-0\.07353[0-9] * 0\.000000 * 0\.00000[0-9] * 0\.06926[0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * 0\.21103[0-9] * 0\.000000 * \-0\.10028[0-9] * \-0\.17352[0-9] * 0\.000000 * 0\.09503[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * \-0\.16949[0-9] * 0\.16042[0-9] * \-0\.06167[0-9] * \-0\.01864[0-9] * 0\.03784[0-9] * \-0\.01875[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * 0\.15763[0-9] * \-0\.33658[0-9] * 0\.10662[0-9] * \-0\.00339[0-9] * 0\.00213[0-9] * 0\.00143[0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * \-0\.09252[0-9] * 0\.15999[0-9] * \-0\.07409[0-9] * 0\.01209[0-9] * \-0\.01855[0-9] * 0\.00262[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * \-0\.16949[0-9] * \-0\.16042[0-9] * \-0\.06167[0-9] * \-0\.01864[0-9] * \-0\.03784[0-9] * \-0\.01875[0-9]" $log | wc -l`
CRIT11=`$GREP "H * y * \-0\.15763[0-9] * \-0\.33658[0-9] * \-0\.10662[0-9] * 0\.00339[0-9] * 0\.00213[0-9] * \-0\.00143[0-9]" $log | wc -l`
CRIT12=`$GREP "H * z * \-0\.09252[0-9] * \-0\.15999[0-9] * \-0\.07409[0-9] * 0\.01209[0-9] * 0\.01855[0-9] * 0\.00262[0-9]" $log | wc -l`
CRIT13=`$GREP "H * x * 0\.17492[0-9]" $log | wc -l`
CRIT14=`$GREP "H * y * \-0\.17625[0-9] * 0\.36287[0-9]" $log | wc -l`
CRIT15=`$GREP "H * z * 0\.07216[0-9] * \-0\.12475[0-9] * 0\.07014[0-9]" $log | wc -l`
CRIT16=`$GREP "H * x * 0\.01321[0-9] * 0\.02201[0-9] * 0\.00826[0-9] * 0\.17492[0-9]" $log | wc -l`
CRIT17=`$GREP "H * y * \-0\.02201[0-9] * \-0\.02843[0-9] * \-0\.01669[0-9] * 0\.17625[0-9] * 0\.36287[0-9]" $log | wc -l`
CRIT18=`$GREP "H * z * 0\.00826[0-9] * 0\.01669[0-9] * 0\.00132[0-9] * 0\.07216[0-9] * 0\.12475[0-9] * 0\.07014[0-9]" $log | wc -l`
TEST[8]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18`
CTRL[8]=18
ERROR[8]="INITIAL HESSIAN NOT CORRECT"

# Initial step
CRIT1=`$GREP "N * \-0\.010743300[0-9] * 0\.000002100[0-9] * \-0\.206057661[0-9]" $log | wc -l`
CRIT2=`$GREP "H * 0\.108692132[0-9] * \-0\.000004215[0-9] * 0\.063205261[0-9]" $log | wc -l`
CRIT3=`$GREP "H * \-0\.048977472[0-9] * 0\.091148043[0-9] * 0\.071426833[0-9]" $log | wc -l`
CRIT4=`$GREP "H * \-0\.048971360[0-9] * \-0\.091145928[0-9] * 0\.071425566[0-9]" $log | wc -l`
TEST[9]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[9]=4
ERROR[9]="INITIAL STEP NOT CORRECT"

# Second energy
CRIT1=`$GREP "Final * HF energy\: * \-56\.19077735967[0-9]" $log | wc -l`
TEST[10]=`expr	$CRIT1`
CTRL[10]=1
ERROR[10]="SECOND ENERGY NOT CORRECT"

# Second gradient
CRIT1=`$GREP "N * \-0\.000460502[0-9] * 0\.000000427[0-9] * \-0\.008837004[0-9]" $log | wc -l`
CRIT2=`$GREP "H * 0\.020484259[0-9] * \-0\.000000704[0-9] * 0\.001885567[0-9]" $log | wc -l`
CRIT3=`$GREP "H * \-0\.010012369[0-9] * 0\.017630133[0-9] * 0\.003475811[0-9]" $log | wc -l`
CRIT4=`$GREP "H * \-0\.010011387[0-9] * \-0\.017629855[0-9] * 0\.003475625[0-9]" $log | wc -l`
TEST[11]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[11]=4
ERROR[11]="SECOND GRADIENT NOT CORRECT"

# Second Hessian
CRIT1=`$GREP "N * x * 0\.78943[0-9]" $log | wc -l`
CRIT2=`$GREP "N * y * \-0\.00000[0-9] * 0\.79138[0-9]" $log | wc -l`
CRIT3=`$GREP "N * z * \-0\.03731[0-9] * 0\.00000[0-9] * 0\.07583[0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * \-0\.43007[0-9] * 0\.00000[0-9] * 0\.09933[0-9] * 0\.45240[0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * 0\.00000[0-9] * \-0\.08609[0-9] * 0\.000000 * \-0\.00000[0-9] * 0\.07538[0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * 0\.14073[0-9] * 0\.000000 * \-0\.03604[0-9] * \-0\.11393[0-9] * 0\.000000 * 0\.04381[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * \-0\.17968[0-9] * 0\.15907[0-9] * \-0\.03101[0-9] * \-0\.01116[0-9] * 0\.03346[0-9] * \-0\.01339[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * 0\.15720[0-9] * \-0\.35264[0-9] * 0\.05960[0-9] * \-0\.00608[0-9] * 0\.00535[0-9] * 0\.00038[0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * \-0\.05171[0-9] * 0\.09541[0-9] * \-0\.01989[0-9] * 0\.00730[0-9] * \-0\.01364[0-9] * \-0\.00388[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * \-0\.17968[0-9] * \-0\.15907[0-9] * \-0\.03101[0-9] * \-0\.01116[0-9] * \-0\.03346[0-9] * \-0\.01339[0-9]" $log | wc -l`
CRIT11=`$GREP "H * y * \-0\.15720[0-9] * \-0\.35264[0-9] * \-0\.05960[0-9] * 0\.00608[0-9] * 0\.00535[0-9] * \-0\.00038[0-9]" $log | wc -l`
CRIT12=`$GREP "H * z * \-0\.05171[0-9] * \-0\.09541[0-9] * \-0\.01989[0-9] * 0\.00730[0-9] * 0\.01364[0-9] * \-0\.00388[0-9]" $log | wc -l`
CRIT13=`$GREP "H * x * 0\.17673[0-9]" $log | wc -l`
CRIT14=`$GREP "H * y * \-0\.17183[0-9] * 0\.36620[0-9]" $log | wc -l`
CRIT15=`$GREP "H * z * 0\.03854[0-9] * \-0\.07088[0-9] * 0\.02866[0-9]" $log | wc -l`
CRIT16=`$GREP "H * x * 0\.01411[0-9] * 0\.02070[0-9] * 0\.00586[0-9] * 0\.17673[0-9]" $log | wc -l`
CRIT17=`$GREP "H * y * \-0\.02070[0-9] * \-0\.01892[0-9] * \-0\.01088[0-9] * 0\.17183[0-9] * 0\.36620[0-9]" $log | wc -l`
CRIT18=`$GREP "H * z * 0\.00586[0-9] * 0\.01088[0-9] * \-0\.00488[0-9] * 0\.03854[0-9] * 0\.07088[0-9] * 0\.02866[0-9]" $log | wc -l`
TEST[12]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12 \+ \
		$CRIT13 \+ $CRIT14 \+ $CRIT15 \+ $CRIT16 \+ $CRIT17 \+ $CRIT18`
CTRL[12]=18
ERROR[12]="SECOND HESSIAN NOT CORRECT"

# Third energy
CRIT1=`$GREP "Final * HF energy\: * \-56\.18573488348[0-9]" $log | wc -l`
TEST[13]=`expr	$CRIT1`
CTRL[13]=1
ERROR[13]="THIRD ENERGY NOT CORRECT"

# Final energy
CRIT1=`$GREP "\@ Energy at current point\: * \-56\.186762439[0-9]" $log | wc -l`
TEST[14]=`expr	$CRIT1`
CTRL[14]=1
ERROR[14]="FINAL ENERGY NOT CORRECT"

# Convergence
CRIT1=`$GREP "\@ Geometry optimization has converged\." $log | wc -l`
TEST[15]=`expr	$CRIT1`
CTRL[15]=1
ERROR[15]="GEOMETRY OPTIMIZATION NOT CONVERGED"

# Final gradient and Hessian eigenvalues
CRIT1=`$GREP "\@ 1 * 1 * 0\.000002016[0-9] * \-0\.103754500[0-9]" $log | wc -l`
CRIT2=`$GREP "\@ 1 * 2 * 0\.000000000[0-9] * 0\.157839985[0-9]" $log | wc -l`
CRIT3=`$GREP "\@ 1 * 3 * 0\.000000000[0-9] * 0\.157840115[0-9]" $log | wc -l`
CRIT4=`$GREP "\@ 1 * 4 * \-0\.000007826[0-9] * 0\.562553328[0-9]" $log | wc -l`
CRIT5=`$GREP "\@ 1 * 5 * \-0\.000000000[0-9] * 1\.472952051[0-9]" $log | wc -l`
CRIT6=`$GREP "\@ 1 * 6 * \-0\.00000000[0-9][0-9] * 1\.472952104[0-9]" $log | wc -l`
TEST[16]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[16]=6
ERROR[16]="FINAL GRADIENT AND HESSIAN EIGENVALUES NOT CORRECT"

# Final geometry
CRIT1=`$GREP "N * \-0\.267050733[0-9] * \-0\.000000309[0-9] * \-0\.000014696[0-9]" $log | wc -l`
CRIT2=`$GREP "H * 1\.594707988[0-9] * 0\.000000100[0-9] * \-0\.097077391[0-9]" $log | wc -l`
CRIT3=`$GREP "H * \-1\.197928911[0-9] * 1\.614519544[0-9] * 0\.048546219[0-9]" $log | wc -l`
CRIT4=`$GREP "H * \-1\.197928210[0-9] * \-1\.614520574[0-9] * 0\.048545908[0-9]" $log | wc -l`
TEST[17]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4`
CTRL[17]=16
ERROR[17]="FINAL GEOMETRY NOT CORRECT"

# Final analysis
CRIT1=`$GREP "Vibrational analysis" $log | wc -l`
CRIT2=`$GREP "Cioslowski population analysis and static polarizabilities only\." $log | wc -l`
TEST[18]=`expr	$CRIT1 \+ $CRIT2`
CTRL[18]=3
ERROR[18]="FINAL ANALYSIS NOT SET UP CORRECTLY"

# Dipole moment gradient
CRIT1=`$GREP "N * x * \-0\.4673008[0-9] * 0\.00000000 * \-0\.0391722[0-9]" $log | wc -l`
CRIT2=`$GREP "N * y * 0\.00000000 * \-0\.4652581[0-9] * 0\.0000000[0-9]" $log | wc -l`
CRIT3=`$GREP "N * z * \-0\.0391725[0-9] * \-0\.0000004[0-9] * \-1\.2164684[0-9]" $log | wc -l`
CRIT4=`$GREP "H * x * 0\.1520990[0-9] * 0\.00000000 * 0\.0132461[0-9]" $log | wc -l`
CRIT5=`$GREP "H * y * 0\.00000000 * 0\.1587635[0-9] * \-0\.0000000[0-9]" $log | wc -l`
CRIT6=`$GREP "H * z * 0\.0132436[0-9] * 0\.0000001[0-9] * 0\.4054799[0-9]" $log | wc -l`
CRIT7=`$GREP "H * x * 0\.1576008[0-9] * 0\.0031802[0-9] * 0\.0129630[0-9]" $log | wc -l`
CRIT8=`$GREP "H * y * 0\.0031803[0-9] * 0\.1532473[0-9] * \-0\.0001680[0-9]" $log | wc -l`
CRIT9=`$GREP "H * z * 0\.0129644[0-9] * \-0\.0001701[0-9] * 0\.4054942[0-9]" $log | wc -l`
CRIT10=`$GREP "H * x * 0\.1576008[0-9] * \-0\.0031802[0-9] * 0\.0129630[0-9]" $log | wc -l`
CRIT11=`$GREP "H * y * \-0\.0031803[0-9] * 0\.1532473[0-9] * 0\.0001680[0-9]" $log | wc -l`
CRIT12=`$GREP "H * z * 0\.0129644[0-9] * 0\.0001704[0-9] * 0\.4054942[0-9]" $log | wc -l`
TEST[19]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6 \+ \
		$CRIT7 \+ $CRIT8 \+ $CRIT9 \+ $CRIT10 \+ $CRIT11 \+ $CRIT12`
CTRL[19]=12
ERROR[19]="DIPOLE MOMENT GRADIENT NOT CORRECT"

# Cioslowski charges
CRIT1=`$GREP "N * \-0\.71634[0-9]" $log | wc -l`
CRIT2=`$GREP "H * 0\.23878[0-9]" $log | wc -l`
TEST[20]=`expr	$CRIT1 \+ $CRIT2`
CTRL[20]=4
ERROR[20]="CIOSLOWSKI CHARGES NOT CORRECT"

# Static polarizabilities
CRIT1=`$GREP "Ex * 8\.46766[0-9] * 0\.000000 * \-0\.22596[0-9]" $log | wc -l`
CRIT2=`$GREP "Ey * 0\.000000 * 8\.47944[0-9] * 0\.000000" $log | wc -l`
CRIT3=`$GREP "Ez * \-0\.22596[0-9] * 0\.000000 * 4\.14608[0-9]" $log | wc -l`
TEST[21]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3`
CTRL[21]=3
ERROR[21]="STATIC POLARIZABILITIES NOT CORRECT"

# Rotational constants
CRIT1=`$GREP "343489\.069[0-9] * 343489\.068[0-9] * 171744\.534[0-9] MHz" $log | wc -l`
CRIT2=`$GREP "11\.45756[0-9] * 11\.45756[0-9] * 5\.72878[0-9] cm\-1" $log | wc -l`
TEST[22]=`expr	$CRIT1 \+ $CRIT2`
CTRL[22]=2
ERROR[22]="ROTATIONAL CONSTANTS NOT CORRECT"

# Vibrational frequencies
CRIT1=`$GREP "1 * A * 4065\.9[0-9] * 0\.01852[0-9] * 43\.34[0-9] * 1\.025[0-9]" $log | wc -l`
CRIT2=`$GREP "2 * A * 4065\.9[0-9] * 0\.01852[0-9] * 43\.34[0-9] * 1\.025[0-9]" $log | wc -l`
CRIT3=`$GREP "3 * A * 3840\.5[0-9] * 0\.01749[0-9] * 0\.000 * 0\.0000" $log | wc -l`
CRIT4=`$GREP "4 * A * 1714\.3[0-9] * 0\.00781[0-9] * 41\.55[0-9] * 0\.983[0-9]" $log | wc -l`
CRIT5=`$GREP "5 * A * 1714\.3[0-9] * 0\.00781[0-9] * 41\.55[0-9] * 0\.983[0-9]" $log | wc -l`
CRIT6=`$GREP "6 * A * 909\.3[0-9]i * 0\.00414[0-9]i" $log | wc -l`
TEST[23]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[23]=6
ERROR[23]="VIBRATIONAL FREQUENCIES NOT CORRECT"

# Partition function
CRIT1=`$GREP "50\.00 * 3\.180[0-9](D|E)\+04 * 13\.9[0-9] * 1\.0000 * 4\.44244[0-9](D|E)\+05" $log | wc -l`
CRIT2=`$GREP "200\.00 * 1\.017[0-9](D|E)\+06 * 107\.3[0-9] * 1\.0000 * 1\.09284[0-9](D|E)\+08" $log | wc -l`
CRIT3=`$GREP "273\.15 * 2\.218[0-9](D|E)\+06 * 170\.7[0-9] * 1\.000[0-9] * 3\.78935[0-9](D|E)\+08" $log | wc -l`
CRIT4=`$GREP "298\.15 * 2\.761[0-9](D|E)\+06 * 194\.5[0-9] * 1\.000[0-9] * 5\.37594[0-9](D|E)\+08" $log | wc -l`
CRIT5=`$GREP "500\.00 * 1\.005[0-9](D|E)\+07 * 421\.0[0-9] * 1\.014[0-9] * 4\.29600[0-9](D|E)\+09" $log | wc -l`
CRIT6=`$GREP "2000\.00 * 3\.218[0-9](D|E)\+08 * 3354\.2[0-9] * 2\.373[0-9] * 2\.56200[0-9](D|E)\+12" $log | wc -l`
TEST[24]=`expr	$CRIT1 \+ $CRIT2 \+ $CRIT3 \+ $CRIT4 \+ $CRIT5 \+ $CRIT6`
CTRL[24]=6
ERROR[24]="MOLECULAR PARTITION FUNCTION NOT CORRECT"

PASSED=1
for i in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
do
   if [ ${TEST[i]} -ne ${CTRL[i]} ]; then
     echo ${ERROR[i]}
     PASSED=0
   fi
done

if [ $PASSED -eq 1 ]
then
  echo TEST ENDED PROPERLY
  exit 0
else
  echo THERE IS A PROBLEM
  exit 1
fi

' > walk_modeflw.check
#######################################################################
