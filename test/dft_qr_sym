#!/bin/sh

. functions || { echo "current dir is not the test dir" ; exit 1; }

info="
   dft_qr_sym
   ------------------
   Molecule:         H2O
   Wave Functions:   DFT B3LYP / aug-cc-pVDZ
   Test Purpose:     DFT B3LYP hyperpolarizability test w/ symmetry.
"

molecule="BASIS
aug-cc-pVDZ
Water
aug-cc-pVDZ basis
    2    2  X  Z
        8.    1
O      .0000   -.2249  0.0000000000
        1.    1
H     1.4523    .8996   .0000000000
"

dalton="**DALTON INPUT
.RUN RESPONSE
.DIRECT
**INTEGRAL
.NOSUP
**WAVE FUNCTIONS
.HF
*SCF INPUT
.B3LYP
.THRESHOLD
1e-12
**RESPONSE
*QUADRATIC
.DIPLEN
.THCLR
1e-8
.FREQUENCIES
2
0 0.1
*END OF INPUT
"

test="
check_hf_energy -76.407512410865 1e-12
check_hyperpolarizabilities 0.0 0.0 'Y;Y,Y'   -6.44653306 1e-6
check_hyperpolarizabilities 0.1 0.0 'Y;Y,Y'   -7.96644848 1e-6
check_hyperpolarizabilities 0.1 0.1 'Y;Y,Y'  -13.64170517 1e-6
check_hyperpolarizabilities 0.0 0.0 'X;X,Y'  -16.49276274 1e-6
check_hyperpolarizabilities 0.1 0.0 'X;X,Y'  -18.32265804 1e-6
check_hyperpolarizabilities 0.0 0.1 'X;X,Y'  -18.49651668 1e-6
check_hyperpolarizabilities 0.1 0.1 'X;X,Y'  -23.52657363 1e-6
check_hyperpolarizabilities 0.0 0.0 'Z;Z,Y'   -2.43368811 1e-6
check_hyperpolarizabilities 0.1 0.0 'Z;Z,Y'   -7.95242740 1e-6
check_hyperpolarizabilities 0.0 0.1 'Z;Z,Y'   -2.73589472 1e-6
check_hyperpolarizabilities 0.1 0.1 'Z;Z,Y'  -30.78810773 1e-6
check_hyperpolarizabilities 0.1 0.0 'Y;X,X'  -18.49651668 1e-6
check_hyperpolarizabilities 0.1 0.1 'Y;X,X'  -25.04607465 1e-6
check_hyperpolarizabilities 0.1 0.0 'Y;Z,Z'   -2.73589472 1e-6
check_hyperpolarizabilities 0.1 0.1 'Y;Z,Z'    3.17791279 1e-6
"

check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"
