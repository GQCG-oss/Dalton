#!/bin/sh

info="
   dft_qr_sym
   ------------------
   Molecule:         H2O
   Wave Functions:   DFT B3LYP / STO-3G
   Test Purpose:     DFT B3LYP hyperpolarizability test w/ symmetry.
"

molecule="BASIS
3-21G
Water
STO-3G basis
    2    2  X  Z
        8.    1
O      .0000   -.2249  0.0000000000
        1.    1
H     1.4523    .8996   .0000000000
"

dalton="**DALTON INPUT
.RUN RESPONSE
.DIRECT
**INTEGRAL
.NOSUP
**WAVE FUNCTIONS
.DFT
 B3LYP
*SCF INPUT
.THRESHOLD
1e-12
*DFT INPUT
.GRID TYPE
LMG BLOCK
**RESPONSE
*QUADRATIC
.DIPLEN
.THCLR
1e-8
.FREQUENCIES
2
0 0.1
*END OF INPUT
"

test="
check_scf_energy DFT -75.935846161926 1e-12
check_hyperpolarizabilities 0.0 0.0 'Y;Y,Y' -16.43967357 1e-6
check_hyperpolarizabilities 0.1 0.0 'Y;Y,Y' -18.52705572 1e-6
check_hyperpolarizabilities 0.1 0.1 'Y;Y,Y' -24.54509994 1e-6
check_hyperpolarizabilities 0.0 0.0 'X;X,Y' -24.37803660 1e-6
check_hyperpolarizabilities 0.1 0.0 'X;X,Y' -26.14244152 1e-6
check_hyperpolarizabilities 0.0 0.1 'X;X,Y' -26.52580226 1e-6
check_hyperpolarizabilities 0.1 0.1 'X;X,Y' -30.94049077 1e-6
check_hyperpolarizabilities 0.0 0.0 'Z;Z,Y'  -1.28340470 1e-6
check_hyperpolarizabilities 0.1 0.0 'Z;Z,Y'  -1.65666307 1e-6
check_hyperpolarizabilities 0.0 0.1 'Z;Z,Y'  -1.49477603 1e-6
check_hyperpolarizabilities 0.1 0.1 'Z;Z,Y'  -2.88768136 1e-6
check_hyperpolarizabilities 0.1 0.0 'Y;X,X' -26.91286577 1e-6
check_hyperpolarizabilities 0.1 0.1 'Y;X,X' -33.57950884 1e-6
check_hyperpolarizabilities 0.1 0.0 'Y;Z,Z'  -1.48249412 1e-6
check_hyperpolarizabilities 0.1 0.1 'Y;Z,Z'  -1.88790935 1e-6
"

. ./functions || { echo "'functions' library not found." ; exit 1; }
check_gen_input "$0" "$info" "$molecule" "$dalton" "$test"
