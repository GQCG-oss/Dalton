\chapter{Getting started with \siraba }\label{ch:starting}

In this chapter we give an introduction to the two input files needed
for doing a calculation with the \siraba\ program, as well as the
shell script file that is supplied with the program for moving
relevant files to the scratch-directory and back to the home directory
after a the calculation has completed. A couple of examples of
input files  are also provided. Finally, the different output files
generated by the program are discussed.

\section{The DALTON.INP file}\label{sec:daltoninp}

The \verb|DALTON.INP| file contains the keywords telling the program
what kind of atomic integrals\index{atomic integrals} are wanted (\her , in the
\Sec{*INTEGRALS} input module), what kind of wave
function\index{wave function} is to be used (\sir , in the \Sec{*WAVE
FUNCTIONS} input
module), what kind of molecular properties \index{molecular properties} are
to be evaluated (\aba , in the \Sec{*PROPERTIES} input module), and
finally which response functions\index{response function} that are to
be evaluated (\resp , in
the \Sec{*RESPONSE} input module).

This input file is described in detail in several of the subsequent chapters,
and we will  only give a few examples of input files here and shortly
explain what they do, in order to give the user a flavor of the input
and the computational possibilities
of \siraba .

\subsection{A CASSCF geometry optimization}

We start by a simple geometry optimization\index{geometry
optimization} of a water\index{water} molecule using a Complete
Active Space (CAS)\index{CASSCF} wave function, where we use C$_{2v}$ symmetry
keeping the 1s-orbital on oxygen inactive and distributing the valence
electrons  into 8 orbitals. At the starting geometry we
evaluate the nuclear magnetic shielding constants\index{nuclear
shielding} and the
magnetizability\index{magnetizability} of the water
molecule, and at the optimized geometry we perform a vibrational
analysis\index{vibrational analysis} and calculate the IR
intensities\index{IR intensity}\index{dipole gradient}\index{atomic polar
tensor}\index{APT} (related to the dipole
gradient). The input file for such a calculation will look like:

{\ttfamily
\begin{tabular}{ll}
**DALTON INPUT\hspace{3cm} & Must start all input files\\
.OPTIMIZE\\
***WAVE FUNCTIONS & Wave function input\\
.HF & We start with HF\\
.MP2 & Then MP2 (starting orb. for MCSCF)\\
.MCSCF & Request an MCSCF\\
**HF INPUT & HF input\\
.HF OCCUPATION\\
 3 1 1 0\\
**CONFIGURATION INPUT & Input of active space\\
.SYMMETRY & Wave function symmetry\\
 1\\
.SPIN MULTIPLICITY\\
 1 & Singlet\\
.INACTIVE & Doubly occupied orbitals\\
 1 0 0 0 & 1s on oxygen\\
.CAS SPACE\\
 4 2 2 0\\
.ELECTRONS & Number of electrons to correlate\\
 8 & The valence electrons\\
***START & Input for start geometry\\
.SHIELD & Nuclear shieldings\\
.MAGNET & Magnetizability\\
***FINAL & Input for optimized geometry\\
.DIPGRA & Dipole gradient\\
.VIBANA & Vibrational analysis\\
**END OF INPUT\\
\end{tabular}}

\subsection{A RASSCF calculation of NMR parameters}

The next input file gives an example of the input needed for
evaluating the two parameters determining an NMR spectrum, the nuclear
shielding\index{nuclear shielding} constants and the spin--spin
coupling constants\index{spin-spin coupling}. We do this
at a fixed geometry, and use a Restricted Active Space (RAS)\index{RASSCF} wave
function. In this way we include near degeneracy\index{near
degeneracy} effects by inclusion
of the appropriate orbitals in the RAS2 space, and also some of the
dynamical correlation\index{dynamical correlation}  by single and
double excitations
from the RAS2 space (and generally also form the RAS1 space) into the
RAS3 space.

In this input we once more use water\index{water} as input molecule,
where we keep
the 1s inactive, correlate 8 electrons in 6 orbitals (Full-Valence
CAS) and in addition allow single- and double-excitations into
7 additional orbitals.

{\ttfamily
\begin{tabular}{ll}
**DALTON INPUT\\
.RUN PROPERTIES\hspace{2cm} & Run integrals, wave
func.\ and properties\\
***WAVE FUNCTIONS\\
.HF\\
.MP2\\
.MCSCF\\
**RHF INPUT\\
.HF OCCUPATION\\
 3 1 1 0\\
**CONFIGURATION INPUT\\
.SYMMETRY\\
 1\\
.SPIN MUL\\
 1\\
.INACTIVE\\
 1 0 0 0\\
.RAS1 SPACE & \# orbitals in RAS1 space\\
 0 0 0 0\\
.RAS2 SPACE & The ``Cas Space''\\
 3 2 1 0\\
.RAS3 SPACE\\
 3 1 2 1\\
.RAS1 HOLES & \# elect. that may be removed from RAS1\\
 0 0\\
.RAS3 ELECTRONS & From 0 to 2 electrons excited into here\\
 0 2\\
***PROPERTIES & Input for single property run\\
.SHIELD\\
.SPIN-S\\
**END OF INPUT\\
\end{tabular}}

\subsection{A parallel cubic response calculation}\index{parallel calculation}

In this example of a \verb|DALTON.INP| input file, we assume that
the program has been compiled with MPI options, and request a SCF
calculation of the second hyperpolarizability\index{second
hyperpolarizability}  ($\gamma_{xxxx}$) using
the cubic response solver\index{cubic response} of the \resp\
program. No two-electron
integrals will be stored on disc in any part of the calculation. The
number of nodes\index{node} used is determined when submitting the
job, and how
this is done depends on the computer on which the job is run.

All treatment  of symmetry, as well as the Hartree-Fock
occupation,\index{HF occupation}\index{Hartree-Fock occupation} is
automatically taken care of by the program, and we thus only need to
specify that we are to do a Hartree-Fock calculation.

{\ttfamily
\begin{tabular}{ll}
**DALTON INPUT\\
.RUN RESPONS\hspace{2.5cm} & Run integrals, wave func.\ and
response\\
.PARALLEL & This is a parallel run\\
***WAVE FUNCTIONS\\
.HF\\
***RESPONSE & Input for the response program\\
**CUBIC & Input for cubic response calculation\\
.DIPLNX & Only consider x-comp. of dipole moment\\
.BFREQ & Two frequencies for B operator\\
 1\\
 0.0 0.0592& Frequencies in atomic units\\
.CFREQ & One frequency for C operator\\
 1\\
 0.0\\
.DFREQ & One frequency for D operator\\
 1\\
 0.0\\
.THCLR & Threshold for linear response equations\\
 1.0D-5\\
**END OF INPUT\\
\end{tabular}}

\section{General structure of the DALTON.INP file}\label{sec:inputstructure}

The input is divided into modules\index{module}, which in turn are
further divided into submodules\index{submodule}. The modules contain
the input to the different
sections that constitute the \siraba\ program package. There exists
four such sections corresponding to respectively the integral
evaluation\index{atomic integrals}, the choice of wave function, the
choice of static properties\index{molecular properties} and finally
the choice of dynamic properties\index{response}. For each of
these sections there exists a module with a name started by two stars,
that is:

\begin{list}{}{}
\item \Sec{*INTEGRALS}
\item \Sec{*WAVE FUNCTIONS}
\item \Sec{*PROPERTIES}
\item \Sec{*RESPONSE}
\end{list}

In addition there is a module controlling the \siraba\ program, which
has the input card \Sec{*DALTON}. All
input modules will be described in detail in separate chapters in the
Reference Manual.

For geometry optimizations\index{geometry optimization},
different options may often be wanted for different stages of the
geometry optimization, and there exists three different \aba\ input
modules for geometry optimizations: \Sec{*START}, \Sec{*PROPERTIES},
\Sec{*FINAL}. \Sec{*START} gives input for the initial point,
\Sec{*PROPERTIES} gives input options during the optimization of the
molecular geometry, and \Sec{*FINAL} gives input options for the
analysis that is to be done at the optimized geometry. In this way one
may start a calculation at an experimental geometry, evaluating a set
of molecular properties of interest, do an ordinary geometry
optimization without any properties evaluated during the geometry
optimization, and then recalculate the same set of molecular
properties (or others) at the optimized geometry in one single run. We
note that if one only does a single point calculation, input
options to \aba\ is to be given in the \Sec{*PROPERTIES} input
module. Note that is a \verb|**RESPONSE| module present in a geometry optimization, the \resp\ calculations will only be performed at the optimized geometry.

The input file must end with the keyword \Sec{END OF}.

In a given module, several submodules\index{submodule} may be
specified, which determine the performance in various parts of the
calculation. The different input cards\index{input card} available
in the different submodules are started with a dot, i.e. an input
option should be typed as \Key{IMAGE}. For most calculations the
default settings may be used. The authors have, however, always
opted for the largest degree of freedom, giving the user good
opportunities for tailoring an input to suit the needs of a given
calculation.

Even though we at times write large, self-explanatory keywords in this
manual, only the first seven characters (including the \verb|.| or
\verb|*|) are significant\index{significant characters} and will be
treated by the program. At any
place in the input, comments\index{comments} may be added using
\verb|#| or \verb|!|
in the first position of the command line.

A general input structure for \siraba\ will look like

\begin{verbatim}
**GENERAL
...
**INTEGRALS
...
**WAVE FUNCTIONS
...
*CONFIGURATION INPUT
...
**START
...
**PROPERTIES
...
**FINAL
...
**RESPONSE
*CUBIC
...
*END OF INPUT
\end{verbatim}

Several submodules can of course be added in each of the above
modules. We also note that if \resp\ is requested in a geometry
optimization, the evaluation of the response functions will only be
done at the optimized geometry.

Examples of input files can be found in the various chapters
describing the calculation of different molecular properties, and
these chapters will probably be sufficient for most calculations done
with \siraba . However, all possible keywords are described in detail
in separate chapters in the Reference Manual.

\section{The \mol\ input file}

We will not go into great detail here of the input format of the \mol\ input
file, as it is treated thoroughly in a separate chapter,
Chapter~\ref{ch:molinp}. Here we only present two inputs for
water\index{water}; one
using Cartesian coordinate\index{cartesian coordinate} input and
automatic symmetry detection\index{symmetry detection} and
the other using Cartesian coordinates and where we explicitly give the
symmetry elements. Finally we show the \mol\ input for H$_{2}$O$^{2+}$
using Z-matrix input\index{Z-matrix}. In
all cases the basis set library of \siraba\ have been used, as we
assume that most users will exploit the basis sets provided in the basis
set library as opposed to punching them in. The punching
format for basis sets are described in detail in Sec.~\ref{sec:molcart}.

Let us first start with an input for water using Cartesian coordinates in bohr,
and the very popular 6-31G** basis set.

\begin{verbatim}
BASIS
6-31G**
Water
6-31G** basis
    2
        8.    1
O      .0000000000        -.2249058930         .0000000000
        1.    2
H     1.4523499293         .8996235720         .0000000000
H    -1.4523499293         .8996235720         .0000000000
\end{verbatim}

The number on the fifth line denotes the number of blocks of atoms,
in this case two, oxygen and hydrogen. There are one oxygen with
charge 8, and two hydrogens with charge 1. The symmetry of the system
will be detected by the program during the input processing unless
turned off as shown in the last of the input examples for the \mol\
input files.

We may also add the symmetry elements\index{symmetry element} of the
symmetry group\index{symmetry group} ourselves. We must
then remove any symmetry-dependent centers\index{symmetry-dependent
center}. For the above input this
will result in, if we use the yz- and xy-planes as symmetry elements:

\begin{verbatim}
ATOMBASIS
Water
augmented correlation-consistent basis set of Dunning and coworkers
    2    2  X  Y
        8.    1 ano-1 5 4 3 1
O      .0000000000        -.2249058930         .0000000000
        1.    1 ano-1 4 3 2
H     1.4523499293         .8996235720         .0000000000
\end{verbatim}

In the above calculation we used the ANO set\index{ANO basis set} of
Widmark and
coworkers~\cite{powpambortca77,powbjpbortca79}. We
use the contraction
[5s4p3d1f/4s3p2d] for the oxygen and the hydrogens respectively. We
also note the keyword \verb|ATOMBASIS|\index{ATOMBASIS} which allows
different basis
functions to be used on different atoms.

Let us now proceed to an input for H$_{2}$O$^{2+}$ where we use
Z-matrix input\index{Z-matrix}. The  input will then look like:

\begin{verbatim}
BASIS
sadlej
 Water - geometry optimization with pVDZ.
 Project:Raman
    3  2 0
O   1 8.0
H   2 1 0.97 1.0
H   3 1 0.97 2 104.5 1.0
\end{verbatim}

The numbers on the fourth row denote, respectively, the number of atoms
in the molecule (3), the charge\index{molecular charge} of the
molecule ($+2$), and the zero
tells that symmetry is not to be used in this calculation. Note that
unlike Cartesian coordinate input, which by default is in atomic units, the
Z-matrix input is always to be in \AA ngstr\o ms.

\section{The first calculation with \siraba\ }\label{sec:firstcalc}

If we have made two input files, one corresponding to
\verb|DALTON.INP|\index{DALTON.INP} and one corresponding to the \mol\
\index{MOLECULE.INP} input file, we
are ready to do our first calculation. Examples of input files can be
found in the \verb|dalton/test| directory in order to give you a
head-on start with \siraba .

Calculations with \siraba\ is most conveniently done using the
supplied shell-script\index{dalton shell script} \verb|dalton|. Thus,
to run a calculation of
$\beta$ (first hyperpolarizability)\index{first hyperpolarizability}
with input available as
\verb|beta.dal| on the HCl molecule, with molecule input available as
\verb|hcl.mol|. In order to run this calculation you would type

\begin{verbatim}
> dalton beta hcl
\end{verbatim}
assuming \verb|dalton| is available in your path. When the job is
finished, the output is copied back as \verb|beta_hcl.out|. In case that the
dalton- and molecule-input has the same name (e.g. \verb|dalton test1 test1|), the output
will be named \verb|test1.out|.

There are several options to this script, which can be viewed by
typing \verb| dalton -h| or just \verb|dalton|. These options include:

\begin{list}{--}{}
\item[-a] Copy various auxiliary files\index{auxiliary files} from the
home directory to the scratch directory before the calculation
starts. This is needed in case of restarts of intrinsic reaction
coordinate, direct dynamics, Raman Optical Activity, or general
numerical differentiation, where information stored in the files
\verb|DALTON.IRC|, \verb|DALTON.TRJ|, and \verb|DALTON.WLK|
respectively is needed.
\item[-A] Copy various auxiliary files\index{auxiliary files} from
the scratch directory to the home directory after the calculation
has completed. These auxiliary files contain extra information
that may become useful for certain kinds of calculations. All
these auxiliary files are described below.
\item[-b directory] Give an alternative directory where the program
should look for basis sets\index{basis set}. Needed in case you want to use local
modifications of a given basis. Note that the directory must end with
a \verb|/|.
\item[-d] Removes the contents of the scratch directory before a
calculation starts in order to avoid inconsistencies between files.
\item[-D] Do not remove the content of the scratch directory. By
default the scratch directory will be deleted. However, in order to do
a restart you will need to keep all files in this directory, and you
then need to add the -D option when submitting the job.
\item[-e ext] Change the extension to the output file from \verb|.out|
to \verb|.ext|.
\item[-f] Copy SIRIUS.RST/RESULTS.RSP/RSPVEC\index{SIRIUS.RST}
files from your home directory to the scratch directory before the
calculation starts. This is needed in order to be able to do a restart
in the wave function optimization.
\item[-F] Copy SIRIUS.RST/RESULTS.RSP/RSPVEC\index{SIRIUS.RST}
files from the
scratch directory to your home directory after the calculation has
finished. This is needed if you want to (re)start\index{restart}
from the wave function created in this run.
\item[-m mem] Change the default size of the scratch
memory\index{scratch memory} space to
mem words.
\item[-n nodes] Number of nodes to be used in a parallel MPI calculation
controlled by running mpirun.
\item[-t tmpdir] Change the \verb|TMPDIR| (the scratch disc area) to
\verb|tmpdir| from the default scratch directory determined at
install-time.
\end{list}

In most cases, the \verb|DALTON.OUT| file will contain all the
information needed about a given calculations. However, in certain
cases, additional information may be wanted, and this is contained
in various sets of auxiliary files. Their contents is described
briefly here. We note that in order for these files to be copied
back to your job directory the flag \verb|-a| must be supplied to
the \verb|dalton| run script.

\begin{description}
\item[DALTON.BAS] Contains a dump of a complete molecule input file
obtainable by the keyword \Key{MOLPRI}. This file take maximum
advantage of formatted input, yet differences may occur compared to
the basis sets obtained from the basis set library due to the
restricted number of digits available in the standard-form output.

\item[DALTON.MOL] Contains the information needed by the
\verb|MOLPLT|-program for visualizing the molecular geometry. The
\verb|MOLPLT|-program is distributed with the GAMESS-US program
package\index{MOLPLT}.

\item[DALTON.NCA] Contains the information needed by the
\verb|MOLPLT|-program for visualizing normal coordinates\index{MOLPLT}.

\item[DALTON.ORB] Contains information about basis set and
MO-coefficients so that MO density plots may be generated using the
\verb|PLTORB| program that comes with the GAMESS-US
distribution. Currently not supported\index{PLTORB}.

\item[DALTON.IRC] Contains information obtained from an Intrinsic
reaction Coordinate (IRC) calculation, as described in
Sec.~\ref{sec:irc}\index{IRC}\index{intrinsic reaction coordinate}.

\item[DALTON.WLK] Contains information from the walk-procedure, and is
needed when restarting a walk (e.g. a numerical differentiation).

\item[DALTON.TRJ] Contains trajectory information from a direct
dynamics calculation as described in
Sec.~\ref{sec:dynamic}\index{dynamics}.

\item[DALTON.CM] An output file that contains the most essential
information needed for calculation of shielding polarizabilities
and magnetizability polarizabilities. Most easily used together
with the analyzing program \verb|ODCPRG.f| supplied in the
tool-directory\index{shielding
polarizability}\index{magnetizability
polarizability}\index{Cotton-Mouton}.

\item[DALTON.HES] If the keyword \Key{HESPUN} has been specified in
the \Sec{VIBANA} input module, the molecular Hessian\index{Hessian}
will be written
to this file in a standard format, which may be used as a start Hessian
in an first-order\index{first-order optimization} geometry
optimization, or as input to a ROA  or VCD \index{ROA}\index{Raman optical
activity}\index{VCD}\index{vibrational circular dichroism}
analysis with different basis sets/level of correlation for the
intensity operators and the force field. See also the
\verb|FChk2HES.f| program in the tool-directory.

\item[DALTON.MOPUN] Contains the molecular-orbital coefficients
printed in a standard format allowing the transfer of molecular
orbitals coefficients from one computer to another.
\end{description}
