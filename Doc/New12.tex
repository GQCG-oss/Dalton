\chapter{New features in Dalton}
%\pagestyle{myheadings}
%\markboth{ }
%{ }
%\markright{ }
%\addcontentsline{toc}{chapter}{New features in Dalton 1.2}

\section{New features in Dalton~2.0}

There are several new additions introduced in the Dalton~2.0. The most
important and largest extension to the code is the addition of a
complete Density Functional Theory (DFT) module, including up to quadratic
response properties as well as an extensive open-shell
(spin-restricted) module. The main new features and changes are
summarized below:

\begin{enumerate}
\item{\bf Density Functional Theory:}

The largest new extension to Dalton~2.0 is the addition of a complete
Density Functional Theory (DFT) module. It contains 24 different
exchange-correlation  functions (and in addition the
Coulomb-Attenuating Method~\cite{tydptnchcpl393}), and is implemented for energies,
linear and quadratic response functions (for both singlet and triplet
perturbing operators) and geometric Hessians, nuclear shielding
tensors, and magnizabilities as well as indirect spin--spin coupling
constants. Energies and linear response properties are also available
for spin-restricted, high-spin DFT ({\em vide infra\/}).

\item{\bf Coulomb-Attenuating Method:} The new hybrid
  exchange-correlation functional named CAM-B3LYP is
  included~\cite{tydptnchcpl393}. This hybrid functional  combines the
  hybrid qualities of B3LYP and the long-range correction presented by
  Tawada {\it et al.\/}~\cite{ytttsytykhjcp120}.


\item{\bf NEVPT2:} Dalton~2.0 allows for the calculation of
  second-order MP2 energy corrections to an MCSCF reference wave
  function. The approach used here, the ``n-electron valence space
  second-order perturbation theory'' approach (NEVPT2)~\cite{carcsetljpmjcp114,carcjpmcpl350,carcjpmjcp117}, is similar to
  CASPT2~\cite{kapamborjcp96}, but is based on a two-electron zeroth-order
  Hamiltonian (the Dyall Hamiltonian~\cite{kgdjcp102}) and thus rarely displays
  problems with intruder states.

\item{\bf R12 methods:} The R12 approach for obtaining basis-set limit
MP2 energies are available in a couple of  approximations~\cite{wkccmsjcp116,ccmswkthcpc149}.

\item{\bf Excited-state gradients:} Excited-state gradients are
  available for singlet excited states for a Hartree--Fock reference
  wave function, calculated as the single residue of the quadratic
  response function. The excited-state gradients can be used to
  optimzie the structure of excited states using first-order
  optimization schemes.

\item{\bf Absorption in linear response:} The linear reponse code now
  allows finite lifetimes for excited states~\cite{pndmbhjajjojcp115}, allowing both scattering
  and absorptions processes to be taken into account simultaneously.

\item{\bf Improvements for 64-bit machines:} The code can now also
  calculate two-electron spin--orbit integrals as well as do AO2MO
  transformations for more than 255 basis functions also on 64-bit
  machines.

\item{\bf Extensions to the coupled cluster code:} CCSD(T) energies
  and analytical gradients are now available.

\item{\bf Orbital exponent gradients:} Gradients of the orbital
exponents can now be calculated for closed-shell molecular
species~\cite{fjjcp115}. 

\item{\bf Spin--spin coupling constants:} Allows for the calculation
  of coupling constants to one single nucleus.

\item{\bf Changes to DALTON.INP:} To harmonize the input for
  single-point and geometry optimization calculations, the labels for
  calculating   molecular properties during a geometry optimization is
  changed such that

\begin{center}
\begin{tabular}{|l|l|}\hline
Old label & New label\\\hline
**START & **START\\
****PROPERTIES & **EACH STEP\\
****FINAL & **PROPERTIES\\\hline
\end{tabular}
\end{center}

\item{\bf New \mol\ input format:} There is now a new input structure
  for the \mol\ input file. The new format is keyword driven and
  contains no fixed-format input lines unless the basis set is
  explicitely given in the input file. However, with the exception of
  the \verb|ATOMBASIS| option, the input file is fully backward
  compatible with the old input format. For more information, see
  Sec.~\ref{ch:molinp}.

\item{\bf Single input file:} In addition to the new input format for
  \dalton , \dalton\ now also allows the entire input to be given in a
  single file. This file must be started by the \mol\ input on the
  first line, and the \dalton\ input is placed at the end of the input
  file. An optimization of methane may thus look like:

\begin{verbatim}
BASIS
aug-cc-pVDZ
CH4  molecule. Basis: aug-cc-pVDZ.
Geometry from JCP 112, 393 (2000).
Atomtypes=2 Generators=2 Y X Angstrom
Charge=6.0 Atoms=1
C     0.000000       0.000000      0.000000
Charge=1.0 Atoms=2
H     0.889981273    0.000000000  -0.629311793
H     0.000000000    0.889981273   0.629311793

**DALTON INPUT
.OPTIMIZE
**WAVE FUNCTION
.HF
*END OF INPUT
\end{verbatim}
This single input file has to be named \verb|foo.dal|, and only a
single filename is given as arguments to the \dalton\ script, that is

\begin{verbatim}
> ./dalton foo
\end{verbatim}

\item{\bf Changes to basis set names:} The following basis sets
have been renamed from \dalton\ 1.2 for consistency with the EMSL 
basis set order form.
\begin{center}
\begin{tabular}{|l|l|}\hline
Old Label & New Label \\\hline
DunningDZ & DZ(Dunning)\\
DunningTZ & TZ(Dunning)\\
SVP(Dunning-Hay)+diffuse & SVP+Diffuse(Dunning-Hay) \\
daug-cc-pVXZ (also t,q) & d-aug-cc-pVXZ (t-,q-)\\
daug-cc-pCVXZ (also t,q) & d-aug-cc-pCVXZ (t-,q-)\\
sadlej & Sadlej-pVTZ \\
sad-J & Sadlej-pVTZ-J \\
\hline
\end{tabular}
\end{center}

\item{\bf Depricated features: PVM no longer supported:} The parallel
  version no longer supports PVM as a message passing
  interface. Currently Dalton will only correctly install a parallel
  version using MPI. Note also that if a parallel \dalton\ is
  requested, the executable can both run parallel and sequential
  calculations.

%\item{\bf Polarizable Continuum Model (PCM):} The official release of
%  Dalton~2.0 does not contain any major extensions to the solvent
%  models used. However, a separate version containing the Polarizable
%  Continuum Model (PCM) for quadratically convergent SCF and MCSCF
%  wave function as well as DFT, including also linear and quadratic
%  respons functions. This module is av

%\item{\bf Higher-order Douglas--Kroll--He\ss :}

%
\item{\bf Numerical Hessian in VROA/Raman calculations:} The
  analytical Hessian is no longer required for the calculation of
  Raman intensities and Vibrational Raman optical activities. Instead,
  the Hessian may be calculated numerically using the analytical
  gradients. This can be achieved adding the keyword \Key{NUMHES} in
  the three input modules \Key{*START}, \Key{*EACH S} and \Key{*PROPER}.

\end{enumerate}

\section{New features in Dalton~1.2}
Dalton 1.2 includes several large modules that have been added in order
to increase the possibilities for user applications of the code. In
addition, several improvements in the general performance of the code
has been made relative to Dalton~1.1. The most important new features
and improvements are presented here.

\begin{enumerate}
\item {\bf Coupled-cluster theory:} The most important and largest
improvement is the addition of
a complete integral-direct coupled cluster module, capable of
calculating all common coupled cluster models, most of them in an
integral-direct manner. Frequency-dependent response functions have
also been implemented up to the cubic response functions for the CCS,
CC2, and CCSD models. Several models for calculating molecular
properties of excited states are also available. Geometry optimization
using analytical gradients for electronic ground states using
first-order optimization methods is also available.

\item {\bf Non-equilibrium solvation} Non-equilibrium
solvation linear, quadratic, and cubic response functions have been
implemented, and this
makes for instance solvent shifts on excitation energies directly
accessible in a one-step calculation. Solvent effects on non-linear
optical processes can also be calculated with this approach.

\item {\bf SOPPA} The Second-Order Polarization Propagator Approach (SOPPA) has
been introduced in the \aba\ module, allowing for convenient and easy
calculations of second-order properties such as polarizabilities,
indirect spin--spin coupling constants, nuclear shieldings and
magnetizabilities, the latter two only without London orbitals.

\item {\bf CSF} Configurations State Functions can now be used also in
property calculations in both the \resp\ and \aba\ modules, allowing
for better control of the spin-state of the reference wave function
also in property calculations.

\item {\bf AMFI} An Atomic Mean-Field Approximation of the spin-orbit
integrals have been implemented. Even though this mean-field
spin-orbit approximation only involves one-electron integrals, it has
proven to be a very good approximation to the full one- and
two-electron Breit-Pauli spin--orbit operator.

\item {\bf ECP} Effective Core Potentials can now be used for calculations
of energies and response functions in which the basis set does not
depend on the applied perturbations. That is, molecular gradients and
Hessians, as well as London orbital-based magnetic properties, can not
be calculated with ECPs.

\item {\bf Douglas-Kroll} The Douglas-Kroll scalar relativistic Hamiltonian
has been implemented to second order. It can be used to account for
scalar relativistic effects in molecular energies and response
functions, and although molecular gradients and Hessians can be
calculated, they are not strictly correct, as they use the
non-relativistic derivatives of the one-electron Hamiltonian.

\item {\bf Linear coupling model} The linear coupling model can be used for
estimating Franck-Condon factors.

\item  {\bf Vibrational averaging} A new approach for calculating
zero-point~\cite{poakrprtjcp112,krpoaprtjcp112} or
tem\-pera\-ture-dependent~\cite{krjljv} vibrational averaged molecular 
properties. For general properties, this have to be in a two-step
procedure in which the first step determines the vibrational averaged
geometry, and the second calculates the average of the molecular
property over a harmonic oscillator approximation for the different
vibrational modes. 

\item {\bf Magnetic Circular Dichroism} The ${\cal{B}}(0\rightarrow f)$ term 
contributing to
magnetic circular dichroism (MCD) has been
implemented~\cite{Coriani:MCDRSP}. 

\item {\bf Two-photon absorption} Although possible to calculate with
Dalton~1.1, the input required for calculating two-photon absorption
has been significantly improved.

\item{\bf Solvent geometry optimizations} Geometry optimizations using
the spherical cavity model can now be done using symmetry. However,
only the second-order geometry optimization routines in the
\verb|*WALK| module will be able to do geometry optimizations with the
solvent model.

\item {\bf File splitting} For file systems where the maximum file length is
2~Gb, {\dalton} will automatically split large files  so that
calculations can be performed on these systems even though some files
may be longer than 2~Gb. Currently the implementation limits the
maximum file size to 22~Gb.

\item {\bf Restart features in \resp } Assuming that the files
\verb|RESULTS.RSP| and \verb|RSPVEC| are available, the \resp\ program
can now be restarted at any point of a linear, quadratic or cubic
response calculation. At the most a few micro-iterations of a solution
of a linear set of equations will be lost. One can now also reuse the
converged response vectors of a quadratic response calculation in a
cubic response vector, making it significantly more computationally
efficient to determine both linear, quadratic and cubic response
functions using SCF or MCSCF wave functions.
\end{enumerate}
