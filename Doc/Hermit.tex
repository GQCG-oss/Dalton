\chapter{Integral evaluation, HERMIT}\label{ch:hermit}

\section{General}\label{sec:herminf}

    \her\ is the integral evaluation part of the code. In ordinary
calculations there is no need to think about integral evaluation, as
this will be automatically taken care of by the program. However,
\her\ has an extensive set of atomic one- and two-electron
integrals\index{one-electron integral}\index{two-electron integral},
and some users may find it useful to generate explicit integrals using
\her . This is for instance necessary if the \resp\ program (dynamic
properties) is to be
used, as described in Chapter~\ref{ch:response}. Disc usage may also
be reduced by not calculating the
supermatrix\index{supermatrix}, and this is also controlled in the
\Sec{*INTEGRALS} input section.

It is worth noticing that the two-electron part of \her\ is actually
two integral programs. One --- \her\ --- is general and invoked by default in
sequential calculations as well as in calculations using generally
contracted basis sets. The other, {\sc ERI}, is a highly vectorized
code with orientation towards integral distributions. This code will
be invoked in direct calculations using segmented basis sets for
totally-symmetric Fock matrices.

    Input to integral evaluation is
indicated by the keyword \Sec{*INTEGRALS}, and the section may be
ended with \Sec{END OF} or any keyword starting with two stars
(like e.g. \Sec{*WAVE FUNCTIONS}). The intermediate input is
divided into two sections: one general input section describing
what molecular integrals is to be evaluated, and then a set of
modules controlling the different parts of the calculation of
undifferentiated atomic integrals and the (possible) formation of
a supermatrix as defined in for instance~\cite{pemsjaahborjcp74}.

\section{\Sec{*INTEGRALS} directives}\label{sec:herinp}

          The following directives may be included in the input to
the integral evaluation.  They are organized according to the program
section names in which they can appear.

\subsection{End of input: \Sec{END OF}}

The last directive of the \Sec{*INTEGRALS} input may be \Sec{END OF}.

\subsection{General: \Sec{*INTEGRALS}}



General-purpose directives are given in the \Sec{*INTEGRALS}
section. This mainly includes requests for different atomic integrals,
as well as some
directives affecting the outcome of such an integral evaluation. Note
that although not explicitly stated, {\em all test options do not
work with symmetry}.

For all atomic integrals, the proper expression for the integral is
given, together with the labels written on the file
\texttt{AOPROPER}\index{AOPROPER}\index{integral label}, for
reference in later stages of a \siraba\ calculation (like for instance
in during the evaluation of dynamic response properties, or for
non-\siraba\ programs).

We also note that as long as any single atomic property
integral\index{property integral} is
requested in this module, the overlap integrals will also be
calculated. Note also, that unless the Huckel starting guess is turned
off, this overlap matrix will not only be calculated for the requested
basis set, but also for ``ghost'' ano-4 basis set appended to the
original set in order to do the Huckel starting guess.

\begin{description}
\item[\Key{1ELPOT}] One-electron potential energy integrals.

\begin{list}{}{}
\item Integral:
$\sum_K\left<\chi_{\mu}\left|\frac{Z_K}{r_{K}}\right|\chi_{\nu}\right>$ 
\item Property label: \verb|POTENERG|
\end{list}

\item[\Key{AD2DAR}]\verb| |\newline
\verb|READ (LUCMD,*) DARFAC|

\begin{list}{}{}
\item Integral:
$\frac{\alpha^2}{4}\left<\chi_{\mu}\chi_{\nu}\left|\delta\left({\mathbf
r}_{12}\right)\right|\chi_{\rho}\chi_\sigma\right>$ 
\end{list}

Add two-electron Darwin integrals to the standard electron-repulsion
integrals with a perturbation factor \verb|DARFAC|.

\item[\Key{ANGLON}] Contribution to the one-electron contribution of
the magnetic moment\index{magnetic moment} using London orbitals
\index{London orbitals} arising from the differentiation on the
London phase factors, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral: $Q_{MN}\left<\chi_{\mu}\left|{\bf
r}h\right|\chi_{\nu}\right>$
\item Property labels: \verb|XANGLON |, \verb|YANGLON |, \verb|ZANGLON |
\end{list}

\item[\Key{ANGMOM}] Angular momentum\index{angular momentum} around the molecular origin.
This can be adjusted by changing the gauge origin through the use of
the \Key{GAUGEO} keyword.

\begin{list}{}{}
\item Integral: $\left<\chi_{\mu}\left|{\bf L}_{O}\right|\chi_{\nu}\right>$
\item Property labels: \verb|XANGMOM |, \verb|YANGMOM |, \verb|ZANGMOM |
\end{list}

\item[\Key{CARMOM}]\verb| |\newline
\verb|READ (LUCMD,*) IORCAR|

Cartesian multipole integrals\index{multipole integral} to order
\verb|IORCAR|. Read one more
line specifying order. See also the keyword \Key{SPHMOM}.

\begin{list}{}{}
\item Integral:
$\left<\chi_{\mu}\left|x^{i}y^{j}z^{k}\right|\chi_{\nu}\right>$
\item Property labels: \verb|CMiijjkk|
\end{list}
where $ii+jj+kk =$\verb|IORDER|, and where \verb|ii| = (i/10)*10+mod(i,10)

\item[\Key{CM-1}]\verb| |\newline
\verb|READ (LUCMD, '(A7)') FIELD1|

First derivative of the  electric dipole operator\index{electric
dipole} with respect to an
external magnetic field\index{magnetic field} due to differentiation of the London phase
factors, see Ref.~\cite{arthkrabmjpjjcp102}. Read one more line giving
the direction of the electric field~(A7)\index{electric field, external}. These
include \verb|X-FIELD|, \verb|Y-FIELD|, and \verb|Z-FIELD|.

\begin{list}{}{}
\item Integral: $Q_{MN}\left<\chi_{\mu}\left|{\bf
r}D\right|\chi_{\nu}\right>$
\item Property labels: \verb|D-CM1 X |, \verb|D-CM1 Y |, \verb|D-CM1 Z |
\end{list}
where $D$ is the direction of the applied electric field as specified in
the input.

\item[\Key{CM-2}]\verb| |\newline
\verb|READ (LUCMD, '(A7)') FIELD2|

Second derivative electric dipole\index{electric
dipole} operator
with respect to an external magnetic field\index{magnetic field} due
to differentiation of
the London phase factors, see Ref.~\cite{arthkrabmjpjjcp102}. Read one
more line giving the direction of the electric
field~(A7)\index{electric field, external}. These
include \verb|X-FIELD|, \verb|Y-FIELD|, and \verb|Z-FIELD|.

\begin{list}{}{}
\item Integral: $Q_{MN}\left<\chi_{\mu}\left|{\bf
rr}^{T}D\right|\chi_{\nu}\right>Q_{MN}$
\item Property labels: \verb|D-CM2 XX|, \verb|D-CM2 XY|, \verb|D-CM2 XZ|,
\verb|D-CM2 YY|, \verb|D-CM2 YZ|, \verb|D-CM2 ZZ|
\end{list}
where $D$ is the direction of the applied electric field as specified in
the input.

\item[\Key{DARWIN}] One-electron Darwin integrals\index{Darwin
integral}~\cite{skjohjajjcp103}.

\begin{list}{}{}
\item Integral: $\frac{\pi\alpha^{2}}{2}\left<\chi_{\mu}\left|\delta\left({\bf
r}\right)\right|\chi_{\nu}\right>$
\item Property label: \verb|DARWIN  |
\end{list}

\item[\Key{DEROVL}] Geometrical first derivatives of overlap
integrals.

\begin{list}{}{}
\item Integral: $\frac{\partial}{\partial {\mathbf
R}_K}\left<\chi_{\mu}\mid\chi_{\nu}\right>$ 
\item Property labels: \verb|1DOVLxyz|
\end{list}
where $xyz$ is the symmetry adapted nuclear coordinate.

\item[\Key{DERHAM}] Geometrical first derivatives of the one-electron
Hamiltonian matrix.

\begin{list}{}{}
\item Integral: $\frac{\partial}{\partial {\mathbf
R}_K}\left<\chi_{\mu}\left|\sum_K\frac{Z_K}{r_K}-\frac{1}{2}\nabla^2\right|\chi_{\nu}\right>$ 
\item Property labels: \verb|1DHAMxyz|
\end{list}
where $xyz$ is the symmetry adapted nuclear coordinate.

\item[\Key{DIASUS}] Diamagnetic magnetizability\index{diamagnetic
magnetizability} integrals, as
calculated with London atomic orbitals, see
Ref.~\cite{thpjjcp95}. It is calculated as the sum of the three
contributions \verb|DSUSLH|, \verb|DSUSLL|, and \verb|DSUSNL|.

\begin{list}{}{}
\item Integral: $\frac{1}{4}\left[\left<\chi_{\mu}\left|r^{2}_{N}I - {\bf r}_{N}
{\bf r}_{N}^{T}\right|\chi_{\nu}\right> +
\overline{Q_{MN}\left<\chi_{\mu}\left|{\bf r}{\bf
L}_{N}^{T}\right|\chi_{\nu}\right>} +
Q_{MN}\left<\chi_{\mu}\left|{\bf r}{\bf
r}^{T}h\right|\chi_{\nu}\right>Q_{MN}\right]$
\item Property label: \verb|XXdh/dB2|, \verb|XYdh/dB2|,
\verb|XZdh/dB2|, \verb|YYdh/dB2|, \verb|YZdh/dB2|, \verb|ZZdh/dB2|
\end{list}

\item[\Key{DIPGRA}]

Calculate dipole gradient integrals, that is, the geometrical first
derivatives of the dipole length integrals.

\begin{list}{}{}
\item Integral: $\frac{\partial}{\partial {\mathbf
R}_K}\left<\chi_{\mu}\left|{\mathbf r}\right|\chi_{\nu}\right>$ 
\item Property labels: \verb|xy DPG z|
\end{list}
where $xy$ is the symmetry adapted nuclear coordinate, and z the
direction (x/y/z) of the dipole moment.

\item[\Key{DIPLEN}] Dipole length\index{dipole length} integrals.

\begin{list}{}{}
\item Integral: $\left<\chi_{\mu}\left|{\bf r}\right|\chi_{\nu}\right>$
\item Property labels: \verb|XDIPLEN |, \verb|YDIPLEN |, \verb|ZDIPLEN |
\end{list}

\item[\Key{DIPORG}]\verb| |\newline
\verb|READ (LUCMD, *) (DIPORG(I), I = 1, 3)|

Specify the dipole origin\index{dipole origin} to be used in the
calculation. Read one more
line containing the three Cartesian components (*). Default is~(0,0,0).

\item[\Key{DIPVEL}] Dipole velocity\index{dipole velocity} integrals.

\begin{list}{}{}
\item Integral: $\left<\chi_{\mu}\left|{\bf \nabla}\right|\chi_{\nu}\right>$
\item Property label: \verb|XDIPVEL |, \verb|YDIPVEL |, \verb|ZDIPVEL |
\end{list}

\item[\Key{DPTOVL}] 

\item[\Key{DPTPOT}]

\item[\Key{DSO}] Diamagnetic spin-orbit\index{diamagnetic spin-orbit}
integrals. These are
calculated using Gaussian quadrature\index{Gaussian quadrature} as
described in
Ref.~\cite{dmtajcp73}. The number of quadrature point is controled by
the keyword \Key{POINTS}.

\begin{list}{}{}
\item Integral: $\left<\chi_{\mu}\left|\frac{{\bf r}_K^T{\bf r}_LI - {\bf r}_K{\bf r}_L^T}{r_K^3r_L^3}\right|\chi_{\nu}\right>$
\item Property labels: \verb|DSO abcd| where \verb|ab| is the symmetry
coordinate of a given component for the symmetry-adapted nucleus K,
and \verb|cd| is in a similar fashion the symmetry coordinate for the
symmetry-adapted nucleus L.
\end{list}

\item[\Key{DSUSLH}] The contribution to diamagnetic
magnetizability\index{diamagnetic magnetizability}
integrals from the differentiation of the London orbital\index{London
orbitals}
phase-factors, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral:$\frac{1}{4}Q_{MN}\left<\chi_{\mu}\left|{\bf
r}{\bf r}^{T}h\right|\chi_{\nu}\right>Q_{MN}$
\item Property labels: \verb|XXDSUSLH|, \verb|XYDSUSLH|,
\verb|XZDSUSLH|, \verb|YYDSUSLH|, \verb|YZDSUSLH|, \verb|ZZDSUSLH|
\end{list}

\item[\Key{DSUSLL}] The contribution to the diamagnetic
magnetizability\index{diamagnetic magnetizability} integrals from mixed differentiation on the Hamiltonian
and the London orbital phase factors\index{London
orbitals}, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral: $\frac{1}{4}\overline{Q_{MN}\left<\chi_{\mu}\left|{\bf
r}{\bf L}_{N}^{T}\right|\chi_{\nu}\right>}$
\item Property labels: \verb|XXDSUSLL|, \verb|XYDSUSLL|,
\verb|XZDSUSLL|, \verb|YYDSUSLL|, \verb|YZDSUSLL|, \verb|ZZDSUSLL|
\end{list}

\item[\Key{DSUSNL}] The contribution to the diamagnetic
magnetizability\index{diamagnetic magnetizability} integrals using
London orbitals\index{London
orbitals} but with
contributions from the differentiation of the Hamiltonian only, see
Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral: $\frac{1}{4}\left<\chi_{\mu}\left|r^{2}_{N}I - {\bf r}_{N}
{\bf r}_{N}^{T}\right|\chi_{\nu}\right>$
\item Property labels: \verb|XXDSUSNL|, \verb|XYDSUSNL|,
\verb|XZDSUSNL|, \verb|YYDSUSNL|, \verb|YZDSUSNL|, \verb|ZZDSUSNL|
\end{list}

\item[\Key{DSUTST}] Test of the diamagnetic magnetizability
integrals\index{diamagnetic magnetizability} with London atomic
orbitals\index{London orbitals}. Mainly for debugging purposes.

\item[\Key{EFGCAR}] Cartesian electric field gradient
integrals\index{electric field gradient}.

\begin{list}{}{}
\item Integral: $\frac{1}{3}\left<\chi_{\mu}\left|\frac{3{\bf
r}_K{\bf r}_K^T - {\bf r}_K^T{\bf r}_KI}{r_K^5}\right|\chi_{\nu}\right>$
\item Property labels: \verb|xyEFGabc|, where \verb|x| and \verb|y| are
the cartesian directions, \verb|ab| the number of the symmetry
independent center, and \verb|c| that centers c'th symmetry-generated
atom.
\end{list}

\item[\Key{EFGSPH}] Spherical electric field gradient\index{electric
field gradient}
integrals. Obtained by transforming the Cartesian electric-field
gradient integrals (see \Key{EFGCAR}) to spherical basis.

\item[\Key{ELGDIA}] Diamagnetic one-electron spin-orbit integrals
without London orbitals.

\begin{list}{}{}
\item Integral: 
\item Property labels: \verb|D1-SO XX|, \verb|D1-SO XY|, \verb|D1-SO XZ|, \verb|D1-SO YX|, \verb|D1-SO YY|, \verb|D1-SO YZ|, \verb|D1-SO ZX|, \verb|D1-SO ZY|, \verb|D1-SO ZZ|
\end{list}

\item[\Key{ELGDIL}] Diamagnetic one-electron spin-orbit integrals
with London orbitals.

\begin{list}{}{}
\item Integral: 
\item Property labels: \verb|D1-SO XX|, \verb|D1-SO XY|, \verb|D1-SO XZ|, \verb|D1-SO YX|, \verb|D1-SO YY|, \verb|D1-SO YZ|, \verb|D1-SO ZX|, \verb|D1-SO ZY|, \verb|D1-SO ZZ|
\end{list}

\item[\Key{EXPIKR}]\verb| |\newline
\verb|READ (LUCMD, *) (EXPKR(I), I = 1, 3)|

Cosine and sine\index{cosine integral}\index{sine integral} integrals.
Read one more line containing the wave numbers in the three Cartesian
directions. The center of expansion is always~(0,0,0).

\item[\Key{FC}] Fermi-contact\index{Fermi contact} integrals, see
Ref.~\cite{ovhapjhjajsbpthjcp96}.

\begin{list}{}{}
\item Integral: $\frac{4\pi g_e}{3}\left<\chi_{\mu}\left|\delta\left({\bf
r}_K\right)\right|\chi_{\nu}\right>$
\item Property label: \verb|FC NAMab|, where \verb|NAM| is the three
first letters in the name of this atom, as given in the
\verb|MOLECULE.INP| file, and \verb|ab| is the number of the
symmetry-adapted nucleus.
\end{list}

\item[\Key{GAUGEO}]\verb| |\newline
\verb|READ (LUCMD, *) (GAGORG(I), I = 1, 3)|

Specify the gauge origin\index{gauge origin} to be used in the
calculation. Read one more line containing the three Cartesian
components (*). Default is~(0,0,0).

\item[\Key{GFACDI}] 
\item[\Key{HBDO}] Geometric half-differentiated overlap
matrix\index{overlap, half-differentiated}
differentiated once more with respect to magnetic field as given in Eq.~(59)
in Ref.~\cite{klbpjthkrhjajjcp98}.

\item[\Key{HDO}] Symmetrized, half-differentiated
overlap integrals with respect to geometric distortions\index{overlap,
half-differentiated}, see
Ref.~\cite{klbpjhjajjothjcp97}. Differentiation on the ket-vector.

\begin{list}{}{}
\item Integral: $\left<\frac{\partial \chi_{\mu}}{\partial
R_{ab}}\mid\chi_{\nu}\right> -
\left<\chi_{\mu}\mid\frac{\partial\chi_{\nu}}{\partial R_{ab}}\right>$
\item Property label: \verb|HDO ab  |, where \verb|ab| is the number
of the symmetry-adapted coordinate being differentiated.
\end{list}

\item[\Key{HDOBR}] Geometric half-differentiated overlap
matrix\index{overlap, half-differentiated}
differentiated once more on the ket-vector with respect to external
magnetic field as given in Eq.~(60) of Ref.~\cite{klbpjthkrhjajjcp98}.

\item[\Key{HDOBRT}] Test the calculation of the \Key{HDOBR}
integral. Mainly for debugging purposes.

\item[\Key{INPTES}] Test the correctness of the \Sec{*INTEGRALS}-input. Mainly
for debugging purposes, but also a good option to check if the \mol\ input
has been typed in correctly.

\item[\Key{KINENE}] Kinetic energy integrals\index{kinetic
energy}. Note however, that the kinetic energy integrals used in the
wave function optimization is generated in the \Sec{ONEINT} section.

\begin{list}{}{}
\item Integral:
$\frac{1}{2}\left<\chi_{\mu}\left|\nabla^{2}\right|\chi_{\nu}\right>$
\item Property label: \verb|KINENERG|, where \verb|ab| is the number
of the symmetry-adapted nuclear coordinate.
\end{list}

\item[\Key{LONMOM}] Contribution to the London magnetic
moment\index{magnetic moment} from
the differentiation with respect to magnetic field on the London
orbital\index{London orbitals} phase factors, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral:
$\frac{1}{4}Q_{MN}\left<\chi_{\mu}\left|{\bf r}h\right|\chi_{\nu}\right>$
\item Property label: \verb|XLONMOM |, \verb|YLONMOM |, \verb|ZLONMOM |.
\end{list}

\item[\Key{MAGMOM}] One-electron contribution to the magnetic
moment\index{magnetic moment}
around the nuclei to which the
atomic orbitals are attached. This is the London atomic
orbital\index{London orbitals}
magnetic moment\index{magnetic moment} as defined in Eq.~(35) of
Ref.~\cite{krthklbpjhjajjcp99}.

\begin{list}{}{}
\item Integral:
$\left<\chi_{\mu}\left|\frac{1}{2}{\bf L}_N + \frac{1}{4}Q_{MN}{\bf
r}h\right|\chi_{\nu}\right>$
\item Property label: \verb|dh/dBX  |, \verb|dh/dBY  |, \verb|dh/dBZ  |.
\end{list}

\item[\Key{MASSVE}] Mass-velocity\index{mass-velocity} integrals.

\begin{list}{}{}
\item Integral:
$\frac{\alpha^2}{4}\left<\chi_{\mu}\left|\nabla^{2}\cdot\nabla^2\right|\chi_{\nu}\right>$
\item Property label: \verb|MASSVELO|, where \verb|ab| is the number
of the symmetry-adapted nuclear coordinate.
\end{list}

\item[\Key{MGMO2T}] Test of two-electron integral contribution to
magnetic moment.

\item[\Key{MGMOMT}] Test the calculation of the \Key{MAGMOM}
integrals.

\item[\Key{MGMTHR}]\verb| |\newline
\verb|READ (LUCMD, *) PRTHRS|

Set the threshold for which two-electron integrals should be tested
 with the keyword \Key{MGMO2T}. Default is~10$^{-10}$.

\item[\Key{NELFLD}] Nuclear electric field integrals\index{electric
 field at nucleus}.

\begin{list}{}{}
\item Integral:
$\left<\chi_{\mu}\left|\frac{{\bf r}_K}{r_{K}^3}\right|\chi_{\nu}\right>$
where $K$ is the nucleus of interest.
\item Property label: \verb|NEF ab  |, where \verb|ab| is the number
of the symmetry-adapted nuclear coordinate.
\end{list}

\item[\Key{NO HAM}] Do not calculate ordinary Hamiltonian integrals.

\item[\Key{NOSUP}] Do not calculate the supermatrix\index{supermatrix}
integral file.
This may be required in order to reduce the amount of disc space used
in the calculation (to approximately one-third before entering the
evaluation of molecular properties).
Note however, that this will increase the time used for the evaluation
of the wave function
significantly in ordinary Hartree-Fock runs. It is default for direct and
parallel calculations.

\item[\Key{NOTWO}] Only calculate the one-electron part of the
Hamiltonian integrals. It is default for direct and parallel calculations.

\item[\Key{NPOTST}] Test of the nuclear potential integrals
calculated with the keyword \Key{NUCPOT}. Mainly for debugging
purposes.

\item[\Key{NSLTST}] Test of the integrals calculated with the
keyword \Key{NSTLON}. Mainly for debugging purposes.

\item[\Key{NSNLTS}] Test of the integrals calculated with the
keyword \Key{NSTNOL}. Mainly for debugging purposes.

\item[\Key{NST}] Calculate the one-electron contribution to the
diamagnetic nuclear shielding\index{diamagnetic nuclear shielding}
tensor integrals using London atomic
orbitals\index{London orbitals}, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral:
$\frac{1}{2}\left<\chi_{\mu}\left|\frac{{\bf r}_N^T{\bf r}_K -
{\bf r}_N{\bf r}_K^T}{r_{K}^3} + Q_{MN}\frac{{\bf r}_N^T{\bf
l}_K}{r_{K}^3}\right|\chi_{\nu}\right>$
where $K$ is the nucleus of interest.
\item Property label: \verb|NST  ab c|, where \verb|ab| is the number
of the symmetry-adapted nuclear magnetic moment coordinate, and
\verb|c| refers to the x, y, or z component of the magnetic field.
\end{list}

\item[\Key{NSTCGO}] Calculate the diamagnetic nuclear shielding\index{diamagnetic nuclear shielding}
tensor integrals without using London atomic orbitals\index{London
orbitals}. Note that the gauge origin is controlled by the keyword
\Key{GAUGEO}.

\begin{list}{}{}
\item Integral:
$\frac{1}{2}Q_{MN}\left<\chi_{\mu}\left|\frac{{\bf r}_O^T{\bf r}_K -
{\bf r}_O{\bf r}_K^T}{r_{K}^3}\right|\chi_{\nu}\right>$
where $K$ is the nucleus of interest.
\item Property label: \verb|NSCOab c|, where \verb|ab| is the number
of the symmetry-adapted nuclear magnetic moment coordinate, and
\verb|c| refers to the x, y, or z component of the magnetic field. O
is the gauge origin.
\end{list}

\item[\Key{NSTLON}] Calculate the contribution to the nuclear
shielding tensor\index{diamagnetic nuclear shielding} from the differentiation of the London orbital
phase-factors\index{London orbitals}, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral:
$\frac{1}{2}Q_{MN}\left<\chi_{\mu}\left|\frac{{\bf r}_N^T{\bf
l}_K}{r_{K}^3}\right|\chi_{\nu}\right>$
where $K$ is the nucleus of interest.
\item Property label: \verb|NSLOab c|, where \verb|ab| is the number
of the symmetry-adapted nuclear magnetic moment coordinate, and
\verb|c| refers to the x, y, or z component of the magnetic field.
\end{list}

\item[\Key{NSTNOL}] Calculate the contribution to the nuclear
shielding tensor\index{diamagnetic nuclear shielding} from the
differentiation of the Hamiltonian alone\index{London orbitals}, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral:
$\frac{1}{2}Q_{MN}\left<\chi_{\mu}\left|\frac{{\bf r}_N^T{\bf r}_K -
{\bf r}_N{\bf r}_K^T}{r_{K}^3}\right|\chi_{\nu}\right>$
where $K$ is the nucleus of interest.
\item Property label: \verb|NSNLab c|, where \verb|ab| is the number
of the symmetry-adapted nuclear magnetic moment coordinate, and
\verb|c| refers to the x, y, or z component of the magnetic field.
\end{list}

\item[\Key{NSTTST}] Test the calculation of the one-electron
diamagnetic  nuclear shielding\index{diamagnetic nuclear shielding}
tensor using London atomic orbitals\index{London orbitals}.

\item[\Key{NUCMOD}]\verb| |\newline
\verb|READ (LUCMD, *) INUC|

Choose nuclear model. A 1 corresponds to a point nucleus (which is the
default), and 2 corresponds to a Gaussian distribution model.

\item[\Key{NUCPOT}] Calculate the nuclear potential energy.
Currently this keyword can only be used in calculations not employing
symmetry.\index{potential energy at nucleus}

\begin{list}{}{}
\item Integral:
$\left<\chi_{\mu}\left|\frac{Z_K}{r_{K}}\right|\chi_{\nu}\right>$
where $K$ is the nucleus of interest.
\item Property label: \verb|POT.E ab|, where \verb|ab| are the two
first letters in the name of this nuclei. Thus note that in order
to distinguish between integrals, the first two letters in an
atom's name must be unique.
\end{list}

\item[\Key{PHASEO}]\verb| |\newline
\verb|READ (LUCMD, *) (ORIGIN(I), I = 1, 3)|

Set the origin appearing in the London atomic orbital phase-factors.
Read one more line containing the Cartesian components of this origin (*).
Default is~(0,0,0).

\item[\Key{POINTS}]\verb| |\newline
\verb|READ (LUCMD,*) NPQUAD|

Read the number of quadrature points\index{Gaussian quadrature} to be
used in the evaluation of
the diamagnetic spin-orbit\index{diamagnetic spin-orbit} integrals, as
requested by the keyword
\Key{DSO}. Read one more line containing the number of quadrature
points. Default is~40.

\item[\Key{PRINT}]\verb| |\newline
\verb|READ (LUCMD,*) IPRDEF|

Set default print level during the integral evaluation.  Read one more line
containing print level. Default is the value of \verb|IPRDEF|
from the general input module for \siraba .

\item[\Key{PROPRI}] Print all one-electron property integrals requested.

\item[\Key{PSO}] Paramagnetic spin-orbit integrals\index{paramagnetic
spin-orbit}, see
Ref.~\cite{ovhapjhjajsbpthjcp96}.

\begin{list}{}{}
\item Integral:
$\left<\chi_{\mu}\left|\frac{{\bf l}_K}{r_{K}^{3}}\right|\chi_{\nu}\right>$
where $K$ is the nucleus of interest.
\item Property label: \verb|PSO ab  |, where \verb|ab| is the number
of the symmetry-adapted nuclear magnetic moment coordinate.
\end{list}

\item[\Key{QUADRU}] Quadrupole moment\index{quadrupole
moment} integrals. For traceless quadrupole moment integrals as
defined by Buckingham~\cite{adbacp12}, see the keyword \Key{THETA}.

\begin{list}{}{}
\item Integral: $\frac{1}{4}\left<\chi_{\mu}\left|{\bf r}_{O}{\bf
r}_{O}^{T} - r^{2}_{O}I\right|\chi_{\nu}\right>$
\item Property label: \verb|XXQUADRU|, \verb|XYQUADRU|,
\verb|XZQUADRU|, \verb|YYQUADRU|, \verb|YZQUADRU|, \verb|ZZQUADRU|
\end{list}

\item[\Key{QUASUM}] Calculate all atomic integrals as square
matrices, irrespective of their inherent Hermiticity or
anti-Hermiticity.

\item[\Key{S1MAG}] Calculate the first derivative overlap
matrix\index{overlap, magnetic field derivative} with respect to an
external magnetic field by differentiation
of the London phase factors\index{London orbitals}, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral: $\frac{1}{2}Q_{MN}\left<\chi_{\mu}\left|{\bf
r}\right|\chi_{\nu}\right>$
\item Property label: \verb|dS/dBX  |, \verb|dS/dBY  |,
\verb|dS/dBZ  |
\end{list}

\item[\Key{S1MAGL}] Calculate the first magnetic half-differentiated overlap
matrix\index{overlap, magnetic field derivative} with respect to an
external magnetic field as needed with the
natural connection\index{natural connection}, see
Ref.~\cite{krthklbpjjocp195}. Differentiated
on the bra-vector.

\begin{list}{}{}
\item Integral: $\frac{1}{2}Q_{MO}\left<\chi_{\mu}\left|{\bf
r}\right|\chi_{\nu}\right>$
\item Property label: \verb|d<S|/dBX|, \verb|d<S|/dBY|,
\verb|d<S|/dBZ|
\end{list}

\item[\Key{S1MAGR}] Calculate the first magnetic half-differentiated overlap
matrix\index{overlap, magnetic field derivative} with respect to an external magnetic field as needed with the
natural connection\index{natural connection}, see Ref.~\cite{krthklbpjjocp195}. Differentiated on
the ket-vector.

\begin{list}{}{}
\item Integral: $\frac{1}{2}Q_{ON}\left<\chi_{\mu}\left|{\bf
r}\right|\chi_{\nu}\right>$
\item Property label: \verb|d|S>/dBX|, \verb|d|S>/dBZ|,
\verb|d|S>/dBZ|
\end{list}

\item[\Key{S1MAGT}] Test the integrals calculated with the keyword
\Key{S1MAG}. Mainly for debugging purposes.

\item[\Key{S1MLT}] Test the integrals calculated with the keyword
\Key{S1MAGL}. Mainly for debugging purposes.

\item[\Key{S1MRT}] Test the integrals calculated with the keyword
\Key{S1MAGR}. Mainly for debugging purposes.

\item[\Key{S2MAG}] Calculate the second derivative of the overlap
matrix\index{overlap, magnetic field derivative} with respect to an external magnetic field by differentiation
of the London phase factors\index{London orbitals}, see Ref.~\cite{thpjjcp95}.

\begin{list}{}{}
\item Integral: $\frac{1}{4}Q_{MN}\left<\chi_{\mu}\left|{\bf r}{\bf
r}^{T}\right|\chi_{\nu}\right>Q_{MN}$
\item Property label: \verb|dS/dB2XX|, \verb|dS/dB2XY|,
\verb|dS/dB2XZ|, \verb|dS/dB2YY|, \verb|dS/dB2YZ|, \verb|dS/dB2ZZ|
\end{list}

\item[\Key{S2MAGT}] Test the integrals calculated with the keyword
\Key{S2MAG}. Mainly for debugging purposes.

\item[\Key{SD}] Spin-dipole integrals\index{spin-dipole}, see
Ref.~\cite{ovhapjhjajsbpthjcp96}.

\begin{list}{}{}
\item Integral: $\frac{g_e}{2}\left<\chi_{\mu}\left|\frac{3{\bf
r}_K^T{\bf r}_K - r_K^2}{r_{K}^5}\right|\chi_{\nu}\right>$
\item Property label: \verb|SD  ab c|, where \verb|ab| is the number
of the first symmetry-adapted coordinate (corresponding to
symmetry-adapted nuclear magnetic moments) and \verb|c| is the x, y,
or z component of the magnetic moment with respect to spin coordinates.
\end{list}

\item[\Key{SD+FC}] Calculate the sum of the spin-dipole\index{spin-dipole} and
Fermi-contact integrals\index{Fermi contact}.

\begin{list}{}{}
\item Integral: $\frac{g_e}{2}\left<\chi_{\mu}\left|\frac{3{\bf
r}_K^T{\bf r}_K - r_K^2}{r_{K}^5}\right|\chi_{\nu}\right> + \frac{4\pi
g_e}{3}\left<\chi_{\mu}\left|\delta\left({\bf
r}_K\right)\right|\chi_{\nu}\right>$
\item Property label: \verb|SDC ab c|, where \verb|ab| is the number
of the first symmetry-adapted coordinate (corresponding to
symmetry-adapted nuclear magnetic moments) and \verb|c| is the x, y,
or z component of the magnetic moment with respect to spin coordinates.
\end{list}

\item[\Key{SECMOM}] Second-moment integrals\index{multipole
integral}\index{second-moment}.

\begin{list}{}{}
\item Integral: $\left<\chi_{\mu}\left|{\bf r}{\bf
r}^{T}\right|\chi_{\nu}\right>$
\item Property label: \verb|XXSECMOM|, \verb|XYSECMOM|,
\verb|XZSECMOM|, \verb|YYSECMOM|, \verb|YZSECMOM|, \verb|ZZSECMOM|
\end{list}

\item[\Key{SELECT}]\verb| |\newline
\verb|READ (LUCMD, *) NPATOM|\newline
\verb|READ (LUCMD, *) (IPATOM(I), I = 1, NPATOM|

Select which atoms for which a given atomic integral is to be
calculated. This applies mainly to property integrals for which
there exist a set of integrals for each nuclei. Read one more line
containing the number of atoms selected, and then another line
containing the numbers of the atoms selected. Most useful when
calculating diamagnetic spin-orbit\index{diamagnetic spin-orbit}
integrals, as this is a rather time-consuming calculation. The
numbering is of symmetry-independent nuclei.

\item[\Key{SORT I}]\index{integral sort} Requests that the
two-electron integrals should be
sorted for later use in \sir . See also keywords \Key{PRESORT} in the
\Sec{*DALTON} and \Sec{TRANSFORMATION} input sections.

\item[\Key{SOTEST}] Test the calculation of spin-orbit integrals as
requested by the keyword \Key{SPIN-O}.

\item[\Key{SPHMOM}]\verb| |\newline
\verb|READ (LUCMD,*) IORSPH|

Spherical multipole\index{multipole integral} integrals to order
\verb|IORSPH|. Read one more
line specifying order. See also the keyword \Key{CARMOM}.

\begin{list}{}{}
\item Property label: \verb|CMiijjkk|
\end{list}
where $i+j+k =$\verb|IORDER|.

\item[\Key{SPIN-O}] Spatial spin-orbit\index{spatial spin-orbit}
integrals, see Ref.~\cite{ovhapjhjajthjojcp96}. Both the one- and the
two-electron integrals are calculated, the latter stored on the file
\verb|AO2SOINT|.

\begin{list}{}{}
\item One-electron Integral:
$\sum_A\left<\chi_{\mu}\left|Z_A\frac{{\bf l}_A}{r_{A}^{3}}\right|\chi_{\nu}\right>$
where $Z_A$ is the charge of nucleus $A$ and the summation runs over
all nuclei of the molecule.
\item Property label: \verb|X1SPNORB|,  \verb|Y1SPNORB|,  \verb|Z1SPNORB|
\item Two-electron Integral:
$\left<\chi_{\mu}\chi_{\nu}\left|\frac{{\bf l}_{12}}{r_{12}^{3}}\right|\chi_{\rho}\chi_{\sigma}\right>$
\item Property label: \verb|X2SPNORB|,  \verb|Y2SPNORB|,  \verb|Z2SPNORB|
\end{list}

%\item[\Key{SQHDOL}] Square, non-symmetrized half differentiated
%overlap integrals\index{overlap, half-differentiated} with respect to
%geometric distortions, see
%Ref.~\cite{klbpjhjajjothjcp97}. Differentiation on the bra-vector.
%
%\begin{list}{}{}
%\item Integral: $\left<\frac{\partial \chi_{\mu}}{\partial
%R_{ab}}\mid\chi_{\nu}\right>$
%\item Property label: \verb|SQHDOLab|, where \verb|ab| is the number
%of the symmetry-adapted coordinate being differentiated.
%\end{list}

\item[\Key{SQHDOR}] Square, non-symmetrized half differentiated
overlap integrals with respect to geometric distortions\index{overlap,
half-differentiated}, see
Ref.~\cite{klbpjhjajjothjcp97}. Differentiation on the ket-vector.

\begin{list}{}{}
\item Integral: $\left<\chi_{\mu}\mid\frac{\partial\chi_{\nu}}{\partial
R_{ab}}\right>$
\item Property label: \verb|SQHDORab|, where \verb|ab| is the number
of the symmetry-adapted coordinate being differentiated.
\end{list}

\item[\Key{SUPONL}] Only calculate the supermatrix. Requires the
presence of the two-electron integral file\index{two-electron
integral}\index{supermatrix}.

\item[\Key{SUSCGO}] Diamagnetic magnetizability\index{diamagnetic
magnetizability} integrals calculated
without the use of London atomic orbitals. The choice of gauge
origin\index{gauge origin}
can be controled by the keyword \Key{GAUGEO}.

\begin{list}{}{}
\item Integral: $\frac{1}{4}\left<\chi_{\mu}\left|r^{2}_{O}I - {\bf r}_{O}
{\bf r}_{O}^{T}\right|\chi_{\nu}\right>$
\item Property label: \verb|XXSUSCGO|, \verb|XYSUSCGO|,
\verb|XZSUSCGO|, \verb|YYSUSCGO|, \verb|YZSUSCGO|, \verb|ZZSUSCGO|
\end{list}

\item[\Key{THETA}] Traceless quadrupole moment\index{quadrupole
moment, trcaeless} integrals as defined by Buckingham~\cite{adbacp12}.

\begin{list}{}{}
\item Integral: $\frac{1}{5}\left<\chi_{\mu}\left|3r^{2}I - {\bf r}
{\bf r}^{T}\right|\chi_{\nu}\right>$
\item Property label: \verb|XXTHETA |, \verb|XYTHETA |,
\verb|XZTHETA |, \verb|YYTHETA |, \verb|YZTHETA |, \verb|ZZTHETA |
\end{list}

\end{description}

\subsection{One-electron integrals: \Sec{ONEINT}}

Directives affecting the one-electron undifferentiated Hamiltonian
integral calculation appear in the \Sec{ONEINT} section.
\begin{description}
\item[\Key{CAVORG}]\verb| |\newline
\verb|READ (LUCMD,*) (CAVORG(I), I = 1, 3|

Read one more line containing the origin to be used for the origin of
the cavity\index{cavity origin} in self-consistent reaction field
calculations. The default
is that this origin is chosen to be the center of mass\index{center of
mass} of the molecule.

\item[\Key{NOT ALLRLM}] Save only the totally symmetric multipole integrals
calculated in the solvent run on disc. Default is that multipole
integrals of all symmetries are written disc. May be used in
calculations of the energy alone in order to save disc space.

\item[\Key{PRINT}]\verb| |\newline
\verb|READ (LUCMD,*) IPRONE|

Set print level during the calculation of one-electron Hamiltonian
integrals.  Read one more line containing print level. Default is
the value of \verb|IPRDEF| from the \Sec{*INTEGRALS} input module.

\item[\Key{SKIP}] Skip the the calculation of one-electron Hamiltonian
integrals. Mainly for debugging purposes.

\item[\Key{SOLVEN}]\verb| |\newline
\verb|READ (LUCMD,*) LMAX|

\begin{list}{}{}
\item Integral:
$\left<\chi_{\mu}\left|x^iy^jz^k\right|\chi_{\nu}\right>$ for all
integrals where $i+j+k\leq$\verb|LMAX|.
\item Property label: Not extractable. Integrals written to file
\verb|AOSOLINT|
\end{list}

Calculate the necessary integrals needed to model the effects of a
dielectric medium\index{dielectric medium} by a
reaction-field\index{reaction field} method as
described in
Ref.~\cite{kvmhahjajthjcp89}.  Read one more line containing maximum
angular quantum
number for the multipole integrals\index{multipole integral} used for
the reaction field.
\end{description}

\subsection{General: \Sec{READIN}}\label{sec:herrdn}

Directives to control the reading of the molecule input appear in the
\Sec{READIN} section.
\begin{description}
\item[\Key{CM FUN}]\verb| |\newline
\verb|READ (LUCMD,*) LCMMAX, CMSTR, CMEND|

Use Rydberg basis functions\index{Rydberg basis function} (center of
mass functions\index{center of mass function}) as suggested by
Kaufman {\it et al.\/}~\cite{kkwbmjjpbamop22}. \verb|LCMMAX| denoted
the maximum quantum number of the Rydberg functions, basis functions
for all quantum up to and including \verb|LCMMAX| will be generated
(s=0, p=1 etc.) \verb|CMSTR| and \verb|CMEND| are the half-integer
start- and ending quantum number for the Rydberg basis functions. The
basis functions will be placed at the position of a dummy center
indicated as \verb|X| in the \verb|MOLECULE.INP| file. The charge of
the ion-core is determined by the keyword \Key{ZCMVAL}. If no center
named \verb|X| is present in the \verb|MOLECULE.INP| file, this input
will be ignored.

\item[\Key{MAXPRI}]\verb| |\newline
\verb|READ (LUCMD,*) MAXPRI|

Set maximum number of primitives\index{primitive orbitals} in any
contraction.  Read one more line containing number.  Default
is~25, except for the Cray-T3D/E, where the default is 14.

\item[\Key{MOLINP}] Indicates that the molecular input comes on the
end of the current file. 
%Default is that the molecular input is to be
%read from unit~9.

\item[\Key{OLDNORM}] Use the normalization scheme for AO's used in \siraba\ 1./1. In \siraba\ 1.2 all components of the cartesian and spherical AO's are normalized to 1. This was not the case in \siraba\ 1.1.

\item[\Key{PRINT}]\verb| |\newline
\verb|READ (LUCMD,*) IPREAD|

Set print level for input processing.  Read one more line containing
print level. Default is the \verb|IPRDEF| from the \Sec{*INTEGRALS} input
module.

\item[\Key{SYMTHR}]\verb| |\newline
\verb|READ (LUCMD,*) TOLLRN|

Read threshold for considering atoms to be related by symmetry. Used
in the automatic symmetry detection routines. Default is $5.0\cdot
10^{-6}$.

\item[\Key{UNCONT}] Force the program to use the basis set as a primitive (completely decontracted) set.

\item[\Key{ZCMVAL}]\verb| |\newline
\verb|READ (LUCMD,*) ZCMVAL|

Read the charge of the center of the Rydberg basis functions specified
by the \Key{CM FUN} keyword. Default is a charge of one.

\end{description}

\subsection{Integral sorting: \Sec{SORINT}}

Affects the sorting of the two-electron integrals\index{integrals
sort}. Note that in order for \sir\ to use the sorted integrals
generated with the keyword \Key{SORT I}, the keyword
\Key{PRESORTED} has to used in the \Sec{TRANSFORMATION} input
module of the \Sec{*WAVE FUNCTION} input section. For standard
calculation you will in general not need to change any of the
default settings.

\begin{description}
\item[\Key{COMND}]

\item[\Key{DELAO}]

\item[\Key{INTSYM}]\verb| |\newline
\verb|READ (LUCMD, *) ISNTSYM|

Symmetry of the two-electron integrals that are to be sorted.
Default is totally-symmetric two-electron integrals (\verb|INTSYM|
= 1).

\item[\Key{IO PRI}]\verb| |\newline
\verb|READ (LUCMD, *) ISPRFIO|

Set the print level in the fast-I/O routines. Default is a print level of 0.

\item[\Key{KEEP}]

\item[\Key{PRINT}]\verb| |\newline
\verb|READ (LUCMD, *) ISPRINT|

Print level in the integral sorting routines.

\item[\Key{SORST}]

\item[\Key{THRQ}]\verb| |\newline
\verb|READ (LUCMD, *) THRQ|

Threshold for setting an integral to zero. By default this threshold
is 1.0D-15.

\end{description}

\subsection{Construction of the supermatrix file:
\Sec{SUPINT}}\label{sec:supint}

Directives affecting the construction of the
supermatrix\index{supermatrix} file is given
in the \Sec{SUPINT} section.

\begin{description}
\item[\Key{NOSYMM}] No advantage is taken of integral symmetry in the
construction of the supermatrix file. This may increase the disc space
requirements as well as  CPU time. Since \aba\ do not use the
supermatrix file (which it in the current version does not), this
keyword is mainly for debugging purposes.

\item[\Key{OLDSUP}] An old output format for the supermatrix file
will be used. Obsolete keyword. Do not use.

\item[\Key{PRINT}]\verb| |\newline
\verb|READ (LUCMD,*) IPRSUP|

Set the print level during the construction of the supermatrix file.
Read one more line containing the print level. Default is the
value of \verb|IPRDEF| in the \Sec{*INTEGRALS} input module.

\item[\Key{SKIP}] Skip the construction of the supermatrix file.
An alternative keyword is \Key{NOSUP} in the \Sec{*INTEGRALS} input
module.

\item[\Key{THRESH}]\verb| |\newline
\verb|READ (LUCMD,*) THRSUP|

Threshold for the supermatrix integrals. Read one more line containing
the threshold. Default is the same as the threshold for
discarding the two-electron integrals (see the chapter describing the
\mol\ input format, Ch.~\ref{ch:molinp}).
\end{description}

\subsection{Two-electron integrals: \Sec{TWOINT}}

Directives affecting the two-electron\index{two-electron integral}
undifferentiated Hamiltonian
integral calculation appear in the \Sec{TWOINT} section.
\begin{description}
\item[\Key{ICEDIF}]\verb| |\newline
\verb|READ (LUCMD,*) ICDIFF,IEDIFF|

Screening\index{intgral screening} threshold for Coulomb and exchange
contributions to the Fock
matrix in direct and parallel calculations. The thresholds for the
integrals will ten to the power of these numbers. By default the same
screening threshold will be used for Coulomb and exchange
contribution which will change dynamically as the wave function converges more and more tightly.

\item[\Key{IFTHRS}]\verb| |\newline
\verb|READ (LUCMD,*) IFTHRS|

Screening threshold\index{integral screening} used in direct and
parallel calculations. The integral threshold will be ten to the
negative power of this number. The default is that this value will change dynamically as the wave function converges more and more tightly.

\item[\Key{PANAS}] Calculates scaled two-electron integrals as
proposed by Panas as a simple way of introducing electron
correlation in calculations of molecular energies~\cite{ipcpl245}.

\item[\Key{PRINT}]\verb| |\newline
\verb|READ (LUCMD, '(5I5)') IPRINT, IPRNTA, IPRNTB, IPRNTC, IPRNTD|

Set print level for the derivative integral calculation of a particular shell
quadruplet.  Read one more line containing print level and the four
shell indices~(5I5).  The print level is changed from the default
for this quadruplet only.

\item[\Key{RETURN}] Stop after the shell quadruplet specified
under \Key{PRINT} above. Mainly for debugging purposes.

\item[\Key{SKIP}] Skip the calculation of two-electron Hamiltonian
integrals. An alternative keyword is \Key{NOTWO} in the \Sec{*INTEGRALS}
input module.

\item[\Key{SOFOCK}] Construct the Fock matrix in symmetry-orbital
basis during a direct or parallel calculation. Currently not active.

\item[\Key{THRFAC}] Not used in \siraba .

\item[\Key{TIME}] Provide detailed timing breakdown for the
two-electron integral calculation.
\end{description}
