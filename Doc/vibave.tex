\chapter{Vibrational corrections}\label{ch:vibave}

\siraba\ provides an efficient automated procedure for calculating
rovibrationally averaged molecular $r_0$ geometries, as well as an
automated procedure for calculating vibrational averages of a large
range of second-order molecular properties, for SCF and MCSCF wave
functions. In the current implementation, it is not possible to
exploit point-group symmetry, and one must ensure that the symmetry is
turned off in the calculation.

\begin{center}
\fbox{
\parbox[h][\height][l]{12cm}{
\small
\noindent
{\bf Reference literature:}
\begin{list}{}{}
\item Effective geometries: P.-O.~{\AA}strand, K.~Ruud and
P.~R.~Taylor.\newblock {\em J.Chem.Phys}, {\bf 112},\hspace{0.25em},
2655 (2000).
\item Vibrational averaged properties: K.~Ruud, P.-O.~{\AA}strand and
P.~R.~Taylor.\newblock {\em J.Chem.Phys.}, {\bf
112},\hspace{0.25em}2668, (2000). 
\item Temperature and isotope effects: K.~Ruud, J.~Lounila and
J.~Vaara. \newblock {\em J.Chem.Phys.}, to be published.
\end{list}
}}
\end{center}

\section{Effective geometries}\label{sec:effgeom}

The (ro)vibrationally averaged geometries\index{effective
geometries}\index{vibrationally averaged
geometries}\index{rovibrationally averaged geometries} can be
calculated from a knowledge of part of the cubic force field

\begin{equation}
\left<r_i\right> = r_{e,i} -
\frac{1}{4\omega_i}\sum_{j=1}^{3N-6}\frac{V^{\left(3\right)}_{ijj}}{\omega_j^2}
\end{equation}
where the summation runs over all normal modes in the molecule and
where $\omega_i$ is the harmonic frequency of normal mode $i$ and
$V^{\left(3\right)}_{ijj}$ is the cubic force field. A typical input
for determining (ro)vibrationally averages Hartree--Fock geometries
for different water isotopomers will look like

\begin{verbatim}
**DALTON INPUT
.WALK
*WALK
.ANHARM
.DISPLACEMENT
0.001
.TEMPERATURES
 4
 0.0 300.0 500.0 1000.0
**WAVE FUNCTIONS
.HF
*HF INPUT
.THRESH
 1.0D-10
**START
*RESPONS
.THRESH
 1.0D-5
**PROPERTIES
*RESPONS
.THRESH
 1.0D-5
**FINAL
.VIBANA
*RESPONS
.THRESH
 1.0D-5
*VIBANA
.ISOTOPES
 4 3
 1 2 1
 1 2 2
 2 1 1
*END OF INPUT
\end{verbatim}

The calculation of (ro)vibrationally averaged geometries are invoked
be the keyword \verb|.ANHARM| in the \verb|*WALK| input module. In
this example, the full cubic force field will be determined as 
first derivatives of analytical molecular Hessians. This will be done
in Cartesian coordinates, and the calculation will therefore require
the evaluation of $6K + 1$ analytical Hessians, where $K$ is the
number of atoms in the molecules. Although expensive, it allows to
calculate (ro)vibrationally for any isotopic spicies, in the above
example for H$_2\;^{16}$O, HD$_2\;^{16}$O, D$_2\;^{16}$O,
H$_2\;^{18}$O. This is directed by the keyword \verb|.ISOTOPES|. We
note that the most abundant isotope will always be calculated, and are
therefore not included in the list above.

We have requested that rovibrationally averaged geometries be
calculated for 5 different temperatures. By default, these geometries
will include centrifugal distortions~\cite{krjljvjcp}. This can be
turned by using the keyword \verb|.NO CENT| in the \verb|*WALK| input
module.

By default, the numerical differentiation will use a step length of
0.0001 bohr. Experience show this to be too short~\cite{poakrprtjcp112}, and we have
therefore changed this to be 0.001 bohr in the example above by the
use of the keyword \verb|.DISPLACMENT| in the \verb|*WALK| input
module.

If only one (or a few) isotopic species are of interest, we can significantly
speed up the calculation of the (ro)vibrationally averaged geometries
by doing the numberical differentiation in the normal coordinates of
the isotopic species of interest. This can be requested through the
keyword \verb|.NORMAL|. The relevant part of the cubic purce field is
then calculated as numerical second derivatives of analytical
gradients. We note that the suggested step length in this case should
be set to 0.0075~\cite{poakrprtjcp112}. We note that we will still need to calculate one
analytical Hessian in order to determine the normal coordinates.

As the default maximum number of iterations in the \verb|*WALK| is 25,
one will have to specify the appropriate number of iterations by using
the keyword \verb|.MAX IT| in the \verb|**DALTON INPUT| module if the
molecule being studied have more than 4-5 atoms.

\section{Vibrational averaged
geometries}\label{sec:solventinp}\index{vibrational
corrections}\index{zero-point vibrational
corrections}\index{temperature effects}

The change in the geometry accounts for part of the contribution to a
vibrationally averaged property, namely that due to the anharmonicity
of the potential~\cite{krpoaprtjacs123}. Although this term is important, we need to
include also the contribution from the averaging of the molecular
property over the harmonic oscillator wave function in order to get an
accurate estimate of the vibrational corrections to the molecular
property. 

At the effective geometry, this contribution to for instance the
nuclear shielding constants can be obtained from the following input
\begin{verbatim}
**DALTON INPUT
.WALK
*WALK
.VIBAVE
.DISPLACEMENT
0.05
.TEMPERATURES
 1
 300.0
**WAVE FUNCTIONS
.HF
*HF INPUT
.THRESH
 1.0D-10
**START
.SHIELD
.ISOTOPE
 3
 3 2 1
*LINRES
.THRESH
 1.0D-6
*RESPONS
.THRESH
 1.0D-5
**PROPERTIES
.SHIELD
.ISOTOPE
 3
 3 2 1
*LINRES
.THRESH
 1.0D-6
*RESPONS
.THRESH
 1.0D-5
*END OF INPUT
\end{verbatim}

This input will calculate the harmonic contribution to the
(ro)vibrational average to the nuclear shielding constants at 300K for
$^{17}$ODH. It is important to realize that since each isotopic
species for each temperature will have its own unique
(ro)vibrationally averaged geometry, we will have to calculate the
harmonic contribution for each temperature and each isotopic species
separately. 

This calculation will always be doen in normal coordinates, and the
recommended step length is 0.05~\cite{krpoaprtjcp112}. As for the calculation of
(ro)vibrationally averaged geometries in normal coordinates, the
calculation requires the determination of one analytical Hessian in
order to determine the harmonic force field.

As the default maximum number of iterations in the \verb|*WALK| is 25,
one will have to specify the appropriate number of iterations by using
the keyword \verb|.MAX IT| in the \verb|**DALTON INPUT| module if the
molecule being studied have more than 4-5 atoms.

